(function(t){function e(e){for(var i,n,o=e[0],l=e[1],c=e[2],d=0,u=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&u.push(a[n][0]),a[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);h&&h(e);while(u.length)u.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],i=!0,o=1;o<s.length;o++){var l=s[o];0!==a[l]&&(i=!1)}i&&(r.splice(e--,1),t=n(n.s=s[0]))}return t}var i={},a={app:0},r=[];function n(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=i,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(s,i,function(e){return t[e]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var h=l;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("cd49")},"0417":function(t,e,s){"use strict";var i=s("d33c"),a=s.n(i);a.a},"0959":function(t,e,s){"use strict";var i=s("baa7"),a=s.n(i);a.a},"0ec6":function(t,e,s){},1:function(t,e){},1030:function(t,e,s){},"11a6":function(t,e,s){"use strict";var i=s("e02b"),a=s.n(i);a.a},"15d1":function(t,e,s){"use strict";var i=s("7bda"),a=s.n(i);a.a},"1f7e":function(t,e,s){"use strict";var i=s("f0c9"),a=s.n(i);a.a},"1f83":function(t,e,s){"use strict";var i=s("85dc"),a=s.n(i);a.a},2:function(t,e){},"28ce":function(t,e,s){},"29e8":function(t,e,s){"use strict";var i=s("71ce"),a=s.n(i);a.a},3:function(t,e){},"31a1":function(t,e,s){"use strict";var i=s("535a"),a=s.n(i);a.a},"320c":function(t){t.exports=JSON.parse('{"SERVER_URL":"https://raw.githubusercontent.com/uwgraphics/BoxerData/master/","datasets":{"Iris":{"path":"datasets/iris/","description":"","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/publication/demo/","views_recommendation":[{"name":"Performance_Overall"},{"name":"Histogram","config":["SepalLengthCm"]}]},"Imputation":{"path":"datasets/imputation/","description":"This use case uses Mushroom dataset and considers a testing set of 2,000 (of 8,124) randomly selected instances.","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/model-selection/","views_recommendation":[{"name":"MetricsParallel"},{"name":"Performance_Overall"},{"name":"Histogram","config":["sColour"]}]},"IMDB Confidence":{"path":"datasets/confidence/","description":"The data consists of 5044 movies with 27 features, however, 25% is sequestered for final assessment. A stratified sampling of 200 movies per class is held out from the 3756 for testing.","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/model-selection-tuning/","views_recommendation":[{"name":"Performance_Overall"},{"name":"CumulativeAccuracy"},{"name":"Histogram","config":["ClassDistribution"]}]},"recid":{"path":"datasets/recid/","description":"We consider a standard test case for fair learning: the Broward County recidivism dataset, popularized by ProPublica. The data set contains 6,172 instances and 14 numeric features (created by one-hot encoding the categorical features in the initial seven feature data set). 20% are held for testing.","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/fairness-assessment/","views_recommendation":[{"name":"Histogram","config":["race"]},{"name":"Performance_Selection"},{"name":"ConfusionMatrixGrid"}]},"date-12000-strat":{"path":"datasets/date-12000-strat/","description":"The dataset for this use case is the TCP collection of historical documents. This use case took a random sample of 12,000 documents, and held out 30% using stratified sampling. While the testing set is balanced (1,800 per class), the training set is highly skewed (only 15% before 1642)","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/bias-discovery/","views_recommendation":[{"name":"Performance_Overall"},{"name":"MetricsParallel"},{"name":"ConfusionMatrixGrid"},{"name":"Histogram","config":["date-bucket"]}]},"fuzz-mod-5-02":{"path":"datasets/fuzz-mod-5-02/","description":"The data set is a collection of 554 plays written in the Early Modern Period (1470-1660). Five linguistic features are used. We classify plays with one of four genres (Comedy, History, Tragedy and Tragicomedy).","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/feature-sensitivity/","views_recommendation":[{"name":"Performance_Overall"},{"name":"MetricsTable"},{"name":"Performance_Selection"}]},"tcp-tree-select-9-10":{"path":"datasets/tcp-tree-select-9-10/","description":"This use case considers a corpus of 59,989 documents from a historical literary collection and the data counts the 500 most common English words in each document.","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/model-selection-discovery/","views_recommendation":[{"name":"MetricsParallel"},{"name":"Performance_Overall"},{"name":"CumulativeAccuracy"},{"name":"Histogram","config":["ClassDistribution"]}]},"(continuous) wine quality":{"path":"datasets/wine_quality_one_classifier/","description":"This use case illustrates how detailed comparisons can improve threshold selection. The scenario uses wine quality benchmark from  which requires classifying the quality of a wine from its properties.","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/continuous-tuning/","views_recommendation":[{"name":"Performance_Overall"},{"name":"Histogram","config":["ClassDistribution"]},{"name":"MetricsTable"},{"name":"Trinary_Instance_Distribuion","config":{"selection":"overall","distribution":"score"}},{"name":"Thresholds","config":{"rf":50}},{"name":"Bandwidths","config":{"rf":"0.45-0.55"}}]},"(continuous) heart disease":{"path":"datasets/heart_disease/","description":"The Heart Disease prediction dataset is a standard data set used in machine learning education. Classifiers are trained to predict if a patient is likely to develop a disease (binary decision). The scenario is an example where the cost of a false negative error (not warning a patient of a potential problem) is more costly than a false positive (which may cause extra caution, or fear). It is also a scenario where a \'no-prediction\' option is viable, recommending that patient is tested further has a lower cost than an error.","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/continuous-heart-example/","views_recommendation":[{"name":"Reliability_Curve","config":{"classifiers":["lr","rf"],"selection":"overall"}},{"name":"Trinary_Performance_Confidence","config":{"selection":"overall","distribution":"trinary"}},{"name":"UncertaintyHeatMap","config":{"classifiers":["rf"],"correlationMode":"precision"}},{"name":"Trinary_Bandwidth_Assessment","config":{"classifiers":["knn"],"evaluation":"accuracy"}},{"name":"Trinary_Instance_Distribuion","config":{"selection":"overall","distribution":"score"}},{"name":"Histogram","config":["sex"]},{"name":"Thresholds","config":{"lr":50,"knn":50,"rf":50}},{"name":"Bandwidths","config":{"lr":"0.2-0.55","knn":"0.45-0.55","rf":"0.45-0.55"}}]},"(continuous) income":{"path":"datasets/income_original","description":"This use case demonstrates how calibration benefits from detailed assessment. The scenario uses the income classification benchmark dataset from that has been downsampled. Classifiers determine whether an individual’s income is above a certain level.","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/continous-model-selection/","views_recommendation":[{"name":"Performance_Overall"},{"name":"Reliability_Curve","config":{"classifiers":["lr","nb"],"selection":"overall"}},{"name":"Trinary_Performance_Confidence","config":{"selection":"overall","distribution":"trinary"}},{"name":"Trinary_Instance_Distribuion","config":{"selection":"overall","distribution":"score"}},{"name":"Thresholds","config":{"lr":50,"nb":50,"mlp":50}},{"name":"Bandwidths","config":{"lr":"0.40-0.60","nb":"0.40-0.60","mlp":"0.40-0.60"}}]},"(continuous) income2":{"path":"datasets/income2","description":"This is the income use case adapted to make a smaller figure in the paper.","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/continous-model-selection/","views_recommendation":[{"name":"Performance_Overall"},{"name":"Reliability_Curve","config":{"classifiers":["lr","nb"],"selection":"overall"}},{"name":"Trinary_Performance_Confidence","config":{"selection":"overall","distribution":"trinary"}},{"name":"Trinary_Instance_Distribuion","config":{"selection":"overall","distribution":"score"}},{"name":"Thresholds","config":{"lr":50,"nb":50}},{"name":"Bandwidths","config":{"lr":"0.40-0.60","nb":"0.40-0.60"}}]},"(continuous) cifar-sampled-scaling":{"path":"datasets/coarse-flowers-1in10-vgg16-scaling-0.0510","description":"This use case shows how out approach can help with model selection and threshold tuning. A classifier was built for the CIFAR 100 computer vision benchmark using Tensorflow. The data set has 100 classes, and the trained classifier produces a distribution over these classes as its decision. Our goal is to create a binary classifier for a “meta-class” which combines 5 of the main classes. In particular, we want to classify flowers, which can be any one of 5 of the original classes. Because the test set contains all 100 classes, it is quite imbal- anced: flowers are only 5% of the total instances","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/continous-detail-examination/","views_recommendation":[{"name":"Reliability_Curve","config":{"classifiers":["largest","avgtop5","sum"],"selection":"overall"}},{"name":"Trinary_Bandwidth_Assessment","config":["largest"]},{"name":"Rejected_Curve","config":{"classifiers":["largest","avgtop5","sum"],"selection":"overall","evaluation":"c_accuracy"}},{"name":"Trinary_Performance_Confidence","config":{"selection":"overall","distribution":"trinary"}},{"name":"Trinary_Instance_Distribuion","config":{"selection":"overall","distribution":"score"}},{"name":"FocusItem"},{"name":"Thresholds","config":{"largest":30,"avgtop5":10,"sum":50}},{"name":"Bandwidths","config":{"largest":"0.12-0.48","avgtop5":"0.06-0.16","sum":"0.46-0.54"}}]},"(continuous) cdate-2500":{"path":"datasets/cdate-2500","description":"This use case considers a corpus of 59,989 documents from a historical literary collection: Text Creation Partnership (TCP) transcriptions of the Early English Books Online (EEBO). The data counts the 500 most common English words in each document. For the experiment, we took a random sample of 2500 documents, and held out 30% using stratified sampling.            ","related_use_case":"https://uwgraphics.github.io/BoxerDocs/docs/use_cases/continuous-exmanination/","views_recommendation":[{"name":"Histogram","config":["date-bucket"]},{"name":"Trinary_Performance_Confidence","config":{"selection":"overall","distribution":"trinary"}},{"name":"Thresholds","config":{"rf":70,"rf-bal":70,"lr":70,"lr-bal":70}},{"name":"Bandwidths","config":{"rf":"0.65-0.75","rf-bal":"0.65-0.75","lr":"0.65-0.75","lr-bal":"0.65-0.75"}}]}}}')},3334:function(t,e,s){},3599:function(t,e,s){},"3b11":function(t,e,s){},"3cd7":function(t,e,s){},"3d07":function(t,e,s){"use strict";var i=s("97da"),a=s.n(i);a.a},"3f5e":function(t,e,s){"use strict";var i=s("9498"),a=s.n(i);a.a},4:function(t,e){},"472f":function(t,e,s){"use strict";var i=s("b1e1"),a=s.n(i);a.a},"47a9":function(t,e,s){"use strict";var i=s("6aca"),a=s.n(i);a.a},"4cc2":function(t,e,s){},"4d02":function(t,e,s){"use strict";var i=s("28ce"),a=s.n(i);a.a},5:function(t,e){},"535a":function(t,e,s){},"552c":function(t,e,s){"use strict";var i=s("3334"),a=s.n(i);a.a},"5ae2":function(t,e,s){"use strict";var i=s("84c6"),a=s.n(i);a.a},6:function(t,e){},"647d":function(t,e,s){"use strict";var i=s("7267"),a=s.n(i);a.a},6836:function(t,e,s){"use strict";var i=s("ebf0"),a=s.n(i);a.a},"69e9":function(t,e,s){"use strict";var i=s("0ec6"),a=s.n(i);a.a},"6aca":function(t,e,s){},"6cb2":function(t,e,s){"use strict";var i=s("9e1a"),a=s.n(i);a.a},"6d4b":function(t,e,s){"use strict";var i=s("3599"),a=s.n(i);a.a},"71ce":function(t,e,s){},7267:function(t,e,s){},"75d2":function(t,e,s){"use strict";var i=s("3b11"),a=s.n(i);a.a},"7bda":function(t,e,s){},"84c6":function(t,e,s){},"85dc":function(t,e,s){},"8e5a":function(t,e,s){"use strict";var i=s("b916"),a=s.n(i);a.a},9498:function(t,e,s){},"97da":function(t,e,s){},"9e1a":function(t,e,s){},b1e1:function(t,e,s){},b8a9:function(t,e,s){"use strict";var i=s("ce11"),a=s.n(i);a.a},b916:function(t,e,s){},baa7:function(t,e,s){},c648:function(t,e,s){"use strict";var i=s("f481"),a=s.n(i);a.a},cd49:function(t,e,s){"use strict";s.r(e);var i=s("2b0e"),a=s("f309");i["a"].use(a["a"]);const r={};var n=new a["a"](r),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",[s("div",{staticClass:"app-container"},[s("div",{staticClass:"app-bar"},[s("v-dialog",{attrs:{"max-width":"400"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[s("v-btn",t._g({attrs:{fab:"",small:""}},i),[s("v-icon",[t._v("add")])],1)]}}]),model:{value:t.load_dialog,callback:function(e){t.load_dialog=e},expression:"load_dialog"}},[s("DatasetSelectorPopup")],1),s("span",{staticClass:"dataset-title"},[t._v(t._s(t.$store.state.chosenDataset.name))]),s("v-btn",{staticClass:"ml-10",attrs:{fab:"",small:""},on:{click:t.change_grid_size}},[s("v-icon",[t._v("grid_on")])],1),s("v-menu",{staticClass:"select_view",attrs:{"close-on-click":"",transition:"slide-y-transition"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[s("v-btn",t._g(t._b({staticClass:"ml-5"},"v-btn",a,!1),i),[t._v("Views")])]}}])},[s("v-list",t._l(t.viewsMapping,(function(e){return s("v-list-item",{key:e.view,on:{click:function(){return t.$store.dispatch("openView",e.view)}}},[s("v-list-item-title",[s("v-btn",{attrs:{block:"",color:"white"}},[t._v(t._s(e.view_name))])],1)],1)})),1)],1),s("multiselect",{staticClass:"select_classifiers",attrs:{placeholder:"Excluded classifiers",options:t.classifiers,multiple:""},model:{value:t.value_classifier,callback:function(e){t.value_classifier=e},expression:"value_classifier"}}),s("v-btn",{staticClass:"ml-10",on:{click:function(e){return t.save_views()}}},[t._v("Save Views")]),s("v-btn",{staticClass:"ml-10",on:{click:function(e){return t.reload_views()}}},[t._v("Reload Views")]),s("v-btn",{staticClass:"ml-16",on:{click:function(e){return t.btnClick("Git Repo")}}},[t._v("Git Repo")]),s("v-menu",{staticClass:"select_help",attrs:{"close-on-click":"",transition:"slide-y-transition"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[s("v-btn",t._g(t._b({staticClass:"ml-5"},"v-btn",a,!1),i),[t._v("Help")])]}}])},[s("v-list",t._l(t.helpButtons,(function(e){return s("v-list-item",{key:e.name,on:{click:function(){return t.btnClick(e.name)}}},[s("v-list-item-title",[s("v-btn",{attrs:{block:"",color:"white"}},[t._v(t._s(e.name))])],1)],1)})),1)],1)],1),s("div",{staticClass:"main"},[s("div",{staticClass:"NavigationDrawer is-closed",attrs:{id:"nav-1"}},[s("Navbar")],1),s("RigidTileHome"),s("v-snackbar",{staticStyle:{"text-align":"center"},attrs:{timeout:0},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[s("span",[t._v("SET UNION MODE")])])],1)])])},l=[],c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",[s("div",{attrs:{id:"app"}},[s("vue-instant-loading-spinner",{ref:"Spinner"})],1),s("v-card-title",[s("h2",[t._v("Dataset list")])]),s("v-card-text",[s("v-list",t._l(Object.keys(this.$store.state.datasets),(function(e){return s("v-list-item",{key:e,on:{click:function(s){t.changedDatasetByName(e),t.test()}}},[s("v-list-item-content",[s("v-list-item-title",{domProps:{textContent:t._s(e)}})],1)],1)})),1),s("v-layout",[s("v-flex",{attrs:{xs8:""}},[s("v-text-field",{attrs:{label:"Enter Custom Dataset URL",outline:""},model:{value:t.customDatasetURL,callback:function(e){t.customDatasetURL=e},expression:"customDatasetURL"}})],1),s("v-flex",{attrs:{xs4:""}},[s("v-btn",{on:{click:function(){t.changedDataset(t.customDatasetURL),t.customDatasetURL="",t.test()}}},[t._v("Load")])],1)],1),s("v-btn",{on:{click:function(){t.btnClick()}}},[t._v("Help preparing your own data")])],1)],1)},h=[],d=s("2f62"),u=s("9ff4"),p=i["a"].extend({name:"DatasetSelectorPopup",components:{VueInstantLoadingSpinner:u["a"]},data(){return{customDatasetURL:""}},methods:Object.assign({btnClick(){console.log("click",this.$store.state.datasets),window.open("https://pages.graphics.cs.wisc.edu/BoxerDocs/docs/user_guide/data_preparation/")},test:function(){console.log("call test"),this.$refs.Spinner.show(),setTimeout(function(){this.$refs.Spinner.hide()}.bind(this),5e3)}},Object(d["b"])(["changedDataset","changedDatasetByName"]))}),f=p,m=s("2877"),g=s("6544"),v=s.n(g),y=s("8336"),_=s("b0af"),x=s("99d9"),b=s("0e8f"),w=s("a722"),C=s("8860"),k=s("da13"),S=s("5d23"),z=s("8654"),$=Object(m["a"])(f,c,h,!1,null,null,null),F=$.exports;v()($,{VBtn:y["a"],VCard:_["a"],VCardText:x["a"],VCardTitle:x["b"],VFlex:b["a"],VLayout:w["a"],VList:C["a"],VListItem:k["a"],VListItemContent:S["a"],VListItemTitle:S["c"],VTextField:z["a"]});var T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-expansion-panel",{attrs:{expand:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("div",{staticClass:"title"},[t._v("Settings")]),s("v-expansion-panel-content",[s("div",{attrs:{slot:"header"},slot:"header"},[t._v("Data Source")]),s("DatasetSelector")],1)],1)],1)},E=[],I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",[s("v-list",{attrs:{"two-line":"",subheader:""}},[s("v-list-tile",[s("v-list-tile-content",[s("v-list-tile-title",[t._v(t._s(t.$store.state.chosenDataset.name))]),s("v-list-tile-sub-title",[t._v("Current Dataset")])],1)],1),s("v-dialog",{attrs:{"max-width":"400"}},[s("v-btn",{attrs:{slot:"activator",fab:"",small:"",color:"light-blue white--text"},slot:"activator"},[s("v-icon",[t._v("add")])],1),s("DatasetSelectorPopup")],1),t._v(" Load new dataset ")],1)],1)},P=[],D=i["a"].extend({name:"DatasetSelector",components:{DatasetSelectorPopup:F},data(){return{datasetFilepath:"@/assets/actual_output.dat"}}}),O=D,A=s("169a"),B=s("132d"),M=Object(m["a"])(O,I,P,!1,null,null,null),R=M.exports;v()(M,{VBtn:y["a"],VCard:_["a"],VDialog:A["a"],VIcon:B["a"],VList:C["a"]});var H=i["a"].extend({name:"Navbar",components:{DatasetSelector:R},data(){return{drawer:!1,panel:[],links:[{text:"Histogram",route:"/histogram"},{text:"New Bar Chart",route:"/new-bar-chart"},{text:"Agreement Matrix",route:"/agreement-matrix"},{text:"Bar Chart",route:"/bar-chart"},{text:"Confusion Matrices",route:"/confusion-matrices"},{text:"Classifier Agreement",route:"/classifier-agreement"},{text:"Home",route:"/"},{text:"Flex Home",route:"/flex-home"}]}}}),V=H,j=s("cd55"),K=s("49e2"),N=Object(m["a"])(V,T,E,!1,null,"36c66adf",null),L=N.exports;v()(N,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"]});var W,q,U,Y,G,Q,J,X,Z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("draggable",{staticClass:"list-group visualizations",attrs:{tag:"div",handle:".handle"},model:{value:t.$store.state.views.open,callback:function(e){t.$set(t.$store.state.views,"open",e)},expression:"$store.state.views.open"}},t._l(t.$store.getters.visualizations,(function(e,i){return s("div",{key:i,class:"list-group-item tile",style:"width: "+t.viewWidthByName(e.name)+";"},[t.visualizationsWithoutExternalHandle.includes(e.name)?t._e():s("div",{staticClass:"top-bar"},[s("div",{staticClass:"handle"},[t._v(t._s(t.handleIcon))]),s("div",{staticClass:"tile-title"},[t._v(t._s(e.name))])]),s(e.name,{tag:"component",staticClass:"vis-component",attrs:{boxProps:e.boxProps,onClose:function(){return t.$store.dispatch("closeView",i)}}})],1)})),0),s("div",{staticClass:"sidebar"},[s("Sidebar")],1)],1)},tt=[],et=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Performance (Overall)")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Sort by accuracy"},model:{value:t.accuracySorting,callback:function(e){t.accuracySorting=e},expression:"accuracySorting"}},[s("v-radio",{attrs:{label:"ascending",value:"ascending"}}),s("v-radio",{attrs:{label:"descending",value:"descending"}}),s("v-radio",{attrs:{label:"alphabetical",value:"alphabetical"}}),s("v-radio",{attrs:{label:"none",value:""}})],1)],1),s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Evaluation method"},model:{value:t.evaluationSelection,callback:function(e){t.evaluationSelection=e},expression:"evaluationSelection"}},[s("v-radio",{attrs:{label:"accuracy",value:"accuracy"}}),s("v-radio",{attrs:{id:"mcc",label:"mcc",value:"mcc"}}),t.classNumber>2&&"continuous"!=t.datasetType?s("v-radio",{attrs:{label:"microf1",value:"microf1"}}):t._e(),t.classNumber>2&&"continuous"!=t.datasetType?s("v-radio",{attrs:{label:"macrof1",value:"macrof1"}}):t._e(),t.classNumber<=2||"continuous"==t.datasetType?s("v-radio",{attrs:{label:"f1",value:"f1"}}):t._e(),t.classNumber<=2||"continuous"==t.datasetType?s("v-radio",{attrs:{label:"precision",value:"precision"}}):t._e(),t.classNumber<=2||"continuous"==t.datasetType?s("v-radio",{attrs:{label:"recall",value:"recall"}}):t._e()],1)],1),s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Performance Type"},model:{value:t.weightedPerformance,callback:function(e){t.weightedPerformance=e},expression:"weightedPerformance"}},[s("v-radio",{attrs:{label:"normal",value:"normal"}}),s("v-radio",{attrs:{label:"weighted",value:"weighted"}})],1)],1)])],1)],1),s("div",{ref:"svg"})],1)},st=[],it=s("5698"),at=s("9ab4");function rt(t){return wt(t)/t.length}function nt(){const t={negation:!1,rule:X.NONE,classifier:"",classifier2:"",target:"",feature:"",value:"",numericValue:0};return t}function ot(t,e){const s={},i=jt(t);return"categorical"!==i.type?(console.error(t+" is not a categorical feature"),s):(i.categories.forEach(i=>{const a=ft({rule:X.FEATURE_EQ,feature:t,value:i}),r=gt(a);s[i]=_t(r,e)}),s)}function lt(t,e){const s=jt(t);let i={};"categorical"===s.type?i=ot(t,e):["interval","ratio"].includes(s.type)?i=ht(t,e):console.error(t,"could not be bucketed because of invalid type.");const a={};return Object.keys(i).forEach(t=>{a[t]=i[t].length}),a}function ct(t,e){const s=lt(t,e),i=wt(Object.values(s)),a={};return Object.keys(s).forEach(t=>{a[t]=s[t]/i}),a}function ht(t,e){const s={},i=jt(t);if(!["interval","ratio"].includes(i.type))return console.error(t+" is not a numeric feature"),s;const a=()=>{const s=10,i=e.map(e=>Nt(e).features[t]),a=Math.min(...i),r=Math.max(...i),n=it["k"]().domain([a,r]).thresholds(s).value(e=>{const s=Nt(e),i=s.features[t];return i})(e);return n.forEach(t=>{delete t.x0,delete t.x1}),n};return a().forEach((t,e)=>{s[e]=t}),s}function dt(){const t=(t,e)=>{const s=[];Object.keys(t).forEach(i=>{const a=e[i];if(0===a)return;const r=t[i];let n=0;if(r<a){const t=0,e=a;n=(r-t)/(e-t),n=1-n}else if(r>a){const t=a,e=1;n=(r-t)/(e-t)}s.push(n)});const i=rt(s);return i},e=Ht.state.overlapSelections.first;if(!e)return void console.error("First overlap selection is not defined.");const s=e.predicate;if(!s)return void console.error("First overlap selection's predicate is not defined.");const i=_t(s),a=[...Ht.getters.features],r=[...Ht.getters.instances],n=["categorical","interval","ratio"],o=t=>n.includes(jt(t).type),l=a.filter(o),c=l.map(e=>{const s=ct(e,r),a=ct(e,i);return{name:e,interestingness:t(a,s)}});c.sort((t,e)=>e.interestingness-t.interestingness),console.log("Interestingness"),c.forEach(t=>{console.log(t.interestingness,t.name)})}function ut(t,e,s){switch(s){case"intersection":const s={type:"and",predicates:[t,e]};return s;case"union":const i={type:"or",predicates:[t,e]};return i;case"difference":const a=t,r=e,n={type:"negated",predicate:r},o={type:"and",predicates:[a,n]};return o;case"complement":const l={type:"or",predicates:[t,e]},c={type:"negated",predicate:l};return c}}function pt(t){const{classifier:e,classifier2:s,feature:i,negation:a,rule:r,target:n,value:o}=t;switch(r){case X.ACTUAL:return a?"True target class was not "+n:"True target class was "+n;case X.AGREE:return a?`Classifiers ${e} and ${s} disagree`:`Classifiers ${e} and ${s} agree`;case X.FEATURE_EQ:return a?`${i} != ${o}`:`${i} = ${o}`;case X.FEATURE_GT:return a?`${i} <= ${o}`:`${i} > ${o}`;case X.FEATURE_LT:return a?`${i} >= ${o}`:`${i} < ${o}`;case X.PREDICTED:return a?`${e} did not predict ${n}`:`${e} predicted ${n}`;case X.RIGHT:return a?e+" was wrong":e+" was right";default:return"constraintToString does not recognize this constraint"}}function ft(t){const e=nt();return Object.assign(e,t)}function mt(t){const e=t=>!0;let s=e;if(!xt(t))return s;const{negation:i,rule:a,classifier:r,classifier2:n,target:o,feature:l,value:c}=t;switch(t.rule){case X.ACTUAL:s=t=>{const e=Nt(t);return e.actual===o};break;case X.AGREE:s=t=>{const e=Nt(t);return e.predictions[r]===e.predictions[n]};break;case X.FEATURE_EQ:s=t=>{const e=Nt(t);return e.features[l]===c};break;case X.FEATURE_GT:s=t=>{const e=Nt(t);return e.features[l]>c};break;case X.FEATURE_LT:s=t=>{const e=Nt(t);return e.features[l]<c};break;case X.PREDICTED:s=t=>{const e=Nt(t);return e.predictions[r]===o};break;case X.RIGHT:s=t=>{const e=Nt(t);return e.predictions[r]===e.actual};break;default:console.error("Case for some constraint is missing.");break}const h=t=>!s(t);return i?h:s}function gt(t){return{type:"simple",constraints:[t],metric:[]}}function vt(t){return mt(t)}function yt(t){switch(t.type){case"simple":const e=t.constraints.map(vt);return t=>e.every(e=>e(t));case"negated":const s=yt(t.predicate);return t=>!s(t);case"and":const i=t.predicates.map(yt);return t=>i.every(e=>e(t));case"or":const a=t.predicates.map(yt);return t=>a.some(e=>e(t))}}function _t(t,e){const s=[...Ht.getters.filteredInstances];e||(e=s);const i=yt(t),a=e.filter(i);return a}function xt(t){const{rule:e,classifier:s,classifier2:i,target:a,feature:r,value:n}=t;switch(e){case X.ACTUAL:return!!a;case X.AGREE:return!(!s||!i);case X.FEATURE_EQ:case X.FEATURE_GT:case X.FEATURE_LT:return!(!r||!n);case X.PREDICTED:return!(!s||!a);case X.RIGHT:return!!s;default:return!1}}function bt(t){const e=[],s=(Ht.getters.filteredClasses,Ht.getters.filteredClassifiers,[...Ht.getters.features]),i=_t(t),a=i.map(Nt),r=()=>{s.forEach(t=>{const s=t=>t.every(e=>e===t[0]),i=jt(t),r=a.map(e=>e.features[t]);switch(i.type){case"nominal":case"categorical":if(s(r)){const s=ft({rule:X.FEATURE_EQ,feature:t,value:r[0]});e.push(s)}break;case"ordinal":console.error("Ordinal variables not handled in predicate abstraction.");break;case"interval":case"ratio":const i=Math.min(...r),a=Math.max(...r);if(i===a){const s=ft({rule:X.FEATURE_EQ,feature:t,numericValue:r[0]});e.push(s)}else{const s=ft({rule:X.FEATURE_LT,negation:!0,feature:t,numericValue:i}),r=ft({rule:X.FEATURE_GT,negation:!0,feature:t,numericValue:a});e.push(s),e.push(r)}break}})};r(),console.log("valid constraints",e);const n=e.map(gt),o=(t,e)=>{const s=ut(t,e,"intersection"),i=_t(s),a=_t(t),r=i.length/a.length;return r},l=n.map(e=>({predicate:e,precision:o(e,t)}));return l.sort((t,e)=>e.precision-t.precision),console.log("precisions and predicates"),l.forEach(t=>{}),e}function wt(t){return t.reduce((t,e)=>t+e,0)}(function(t){t["Class"]="class",t["Classifier"]="classifier",t["Instance"]="instance"})(W||(W={})),function(t){t[t["Set"]=0]="Set",t[t["Clear"]=1]="Clear",t[t["Add"]=2]="Add",t[t["Remove"]=3]="Remove"}(q||(q={})),function(t){t["Include"]="include",t["Exclude"]="exclude"}(U||(U={})),function(t){t[t["Any"]=0]="Any",t[t["All"]=1]="All"}(Y||(Y={})),function(t){t["AND"]="and",t["MINUS"]="minus",t["OR"]="or",t["XOR"]="xor"}(G||(G={})),function(t){t["CA"]="Performance_Overall",t["SCP"]="Performance_Selection",t["COV"]="Performance_Per_Class",t["CC"]="Performance_Curves",t["CB"]="Trinary_Performance_Confidence",t["RC"]="Reliability_Curve",t["BA"]="Trinary_Bandwidth_Assessment",t["REC"]="Rejected_Curve",t["TID"]="Trinary_Instance_Distribuion",t["CMG"]="ConfusionMatrixGrid",t["FH"]="Histogram",t["UM"]="UncertaintyHeatMap",t["OCA"]="CumulativeAccuracy",t["PCC"]="PairwiseClassifierConsensus",t["SM"]="MetricsTable",t["SMP"]="MetricsParallel",t["ITL"]="InstanceList",t["SP"]="ScatterPlot",t["FI"]="FocusItem"}(Q||(Q={})),function(t){t["classifier"]="[ Classifier ]",t["feature"]="[ Feature ]",t["rule"]="[ Rule ]",t["target"]="[ Target Class ]"}(J||(J={})),function(t){t["ACTUAL"]="True target class",t["AGREE"]="Classifiers agree",t["FEATURE_EQ"]="Feature equals",t["FEATURE_GT"]="Feature greater than",t["FEATURE_LT"]="Feature less than",t["NONE"]="",t["PREDICTED"]="Classifier predicted target class",t["RIGHT"]="Classifier was right"}(X||(X={}));const Ct="#4393c3",kt="#2166ac",St="#d1e5f0",zt="#fc9236",$t="#cf6d17",Ft="#ffd9b3",Tt="#000000",Et=["#e6194B","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#42d4f4","#f032e6","#bfef45","#fabebe","#469990","#e6beff","#9A6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#a9a9a9"],It=Ct,Pt="#ffffff",Dt="#F5D300";let Ot={bad:zt,badDark:$t,badLight:Ft,categorical:Et,good:Ct,goodDark:kt,goodLight:St,highlight:Tt,overlapSelections:{first:"#18FFFF",second:"#FF40C1",background:"lightgray"},usual:It,white:Pt,focus:Dt};const At=s("f0db");i["a"].use(d["a"]);const Bt=s("320c"),Mt=Bt.datasets,Rt=Bt.SERVER_URL;var Ht=new d["a"].Store({state:{saveStatus:0,resumeStatus:0,saveConfig:{Reliability_Curve:[],Histogram:[],Performance_Curves:[],Trinary_Bandwidth_Assessment:[],Rejected_Curve:[],UncertaintyHeatMap:[],Trinary_Performance_Confidence:[],Trinary_Instance_Distribuion:[],Thresholds:{},Bandwidths:{}},resumedBandwidths:{},viewsConfig:[],chosenFixedDataset:{},fixedDataset:"yes",corsError:"",currentChosenSample:"",weightMode:"no",currentChosenFold:"",sampleList:[],sampleDict:{},selectedSampleSet:{first:null,second:null},validationList:[],addedThresholdClassifiers:[],curAddedThresholdClassifier:{},addedBandWidthClassifiers:[],withinClassifierBandWidthList:[],withinClassifierName:"",classifierBandWidthDict:{},bandWidthChangedClassifierName:"",outerBandWidth:{},classifierThresholdList:[],classifierThresholdDict:{},thresholdClassifierNameList:[],chosenClassifierThresholdTuple:{classifier:"",single_threshold:0},curveChosenClassifierThresholdTuple:{classifier:"",single_threshold:0},datasetType:"discrete",viewWidth:"50%",baseDataset:"both",baseSelection:{description:"Not yet set",id:-1,instances:new Set,name:"Not yet set",classifier:"null",className:"null",weight:0},chosenDataset:{name:"",classes:[],classifiers:[],features:{},instances:{}},datasets:Mt,hoverInstance:"",continuous_metrics:{},weighted_metrics:{},filters:{class:{type:U.Exclude,set:new Set},classifier:{type:U.Exclude,set:new Set},instance:{type:U.Exclude,set:new Set}},overlapSelections:{first:null,second:null},selectionHistory:[],focusItemId:null,focusSet:null,focusDotEmphasis:!1,modelSelections:null,modelSelectionHistory:[],selectionStrategy:Y.Any,views:{all:[Q.CA,Q.SCP,Q.COV,Q.CMG,Q.FH,Q.UM,Q.OCA,Q.PCC,Q.SM,Q.SMP,Q.ITL,Q.SP,Q.FI],open:[Q.CA,Q.FH]},intersectionMode:!0},mutations:{setSavesStatus(t,e){i["a"].set(t,"saveStatus",e)},setResumeStatus(t,e){i["a"].set(t,"resumeStatus",e)},setSaveConfig(t,e){i["a"].set(t.saveConfig,e["name"],e["config"])},setChosenFixedDataset(t,e){i["a"].set(t,"chosenFixedDataset",e)},setFixedDataset(t,e){i["a"].set(t,"fixedDataset",e)},setcorsError(t,e){i["a"].set(t,"corsError",e)},setContinuousMetrics(t,e){i["a"].set(t,"continuous_metrics",e)},setWeightMetrics(t,e){i["a"].set(t,"weighted_metrics",e)},setCurveChosenClassifierThresholdTuple(t,e){i["a"].set(t,"curveChosenClassifierThresholdTuple",e)},setChosenClassifierThresholdTuple(t,e){i["a"].set(t,"chosenClassifierThresholdTuple",e)},setWeightMode(t,e){i["a"].set(t,"weightMode",e)},setclassifierBandWidthDict(t,e){i["a"].set(t,"classifierBandWidthDict",e)},setWithinClassifierBandWidthList(t,e){i["a"].set(t,"withinClassifierBandWidthList",e)},setWithinClassifierName(t,e){i["a"].set(t,"withinClassifierName",e)},setBandWidthChangedClassifier(t,e){i["a"].set(t,"bandWidthChangedClassifierName",e)},setouterBandWidth(t,e){i["a"].set(t,"outerBandWidth",e)},setClassifierThresholdDict(t,e){i["a"].set(t,"classifierThresholdDict",e)},setThresholdClassifierNameList(t,e){i["a"].set(t,"thresholdClassifierNameList",e)},setResumedBandwidths(t,e){i["a"].set(t,"resumedBandwidths",e)},setViewsType(t,e){i["a"].set(t.views,"all",e)},setTileWidth(t,e){i["a"].set(t,"viewWidth",e)},setToggleIntersectionMode(t,e){i["a"].set(t,"intersectionMode",e)},setBaseSelection(t,e){i["a"].set(t,"baseSelection",e)},setOpenViews(t,e){i["a"].set(t.views,"open",e)},setViewsConfig(t,e){i["a"].set(t,"viewsConfig",e)},setOverlapSelection(t,e){const{whichOverlap:s,selection:a}=e,r=Object.assign({},t.overlapSelections);r[s]=a,i["a"].set(t,"overlapSelections",r),console.log(`Set ${s} selection set to`,t.overlapSelections[s])},setSampleSelection(t,e){const{whichOverlap:s,selection:a}=e,r=Object.assign({},t.selectedSampleSet);r[s]=a,i["a"].set(t,"selectedSampleSet",r)},setSampledList(t,e){i["a"].set(t,"sampleList",e)},setValidationdList(t,e){i["a"].set(t,"validationList",e)},setCurrentChosenSample(t,e){i["a"].set(t,"currentChosenSample",e)},setCurrentChosenFold(t,e){i["a"].set(t,"currentChosenFold",e)},setSampleData(t,e){const s=e.selection;i["a"].set(t,"sampleDict",s),i["a"].set(t,"baseDataset","sample")},setSelectionHistory(t,e){i["a"].set(t,"selectionHistory",e);const s=t.selectionHistory[0].predicate;s&&bt(s)},setAddedThresholdClassifiers(t,e){i["a"].set(t,"addedThresholdClassifiers",e)},setAddedBandWidthClassifiers(t,e){i["a"].set(t,"addedBandWidthClassifiers",e)},setCurAddedThresholdClassifier(t,e){i["a"].set(t,"curAddedThresholdClassifier",e)},mutateFocusItem(t,e){i["a"].set(t,"focusItemId",e)},mutateFocusSet(t,e){i["a"].set(t,"focusSet",e)},setEmphasis(t,e){i["a"].set(t,"focusDotEmphasis",e)},setAddedClassifier(t,e){i["a"].set(t,"addedClassifier",e)},setAdditionalClassifiers(t,e){i["a"].set(t,"additionalClassifiers",e)},setModelSelection(t,e){const{selection:s}=e;i["a"].set(t,"modelSelections",s)},setChosenDataset(t,e){i["a"].set(t,"chosenDataset",e)},setHoverInstance(t,e){i["a"].set(t,"hoverInstance",e)},setFilter(t,e){i["a"].set(t.filters,e.entityType,e.newFilter)}},actions:{resumeViews(t){const e=this.state.chosenFixedDataset["views_recommendation"].map(t=>t.name).filter(t=>"Bandwidths"!=t&&"Thresholds"!=t);t.commit("setOpenViews",e);const s=this.state.chosenFixedDataset["views_recommendation"].filter(t=>"Thresholds"==t.name),i=this.state.chosenFixedDataset["views_recommendation"].filter(t=>"Bandwidths"==t.name);if(s.length>0){let e={},i=Object.keys(t.state.classifierThresholdDict);i.forEach(t=>{Object.keys(s[0].config).includes(t)&&""!=t&&(e[t]=s[0].config[t])}),t.commit("setClassifierThresholdDict",e)}if(i.length>0){let e={};Object.keys(this.getters.classifierThresholdDict).forEach(t=>{if(""!=t){let s=parseFloat(i[0].config[t].split("-")[0]),a=parseFloat(i[0].config[t].split("-")[1]);e[t]={left_range:s,right_range:a}}}),t.commit("setResumedBandwidths",e)}t.commit("setViewsConfig",this.state.chosenFixedDataset["views_recommendation"]),t.commit("setResumeStatus",t.state.resumeStatus+1)},changedSaveConfig(t,e){t.commit("setSaveConfig",e)},reloadViews(t){const e="views_config.json";setTimeout(()=>{At.readFile(e,"utf-8",(function(e,s){let i=JSON.parse(s);const a=i["views_recommendation"].map(t=>t.name).filter(t=>"Bandwidths"!=t&&"Thresholds"!=t);t.commit("setOpenViews",a);const r=i["views_recommendation"].filter(t=>"Thresholds"==t.name),n=i["views_recommendation"].filter(t=>"Bandwidths"==t.name),o=i["views_recommendation"].filter(t=>"Selections"==t.name);if(o[0]["config"]["instances"]=new Set(o[0]["config"]["instances"]),t.dispatch("prependToSelectionHistory",o[0].config),t.dispatch("changedMostRecentSelection","first"),r.length>0&&t.commit("setClassifierThresholdDict",r[0].config),n.length>0){let e={};Object.keys(t.state.classifierThresholdDict).forEach(t=>{let s=parseFloat(n[0].config[t].split("-")[0]),i=parseFloat(n[0].config[t].split("-")[1]);e[t]={left_range:s,right_range:i}}),t.commit("setResumedBandwidths",e)}t.commit("setViewsConfig",i["views_recommendation"]),t.commit("setResumeStatus",t.state.resumeStatus+1)}))},1e3)},saveViews(t){t.commit("setSavesStatus",t.state.saveStatus+1)},wrtieConfig(t){const e="views_config.json";setTimeout(()=>{const s=t.state.views.open,i=Object.keys(t.state.saveConfig);let a={views_recommendation:[]};s.forEach(e=>{"Selections"!=e.toString()&&(i.includes(e)?a["views_recommendation"].push({name:e,config:t.state.saveConfig[e]}):a["views_recommendation"].push({name:e}))});let r={};for(let e in t.state.selectionHistory[0])r[e]="instances"==e?[...t.state.selectionHistory[0][e]]:t.state.selectionHistory[0][e];if(a["views_recommendation"].push({name:"Selections",config:r}),"continuous"==t.state.datasetType){a["views_recommendation"].push({name:"Thresholds",config:t.state.classifierThresholdDict});let e={},s=t.state.classifierThresholdDict;Object.keys(s).forEach(t=>{e[t]=this.getters.continuous_metrics[t].cur_left_edge.toFixed(2)+"-"+this.getters.continuous_metrics[t].cur_right_edge.toFixed(2)}),a["views_recommendation"].push({name:"Bandwidths",config:e})}const n=JSON.stringify(a);At.writeFile(e,n,(function(){}))},1e3)},drawSelections(t,e){const s=e.barCells,i=e.x,a=e.y,r=e.width,n=e.height,o=e.r,l=e.color,c=e.circle_visibility,h=e.cx,d=e.cy,u=e.selection_type,p=e.focused;s.append("rect").attr("class","selection-rect-"+u).attr("x",i).attr("y",a).attr("width",r).attr("height",n).attr("fill",l).attr("stroke","black").attr("stroke-width","2px").attr("pointer-events","none"),s.append("circle").attr("class","selection-circle-"+u).attr("cx",h).attr("cy",d).attr("r",o).style("fill",l).attr("stroke","grey").attr("visibility",c),s.append("circle").attr("class","selection-focus-"+u).attr("cx",h).attr("cy",a+n/2).attr("r",this.state.focusDotEmphasis?3*o:o/1.5).style("fill",Ot.focus).attr("stroke","black").attr("stroke-width",3).attr("visibility",p?"visible":"hidden")},blinkFocus(t){t.commit("setEmphasis",!0),setTimeout(()=>{t.commit("setEmphasis",!1)},1e3)},emphasizeFocus(t){t.commit("setEmphasis",!this.state.focusDotEmphasis)},changedcorsError(t,e){t.commit("setcorsError",e)},changedToSamplingData(t,e){t.commit("setSampleData",e),t.dispatch("changedContinuousMetrics"),t.dispatch("updateContinuousMetrics")},changedSampledList(t,e){t.commit("setSampledList",e)},changedValidationList(t,e){t.commit("setValidationdList",e)},changeCurrentChosenSample(t,e){t.commit("setCurrentChosenSample",e)},changedCurrentChosenFold(t,e){t.commit("setCurrentChosenFold",e),t.dispatch("changedContinuousMetrics"),t.dispatch("updateWeightedMetrics")},changedDataType(t,e){t.commit("setDataType",e)},changedAddedThresholdClassifiers(t,e){t.commit("setAddedThresholdClassifiers",e),t.dispatch("updateContinuousMetrics")},changedAddedBandWidthClassifiers(t,e){t.commit("setAddedBandWidthClassifiers",e)},changedOuterBandWidth(t,e){t.commit("setouterBandWidth",e)},changedCurAddedThresholdClassifier(t,e){t.commit("setCurAddedThresholdClassifier",e)},changedclassifierBandWidthDict(t,e){t.commit("setclassifierBandWidthDict",e),t.dispatch("updateContinuousMetrics")},changedWithinClassifierBandWidthList(t,e){t.commit("setWithinClassifierBandWidthList",e)},changedWithinClassifierName(t,e){t.commit("setWithinClassifierName",e)},changedBandWidthClassifier(t,e){t.commit("setBandWidthChangedClassifier",e)},changedCurveChosenClassifierThresholdTuple(t,e){t.commit("setCurveChosenClassifierThresholdTuple",e),t.commit("setChosenClassifierThresholdTuple",e),t.dispatch("changedDatasetContinuous")},changedContinuousThreshold(t,e){t.commit("setChosenClassifierThresholdTuple",e),t.dispatch("changedDatasetContinuous")},changedGridSize(t){"50%"===t.state.viewWidth?t.commit("setTileWidth",100/3+"%"):t.commit("setTileWidth","50%")},changedToggleShift(t,e){"Shift"===e.key&&t.commit("setToggleIntersectionMode","keyup"===e.type)},changedSampleSelection(t,e){t.commit("setSampleSelection",e)},changedOverlapSelection(t,e){t.commit("setOverlapSelection",e)},clearHoverInstance(t){t.commit("setHoverInstance","")},openView(t,e){const s=t.state.views.open,i=[...s,e];t.commit("setOpenViews",i)},closeView(t,e){const s=t.state.views.open,i=s.filter((t,s)=>s!==e);t.commit("setOpenViews",i)},loadFirstDataset(t){const e=Object.keys(t.state.datasets);if(0===e.length)return void console.error("Vuex state.datasets is empty. Cannot load first dataset.");const s=e[0];t.dispatch("changedDatasetByName",s)},prependToSelectionHistory(t,e){if(console.log(e),t.state.intersectionMode||t.state.selectionHistory.length<2){const s=t.state.selectionHistory,i={description:e.description,id:s.length,instances:e.instances,name:"No name",weight:0};e.predicate&&(i.predicate=e.predicate);const a=[i,...s];t.commit("setSelectionHistory",a)}else{console.log("UNION MODE");const s=t.state.selectionHistory,i=t.state.selectionHistory[0];let a=new Set([...i.instances,...e.instances]),r="union("+i.id+", "+e.description+")";const n={description:r,id:s.length,instances:a,name:"No name",weight:0};e.predicate&&i.predicate&&(n.predicate=ut(e.predicate,i.predicate,"union"));const o=[n,...s];t.commit("setSelectionHistory",o)}},resetSelectionHistory(t){const e=[{id:0,name:"Original",description:"Original dataset",instances:new Set(Object.keys(t.state.chosenDataset.instances)),weight:0}];t.commit("setSelectionHistory",e),"continuous"==t.state.datasetType&&t.dispatch("updateWeightedMetrics");const s=e[0];t.commit("setBaseSelection",s),t.commit("setOverlapSelection",{whichOverlap:"first",selection:null}),t.commit("setOverlapSelection",{whichOverlap:"second",selection:null})},changedBaseSelection(t,e){t.commit("setBaseSelection",e)},changedDatasetByName(t,e){const s=Object.keys(t.state.datasets),i=s.indexOf(e);if(-1===i)return void console.error(`Dataset named ${e} not found in state.datasets`);const a=Rt+Mt[e].path;t.commit("setChosenFixedDataset",Mt[e]),t.commit("setClassifierThresholdDict",{}),t.commit("setThresholdClassifierNameList",[]),t.dispatch("changedDataset",a)},changedDataset(t,e){e.substring(0,Rt.length)==Rt?t.commit("setFixedDataset","yes"):t.commit("setFixedDataset","no");let s=e.endsWith("/")?e:e+"/";const i=["manifest.json","results.csv","features.csv"];Promise.all(i.map(e=>{const i=s+e,a=e.split(".").pop();return fetch(i).then(t=>t.ok?t.text():Promise.reject(t.status)).then(t=>{switch(a){case"csv":return it["g"](t);case"json":return JSON.parse(t);default:return t}}).catch(e=>{console.log("Catch Error, check CORS extension"),t.dispatch("changedcorsError","error")})})).then(e=>{let[i,a,r]=e;const n=()=>{const t=()=>{const t=new Set(i.classifiers),e=new Set(a.columns.filter(t=>!["id","actual"].includes(t))),s=Yt(t,e);s.size>0&&console.error("Mismatch in classifiers from manifest and classifiers in results.csv columns headers.")};t();const e=()=>{a.length!==r.length&&console.error("Number of rows in features and results is not equal.")};e();const s=()=>{const t=a;Object.values(t).forEach(t=>{Object.values(t).forEach(t=>{""===t&&console.error("Empty cell in results.csv")})})};s()};n();const o=s.split("/"),l=o[o.length-2],c=i.classes.map(t=>t.toString()),h=i.classifiers.map(t=>t.toString()),d=Object.keys(i.features).filter(t=>"id"!==t);if(d.includes("texts")){let t=[];r.forEach(e=>{e["texts-length"]=e["texts"].length,t.push(e)}),r=t,i["features"]["texts-length"]={description:"text length",type:"ratio"}}const u=a.map(t=>t[h[0]]),p=u.filter((function(t,e){return u.indexOf(t)==e}));this.state.views.all=[Q.FI,Q.CA,Q.SCP,Q.COV,Q.CMG,Q.FH,Q.OCA,Q.PCC,Q.SP,Q.SM,Q.SMP,Q.ITL],this.state.datasetType="discrete",p.length>c.length&&(this.state.datasetType="continuous",this.state.views.all=[Q.FI,Q.CA,Q.SCP,Q.CC,Q.RC,Q.CB,Q.BA,Q.REC,Q.TID,Q.UM,Q.CMG,Q.FH,Q.OCA,Q.PCC,Q.SP,Q.SM,Q.SMP,Q.ITL]);const f={};a.forEach((e,s)=>{const i={},a={},n={};if(h.forEach(t=>{i[t]=parseFloat(e[t]).toFixed(3)+"",a[t]=.05,n[t]=.05}),"continuous"==this.state.datasetType){let s=[];h.forEach(t=>{s.push(t+"_50")}),t.commit("setThresholdClassifierNameList",s);let a={};h.forEach(t=>{a[t]=50}),t.commit("setClassifierThresholdDict",a),h.forEach(t=>{parseFloat(e[t])<this.state.classifierThresholdDict[t]/100?e[t]=c[0]:e[t]=c[1]}),this.state.thresholdClassifierNameList.forEach(t=>{let s=t.split("_"),a=t.substring(0,t.length-s[s.length-1].length-1),r=parseFloat(s[s.length-1]);parseFloat(i[a])<r/100?e[t]=c[0]:e[t]=c[1]})}const{id:o,actual:l}=e,d=Object(at["a"])(e,["id","actual"]),u=r[s],{id:p}=u,m=Object(at["a"])(u,["id"]);o===p?f[s]={actual:l,predictions:d,continuous_predictions:i,left_range:a,right_range:n,features:m}:console.error("Ids in results.csv and features.csv do not match.",o,p)});const m=()=>{const t="Random Classifier";h.unshift(t),Object.values(f).forEach(e=>{const s=c[Math.floor(Math.random()*c.length)];e.predictions[t]=s})};m();const g=()=>{const t="Majority Classifier";h.unshift(t);const e={};c.forEach(t=>e[t]=0),Object.values(f).forEach(t=>e[t.actual]++);let s=Object.keys(e)[0];Object.keys(e).forEach(t=>{e[t]>e[s]&&(s=t)}),Object.values(f).forEach(e=>e.predictions[t]=s)};g();const v=()=>{const t="Oracle";h.unshift(t),Object.values(f).forEach(e=>e.predictions[t]=e.actual)};v();const y=i.features,_=()=>{const t=["categorical","interval","nominal","ordinal","ratio"];Object.keys(y).forEach(e=>{const s=y[e];s.description||console.error(`Feature ${e} has no description.`),t.includes(s.type)||console.error(`Feature ${e} does not have a valid type. It has type "${s.type}" instead`)})};_();const x={name:l,classes:c,classifiers:h,features:y,instances:f};Object.keys(y).includes("train_or_test")?t.state.baseDataset="test":t.state.baseDataset="both",0!=Object.keys(t.state.sampleDict).length&&(t.state.baseDataset="sample"),t.commit("setChosenDataset",x),t.dispatch("resetSelectionHistory"),"continuous"==this.state.datasetType&&t.dispatch("changedContinuousMetrics")})},updateWeightedMode(t){t.commit("setWeightMode","no")},updateWeightedMetrics(t){t.commit("setWeightMode","yes");const e=this.state.selectionHistory,s=[...this.getters.filteredInstances],i=["Oracle","Majority Classifier","Random Classifier"],a=[...this.getters.filteredClassifiers],r=this.getters.continuous_metrics;if(0==Object.keys(r).length)return;let n=["x_roc","y_roc","value_roc","x_pr","y_pr","line_roc","line_pr","auc_area","acc","cur_threshold","cur_uncertain","cur_left_edge","cur_right_edge","tp_instances","fp_instances","tn_instances","fn_instances","m_tp_instances","m_tn_instances","m_fp_instances","m_fn_instances","ins_per"],o=["tp","fp","tn","fn","m_tp","m_tn","m_fp","m_fn","accuracy","mcc","precision","recall","f1"],l=["tp_instances","fp_instances","tn_instances","fn_instances","m_tp_instances","m_tn_instances","m_fp_instances","m_fn_instances"],c={},h={};s.forEach(t=>{h[t]=1}),e.forEach(t=>{let e=[...t.instances],s=parseFloat(t.weight.toString());e.forEach(t=>{h[t]+=s})}),a.forEach(t=>{i.includes(t)?(c[t]={},n.forEach(e=>{c[t][e]=r[t][e]}),o.forEach(e=>{c[t][e]=r[t][e]})):(c[t]={},n.forEach(e=>{c[t][e]=r[t][e]})),l.forEach(e=>{let s=[...c[t][e]],i=e.substring(0,e.length-10),a=0;s.forEach(t=>{a+=h[t]}),c[t][i]=a});let e=c[t].tp+c[t].m_tp,s=c[t].tn+c[t].m_tn,a=c[t].fp+c[t].m_fp,d=c[t].fn+c[t].m_fn;c[t].accuracy=(e+s)/(e+a+s+d),c[t].precision=e/(e+a),c[t].recall=e/(e+d),c[t].f1=c[t].precision+c[t].recall==0?0:2*c[t].precision*c[t].recall/(c[t].precision+c[t].recall),0==Math.sqrt((e+a)*(e+d)*(s+a)*(s+d))&&(c[t].mcc=0),(e+a)*(e+d)*(s+a)*(s+d)!=0&&(c[t].mcc=(e*s-a*d)/Math.sqrt((e+a)*(e+d)*(s+a)*(s+d)))}),t.commit("setWeightMetrics",c)},updateContinuousMetrics(t){const e=[...this.getters.filteredClasses],s=["Oracle","Majority Classifier","Random Classifier"],i=[...this.getters.filteredClassifiers],a=[...this.getters.filteredInstances],r=this.state.classifierThresholdDict,n=this.state.classifierBandWidthDict,o=this.getters.continuous_metrics;let l=this.state.addedThresholdClassifiers,c=["x_roc","y_roc","value_roc","x_pr","y_pr","line_roc","line_pr","auc_area","acc"],h=["cur_threshold","cur_uncertain","cur_left_edge","cur_right_edge","tp","fp","tn","fn","m_tp","m_tn","m_fp","m_fn","tp_instances","fp_instances","tn_instances","fn_instances","m_tp_instances","m_tn_instances","m_fp_instances","m_fn_instances","accuracy","mcc","precision","recall","f1","mcc","ins_per"],d={};i.forEach(t=>{if(s.includes(t))d[t]={},c.forEach(e=>{d[t][e]=o[t][e]}),h.forEach(e=>{d[t][e]=o[t][e]});else if(Math.abs(o[t].cur_threshold-r[t]/100)<1e-4&&(!Object.keys(n).includes(t)||Math.abs(o[t].cur_left_edge-n[t].left_range)<1e-4)&&(!Object.keys(n).includes(t)||Math.abs(o[t].cur_right_edge-n[t].right_range)<1e-4))d[t]={},c.forEach(e=>{d[t][e]=o[t][e]}),h.forEach(e=>{d[t][e]=o[t][e]});else{var i=0;d[t]={},c.forEach(e=>{d[t][e]=o[t][e]}),h.forEach(e=>{d[t][e]=o[t][e]}),d[t].m_tp=0,d[t].m_tn=0,d[t].m_fp=0,d[t].m_fn=0,d[t].tp=0,d[t].tn=0,d[t].fp=0,d[t].fn=0,d[t].m_tp_instances=new Set,d[t].m_tn_instances=new Set,d[t].m_fp_instances=new Set,d[t].m_fn_instances=new Set,d[t].tp_instances=new Set,d[t].tn_instances=new Set,d[t].fp_instances=new Set,d[t].fn_instances=new Set,d[t].cur_threshold=r[t]/100,Object.keys(n).includes(t)?(d[t].cur_left_edge=n[t].left_range,d[t].cur_right_edge=n[t].right_range):(d[t].cur_left_edge=d[t].cur_threshold-.05<0?0:d[t].cur_threshold-.05,d[t].cur_right_edge=d[t].cur_threshold+.05>1?1:d[t].cur_threshold+.05),d[t].cur_left_edge=parseFloat(d[t].cur_left_edge.toFixed(2)),d[t].cur_right_edge=parseFloat(d[t].cur_right_edge.toFixed(2)),d[t].cur_uncertain=d[t].cur_left_edge.toFixed(2)+"-"+d[t].cur_right_edge.toFixed(2),a.forEach(s=>{const a=Nt(s),r=a.actual==e[1]?1:0,n=a.continuous_predictions[t];i+=(a.continuous_predictions[t]-r)*(a.continuous_predictions[t]-r),n<d[t].cur_right_edge&&n>d[t].cur_left_edge?0==r?n<d[t].cur_threshold?(d[t].m_tn+=1,d[t].m_tn_instances.add(s)):(d[t].m_fp+=1,d[t].m_fp_instances.add(s)):n>=d[t].cur_threshold?(d[t].m_tp+=1,d[t].m_tp_instances.add(s)):(d[t].m_fn+=1,d[t].m_fn_instances.add(s)):0==r?n<d[t].cur_left_edge?(d[t].tn+=1,d[t].tn_instances.add(s)):(d[t].fp+=1,d[t].fp_instances.add(s)):n>=d[t].cur_right_edge?(d[t].tp+=1,d[t].tp_instances.add(s)):(d[t].fn+=1,d[t].fn_instances.add(s))});let s=d[t].tp+d[t].m_tp,l=d[t].tn+d[t].m_tn,u=d[t].fp+d[t].m_fp,p=d[t].fn+d[t].m_fn,f=((d[t].tp+d[t].fp+d[t].tn+d[t].fn)/a.length).toFixed(2);d[t].ins_per=f,d[t].mse=i,d[t].accuracy=(s+l)/(s+u+l+p),d[t].precision=s/(s+u),d[t].recall=s/(s+p),d[t].f1=d[t].precision+d[t].recall==0?0:2*d[t].precision*d[t].recall/(d[t].precision+d[t].recall),0==Math.sqrt((s+u)*(s+p)*(l+u)*(l+p))&&(d[t].mcc=0),(s+u)*(s+p)*(l+u)*(l+p)!=0&&(d[t].mcc=(s*l-u*p)/Math.sqrt((s+u)*(s+p)*(l+u)*(l+p)))}}),null===l&&(l=[]),l.forEach(t=>{if(t=t.name,Object.keys(o).includes(t))d[t]={},c.forEach(e=>{d[t][e]=o[t][e]}),h.forEach(e=>{d[t][e]=o[t][e]});else{let s=t.substring(4,t.length-5),i=parseFloat(t.substring(t.length-4,t.legend));d[t]={},c.forEach(e=>{d[t][e]=o[s][e]}),h.forEach(e=>{d[t][e]=o[s][e]}),d[t].m_tp=0,d[t].m_tn=0,d[t].m_fp=0,d[t].m_fn=0,d[t].tp=0,d[t].tn=0,d[t].fp=0,d[t].fn=0,d[t].m_tp_instances=new Set,d[t].m_tn_instances=new Set,d[t].m_fp_instances=new Set,d[t].m_fn_instances=new Set,d[t].tp_instances=new Set,d[t].tn_instances=new Set,d[t].fp_instances=new Set,d[t].fn_instances=new Set,d[t].cur_threshold=i,Object.keys(n).includes(t)&&(d[t].cur_left_edge=n[t].left_range,d[t].cur_right_edge=n[t].right_range),d[t].cur_left_edge=d[t].cur_threshold-.05<0?0:d[t].cur_threshold-.05,d[t].cur_right_edge=d[t].cur_threshold+.05>1?1:d[t].cur_threshold+.05,d[t].cur_uncertain=d[t].cur_left_edge+"-"+d[t].cur_right_edge,d[t].cur_left_edge=parseFloat(d[t].cur_left_edge.toFixed(2)),d[t].cur_right_edge=parseFloat(d[t].cur_right_edge.toFixed(2)),a.forEach(i=>{const a=Nt(i),r=a.actual==e[1]?1:0,n=a.continuous_predictions[s];n<=d[t].cur_right_edge&&n>=d[t].cur_left_edge?0==r?n<d[t].cur_threshold?(d[t].m_tn+=1,d[t].m_tn_instances.add(i)):(d[t].m_fp+=1,d[t].m_fp_instances.add(i)):n>=d[t].cur_threshold?(d[t].m_tp+=1,d[t].m_tp_instances.add(i)):(d[t].m_fn+=1,d[t].m_fn_instances.add(i)):0==r?n<d[t].cur_left_edge?(d[t].tn+=1,d[t].tn_instances.add(i)):(d[t].fp+=1,d[t].fp_instances.add(i)):n>=d[t].cur_right_edge?(d[t].tp+=1,d[t].tp_instances.add(i)):(d[t].fn+=1,d[t].fn_instances.add(i))});let r=d[t].tp+d[t].m_tp,l=d[t].tn+d[t].m_tn,u=d[t].fp+d[t].m_fp,p=d[t].fn+d[t].m_fn,f=((d[t].tp+d[t].fp+d[t].tn+d[t].fn)/a.length).toFixed(2);d[t].ins_per=f,d[t].accuracy=(r+l)/(r+u+l+p),d[t].precision=r/(r+u),d[t].recall=r/(r+p),d[t].f1=d[t].precision+d[t].recall==0?0:2*d[t].precision*d[t].recall/(d[t].precision+d[t].recall),0==Math.sqrt((r+u)*(r+p)*(l+u)*(l+p))&&(d[t].mcc=0),(r+u)*(r+p)*(l+u)*(l+p)!=0&&(d[t].mcc=(r*l-u*p)/Math.sqrt((r+u)*(r+p)*(l+u)*(l+p)))}}),t.commit("setContinuousMetrics",d)},changedContinuousMetrics(t){const e={};var s={};const i=[...this.getters.filteredClasses],a=[...this.getters.filteredClassifiers],r=[...this.getters.filteredInstances],n=this.state.classifierThresholdDict,o=this.state.classifierBandWidthDict;var l=[];const c=it["j"](".4f");for(var h in n)l.push(h);a.forEach(t=>{e[t]={x_roc:[],y_roc:[],value_roc:[],x_pr:[],y_pr:[],acc:[],line_roc:"",line_pr:"",auc_area:0,cur_threshold:0,cur_uncertain:"",cur_left_edge:0,cur_right_edge:0,tp:0,tn:0,fp:0,fn:0,m_tp:0,m_tn:0,m_fp:0,m_fn:0,tp_instances:new Set,tn_instances:new Set,fn_instances:new Set,fp_instances:new Set,m_tp_instances:new Set,m_tn_instances:new Set,m_fn_instances:new Set,m_fp_instances:new Set,accuracy:0,mcc:0,precision:0,recall:0,f1:0,mse:0,ins_per:"0"},s[t]=[]});let d=0,u=1,p=.01;while(d<=u)a.forEach(t=>{s[t].push(d.toFixed(3))}),d+=p;a.forEach(t=>{var a=[],h=0;s[t].sort(),0==l.length?e[t].cur_threshold=0:e[t].cur_threshold=n[t]/100,Object.keys(o).includes(t)?(e[t].cur_left_edge=o[t].left_range,e[t].cur_right_edge=o[t].right_range):(e[t].cur_left_edge=e[t].cur_threshold-.05<0?0:e[t].cur_threshold-.05,e[t].cur_right_edge=e[t].cur_threshold+.05>1?1:e[t].cur_threshold+.05),e[t].cur_left_edge=parseFloat(e[t].cur_left_edge.toFixed(2)),e[t].cur_right_edge=parseFloat(e[t].cur_right_edge.toFixed(2)),e[t].cur_uncertain=e[t].cur_left_edge+"-"+e[t].cur_right_edge,r.forEach(s=>{const a=Nt(s),r=a.actual==i[1]?1:0,n=a.continuous_predictions[t];h+=(a.continuous_predictions[t]-r)*(a.continuous_predictions[t]-r),n<e[t].cur_right_edge&&n>e[t].cur_left_edge?0==r?n<e[t].cur_threshold?(e[t].m_tn+=1,e[t].m_tn_instances.add(s)):(e[t].m_fp+=1,e[t].m_fp_instances.add(s)):n>=e[t].cur_threshold?(e[t].m_tp+=1,e[t].m_tp_instances.add(s)):(e[t].m_fn+=1,e[t].m_fn_instances.add(s)):0==r?n<e[t].cur_threshold?(e[t].tn+=1,e[t].tn_instances.add(s)):(e[t].fp+=1,e[t].fp_instances.add(s)):n>=e[t].cur_threshold?(e[t].tp+=1,e[t].tp_instances.add(s)):(e[t].fn+=1,e[t].fn_instances.add(s))});let d=e[t].tp+e[t].m_tp,u=e[t].tn+e[t].m_tn,p=e[t].fp+e[t].m_fp,f=e[t].fn+e[t].m_fn,m=((e[t].tp+e[t].fp+e[t].tn+e[t].fn)/r.length).toFixed(2);e[t].ins_per=m,e[t].mse=h,e[t].accuracy=(d+u)/(d+p+u+f),e[t].precision=d/(d+p),e[t].recall=d/(d+f),e[t].f1=e[t].precision+e[t].recall==0?0:2*e[t].precision*e[t].recall/(e[t].precision+e[t].recall),0==Math.sqrt((d+p)*(d+f)*(u+p)*(u+f))&&(e[t].mcc=0),(d+p)*(d+f)*(u+p)*(u+f)!=0&&(e[t].mcc=(d*u-p*f)/Math.sqrt((d+p)*(d+f)*(u+p)*(u+f)));let g=0,v="0",y=e=>{let s=0,a=0,n=0,o=0;return r.forEach(r=>{const l=Nt(r),c=l.continuous_predictions[t]<parseFloat(e)?i[0]:i[1];l.actual==i[1]?c==l.actual?s+=1:n+=1:c==l.actual?o+=1:a+=1}),[s,o,a,n]},_=(s,i,r,n,o)=>{a.push({x:r/(r+i),y:s/(s+n)}),e[t].x_roc.push(r/(r+i)),e[t].y_roc.push(s/(s+n)),e[t].value_roc.push(o),e[t].x_pr.push(s/(s+n)),e[t].y_pr.push(s/(s+r)),e[t].acc.push((i+s)/(i+s+n+r))};function x(t,e,s,i,a){if(!(a>100)&&Math.abs(s-i)/s>.5){let r=((parseFloat(e)+parseFloat(t))/2).toString(),n=y(r),o=(n[0]+n[1])/(n[1]+n[0]+n[2]+n[3]);Math.abs(o-s)/s>.5&&(x(t,r,s,o,a+1),_(n[0],n[1],n[2],n[3],parseFloat(r))),Math.abs(i-o)/i>.5&&(_(n[0],n[1],n[2],n[3],parseFloat(r)),x(r,e,o,i,a+1))}}s[t].forEach((t,e)=>{t=c(t);let s=y(t),i=s[0],a=s[1],r=s[2],n=s[3];if(0==e)g=(a+i)/(a+i+n+r),v=t;else{let e=(a+i)/(a+i+n+r);x(v,t,g,e,0),g=e,v=t}_(i,a,r,n,t)}),e[t].auc_area=0;var b=0,w=0;a.sort((function(t,e){return it["a"](t.x,e.x)})),a.forEach(s=>{e[t].auc_area+=(s.y+w)*(s.x-b)/2,b=s.x,w=s.y})}),t.commit("setContinuousMetrics",e)},changedDatasetContinuous(t){const e=this.state.chosenClassifierThresholdTuple.classifier,s=this.state.chosenClassifierThresholdTuple.single_threshold;let i=this.state.classifierThresholdDict,a=this.state.thresholdClassifierNameList.map(t=>t);i[e]=s,t.commit("setClassifierThresholdDict",i),t.dispatch("updateContinuousMetrics");for(let l in a){let t=a[l];0==t.indexOf(e)&&(a[l]=e+"_"+s)}t.commit("setThresholdClassifierNameList",a);const r=this.state.chosenDataset.classes,n=this.state.chosenDataset.classifiers,o=this.state.chosenDataset.instances;for(let l in n){let t=n[l];if(t!=e)continue;let i=[];for(let e in o){const a=o[e].continuous_predictions;parseFloat(a[t])<s/100?(i.push(r[0]),o[e].predictions[t]=r[0]):(i.push(r[1]),o[e].predictions[t]=r[1])}}},changedFilter(t,e){t.commit("setFilter",e)},changedHoverInstance(t,e){t.commit("setHoverInstance",e)},changedMostRecentSelection(t,e){const s=t.state.selectionHistory[0];t.dispatch("changedOverlapSelection",{selection:s,whichOverlap:e})},setFocusItem(t,e){t.commit("mutateFocusItem",e)},changeFocusSet(t,e){t.commit("mutateFocusSet",e)}},getters:{curveChosenClassifierThresholdTuple(t){return t.curveChosenClassifierThresholdTuple},classifierBandWidthDict(t){return t.classifierBandWidthDict},withinClassifierBandWidthList(t){return t.withinClassifierBandWidthList},withinClassifierName(t){return t.withinClassifierName},classifierThresholdDict(t){return t.classifierThresholdDict},thresholdClassifierNameList(t){return t.thresholdClassifierNameList},classifierThresholdList(t,e){const s=[...e.filteredClassifiers],i=["Oracle","Majority Classifier","Random Classifier"],a=s.filter(t=>!i.includes(t)&&""!=t),r=a.map(t=>({classifier:t,single_threshold:50}));return r},continuousThresholdClassifiers(t){return new Set(t.chosenDataset.classifiers)},datasetType(t){return t.datasetType},fixedDataset(t){return t.fixedDataset},viewWidth(t){return t.viewWidth},intersectionMode(t){return t.intersectionMode},classes(t){return new Set(t.chosenDataset.classes)},classifiers(t){return new Set(t.chosenDataset.classifiers)},feature(t){return e=>t.chosenDataset.features[e]},features(t){return new Set(Object.keys(t.chosenDataset.features))},instance(t){return e=>t.chosenDataset.instances[e]},instances(t){return t.baseSelection.instances},filteredClasses(t,e){const s=t.filters.class.set,i=e.classes,a=Vt(i,s);return a},filteredClassifiers(t,e){const s=t.filters.classifier.set,i=e.classifiers,a=Vt(i,s);return a},filteredInstances(t,e){let s=[...e.instances];const i="train_or_test";switch(t.baseDataset){case"test":""!=t.currentChosenFold?t.validationList.forEach(e=>{e.name==t.currentChosenFold&&(s=[...e.testing])}):s=s.filter(t=>"test"===Nt(t).features[i]||"0"===Nt(t).features[i]);break;case"train":""!=t.currentChosenFold?t.validationList.forEach(e=>{e.name==t.currentChosenFold&&(s=[...e.training])}):s=s.filter(t=>"train"===Nt(t).features[i]||"1"===Nt(t).features[i]);break;case"sample":s=[...t.sampleDict["instances"]];break}return new Set(s)},additionMetrics(t,e){const s=[...e.filteredClasses],i=t.addedThresholdClassifiers,a=[...e.filteredInstances],r={};return i.forEach(t=>{let e=t["name"],i=e.substring(4,e.length-5),n=parseFloat(e.substring(e.length-4,e.length));r[e]={accuracy:-1,acc:{average:-1},mcc:{average:-1},f1:{average:-1},microf1:{average:-1},macrof1:{average:-1},precision:{average:-1},recall:{average:-1},predicted:{},actual:{},false:{},true:{},tp:{},fp:{},fn:{},tn:{}};const o=r[e];s.forEach(t=>{o.actual[t]=new Set(a.filter(e=>Nt(e).actual===t))}),s.forEach(t=>{o.predicted[t]=new Set(a.filter(e=>t==s[0]?Nt(e).continuous_predictions[i]<=n:Nt(e).continuous_predictions[i]>n))}),s.forEach(t=>{o.true[t]=Lt(o.actual[t],o.predicted[t])}),s.forEach(t=>{o.false[t]=Vt(o.predicted[t],o.actual[t])}),s.forEach(t=>{o.tp[t]=new Set,o.fp[t]=new Set,o.fn[t]=new Set,o.tn[t]=new Set}),a.forEach(t=>{const e=Nt(t);var a=i;e.actual==s[1]?e.continuous_predictions[a]>=n?o.tp[s[1]].add(t):o.fn[s[1]].add(t):e.continuous_predictions[a]<n?o.tn[s[1]].add(t):o.fp[s[1]].add(t)});let l=0;s.forEach(t=>{l+=o.true[t].size}),o.accuracy=l/a.length;var c=s[1];o.precision[c]=o.tp[c].size/(o.tp[c].size+o.fp[c].size),o.precision[s[0]]=1-o.precision[c],o.precision.average=o.precision[c];c=s[1];o.recall[c]=o.tp[c].size/(o.tp[c].size+o.fn[c].size),o.recall[s[0]]=1-o.recall[c],o.recall.average=o.recall[c];c=s[1];const h=o.precision[c],d=o.recall[c];o.f1[c]=2*h*d/(h+d),o.f1[s[0]]=2*(1-h)*(1-d)/(2-h-d),o.f1.average=o.f1[c];c=s[1];var u=o.tp[c].size,p=o.tn[c].size,f=o.fp[c].size,m=o.fn[c].size;0==Math.sqrt((u+f)*(u+m)*(p+f)*(p+m))&&(o.mcc.average=0),(u+f)*(u+m)*(p+f)*(p+m)!=0&&(o.mcc.average=(u*p-f*m)/Math.sqrt((u+f)*(u+m)*(p+f)*(p+m)))}),r},metrics(t,e){const s=[...e.filteredClasses],i=[...e.filteredClassifiers],a=[...e.filteredInstances],r={};return i.forEach(t=>{r[t]={accuracy:-1,acc:{average:-1},mcc:{average:-1},f1:{average:-1},microf1:{average:-1},macrof1:{average:-1},precision:{average:-1},recall:{average:-1},predicted:{},actual:{},false:{},true:{},tp:{},fp:{},fn:{},tn:{}};const e=r[t];s.forEach(t=>{e.actual[t]=new Set(a.filter(e=>Nt(e).actual===t))}),s.forEach(s=>{e.predicted[s]=new Set(a.filter(e=>Nt(e).predictions[t]===s))}),s.length>2?(s.forEach(t=>{var s=[...e.predicted[t]],i=[...e.actual[t]];e.true[t]=Lt(e.actual[t],e.predicted[t]),e.tp[t]=e.true[t],e.fp[t]=new Set(s.filter(t=>!i.includes(t))),e.fn[t]=new Set(i.filter(t=>!s.includes(t)))}),s.forEach(t=>{e.false[t]=Vt(e.predicted[t],e.actual[t])}),s.forEach(t=>{e.tn[t]=new Set,s.forEach(s=>{s!=t&&(e.tn[t]=new Set([...e.tn[t],...e.tp[s]]))})})):(s.forEach(t=>{e.true[t]=Lt(e.actual[t],e.predicted[t])}),s.forEach(t=>{e.false[t]=Vt(e.predicted[t],e.actual[t])}),s.forEach(t=>{e.tp[t]=new Set,e.fp[t]=new Set,e.fn[t]=new Set,e.tn[t]=new Set}),a.forEach(i=>{const a=Nt(i);var r=t;a.actual==s[1]?a.predictions[r]==a.actual?e.tp[s[1]].add(i):e.fn[s[1]].add(i):a.predictions[r]==a.actual?e.tn[s[1]].add(i):e.fp[s[1]].add(i)}));let i=0;if(s.forEach(t=>{i+=e.true[t].size}),e.accuracy=i/a.length,s.length>2){let t=0;s.forEach(s=>{e.precision[s]=e.tp[s].size/(e.tp[s].size+e.fp[s].size),t+=e.precision[s]}),e.precision.average=t/s.length}else{var n=s[1];e.precision[n]=e.tp[n].size/(e.tp[n].size+e.fp[n].size),e.precision[s[0]]=1-e.precision[n],e.precision.average=e.precision[n]}if(s.length>2){let t=0;s.forEach(s=>{e.recall[s]=e.tp[s].size/(e.tp[s].size+e.fn[s].size),t+=e.recall[s]}),e.recall.average=t/s.length}else{n=s[1];e.recall[n]=e.tp[n].size/(e.tp[n].size+e.fn[n].size),e.recall[s[0]]=1-e.recall[n],e.recall.average=e.recall[n]}if(s.length>2){let t=0;s.forEach(s=>{const i=e.precision[s],a=e.recall[s];e.f1[s]=2*i*a/(i+a),t+=e.f1[s]}),e.f1.average=t/s.length}else{n=s[1];const t=e.precision[n],i=e.recall[n];e.f1[n]=2*t*i/(t+i),e.f1[s[0]]=2*(1-t)*(1-i)/(2-t-i),e.f1.average=e.f1[n]}let o=0,l=0,c=0;s.forEach(t=>{o+=e.tp[t].size,l+=e.fp[t].size,c+=e.fn[t].size});let h=o/(o+l),d=o/(o+c);if(e.microf1.average=e.f1.average,e.macrof1.average=2*h*d/(h+d),s.length>2){var u=0,p=0,f=0,m=0;s.forEach(t=>{u+=e.tp[t].size,p+=e.tn[t].size,f+=e.fp[t].size,m+=e.fn[t].size}),0==Math.sqrt((u+f)*(u+m)*(p+f)*(p+m))?e.mcc.average=u*p-u*m<0?-1:1:e.mcc.average=(u*p-u*m)/Math.sqrt((u+f)*(u+m)*(p+f)*(p+m))}else{n=s[1],u=e.tp[n].size,p=e.tn[n].size,f=e.fp[n].size,m=e.fn[n].size;0==Math.sqrt((u+f)*(u+m)*(p+f)*(p+m))&&(e.mcc.average=0),(u+f)*(u+m)*(p+f)*(p+m)!=0&&(e.mcc.average=(u*p-f*m)/Math.sqrt((u+f)*(u+m)*(p+f)*(p+m)))}}),r},continuous_metrics(t){return t.continuous_metrics},weighted_metrics(t){return t.weighted_metrics},visualizations(t,e){const s=[],i=t.views.open;return i.forEach(t=>{const i=()=>({name:t,boxProps:{classes:e.filteredClasses,classifiers:e.filteredClassifiers,instances:e.filteredInstances,features:e.features,thresholdClassifierNameList:e.thresholdClassifierNameList,classifierBandWidthDict:e.classifierBandWidthDict,withinClassifierBandWidthList:e.withinClassifierBandWidthList}});switch(t){case Q.CA:case Q.SCP:case Q.COV:case Q.CC:case Q.CB:case Q.RC:case Q.BA:case Q.REC:case Q.TID:case Q.UM:case Q.CMG:case Q.FH:case Q.OCA:case Q.PCC:case Q.SMP:case Q.SP:case Q.SM:case Q.ITL:case Q.FI:s.push(i());break;default:console.error("Visualization",t,"not implemented");break}}),s}}});function Vt(t,e){return new Set([...t].filter(t=>!e.has(t)))}function jt(t){return Ht.getters.feature(t)}function Kt(t="randomlyGeneratedId-"){const e=Math.random().toString().substr(2),s=t+e;return s}function Nt(t){return Ht.getters.instance(t)}function Lt(t,e){return new Set([...t].filter(t=>e.has(t)))}function Wt(t,e){const s=Lt(t,e);return s.size}function qt(t,e){return 0===e.size?0:Wt(t,e)/e.size}function Ut(t,e){return new Set([...t,...e])}function Yt(t,e){const s=Ut(Vt(t,e),Vt(e,t));return s}var Gt=i["a"].extend({name:"Performance_Overall",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:150,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i="",a="accuracy",r="normal",n={type:"",classifier:""},o=Ot.focus;return{svg:"",accuracySorting:i,evaluationSelection:a,weightedPerformance:r,height:s,hover:n,margin:t,panel:[],rightColor:"#d1e5f0",rightHoverColor:"#4393c3",selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e,wrongColor:"#fddbc7",wrongHoverColor:"#d6604d",classNumber:[...this.boxProps.classes].length,focusColor:o}},computed:{addedThresholdClassifiers(){if("continuous"!=this.$store.state.datasetType)return[];let t=this.$store.state.addedThresholdClassifiers;return null===t&&(t=[]),t},datasetType(){var t=this.$store.state.datasetType;return t},continuous_metrics(){return this.$store.state.continuous_metrics},weighted_metrics(){return this.$store.state.weighted_metrics},classes(){return this.classNumber=[...this.boxProps.classes].length,[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},thresholdClassifierNameList(){return this.boxProps.thresholdClassifierNameList},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},predictionKeys(){var t=this.evaluationKeys;const e=(e,s)=>"f1"==t?this.predictions[e].f1-this.predictions[s].f1:"macrof1"==t?this.predictions[e].macro_f1-this.predictions[s].macro_f1:"microf1"==t?this.predictions[e].micro_f1-this.predictions[s].micro_f1:"mcc"==t?this.predictions[e].mcc-this.predictions[s].mcc:"precision"==t?this.predictions[e].precision-this.predictions[s].precision:"recall"==t?this.predictions[e].recall-this.predictions[s].recall:this.predictions[e].right.size-this.predictions[s].right.size,s=(t,s)=>-e(t,s);let i=this.classifiers.slice();if("continuous"==this.$store.state.datasetType){var a=[];i.forEach(t=>{a.push(t+"_"+this.classifierThresholdDict[t]/100)}),this.addedThresholdClassifiers.forEach(t=>{a.push(t.name)}),i=a}switch(this.accuracySorting){case"ascending":i.sort(e);break;case"descending":i.sort(s);break;case"alphabetical":i.sort();break}return i},classifierThresholdDict(){return this.$store.state.classifierThresholdDict},continuousPredictionKeys(){return this.predictionKeys},evaluationKeys(){var t="";switch(this.evaluationSelection){case"accuracy":t="accuracy";break;case"f1":t="f1";break;case"microf1":t="microf1";break;case"macrof1":t="macrof1";break;case"mcc":t="mcc";break;case"precision":t="precision";break;case"recall":t="recall";break}return t},continuousMetrics(){let t={},e=["Oracle","Majority Classifier","Random Classifier"],s="normal"==this.weightedPerformance?this.$store.state.continuous_metrics:this.$store.state.weighted_metrics,i={};for(let r in s)e.includes(r)||("set"!=r.substring(0,3)?i[r]=r+"_"+this.classifierThresholdDict[r]/100:i[r]=r);for(let r in i)t[i[r]]={right:new Set,wrong:new Set,fp:new Set,fn:new Set,tp:new Set,tn:new Set,f1:0,micro_f1:0,macro_f1:0,mcc:0,precision:0,recall:0,accuracy:0};for(let r in s)if(!e.includes(r)){t[i[r]].fp=a(s[r].fp_instances,s[r].m_fp_instances),t[i[r]].tp=a(s[r].tp_instances,s[r].m_tp_instances),t[i[r]].fn=a(s[r].fn_instances,s[r].m_fn_instances),t[i[r]].tn=a(s[r].tn_instances,s[r].m_tn_instances),t[i[r]].right=a(t[i[r]].tp,t[i[r]].tn),t[i[r]].wrong=a(t[i[r]].fp,t[i[r]].fn);t[i[r]].tp.size,t[i[r]].fp.size,t[i[r]].fn.size,t[i[r]].tn.size;t[i[r]].precision=s[r].precision,t[i[r]].recall=s[r].recall,t[i[r]].accuracy=s[r].accuracy,t[i[r]].f1=s[r].f1,t[i[r]].mcc=s[r].mcc}function a(t,e){let s=[...t],i=[...e];return i.forEach(t=>{s.push(t)}),new Set(s)}return t},predictions(){let t={};if("continuous"==this.datasetType)return this.continuousMetrics;{let s={};this.classifiers.forEach(t=>{s[t]=t}),this.classifiers.forEach(e=>{t[s[e]]={right:new Set,wrong:new Set,fp:new Set,fn:new Set,tp:new Set,tn:new Set,f1:0,micro_f1:0,macro_f1:0,mcc:0,precision:0,recall:0,accuracy:0}});var e={};this.classifiers.forEach(t=>{e[t]={},this.classes.forEach(s=>{e[t][s]={right:[],wrong:[],tp:[],fp:[],fn:[],tn:[],pred:[],actual:[]}})}),this.instances.forEach(t=>{var s=Nt(t);this.classifiers.forEach(i=>{var a=s.actual,r=s.predictions[i],n=i;e[n][r].pred.push(t),e[n][a].actual.push(t),s.predictions[i]==s.actual?(e[i][a].right.push(t),e[n][a].tp.push(t),this.classes.forEach(s=>{s!=r&&e[n][s].tn.push(t)})):(e[i][a].wrong.push(t),e[i][r].fp.push(t),e[n][a].fn.push(t))})});this.instances.length;return this.instances.forEach(e=>{const i=Nt(e);this.classifiers.forEach(a=>{i.predictions[a]===i.actual?t[s[a]].right.add(e):t[s[a]].wrong.add(e),i.actual==this.classes[1]?i.predictions[a]==i.actual?t[s[a]].tp.add(e):t[s[a]].fn.add(e):i.predictions[a]==i.actual?t[s[a]].tn.add(e):t[s[a]].fp.add(e)})}),this.classifiers.forEach(e=>{var i=t[s[e]].tp.size,a=t[s[e]].fp.size,r=t[s[e]].fn.size,n=t[s[e]].tn.size;t[s[e]].precision=i/(i+a),t[s[e]].recall=i/(i+r),t[s[e]].accuracy=(i+n)/(i+n+a+r),t[s[e]].f1=2*t[s[e]].precision*t[s[e]].recall/(t[s[e]].precision+t[s[e]].recall),t[s[e]].mcc=(i+a)*(i+r)*(n+a)*(n+r)!=0?(i*n-a*r)/Math.sqrt((i+a)*(i+r)*(n+a)*(n+r)):0}),this.classes.length>2&&this.classifiers.forEach(i=>{var a=0,r=0,n=0,o=0,l=0;this.classes.forEach(t=>{var s=e[i][t].tp.length,c=e[i][t].fp.length,h=e[i][t].tn.length,d=e[i][t].fn.length;a+=s,r+=c,n+=h,o+=d;var u=s/(s+c),p=s/(s+d);l+=u+p==0?0:2*u*p/(u+p)}),t[s[i]].micro_f1=l/this.classes.length;var c=a/(a+o),h=a/(a+r);t[s[i]].macro_f1=c+h==0?0:c*h*2/(c+h),t[s[i]].mcc=(a+r)*(a+o)*(n+r)*(n+o)!=0?(a*n-r*o)/Math.sqrt((a+r)*(a+o)*(n+r)*(n+o)):0}),t}},focusItemId(){return this.$store.state.focusItemId},focusSet(){return this.$store.state.focusSet},focusDotEmphasis(){return this.$store.state.focusDotEmphasis},selections(){return this.$store.state.overlapSelections},x(){const t=it["x"]().domain(this.continuousPredictionKeys).range([0,this.width]).paddingOuter(1).paddingInner(.3);return t},y(){const t=it["y"]().domain(["mcc"==this.evaluationKeys?-1:0,1]).range([this.height,0]);return t}},watch:{weightedPerformance(){this.drawInitial()},accuracySorting(){this.drawInitial()},evaluationSelection(){this.drawInitial()},hover(){this.drawHover()},classifierThresholdDict(){this.drawInitial()},instances(){this.drawInitial()},selections(){this.drawInitial()},weighted_metrics(){"weighted"==this.weightedPerformance&&this.drawInitial()},continuous_metrics(){this.drawInitial()},focusItemId(){this.drawInitial()},focusSet(){this.drawInitial()},focusDotEmphasis(){this.drawInitial()}},mounted(){this.drawInitial()},methods:{clearHover(){this.hover={type:"",classifier:""}},drawHover(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-right"),s=t.selectAll(".bar-wrong"),i=t.select(".y-axis-marker-line"),a=t.select(".y-axis-marker-text-right"),r=t.select(".y-axis-marker-text-wrong"),{first:n,second:o}=this.selections,l=t.select(".y-axis-marker-text-selection1"),c=t.select(".y-axis-marker-text-selection2"),h=t.select(".y-axis-marker-rect"),d=500,u=1e3,p=it["j"](".1f"),f=(t,e,s)=>{const i=this.predictions[t][e];"precision"==this.evaluationKeys?(this.predictions[t]["fp"].size,this.predictions[t]["tp"].size):"recall"==this.evaluationKeys?(this.predictions[t]["fn"].size,this.predictions[t]["tp"].size):this.instances.length;const a=Lt(i,s);return a.size};(n||o)&&"mcc"!=this.evaluationKeys&&"microf1"!=this.evaluationKeys&&"macrof1"!=this.evaluationKeys&&"f1"!=this.evaluationKeys&&h.transition().duration(d).attr("opacity",1).attr("transform",`translate(\n            ${this.x(this.hover.classifier)},\n            ${this.y(1)-70})`),n&&"mcc"!=this.evaluationKeys&&"microf1"!=this.evaluationKeys&&"macrof1"!=this.evaluationKeys&&"f1"!=this.evaluationKeys?("right"===this.hover.type&&l.transition().duration(d).attr("fill-opacity",1).attr("transform",`translate(\n            ${this.x(this.hover.classifier)+60},\n            ${this.y(1)-60})`).text("1st: "+p(f(this.hover.classifier,"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"tp":"right",n.instances))),"wrong"===this.hover.type&&l.transition().duration(d).attr("fill-opacity",1).attr("transform",`translate(\n            ${this.x(this.hover.classifier)+60},\n            ${this.y(1)-60})`).text("1st: "+p(f(this.hover.classifier,"precision"==this.evaluationKeys?"fp":"recall"==this.evaluationKeys?"fn":"wrong",n.instances)))):l.transition().duration(u).attr("fill-opacity",0),o&&"mcc"!=this.evaluationKeys&&"microf1"!=this.evaluationKeys&&"macrof1"!=this.evaluationKeys&&"f1"!=this.evaluationKeys?("right"===this.hover.type&&c.transition().duration(d).attr("fill-opacity",1).attr("transform",`translate(\n            ${this.x(this.hover.classifier)+60},\n            ${this.y(1)-30})`).text("2nd: "+p(f(this.hover.classifier,"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"tp":"right",o.instances))),"wrong"===this.hover.type&&c.transition().duration(d).attr("fill-opacity",1).attr("transform",`translate(\n            ${this.x(this.hover.classifier)+60},\n            ${this.y(1)-30})`).text("2nd: "+p(f(this.hover.classifier,"precision"==this.evaluationKeys?"fp":"recall"==this.evaluationKeys?"fn":"wrong",o.instances)))):c.transition().duration(u).attr("fill-opacity",0),"right"===this.hover.type?e.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hover.classifier?this.rightHoverColor:this.rightColor):e.attr("fill",this.rightColor),"wrong"===this.hover.type?s.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hover.classifier?this.wrongHoverColor:this.wrongColor):s.attr("fill",this.wrongColor),this.hover.type?(i.transition().duration(d).attr("stroke-opacity",1).attr("y1","f1"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].f1):"precision"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].precision):"recall"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].recall):"microf1"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].micro_f1):"macrof1"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].macro_f1):"mcc"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].mcc):this.y(this.predictions[this.hover.classifier].accuracy)).attr("x2",this.width).attr("y2","f1"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].f1):"precision"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].precision):"recall"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].recall):"microf1"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].micro_f1):"macrof1"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].macro_f1):"mcc"==this.evaluationKeys?this.y(this.predictions[this.hover.classifier].mcc):this.y(this.predictions[this.hover.classifier].accuracy)),a.transition().duration(d).attr("fill-opacity",1).attr("transform","f1"==this.evaluationKeys?`translate(\n            ${this.x.paddingOuter()*this.x.bandwidth()/2},\n            ${this.y(this.predictions[this.hover.classifier].f1)+10})`:"precision"==this.evaluationKeys?`translate(\n            ${this.x.paddingOuter()*this.x.bandwidth()/2},\n            ${this.y(this.predictions[this.hover.classifier].precision)+10})`:"recall"==this.evaluationKeys?`translate(\n            ${this.x.paddingOuter()*this.x.bandwidth()/2},\n            ${this.y(this.predictions[this.hover.classifier].recall)+10})`:"microf1"==this.evaluationKeys?`translate(\n            ${this.x.paddingOuter()*this.x.bandwidth()/2},\n            ${this.y(this.predictions[this.hover.classifier].micro_f1)+10})`:"macrof1"==this.evaluationKeys?`translate(\n            ${this.x.paddingOuter()*this.x.bandwidth()/2},\n            ${this.y(this.predictions[this.hover.classifier].macro_f1)+10})`:"mcc"==this.evaluationKeys?`translate(\n            ${this.x.paddingOuter()*this.x.bandwidth()/2},\n            ${this.y(this.predictions[this.hover.classifier].mcc)+10})`:`translate(\n            ${this.x.paddingOuter()*this.x.bandwidth()/2},\n            ${this.y(this.predictions[this.hover.classifier].right.size/this.instances.length)+10})`).text("f1"==this.evaluationKeys?(100*this.predictions[this.hover.classifier].f1).toFixed(1)+"%":"precision"==this.evaluationKeys?(100*this.predictions[this.hover.classifier].precision).toFixed(1)+"%":"recall"==this.evaluationKeys?(100*this.predictions[this.hover.classifier].recall).toFixed(1)+"%":"microf1"==this.evaluationKeys?(100*this.predictions[this.hover.classifier].micro_f1).toFixed(1)+"%":"macrof1"==this.evaluationKeys?(100*this.predictions[this.hover.classifier].macro_f1).toFixed(1)+"%":"mcc"==this.evaluationKeys?(100*this.predictions[this.hover.classifier].mcc).toFixed(1)+"%":(100*this.predictions[this.hover.classifier].accuracy).toFixed(1)+"%"),"accuracy"==this.evaluationKeys&&r.transition().duration(d).attr("fill-opacity",1).attr("transform","f1"==this.evaluationKeys?`translate(\n              ${this.x.paddingOuter()*this.x.bandwidth()/2},\n              ${this.y(1/(2*this.predictions[this.hover.classifier].tp.size/(this.predictions[this.hover.classifier].tp.size+this.predictions[this.hover.classifier].fp.size)))-10})`:`translate(\n              ${this.x.paddingOuter()*this.x.bandwidth()/2},\n              ${this.y(this.predictions[this.hover.classifier].right.size/this.instances.length)-10})`).text("f1"==this.evaluationKeys?(100-100*this.predictions[this.hover.classifier].f1).toFixed(1)+"%":"precision"==this.evaluationKeys?(100-100*this.predictions[this.hover.classifier].precision).toFixed(1)+"%":"recall"==this.evaluationKeys?(100-100*this.predictions[this.hover.classifier].recall).toFixed(1)+"%":"microf1"==this.evaluationKeys?(100-100*this.predictions[this.hover.classifier].micro_f1).toFixed(1)+"%":"macrof1"==this.evaluationKeys?(100-100*this.predictions[this.hover.classifier].macro_f1).toFixed(1)+"%":"mcc"==this.evaluationKeys?(100-100*this.predictions[this.hover.classifier].mcc).toFixed(1)+"%":(100-100*this.predictions[this.hover.classifier].accuracy).toFixed(1)+"%")):(i.transition().duration(u).attr("stroke-opacity",0),a.transition().duration(u).attr("fill-opacity",0),r.transition().duration(u).attr("fill-opacity",0),l.transition().duration(u).attr("fill-opacity",0),c.transition().duration(u).attr("fill-opacity",0),h.transition().duration(u).attr("opacity",0))},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();let t=160;const e=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+t+this.margin.bottom}`).append("g").attr("transform",`translate(${t}, 160)`),s=this.x,i=this.y,a=()=>{const t=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](s).tickSizeOuter(0));e.append("g").call(t).attr("font-size",18).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start");const a=t=>t.call(it["c"](i).ticks(5).tickFormat(it["j"](".0%")));e.append("g").call(a).attr("font-size",20)};a();const r=()=>{e.append("text").attr("transform",()=>{const t=this.width/2,e=this.height+this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Classifier"),e.append("text").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("accuracy"==this.evaluationKeys?"Fraction of instances":"mcc"==this.evaluationKeys?"MCC value":"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"Fraction of instances":"microf1"==this.evaluationKeys?"Micro F1 value":"macrof1"==this.evaluationKeys?"Macro F1 value":"F1 value"),e.append("text").attr("x",this.width/2).attr("y",-100).attr("dy","1em").style("text-anchor","middle").style("font-size","32px").text(("normal"==this.weightedPerformance?"":"Weighted ")+("accuracy"==this.evaluationKeys?"Accuracy":"mcc"==this.evaluationKeys?"MCC":"precision"==this.evaluationKeys?"Precision":"recall"==this.evaluationKeys?"Recall":"microf1"==this.evaluationKeys?"Micro F1":"macrof1"==this.evaluationKeys?"Macro F1":"F1"))};r();const n=()=>{const t=this.width/4,s=this.margin.top/2,i=e.append("g").attr("class","legend").attr("transform",`translate(\n              ${3*this.width/4},\n              ${2*-s})`);i.append("rect").attr("width",t).attr("height",s/2).attr("fill",this.wrongColor).style("visibility","accuracy"==this.evaluationKeys||"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"visible":"hidden"),i.append("rect").attr("y",s/2).attr("width",t).attr("height",s/2).attr("fill",this.rightColor).style("visibility","accuracy"==this.evaluationKeys||"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"visible":"hidden"),i.append("text").attr("transform",`translate(${t/2}, ${s/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("accuracy"==this.evaluationKeys?"misclassified":"precision"==this.evaluationKeys?"fp":"recall"==this.evaluationKeys?"fn":"").style("visibility","accuracy"==this.evaluationKeys||"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"visible":"hidden"),i.append("text").attr("transform",`translate(${t/2}, ${3*s/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("accuracy"==this.evaluationKeys?"correctly classified":"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"tp":"").style("visibility","accuracy"==this.evaluationKeys||"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"visible":"hidden")},o=()=>{const t=e.selectAll(".cell").data(this.continuousPredictionKeys).join("g").attr("class","cell").attr("transform",t=>`translate(${s(t)}, 0)`);this.svg=e;const a=s.bandwidth();t.append("circle").attr("cx",a/2).attr("cy",t=>this.height-15).attr("r","15px").attr("fill",this.rightColor).attr("stroke","grey").on("mouseenter",t=>this.hover={type:"right",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"right","first")).on("contextmenu",t=>this.select(t,"right","second")).style("visibility",t=>{var e="f1"==this.evaluationKeys?this.predictions[t].f1:"mcc"==this.evaluationKeys?this.predictions[t].mcc:"precision"==this.evaluationKeys?this.predictions[t].precision:"recall"==this.evaluationKeys?this.predictions[t].recall:"microf1"==this.evaluationKeys?this.predictions[t].micro_f1:"macrof1"==this.evaluationKeys?this.predictions[t].macro_f1:this.predictions[t].accuracy;return e<.05?"visible":"hidden"});var r=t.append("rect").attr("class","bar-right").attr("y",t=>"f1"==this.evaluationKeys?i(this.predictions[t].f1):"mcc"==this.evaluationKeys?i(this.predictions[t].mcc):"precision"==this.evaluationKeys?i(this.predictions[t].precision):"recall"==this.evaluationKeys?i(this.predictions[t].recall):"microf1"==this.evaluationKeys?i(this.predictions[t].micro_f1):"macrof1"==this.evaluationKeys?i(this.predictions[t].macro_f1):i(this.predictions[t].accuracy)).attr("width",a).attr("height",t=>"f1"==this.evaluationKeys?this.height-i(this.predictions[t].f1):"mcc"==this.evaluationKeys?this.height-i(this.predictions[t].mcc):"precision"==this.evaluationKeys?this.height-i(this.predictions[t].precision):"recall"==this.evaluationKeys?this.height-i(this.predictions[t].recall):"microf1"==this.evaluationKeys?this.height-i(this.predictions[t].micro_f1):"macrof1"==this.evaluationKeys?this.height-i(this.predictions[t].macro_f1):this.height-i(this.predictions[t].accuracy)).attr("fill",this.rightColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right",classifier:t}).on("mouseleave",this.clearHover);if("accuracy"==this.evaluationKeys||"precision"==this.evaluationKeys||"recall"==this.evaluationKeys){r.on("click",t=>this.select(t,"right","first")).on("contextmenu",t=>this.select(t,"right","second")),t.append("rect").attr("class","bar-wrong").attr("y",t=>i(1)).attr("width",a).attr("height",t=>"precision"==this.evaluationKeys?this.height-i(1-this.predictions[t].precision):"recall"==this.evaluationKeys?this.height-i(1-this.predictions[t].recall):this.height-i(1-this.predictions[t].accuracy)).attr("fill",this.wrongColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong","first")).on("contextmenu",t=>this.select(t,"wrong","second"));t.append("circle").attr("cx",a/2).attr("cy",15).attr("r","15px").attr("fill",this.wrongColor).attr("stroke","grey").on("mouseenter",t=>this.hover={type:"wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong","first")).on("contextmenu",t=>this.select(t,"wrong","second")).style("visibility",t=>{var e="precision"==this.evaluationKeys?1-this.predictions[t].precision:"recall"==this.evaluationKeys?1-this.predictions[t].recall:1-this.predictions[t].accuracy;return 0==e?"hidden":e<.05?"visible":"hidden"})}},l=()=>{e.append("line").attr("class","y-axis-marker-line").attr("y1",i(1)).attr("x2",this.width).attr("y2",i(1)).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none")},c=()=>{e.append("text").attr("class","y-axis-marker-text-right").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.rightHoverColor).attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-wrong").attr("text-anchor","middle").attr("font-size",20).attr("fill",this.wrongHoverColor).attr("pointer-events","none"),e.append("rect").attr("class","y-axis-marker-rect").attr("width",120).attr("height",60).attr("stroke","grey").attr("fill","white").attr("opacity",0),e.append("text").attr("class","y-axis-marker-text-selection1").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-selection2").attr("text-anchor","middle").attr("font-size",20).attr("fill","red").attr("pointer-events","none")};n(),o(),l(),c(),this.drawHover(),this.drawSelections()},drawSelections(){const t=it["C"](this.$refs.svg),e=t.select(".y-axis-marker-rect"),{first:s,second:i}=this.selections,a=this.x,r=a.bandwidth(),n=a.bandwidth()/8,o=["Right","Wrong"],l=[s,i];let c={},h=[...this.$store.getters.filteredInstances],d=this.$store.state.selectionHistory;h.forEach(t=>{c[t]=1}),"weighted"==this.weightedPerformance&&d.forEach(t=>{let e=[...t.instances],s=parseFloat(t.weight.toString());e.forEach(t=>{c[t]+=s})});const u=t=>{let e=0;return t.forEach(t=>{e+=c[t]}),e},p=(t,e)=>{let s=[...t],i=[...e];return s.forEach(t=>{i.push(t)}),new Set(i)},f=(t,e,s)=>{const i=this.predictions[t][e];var a=new Set;a="precision"==this.evaluationKeys?p(this.predictions[t]["fp"],this.predictions[t]["tp"]):"recall"==this.evaluationKeys?p(this.predictions[t]["fn"],this.predictions[t]["tp"]):new Set(this.instances);const r=Lt(i,s),n=u([...r])/u([...a]);return this.y(n)},m=(t,e,s)=>{this.predictions[t][e];return this.height-f(t,e,s)},g=(t,e,s)=>{const i=this.predictions[t][e];var a=new Set;a="precision"==this.evaluationKeys?p(this.predictions[t]["fp"],this.predictions[t]["tp"]):"recall"==this.evaluationKeys?p(this.predictions[t]["fn"],this.predictions[t]["tp"]):new Set(this.instances);const r=Lt(i,s),n=u([...r])/u([...a]);return this.height-this.y(n)},v=(t,e,s)=>{const i=this.predictions[t][e],a=Lt(i,s);for(const r of a)if(this.$store.state.focusItemId===r)return!0;return!1};this.hover.type&&("mcc"!=this.evaluationKeys&&"microf1"!=this.evaluationKeys&&"macrof1"!=this.evaluationKeys&&"f1"!=this.evaluationKeys?(e.attr("opacity",1).attr("transform",`translate(\n              ${this.x(this.hover.classifier)},\n              ${this.y(1)-70})`),(s||i)&&this.drawHover()):e.attr("opacity",0)),"microf1"!=this.evaluationKeys&&"macrof1"!=this.evaluationKeys&&"f1"!=this.evaluationKeys&&"mcc"!=this.evaluationKeys&&l.forEach((t,e)=>{t?this.continuousPredictionKeys.forEach(s=>{o.forEach((i,o)=>{let l={barCells:this.svg,x:a(s)+r/2+(e-1)*n,y:"Wrong"==i?0:f(s,"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"tp":"right",t.instances),width:n,height:"Wrong"==i?g(s,"precision"==this.evaluationKeys?"fp":"recall"==this.evaluationKeys?"fn":"wrong",t.instances):m(s,"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"tp":"right",t.instances),r:n/2,color:0==e?this.selection1Color:this.selection2Color,circle_visibility:"Wrong"==i?0==g(s,"precision"==this.evaluationKeys?"fp":"recall"==this.evaluationKeys?"fn":"wrong",t.instances)||g(s,"precision"==this.evaluationKeys?"fp":"recall"==this.evaluationKeys?"fn":"wrong",t.instances)/this.height>.05?"hidden":"visible":0==m(s,"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"tp":"right",t.instances)||m(s,"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"tp":"right",t.instances)/this.height>.05?"hidden":"visible",cx:a(s)+r/2+(e-.5)*n,cy:"Wrong"==i?0+n/2:this.height-n/2,selection_type:e,focused:v(s,"Wrong"==i?"precision"==this.evaluationKeys?"fp":"recall"==this.evaluationKeys?"fn":"wrong":"precision"==this.evaluationKeys||"recall"==this.evaluationKeys?"tp":"right",t.instances),view_name:this.name};this.$store.dispatch("drawSelections",l)})}):(this.svg.selectAll("selection-rect-"+e).attr("height","0"),this.svg.selectAll("selection-circle-"+e).attr("visibility","hidden"),this.svg.selectAll("selection-focus-"+e).attr("visibility","hidden"))})},select(t,e,s){it["i"].preventDefault(),it["i"].stopPropagation();const i=nt();i.rule=X.RIGHT,i.classifier=t,i.negation="wrong"===e;const a="precision"!=this.evaluationKeys&&"recall"!=this.evaluationKeys||"right"!=e?"accuracy"==this.evaluationKeys&&"right"==e?"right":"precision"==this.evaluationKeys&&"wrong"==e?"fp":"recall"==this.evaluationKeys&&"wrong"==e?"fn":"wrong":"tp",r=this.predictions[t][a],n=`Instances which ${t} got ${e}`,o={type:"simple",constraints:[i],metric:[]},l={description:n,instances:r,predicate:o};this.$store.dispatch("prependToSelectionHistory",l),this.$store.dispatch("changedMostRecentSelection",s)}}}),Qt=Gt,Jt=(s("11a6"),s("c865")),Xt=s("0393"),Zt=s("67b6"),te=s("43a6"),ee=Object(m["a"])(Qt,et,st,!1,null,"92fb7b2e",null),se=ee.exports;v()(ee,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var ie=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Performance Curves")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Evaluation method"},model:{value:t.evaluationKeys,callback:function(e){t.evaluationKeys=e},expression:"evaluationKeys"}},[s("v-radio",{attrs:{label:"ROC",value:"roc"}}),s("v-radio",{attrs:{label:"PR",value:"pr"}})],1)],1),s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Selection Mode"},model:{value:t.selection_mode,callback:function(e){t.selection_mode=e},expression:"selection_mode"}},[s("v-radio",{attrs:{label:"overall curve ",value:"overall"}}),s("v-radio",{attrs:{label:"selection curve",value:"selected"}})],1)],1)])],1)],1),s("multiselect",{attrs:{options:t.options,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pick sets",label:"name","track-by":"name","preselect-first":!0},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.values,a=(e.search,e.isOpen);return[i.length&&!a?s("span",{staticClass:"multiselect__single"},[t._v(" "+t._s(i.length)+" options selected ")]):t._e()]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),s("div",{attrs:{id:"legend1"}}),s("div",{ref:"svg"})],1)},ae=[],re=i["a"].extend({name:"Performance_Curves",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:30,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i="roc",a={classifier:"",threshold:""},r={classifier:"",threshold:""},n={classifier:"",threshold:""},o="overall";return{value:[],thresholdToidx:{},selectedCurves:[],selection_mode:o,pointRemove:n,pointSelection:r,hover:a,evaluationKeys:i,height:s,margin:t,curclick:[],panel:[],rightColor:"#d1e5f0",rightHoverColor:"#4393c3",width:e,selectedEval:"",wrongColor:"#fddbc7",wrongHoverColor:"#d6604d"}},computed:{addedThresholdClassifiers(){return"continuous"!=this.$store.state.datasetType?[]:this.$store.state.addedThresholdClassifiers},classes(){return[...this.boxProps.classes]},thresholdClassifierNameList(){return this.$store.state.thresholdClassifierNameList},classifierThresholds(){let t={};return this.thresholdClassifierNameList.forEach(e=>{let s=e.split("_")[0],i=(parseInt(e.split("_")[1])/100).toFixed(2);t[s]=i}),t},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},options(){let t=[];const e=this.classifiers;return e.forEach(e=>{t.push({name:e})}),t},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},metrics(){const t=this.$store.getters.metrics,e=Object.entries(t).map(([t,e])=>({classifier:t,metrics:e}));return e},min_y(){return{roc:1,pr:1}},predictions(){const t=this.$store.getters.continuous_metrics;return t},x(){const t=it["y"]().domain([0,1]).range([0,this.width]);return t},y(){const t=it["y"]().domain([0,1]).range([this.height,0]);return t},outSelections(){return this.$store.state.overlapSelections},saveStatus(){return this.$store.state.saveStatus},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Performance_Curves"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.evaluationKeys=e.evaluation,this.selection_mode=e.selection}}),this.drawInitial()},saveStatus(){let t={name:"Performance_Curves",config:{classifiers:this.value.map(t=>t.name),evaluation:this.evaluationKeys,selection:this.selection_mode}};this.$store.dispatch("changedSaveConfig",t)},value(){this.drawInitial()},addedThresholdClassifiers(){this.drawAddedPoint(),this.drawCurrentThreshold()},thresholdClassifierNameList(){this.drawAddedPoint(),this.drawCurrentThreshold()},classifiers(){this.drawInitial()},outSelections(){this.drawInitial()},selection_mode(){this.drawInitial()},pointRemove(){this.clearPointSelection()},pointSelection(){this.drawAddedPoint(),this.drawPointSelection()},hover(){this.drawHover()},evaluationKeys(){this.clearHover(),this.drawInitial()}},mounted(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Performance_Curves"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.evaluationKeys=e.evaluation,this.selection_mode=e.selection}}),this.drawInitial()},methods:{clearHover(){this.hover={classifier:"",threshold:""}},clearPointSelection(){const t=it["C"](this.$refs.svg),e=this.pointSelection.classifier;this.pointSelection.threshold;t.select(".dot_"+e).attr("r",5).attr("opacity",0),t.select(".pointText_"+e).attr("visibility","hidden")},drawAddedPoint(){const t=it["C"](this.$refs.svg);for(let e in this.classifierThresholds)for(let s in this.thresholdToidx[e]){let i=this.thresholdToidx[e][s];t.select(".dot_"+e+"_"+i).attr("r",5).attr("opacity",0),t.select(".pointText_"+e+"_"+i).attr("visibility","hidden")}this.addedThresholdClassifiers.forEach(e=>{let s=e.substring(4,e.length-5),i=parseFloat(e.substring(e.length-4,e.legend)),a=s+"_"+this.thresholdToidx[s][i];t.select(".dot_"+a).attr("r",8).attr("opacity",1),t.select(".pointText_"+a).attr("visibility","visible")})},drawPointSelection(){const t=it["C"](this.$refs.svg),e=this.pointSelection.classifier;this.pointSelection.threshold;t.select(".dot_"+e).attr("r",8).attr("opacity",1),t.select(".pointText_"+e).attr("visibility","visible"),this.updateThreshold()},drawCurrentThreshold(){const t=it["C"](this.$refs.svg),e=this.value.map(t=>t.name);for(let s in this.classifierThresholds)if(e.includes(s)){let e=this.classifierThresholds[s],i=this.thresholdToidx[s][e];t.select(".dot_"+s+"_"+i).attr("r",8).attr("opacity",1),t.select(".pointText_"+s+"_"+i).attr("visibility","visible")}},updateThreshold(){const t=this.pointSelection.classifier.split("_")[0],e=parseFloat(this.pointSelection.threshold).toFixed(2);let s={classifier:t,single_threshold:100*parseFloat(e)};this.$store.dispatch("changedCurveChosenClassifierThresholdTuple",s)},drawHover(){const t=it["C"](this.$refs.svg),e=this.evaluationKeys,s=this.hover.classifier,i=this.hover.threshold,a=this.value.map(t=>t.name);if("overall"==this.selection_mode)""!=s?(t.select(".hoverBox").attr("hidden"),"roc"==e&&t.select(".auc_value_"+s).attr("visibility","visible"),t.select(".legend_circle_"+s).attr("r",8),t.select(".legend_text_"+s).style("font-size","20px"),a.forEach(e=>{e!=s&&t.select(".line_"+e).style("opacity",.3)}),""!=i&&(t.select(".text_"+s+"_"+i).attr("visibility","visible"),t.select(".tpr_"+s+"_"+i).attr("visibility","visible"),t.select(".fpr_"+s+"_"+i).attr("visibility","visible"),t.select(".acc_"+s+"_"+i).attr("visibility","visible"),t.select(".hoverBox").attr("visibility","visible"))):a.forEach(e=>{t.select(".text_"+e+"_"+i).attr("visibility","hidden"),t.select(".fpr_"+e+"_"+i).attr("visibility","hidden"),t.select(".tpr_"+e+"_"+i).attr("visibility","hidden"),t.select(".acc_"+e+"_"+i).attr("visibility","hidden"),t.select(".hoverBox").attr("visibility","hidden"),t.select(".legend_circle_"+e).attr("r",6),t.select(".legend_text_"+e).style("font-size","15px"),t.select(".line_"+e).style("opacity",1),t.select(".auc_value_"+e).attr("visibility","hidden")});else{let r=0;this.selectedCurves.forEach(n=>{r+=1;let o=n.name;""!=s?(t.select(".hoverBox").attr("hidden"),"roc"==e&&t.select(".auc_value_"+s+"_"+o).attr("visibility","visible").attr("y",100+40*r),t.select(".legend_circle_"+s).attr("r",8),t.select(".legend_text_"+s).style("font-size","20px"),a.forEach(e=>{e!=s&&t.select(".line_"+e+"_"+o).style("opacity",.3)}),""!=i&&(t.select(".text_"+s+"_"+i).attr("visibility","visible"),t.select(".tpr_"+s+"_"+i).attr("visibility","visible"),t.select(".fpr_"+s+"_"+i).attr("visibility","visible"),t.select(".acc_"+s+"_"+i).attr("visibility","visible"),t.select(".hoverBox").attr("visibility","visible"))):a.forEach(e=>{t.select(".text_"+e+"_"+i).attr("visibility","hidden"),t.select(".fpr_"+e+"_"+i).attr("visibility","hidden"),t.select(".tpr_"+e+"_"+i).attr("visibility","hidden"),t.select(".acc_"+e+"_"+i).attr("visibility","hidden"),t.select(".hoverBox").attr("visibility","hidden"),t.select(".legend_circle_"+e).attr("r",6),t.select(".legend_text_"+e).style("font-size","15px"),t.select(".line_"+e+"_"+o).style("opacity",1),t.select(".auc_value_"+e+"_"+o).attr("visibility","hidden")})})}},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["B"](it["n"]).domain([0,this.classifiers.length]).interpolator((function(t){return it["n"](.8*t)})),e=it["j"](".4f"),s=(this.width,this.height),i=(this.margin,this.evaluationKeys),a=this.value.map(t=>t.name),r=it["y"]().domain([0,1]).range([0,this.width]),n=it["y"]().domain([(this.evaluationKeys,0),1]).range([this.height,0]),o=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+this.margin.bottom}`).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`);let l={},c=0;a.forEach(e=>{c+=1,l[e]=[];let s=this.predictions[e].x_roc.length,i=0;this.thresholdToidx[e]={};while(i<s){if("roc"==this.evaluationKeys){let s={x:this.predictions[e].x_roc[i],y:this.predictions[e].y_roc[i],acc:this.predictions[e].acc[i],name:e,threshold:this.predictions[e].value_roc[i],color:t(c)};l[e].push(s)}else{let s={x:this.predictions[e].x_pr[i],y:this.predictions[e].y_pr[i],acc:this.predictions[e].acc[i],name:e,threshold:this.predictions[e].value_roc[i],color:t(c)};l[e].push(s)}this.thresholdToidx[e][parseFloat(this.predictions[e].value_roc[i]).toFixed(2)]=i,i+=1}});let h=[],d=0;a.forEach(e=>{d+=1;let s={name:e,data:l[e],color:t(d)};h.push(s)});const u=()=>{l[a[0]];var t={};function c(e){var s=e.name;t[s]=0,e=e.data;var a="M",o=1,l=0;return e.forEach(e=>{a=a+" "+r(e.x),a=a+" "+n(e.y),a+=" L",t[s]+=(e.y+l)*(o-e.x)/2,o=e.x,l=e.y}),"roc"==i&&(a+=r(0)+" "+n(0)),a}o.append("g").attr("transform","translate(0,"+s+")").call(it["b"](r)),o.append("g").call(it["c"](n));o.selectAll("myPath").data(h).enter().append("path").attr("d",c).attr("class",(t,e)=>"line_"+t.name).style("fill","none").attr("stroke",t=>t.color).style("stroke-width",3).style("opacity",1),o.selectAll(".dot").data(h).enter().selectAll(".circle").data((function(t){return t["data"]})).enter().append("circle").attr("class",(t,e)=>"dot_"+t["name"]+"_"+e).attr("cx",(function(t,e){return r(t["x"])})).attr("cy",(function(t){return n(t["y"])})).attr("r",t=>5).attr("fill",t=>t["color"]).on("mouseenter",(t,e)=>this.hover={classifier:t["name"],threshold:e}).on("mouseleave",(t,e)=>this.hover={classifier:"",threshold:e}).on("click",(t,e)=>this.pointSelection={classifier:t["name"]+"_"+e,threshold:t["threshold"]}).on("contextmenu",(t,e)=>{it["i"].preventDefault(),this.pointRemove={classifier:t["name"]+"_"+e,threshold:t["threshold"]}}).attr("opacity",0),o.selectAll(".pointText").data(h).enter().selectAll(".text").data((function(t){return t["data"]})).enter().append("text").attr("class",(t,e)=>"pointText_"+t["name"]+"_"+e).attr("x",(function(t,e){return r(t["x"])})).attr("y",(function(t){return n(t["y"])})).text(t=>t["threshold"]).attr("font-size",16).attr("visibility","hidden").on("contextmenu",(t,e)=>{it["i"].preventDefault(),this.pointRemove={classifier:t["name"]+"_"+e,threshold:t["threshold"]}}),o.append("rect").attr("class","hoverBox").attr("width",200).attr("height",200).attr("x","roc"==this.evaluationKeys?this.width-400:115).attr("y","roc"==this.evaluationKeys?105:205).attr("fill","white").attr("stroke","black").attr("visibility","hidden"),o.selectAll(".text").data(h).enter().selectAll(".text").data((function(t){return t["data"]})).enter().append("text").attr("class",(t,e)=>"text_"+t["name"]+"_"+e).attr("x","roc"==this.evaluationKeys?this.width-395:120).attr("y","roc"==this.evaluationKeys?160:245).text(t=>"Threshold: "+e(t["threshold"])).style("font-size","25px").attr("alignment-baseline","middle").attr("visibility","hidden"),o.selectAll(".text").data(h).enter().selectAll(".text").data((function(t){return t["data"]})).enter().append("text").attr("class",(t,e)=>"fpr_"+t["name"]+"_"+e).attr("x","roc"==this.evaluationKeys?this.width-395:120).attr("y","roc"==this.evaluationKeys?200:285).text(t=>"roc"==this.evaluationKeys?"FPR: "+e(t["x"]):"Recall: "+e(t["x"])).style("font-size","25px").attr("alignment-baseline","middle").attr("visibility","hidden"),o.selectAll(".text").data(h).enter().selectAll(".text").data((function(t){return t["data"]})).enter().append("text").attr("class",(t,e)=>"tpr_"+t["name"]+"_"+e).attr("x","roc"==this.evaluationKeys?this.width-395:120).attr("y","roc"==this.evaluationKeys?240:325).text(t=>"roc"==this.evaluationKeys?"TPR: "+e(t["y"]):"Precision: "+e(t["y"])).style("font-size","25px").attr("alignment-baseline","middle").attr("visibility","hidden"),o.selectAll(".text").data(h).enter().selectAll(".text").data((function(t){return t["data"]})).enter().append("text").attr("class",(t,e)=>"acc_"+t["name"]+"_"+e).attr("x","roc"==this.evaluationKeys?this.width-395:120).attr("y","roc"==this.evaluationKeys?280:365).text(t=>"Accuracy: "+e(t["acc"])).style("font-size","25px").attr("alignment-baseline","middle").attr("visibility","hidden"),o.selectAll("myText").data(h).enter().append("text").attr("class",t=>"auc_value_"+t.name).attr("x",this.width-395).attr("y",130).text(s=>"AUC: "+e(t[s.name])).style("font-size","25px").attr("alignment-baseline","middle").attr("visibility","hidden")},p=()=>{o.append("text").attr("transform",()=>{const t=this.width/2,e=this.height+.8*this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("roc"==this.evaluationKeys?"FPR":"Recall"),o.append("text").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("roc"==this.evaluationKeys?"TPR":"Precision")},f=()=>{this.evaluationKeys,o.selectAll("myCicle").data(h).enter().append("circle").attr("class",(t,e)=>"legend_circle_"+t.name).attr("cx","roc"==this.evaluationKeys?10:this.width-100).attr("cy",(t,e)=>10+25*e).attr("r",6).style("fill",t=>t.color).on("mouseenter",t=>this.hover={classifier:t.name,threshold:""}).on("mouseleave",this.clearHover),o.selectAll("myText").data(h).enter().append("text").attr("class",(t,e)=>"legend_text_"+t.name).attr("x","roc"==this.evaluationKeys?30:this.width-80).attr("y",(t,e)=>10+25*e).text(t=>t.name).style("font-size","15px").attr("alignment-baseline","middle").on("mouseenter",t=>this.hover={classifier:t.name,threshold:""}).on("mouseleave",this.clearHover);"overall"!=this.selection_mode&&(o.append("line").attr("y1",10).attr("x1",100).attr("x2",140).attr("y2",10).attr("stroke","blue").attr("stroke-width","2px").attr("stroke-opacity",.5).style("stroke-dasharray","3, 3"),o.append("text").attr("y",10).attr("x",142).style("font-size","15px").attr("alignment-baseline","middle").text("selection 1"),o.append("line").attr("y1",35).attr("x1",100).attr("x2",140).attr("y2",35).attr("stroke","blue").attr("stroke-width","2px").attr("stroke-opacity",.5),o.append("text").attr("y",35).attr("x",142).style("font-size","15px").attr("alignment-baseline","middle").text("selection 2"))},m=()=>{this.calculatedSelectedCurves(),o.append("g").attr("transform","translate(0,"+s+")").call(it["b"](r)),o.append("g").call(it["c"](n));this.selectedCurves.forEach(s=>{let l={},c=0,h=s.name;a.forEach(e=>{c+=1,l[e]=[];let i=s[e].x_roc.length,a=0;while(a<i){if("roc"==this.evaluationKeys){let i={x:s[e].x_roc[a],y:s[e].y_roc[a],name:e,threshold:s[e].value_roc[a],color:t(c)};l[e].push(i)}else{let i={x:s[e].x_pr[a],y:s[e].y_pr[a],name:e,threshold:s[e].value_roc[a],color:t(c)};l[e].push(i)}a+=1}});let d=[],u=0;a.forEach(e=>{u+=1;let s={name:e,data:l[e],color:t(u)};d.push(s)});l[a[0]];var p={};function f(t){var e=t.name;p[e]=0,t=t.data;var s="M",a=1,o=0;return t.forEach(t=>{s=s+" "+r(t.x),s=s+" "+n(t.y),s+=" L",p[e]+=(t.y+o)*(a-t.x)/2,a=t.x,o=t.y}),"roc"==i&&(s+=r(0)+" "+n(0)),s}o.selectAll("myPath").data(d).enter().append("path").attr("d",f).attr("class",(t,e)=>"line_"+t.name+"_"+h).style("fill","none").attr("stroke",t=>t.color).style("stroke-width",3).style("stroke-dasharray","1"==h?"3, 3":"0, 0").style("opacity",1),o.selectAll(".dot").data(d).enter().selectAll(".circle").data((function(t){return t["data"]})).enter().append("circle").attr("class",(t,e)=>"dot_"+t["name"]+"_"+e).attr("cx",(function(t,e){return r(t["x"])})).attr("cy",(function(t){return n(t["y"])})).attr("r",5).attr("fill",t=>t["color"]).on("mouseenter",(t,e)=>this.hover={classifier:t["name"],threshold:e}).on("mouseleave",(t,e)=>this.hover={classifier:"",threshold:e}).on("click",(t,e)=>this.pointSelection={classifier:t["name"]+"_"+e,threshold:t["threshold"]}).on("contextmenu",(t,e)=>{it["i"].preventDefault(),this.pointRemove={classifier:t["name"]+"_"+e,threshold:t["threshold"]}}).attr("opacity",0),o.selectAll(".pointText").data(d).enter().selectAll(".text").data((function(t){return t["data"]})).enter().append("text").attr("class",(t,e)=>"pointText_"+t["name"]+"_"+e).attr("x",(function(t,e){return r(t["x"])})).attr("y",(function(t){return n(t["y"])})).text(t=>t["threshold"]).attr("font-size",16).attr("visibility","hidden").on("contextmenu",(t,e)=>{it["i"].preventDefault(),this.pointRemove={classifier:t["name"]+"_"+e,threshold:t["threshold"]}}),o.append("rect").attr("class","hoverBox").attr("width",200).attr("height",80).attr("x","roc"==this.evaluationKeys?this.width-400:115).attr("y","roc"==this.evaluationKeys?105:205).attr("fill","white").attr("stroke","black").attr("visibility","hidden"),o.selectAll(".text").data(d).enter().selectAll(".text").data((function(t){return t["data"]})).enter().append("text").attr("class",(t,e)=>"text_"+t["name"]+"_"+e).attr("x","roc"==this.evaluationKeys?this.width-395:120).attr("y","roc"==this.evaluationKeys?160:245).text(t=>"Threshold: "+e(t["threshold"])).style("font-size","25px").attr("alignment-baseline","middle").attr("visibility","hidden"),o.selectAll("myText").data(d).enter().append("text").attr("class",t=>"auc_value_"+t.name+"_"+h).attr("x",this.width-395).attr("y",130).text(t=>"selected "+h+" AUC: "+e(p[t.name])).style("font-size","25px").attr("alignment-baseline","middle").attr("visibility","hidden");u+=1})};p(),f(),"overall"==this.selection_mode?u():m(),this.drawAddedPoint(),this.drawCurrentThreshold()},calculatedSelectedCurves(){const t=this.value.map(t=>t.name),{first:e,second:s}=this.outSelections;this.selectedCurves=[];const i=(t,e)=>{let s={},i=[],a={},r=0,n=0,o=0,l=1,c=0;const h=t,d=it["j"](".2f");s[h]={x_roc:[],y_roc:[],value_roc:[],x_pr:[],y_pr:[],auc_area:0},a[h]=[],e.forEach(t=>{const e=Nt(t);a[h].includes(e.continuous_predictions[h])||a[h].push(e.continuous_predictions[h])}),a[h].sort(),a[h].forEach(t=>{t=d(t);let a=0,r=0,u=0,p=0;e.forEach(e=>{const s=Nt(e),i=s.continuous_predictions[h]<parseFloat(t)?this.classes[0]:this.classes[1];s.actual==this.classes[1]?i==s.actual?a+=1:u+=1:i==s.actual?p+=1:r+=1}),a<n&&(l=0),1==l&&a>=n&&(o+=1,n=a),a+p>c&&(c=a+p),i.push({x:r/(r+p),y:a/(a+u)}),s[h].x_roc.push(r/(r+p)),s[h].y_roc.push(a/(a+u)),s[h].value_roc.push(t),s[h].x_pr.push(a/(a+u)),s[h].y_pr.push(a/(a+r))});let u=0,p=0;return i.sort((function(t,e){return it["a"](t.x,e.x)})),i.forEach(t=>{r+=(t.y+p)*(t.x-u)/2,u=t.x,p=t.y}),s[h]};if(e){let s={name:"1"};t.forEach(t=>{s[t]=i(t,e.instances)}),this.selectedCurves.push(s)}if(s){let e={name:"2"};t.forEach(t=>{e[t]=i(t,s.instances)}),this.selectedCurves.push(e)}}}}),ne=re,oe=(s("1f83"),Object(m["a"])(ne,ie,ae,!1,null,"603a45b7",null)),le=oe.exports;v()(oe,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var ce=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("(Trinary) Performance Confidence")])],1)]),s("v-expansion-panel-content"),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Distribution Mode"},model:{value:t.distribution,callback:function(e){t.distribution=e},expression:"distribution"}},[s("v-radio",{attrs:{label:"original distribution",value:"original"}}),s("v-radio",{attrs:{label:"trinary distribution",value:"trinary"}})],1)],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Selection Mode"},model:{value:t.selection_mode,callback:function(e){t.selection_mode=e},expression:"selection_mode"}},[s("v-radio",{attrs:{label:"overall confidence ",value:"overall"}}),s("v-radio",{attrs:{label:"selection confidence",value:"selected"}})],1)],1)])],1)],1),s("div",{attrs:{id:"legend1"}},["overall"==t.selection_mode?s("v-switch",{staticClass:"ml-8",staticStyle:{"font-size":"12px"},attrs:{label:"normalize"},model:{value:t.normalization_switch,callback:function(e){t.normalization_switch=e},expression:"normalization_switch"}}):t._e()],1),s("div",{ref:"svg"})],1)},he=[],de=i["a"].extend({name:"Trinary_Performance_Confidence",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:30,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i={type:"",selection:"",classifier:"",interval:""},a={type:"",classifier:"",interval:""},r="trinary";return{selection_mode:"overall",maxIntervals:0,distribution:r,hover_distribution:a,normalization:"No",height:s,hover:i,margin:t,curclick:[],panel:[],rightColor:"#b8ddf2",width:e,selectedEval:"",wrongColor:"#f7c8aa",rightColor1:"#b8ddf2",wrongColor1:"#f7c8aa",rightHoverColor1:"#4ba0ce",wrongHoverColor1:"#ff884d",rightHoverColor:"#4393c3",wrongHoverColor:"#d6604d",selection1Color:"#18FFFF",selection2Color:"#FF4081",nameTocontinuous:{}}},computed:{addedThresholdClassifiers(){return"continuous"!=this.$store.state.datasetType?[]:this.$store.state.addedThresholdClassifiers.map(t=>t.name)},addedBandWidthClassifiers(){if(0==this.$store.state.addedBandWidthClassifiers.length){const t=Object.keys(this.$store.state.classifierThresholdDict).map(t=>{let e=this.$store.state.classifierThresholdDict[t]/100;return{name:t+"("+(e-.05<0?0:e-.05).toFixed(2)+","+(e+.05>1?1:e+.05).toFixed(2)+")"}});return t}return this.$store.state.addedBandWidthClassifiers},normalization_switch:{set(){"Yes"==this.normalization?this.normalization="No":this.normalization="Yes"},get(){return"Yes"===this.normalization}},bandWidthClassifiers(){let t=[];return this.classifiers.forEach(e=>{t.push(e)}),this.addedThresholdClassifiers.forEach(e=>{t.push(e)}),t},classifierBandWidthDict(){if("original"==this.distribution){const t=this.boxProps.classifierBandWidthDict,e=this.bandWidthClassifiers;return 0!=Object.keys(t).length&&e.length==Object.keys(t).length||e.forEach(e=>{Object.keys(t).includes(e)||(t[e]={name:e,threshold:Object.keys(this.classifierThresholds).includes(e)?this.classifierThresholds[e]:0,left_range:Object.keys(this.classifierThresholds).includes(e)?this.classifierThresholds[e]/100-.05<0?0:this.classifierThresholds[e]/100-.05:0,right_range:Object.keys(this.classifierThresholds).includes(e)?this.classifierThresholds[e]/100+.05>1?1:this.classifierThresholds[e]/100+.05:0})}),t}let t=[],e=this.addedBandWidthClassifiers.map(t=>t.name);return e.forEach(e=>{e.split("(")[0];let s=parseFloat(e.substring(e.length-10,e.length-6)).toFixed(2),i=parseFloat(e.substring(e.length-5,e.length-1)).toFixed(2),a=((parseFloat(i)+parseFloat(s))/2).toFixed(2);t[e]={name:e,threshold:a,left_range:s,right_range:i}}),t},bandWidthChangedClassifierName(){return this.$store.state.bandWidthChangedClassifierName},classifierThresholds(){return this.$store.state.classifierThresholdDict},classes(){return[...this.boxProps.classes]},confidence(){return["0","0.1","0.2","0.3","0.4","0.5","0.6","0.7","0.8","0.9","1.0"]},confidenceIndex(){let t={};for(let e in this.confidence)t[this.confidence[e]]=parseInt(e);return t},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},continuousPredictionKeys(){if("continuous"==this.$store.state.datasetType){var t=[];return this.classifiers.forEach(e=>{t.push(e+"_"+this.$store.state.classifierThresholdDict[e]/100),this.nameTocontinuous[e]=e+"_"+this.$store.state.classifierThresholdDict[e]/100}),this.addedThresholdClassifiers.forEach(e=>{t.push(e)}),t}return this.predictionKeys},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},metrics(){const t=this.$store.getters.metrics,e=Object.entries(t).map(([t,e])=>({classifier:t,metrics:e}));return e},predictions(){const t={};var e=[];return"trinary"==this.distribution?this.addedBandWidthClassifiers.forEach(s=>{let i=s.name,a=i.split("(")[0],r=parseFloat(i.substring(i.length-10,i.length-6)).toFixed(2),n=parseFloat(i.substring(i.length-5,i.length-1)).toFixed(2),o=(parseFloat(n)+parseFloat(r))/2;t[i]={name:i,threshold:o,acc:0,ci_tp:[],ci_fn:[],ci_tn:[],ci_fp:[],ci_mn:[],ci_mp:[],ci_pred:[],ci_tp_instances:{},ci_fp_instances:{},ci_tn_instances:{},ci_fn_instances:{},ci_mp_instances:{},ci_mn_instances:{},all_instances:{},continuous_pred:[]},this.confidence.forEach(e=>{t[i]["ci_tp_instances"][e]={instances:new Set},t[i]["ci_tn_instances"][e]={instances:new Set},t[i]["ci_fp_instances"][e]={instances:new Set},t[i]["ci_fn_instances"][e]={instances:new Set},t[i]["ci_mp_instances"][e]={instances:new Set},t[i]["ci_mn_instances"][e]={instances:new Set},t[i]["all_instances"][e]={instances:new Set}}),this.instances.forEach(e=>{let s=Nt(e).continuous_predictions[a];Nt(e).actual,Nt(e).predictions[a];t[i].continuous_pred.push(parseFloat(s));let o=(s.split(".")[1].substring(0,1)/10).toString();"1"==s.split(".")[0]&&(o="1.0");let l=this.confidenceIndex[o];if(l>0&&l<this.confidence.length){let t=l+1,e=parseFloat(this.confidence[t]);Math.abs(e-parseFloat(s))<Math.abs(parseFloat(s)-parseFloat(o))&&(o=this.confidence[t])}t[i]["all_instances"][o].instances.add(e),s>r&&s<n?s>=t[i].threshold/100?t[i]["ci_mp_instances"][o].instances.add(e):t[i]["ci_mn_instances"][o].instances.add(e):s>=n?Nt(e).actual==this.classes[1]?t[i]["ci_tp_instances"][o].instances.add(e):t[i]["ci_fp_instances"][o].instances.add(e):Nt(e).actual==this.classes[0]?t[i]["ci_tn_instances"][o].instances.add(e):t[i]["ci_fn_instances"][o].instances.add(e)}),this.confidence.forEach(s=>{t[i]["ci_tp"].push(t[i]["ci_tp_instances"][s].instances.size),t[i]["ci_tn"].push(t[i]["ci_tn_instances"][s].instances.size),t[i]["ci_fp"].push(t[i]["ci_fp_instances"][s].instances.size),t[i]["ci_fn"].push(t[i]["ci_fn_instances"][s].instances.size),t[i]["ci_mp"].push(t[i]["ci_mp_instances"][s].instances.size),t[i]["ci_mn"].push(t[i]["ci_mn_instances"][s].instances.size),e.push(t[i]["ci_tn_instances"][s].instances.size+t[i]["ci_tp_instances"][s].instances.size+t[i]["ci_fn_instances"][s].instances.size+t[i]["ci_fp_instances"][s].instances.size)});for(let e in t[i]["ci_tp"])t[i]["ci_pred"].push(t[i]["ci_tp"][e]+t[i]["ci_tn"][e]+t[i]["ci_fp"][e]+t[i]["ci_fn"][e]+t[i]["ci_mp"][e]+t[i]["ci_mn"][e])}):this.classifiers.forEach(s=>{let i=0==Object.keys(this.classifierBandWidthDict).length?.45:this.classifierBandWidthDict[s].left_range,a=0==Object.keys(this.classifierBandWidthDict).length?.55:this.classifierBandWidthDict[s].right_range;t[s]={name:s,threshold:Object.keys(this.classifierThresholds).includes(s)?this.classifierThresholds[s]:0,acc:0,ci_tp:[],ci_fn:[],ci_tn:[],ci_fp:[],ci_mn:[],ci_mp:[],ci_pred:[],ci_tp_instances:{},ci_fp_instances:{},ci_tn_instances:{},ci_fn_instances:{},ci_mp_instances:{},ci_mn_instances:{},all_instances:{},continuous_pred:[]},this.confidence.forEach(e=>{t[s]["ci_tp_instances"][e]={instances:new Set},t[s]["ci_tn_instances"][e]={instances:new Set},t[s]["ci_fp_instances"][e]={instances:new Set},t[s]["ci_fn_instances"][e]={instances:new Set},t[s]["ci_mp_instances"][e]={instances:new Set},t[s]["ci_mn_instances"][e]={instances:new Set},t[s]["all_instances"][e]={instances:new Set}}),this.instances.forEach(e=>{let r=Nt(e).continuous_predictions[s];Nt(e).actual,Nt(e).predictions[s];t[s].continuous_pred.push(parseFloat(r));let n=(r.split(".")[1].substring(0,1)/10).toString();"1"==r.split(".")[0]&&(n="1.0");let o=this.confidenceIndex[n];if(o>0&&o<this.confidence.length){let t=o+1,e=parseFloat(this.confidence[t]);Math.abs(e-parseFloat(r))<Math.abs(parseFloat(r)-parseFloat(n))&&(n=this.confidence[t])}t[s]["all_instances"][n].instances.add(e),r>i&&r<a?r>=t[s].threshold/100?t[s]["ci_mp_instances"][n].instances.add(e):t[s]["ci_mn_instances"][n].instances.add(e):r>=a?Nt(e).actual==this.classes[1]?t[s]["ci_tp_instances"][n].instances.add(e):t[s]["ci_fp_instances"][n].instances.add(e):Nt(e).actual==this.classes[0]?t[s]["ci_tn_instances"][n].instances.add(e):t[s]["ci_fn_instances"][n].instances.add(e)}),this.confidence.forEach(i=>{t[s]["ci_tp"].push(t[s]["ci_tp_instances"][i].instances.size),t[s]["ci_tn"].push(t[s]["ci_tn_instances"][i].instances.size),t[s]["ci_fp"].push(t[s]["ci_fp_instances"][i].instances.size),t[s]["ci_fn"].push(t[s]["ci_fn_instances"][i].instances.size),t[s]["ci_mp"].push(t[s]["ci_mp_instances"][i].instances.size),t[s]["ci_mn"].push(t[s]["ci_mn_instances"][i].instances.size),e.push(t[s]["ci_tn_instances"][i].instances.size+t[s]["ci_tp_instances"][i].instances.size+t[s]["ci_fn_instances"][i].instances.size+t[s]["ci_fp_instances"][i].instances.size)});for(let e in t[s]["ci_tp"])t[s]["ci_pred"].push(t[s]["ci_tp"][e]+t[s]["ci_tn"][e]+t[s]["ci_fp"][e]+t[s]["ci_fn"][e]+t[s]["ci_mp"][e]+t[s]["ci_mn"][e])}),this.maxIntervals=.9*it["t"](e),this.x.domain([0,2*it["t"](e)]),t},selections(){return this.$store.state.overlapSelections},x(){let t=this.addedBandWidthClassifiers.map(t=>{t.name});const e=it["y"]().range([0,this.width/t.length]).domain([0,100]);return e},xRight(){let t=this.addedBandWidthClassifiers.map(t=>{t.name});const e=it["y"]().range([0,this.width/t.length]).domain([0,1]);return e},y(){const t=it["x"]().range([this.height,0]).padding(.1).domain(this.confidence);return t},yScale(){const t=it["y"]().domain([0,1]).range([this.height,0]);return t},saveStatus(){return this.$store.state.saveStatus},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Trinary_Performance_Confidence"==t.name&&t.config){let e=t.config;this.selection_mode=e.selection,this.distribution=e.distribution}}),this.drawInitial()},saveStatus(){let t={name:"Trinary_Performance_Confidence",config:{selection:this.selection_mode,distribution:this.distribution}};this.$store.dispatch("changedSaveConfig",t)},addedBandWidthClassifiers(){this.drawInitial()},selection_mode(){this.drawInitial()},normalization(){"original"==this.distribution?this.drawOriginalDistribution():this.drawInitial()},hover_distribution(){this.drawDistributionHover()},hover(){this.drawHover()},instances(){"original"==this.distribution?this.drawOriginalDistribution():this.drawInitial()},selections(){"selected"==this.selection_mode&&this.drawInitial(),this.drawSelections(),this.drawDistSelections()},distribution(){"original"==this.distribution?this.drawOriginalDistribution():this.drawInitial()}},mounted(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Trinary_Performance_Confidence"==t.name&&t.config){let e=t.config;this.selection_mode=e.selection,this.distribution=e.distribution}}),this.drawInitial()},methods:{dataUpdateWithRange(){const t=this.bandWidthChangedClassifierName,e=this.classifierBandWidthDict[t].left_range,s=this.classifierBandWidthDict[t].right_range;let i=0,a=0,r=-.1;this.confidence.forEach(t=>{e<=t&&e>r&&(i=r),s<=t&&s>r&&(a=t),r=t});for(let n in this.confidence){let r=this.confidence[n],o=[...this.predictions[t]["all_instances"][r].instances],l=r;r>=i&&r<=a&&(this.predictions[t]["ci_tp_instances"][r]["instances"]=new Set,this.predictions[t]["ci_tn_instances"][r]["instances"]=new Set,this.predictions[t]["ci_fp_instances"][r]["instances"]=new Set,this.predictions[t]["ci_fn_instances"][r]["instances"]=new Set,this.predictions[t]["ci_mp_instances"][r]["instances"]=new Set,this.predictions[t]["ci_mn_instances"][r]["instances"]=new Set,o.forEach(i=>{let a=Nt(i).continuous_predictions[t];Nt(i).actual,Nt(i).predictions[t];a>e&&a<s?a>=this.predictions[t].threshold||parseFloat(l)>this.predictions[t].threshold/100?this.predictions[t]["ci_mp_instances"][l].instances.add(i):this.predictions[t]["ci_mn_instances"][l].instances.add(i):a>=s?Nt(i).actual==this.classes[1]?this.predictions[t]["ci_tp_instances"][l].instances.add(i):this.predictions[t]["ci_fp_instances"][l].instances.add(i):Nt(i).actual==this.classes[0]?this.predictions[t]["ci_tn_instances"][l].instances.add(i):this.predictions[t]["ci_fn_instances"][l].instances.add(i)}),this.predictions[t].ci_tp[n]=this.predictions[t]["ci_tp_instances"][r]["instances"].size,this.predictions[t].ci_tn[n]=this.predictions[t]["ci_tn_instances"][r]["instances"].size,this.predictions[t].ci_fp[n]=this.predictions[t]["ci_fp_instances"][r]["instances"].size,this.predictions[t].ci_fn[n]=this.predictions[t]["ci_fn_instances"][r]["instances"].size,this.predictions[t].ci_mp[n]=this.predictions[t]["ci_mp_instances"][r]["instances"].size,this.predictions[t].ci_mn[n]=this.predictions[t]["ci_mn_instances"][r]["instances"].size,this.predictions[t].ci_pred[n]=this.predictions[t].ci_tp[n]+this.predictions[t].ci_tn[n]+this.predictions[t].ci_fp[n]+this.predictions[t].ci_fn[n]+this.predictions[t].ci_mp[n]+this.predictions[t].ci_mn[n])}},drawUpdateWithRange(){const t=this.bandWidthChangedClassifierName,e=(this.instances,this.yScale),s=it["C"](this.$refs.svg);s.select(".slider-circle-time-from-"+t).attr("transform",t=>"translate(0,"+e(this.classifierBandWidthDict[this.bandWidthChangedClassifierName].left_range.toFixed(2))+")rotate(30)"),s.select(".slider-circle-time-to-"+t).attr("transform",t=>"translate(0,"+e(this.classifierBandWidthDict[this.bandWidthChangedClassifierName].right_range.toFixed(2))+")rotate(30)"),s.select(".slider-line-"+t).attr("y1",t=>e(this.classifierBandWidthDict[this.bandWidthChangedClassifierName].left_range.toFixed(2))).attr("y2",t=>e(this.classifierBandWidthDict[this.bandWidthChangedClassifierName].right_range.toFixed(2))),this.dataUpdateWithRange(),this.drawConfidence()},clearDistributionHover(){this.hover_distribution={type:"",classifier:"",interval:""}},clearHover(){this.hover={type:"",selection:"",classifier:"",interval:""}},drawHover(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-right1"),s=t.selectAll(".bar-wrong1"),i=t.selectAll(".bar-right2"),a=t.selectAll(".bar-wrong2"),r=t.selectAll(".bar-middle1"),n=t.selectAll(".bar-middle2"),o=t.select(".y-axis-marker-rect"),l=t.select(".y-axis-marker-text-right1"),c=t.select(".y-axis-marker-text-wrong1"),h=t.select(".y-axis-marker-text-middle1"),d=t.select(".y-axis-marker-text-right1-s1"),u=t.select(".y-axis-marker-text-wrong1-s1"),p=t.select(".y-axis-marker-text-middle1-s1"),f=t.select(".y-axis-marker-text-right1-s2"),m=t.select(".y-axis-marker-text-wrong1-s2"),g=t.select(".y-axis-marker-text-middle1-s2"),{first:v,second:y}=this.selections,_=(t,e,s,i)=>{const a=1==i?this.predictions[t]["ci_tp_instances"][e].instances:this.predictions[t]["ci_tn_instances"][e].instances;this.instances.length;const r=Lt(a,s),n=(1==i?(this.predictions[t]["ci_tp_instances"][e].instances.size,this.predictions[t]["ci_fp_instances"][e].instances.size,this.predictions[t]["ci_mp_instances"][e].instances.size):(this.predictions[t]["ci_tn_instances"][e].instances,this.predictions[t]["ci_fn_instances"][e].instances,this.predictions[t]["ci_mn_instances"][e].instances),"No"==this.normalization?r.size:0==a.size?0:(100*r.size/a.size).toFixed(0));return n},x=(t,e,s,i)=>{const a=1==i?this.predictions[t]["ci_fp_instances"][e].instances:this.predictions[t]["ci_fn_instances"][e].instances;this.instances.length;const r=Lt(a,s),n=(1==i?(this.predictions[t]["ci_tp_instances"][e].instances.size,this.predictions[t]["ci_fp_instances"][e].instances.size,this.predictions[t]["ci_mp_instances"][e].instances.size):(this.predictions[t]["ci_tn_instances"][e].instances,this.predictions[t]["ci_fn_instances"][e].instances,this.predictions[t]["ci_mn_instances"][e].instances),"No"==this.normalization?r.size:0==a.size?0:(100*r.size/a.size).toFixed(0));return n},b=(t,e,s,i)=>{const a=1==i?this.predictions[t]["ci_mp_instances"][e].instances:this.predictions[t]["ci_mn_instances"][e].instances;this.instances.length;const r=Lt(a,s),n=(1==i?(this.predictions[t]["ci_tp_instances"][e].instances.size,this.predictions[t]["ci_fp_instances"][e].instances.size,this.predictions[t]["ci_mp_instances"][e].instances.size):(this.predictions[t]["ci_tn_instances"][e].instances,this.predictions[t]["ci_fn_instances"][e].instances,this.predictions[t]["ci_mn_instances"][e].instances),"No"==this.normalization?r.size:0==a.size?0:(100*r.size/a.size).toFixed(0));return n},w=this.addedBandWidthClassifiers.map(t=>t.name);var C=it["A"]().range([0,this.width]).padding(.5).domain(w);"right1"===this.hover.type&&""==this.hover.selection?e.attr("fill",t=>t["classifier"]===this.hover.classifier&&t["confidence"]===this.hover.interval?this.rightHoverColor:this.rightColor):"overall"==this.selection_mode&&e.attr("fill",this.rightColor),"wrong1"===this.hover.type&&""==this.hover.selection?s.attr("fill",t=>t["classifier"]===this.hover.classifier&&t["confidence"]===this.hover.interval?this.wrongHoverColor:this.wrongColor):"overall"==this.selection_mode&&s.attr("fill",this.wrongColor),"middle1"===this.hover.type&&""==this.hover.selection?r.attr("fill",t=>t["classifier"]===this.hover.classifier&&t["confidence"]===this.hover.interval?"grey":"lightgrey"):"overall"==this.selection_mode&&r.attr("fill","lightgrey"),"right2"===this.hover.type&&""==this.hover.selection?i.attr("fill",t=>t["classifier"]===this.hover.classifier&&t["confidence"]===this.hover.interval?this.rightHoverColor1:this.rightColor1):"overall"==this.selection_mode&&i.attr("fill",this.rightColor1),"wrong2"===this.hover.type&&""==this.hover.selection?a.attr("fill",t=>t["classifier"]===this.hover.classifier&&t["confidence"]===this.hover.interval?this.wrongHoverColor1:this.wrongColor1):"overall"==this.selection_mode&&a.attr("fill",this.wrongColor1),"middle2"===this.hover.type&&""==this.hover.selection?n.attr("fill",t=>t["classifier"]===this.hover.classifier&&t["confidence"]===this.hover.interval?"grey":"lightgrey"):"overall"==this.selection_mode&&n.attr("fill","lightgrey");const k=500,S=1e3;this.hover.type?(o.transition().duration(k).attr("transform","translate("+(C(this.hover.classifier)-120)+",0)").attr("opacity",1),"right1"==this.hover.type||"wrong1"==this.hover.type||"middle1"==this.hover.type?(l.transition().duration(k).attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)-80)+",-60)").text("Yes"==this.normalization?"tp (%)":"tp: "+this.predictions[this.hover.classifier]["ci_tp_instances"][this.hover.interval].instances.size),h.transition().duration(k).attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)-80)+",-40)").text("Yes"==this.normalization?"mp (%)":"mp:"+this.predictions[this.hover.classifier]["ci_mp_instances"][this.hover.interval].instances.size),c.transition().duration(k).attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)-80)+",-20)").text("Yes"==this.normalization?"fp (%)":"fp:"+this.predictions[this.hover.classifier]["ci_fp_instances"][this.hover.interval].instances.size),v&&(d.transition().duration(k).attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+(C(this.hover.classifier)-10)+",-60)").text("1st: "+_(this.hover.classifier,this.hover.interval,v.instances,1)),p.transition().duration(k).attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+(C(this.hover.classifier)-10)+",-40)").text("1st: "+b(this.hover.classifier,this.hover.interval,v.instances,1)),u.transition().duration(k).attr("fill","steelblue").attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)-10)+",-20)").text("1st: "+x(this.hover.classifier,this.hover.interval,v.instances,1))),y&&(f.transition().duration(k).attr("fill-opacity",1).attr("fill",this.selection2Color).attr("transform","translate("+(C(this.hover.classifier)+60)+",-60)").text("2nd: "+_(this.hover.classifier,this.hover.interval,y.instances,1)),g.transition().duration(k).attr("fill-opacity",1).attr("fill",this.selection2Color).attr("transform","translate("+(C(this.hover.classifier)+60)+",-40)").text("2nd: "+b(this.hover.classifier,this.hover.interval,y.instances,1)),m.transition().duration(k).attr("fill",this.selection2Color).attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)+60)+",-20)").text("2nd: "+x(this.hover.classifier,this.hover.interval,y.instances,1)))):(l.transition().duration(k).attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)-80)+",-60)").text("Yes"==this.normalization?"tn (%)":"tn: "+this.predictions[this.hover.classifier]["ci_tn_instances"][this.hover.interval].instances.size),h.transition().duration(k).attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)-80)+",-40)").text("Yes"==this.normalization?"mn (%)":"mn: "+this.predictions[this.hover.classifier]["ci_mn_instances"][this.hover.interval].instances.size),c.transition().duration(k).attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)-80)+",-20)").text("Yes"==this.normalization?"fn (%)":"fn: "+this.predictions[this.hover.classifier]["ci_fn_instances"][this.hover.interval].instances.size),v&&(d.transition().duration(k).attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+(C(this.hover.classifier)-10)+",-60)").text("1st: "+_(this.hover.classifier,this.hover.interval,v.instances,2)),p.transition().duration(k).attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+(C(this.hover.classifier)-10)+",-40)").text("1st: "+b(this.hover.classifier,this.hover.interval,v.instances,2)),u.transition().duration(k).attr("fill","steelblue").attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)-10)+",-20)").text("1st: "+x(this.hover.classifier,this.hover.interval,v.instances,2))),y&&(f.transition().duration(k).attr("fill-opacity",1).attr("fill",this.selection2Color).attr("transform","translate("+(C(this.hover.classifier)+60)+",-60)").text("2nd: "+_(this.hover.classifier,this.hover.interval,y.instances,2)),g.transition().duration(k).attr("fill-opacity",1).attr("fill",this.selection2Color).attr("transform","translate("+(C(this.hover.classifier)+60)+",-40)").text("2nd: "+b(this.hover.classifier,this.hover.interval,y.instances,2)),m.transition().duration(k).attr("fill",this.selection2Color).attr("fill-opacity",1).attr("transform","translate("+(C(this.hover.classifier)+60)+",-20)").text("2nd: "+x(this.hover.classifier,this.hover.interval,y.instances,2))))):(l.transition().duration(S).attr("fill-opacity",0),h.transition().duration(S).attr("fill-opacity",0),c.transition().duration(S).attr("fill-opacity",0),d.transition().duration(S).attr("fill-opacity",0),p.transition().duration(S).attr("fill-opacity",0),u.transition().duration(S).attr("fill-opacity",0),f.transition().duration(S).attr("fill-opacity",0),g.transition().duration(S).attr("fill-opacity",0),m.transition().duration(S).attr("fill-opacity",0),o.transition().duration(S).attr("opacity",0))},drawDistributionHover(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-original"),s=t.select(".y-axis-marker-rect-dist"),i=t.select(".y-axis-marker-text-pred"),a=t.select(".y-axis-marker-text-pred-s1"),r=t.select(".y-axis-marker-text-pred-s2"),n=t.select(".y-axis-marker-line-dist"),o=500,l=1e3,{first:c,second:h}=this.selections,d=(t,e,s,i)=>{const a=new Set([...this.predictions[t]["ci_tp_instances"][e].instances,...this.predictions[t]["ci_fn_instances"][e].instances,...this.predictions[t]["ci_tn_instances"][e].instances,...this.predictions[t]["ci_fp_instances"][e].instances,...this.predictions[t]["ci_mn_instances"][e].instances,...this.predictions[t]["ci_mp_instances"][e].instances]);this.instances.length;const r=Lt(a,s),n=r.size;return n};let u=[];this.classifiers.forEach(t=>{u.push(t)}),this.addedThresholdClassifiers.forEach(t=>{u.push(t)});const p=it["A"]().range([0,this.width]).padding(.5).domain(u);var f="0";for(let m in this.confidence)if(this.confidence[m]==this.hover_distribution.interval){f=m;break}"dist"===this.hover_distribution.type?e.attr("fill",t=>t["classifier"]===this.hover_distribution.classifier&&t["confidence"]===this.hover_distribution.interval?this.rightHoverColor:this.rightColor):e.attr("fill",this.rightColor),this.hover_distribution.type?(s.transition().duration(o).attr("transform","translate("+(p(this.hover_distribution.classifier)-60)+",0)").attr("opacity",1),n.transition().duration(o).attr("stroke-opacity",1).attr("transform","translate("+p(this.hover_distribution.classifier)+",0)").attr("x1",this.x(this.predictions[this.hover_distribution.classifier]["ci_pred"][f])).attr("y1",-20).attr("y2",1.2*this.height).attr("x2",this.x(this.predictions[this.hover_distribution.classifier]["ci_pred"][f])),i.transition().duration(o).attr("fill-opacity",1).attr("transform","translate("+p(this.hover_distribution.classifier)+",-55)").text("pred:"+this.predictions[this.hover_distribution.classifier]["ci_pred"][f]),c&&a.transition().duration(o).attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+p(this.hover_distribution.classifier)+",-40)").text("1st: "+d(this.hover_distribution.classifier,this.hover_distribution.interval,c.instances,1)),h&&r.transition().duration(o).attr("fill-opacity",1).attr("fill",this.selection2Color).attr("transform","translate("+p(this.hover_distribution.classifier)+",-25)").text("2nd: "+d(this.hover_distribution.classifier,this.hover_distribution.interval,h.instances,1))):(n.transition().duration(l).attr("stroke-opacity",0),i.transition().duration(l).attr("fill-opacity",0),a.transition().duration(l).attr("fill-opacity",0),r.transition().duration(l).attr("fill-opacity",0),s.transition().duration(l).attr("opacity",0))},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("class","svg-all").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+2*this.margin.bottom}`),e=(t.append("g").attr("class","svg-confidence").attr("transform",`translate(${this.margin.left/4}, ${1.5*this.margin.bottom})`),t.append("g").attr("transform",`translate(${this.margin.left/4}, ${1.5*this.margin.bottom})`)),s=this.addedBandWidthClassifiers.map(t=>t.name),i=this.x,a=this.y,r=this.height;this.width,s.length;var n=it["A"]().range([0,this.width]).padding(.5).domain(s);const o=()=>{let t=this.yScale,i=this.classifierBandWidthDict;Math.sqrt(3);const r=e.append("g").selectAll("g").data(s).enter().append("g").attr("transform",(function(t){return"translate("+n(t)+")"}));r.append("line").attr("class",t=>"slider-line-"+t).style("stroke","#777").style("stroke-opacity","1").style("stroke-width","4").attr("x1",0).attr("x2",0).attr("y1",e=>t(i[e].left_range)).attr("y2",e=>t(i[e].right_range)),r.append("circle").style("fill","red").attr("r",a.bandwidth()/6).style("stroke","none").attr("class",t=>"slider-circle-time-from"+t).attr("transform",e=>"translate(0,"+t(i[e].left_range)+")rotate(30)").attr("id",t=>"slider-circle-time-to-left_"+t),r.append("circle").style("fill","green").attr("r",a.bandwidth()/6).style("stroke","none").attr("class",t=>"slider-circle-time-to"+t).attr("transform",e=>"translate(0,"+t(i[e].right_range)+")rotate(30)").attr("id",t=>"slider-circle-time-to-right_"+t),r.append("circle").attr("class","x-axis-marker-line").attr("transform",e=>"translate(0,"+t(i[e].threshold)+")rotate(30)").attr("r",a.bandwidth()/4).attr("fill","drakblue").attr("stroke-opacity",1)},l=()=>{e.selectAll("myText").data(s).enter().append("text").style("text-anchor","middle").attr("transform","rotate(30)").attr("transform",(function(t){return"translate("+(n(t)+10)+","+(r+40)+") rotate(20)"})).text(t=>t).style("fill","black").style("font-size",20)},c=()=>{const t=this.width/8,s=this.margin.top/1.5,i=e.append("g").attr("class","legend").attr("transform","selected"==this.selection_mode?`translate(\n              ${this.width-t},\n              ${4*-s})`:`translate(\n              ${this.width-t},\n              ${6*-s})`);"selected"==this.selection_mode?(i.append("rect").attr("width",t).attr("height",s).attr("fill",this.selection1Color).attr("stroke","black"),i.append("rect").attr("x",t).attr("width",t).attr("height",s).attr("fill",this.selection1Color).attr("stroke","black"),i.append("rect").attr("y",s).attr("width",t).attr("height",s).attr("fill",this.selection2Color).attr("stroke","black"),i.append("rect").attr("y",s).attr("x",t).attr("width",t).attr("height",s).attr("fill",this.selection2Color).attr("stroke","black"),i.append("text").attr("transform",`translate(${t/2}, ${s/2})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("incorrect s1"),i.append("text").attr("transform",`translate(${t/2*3}, ${s/2})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("correct s1"),i.append("text").attr("transform",`translate(${t/2}, ${s/2*3})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("incorrect s2"),i.append("text").attr("transform",`translate(${t/2*3}, ${s/2*3})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("correct s2")):(i.append("rect").attr("width",t).attr("height",s).attr("fill",this.wrongColor),i.append("rect").attr("y",s).attr("width",t).attr("height",s).attr("fill",this.rightColor),i.append("rect").attr("y",2*s).attr("width",t).attr("height",s).attr("fill","lightgrey"),i.append("rect").attr("y",3*s).attr("width",t).attr("height",s).attr("fill",this.wrongColor1),i.append("rect").attr("y",4*s).attr("width",t).attr("height",s).attr("fill",this.rightColor1),i.append("text").attr("transform",`translate(${t/2}, ${s/2})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("fp"),i.append("text").attr("transform",`translate(${t/2}, ${3*s/2})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("tp"),i.append("text").attr("transform",`translate(${t/2}, ${2.5*s})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("uncertain"),i.append("text").attr("transform",`translate(${t/2}, ${3.5*s})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("fn"),i.append("text").attr("transform",`translate(${t/2}, ${4.5*s})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("tn"))},h=()=>{e.append("line").attr("class","y-axis-marker-line1").attr("x1",i(0)).attr("y1",0).attr("x2",i(0)).attr("y2",1.2*this.height).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none"),e.append("line").attr("class","y-axis-marker-line2").attr("x1",i(0)).attr("y1",0).attr("x2",i(0)).attr("y2",1.2*this.height).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none"),e.append("line").attr("class","y-axis-marker-line1-2").attr("x1",i(0)).attr("y1",0).attr("x2",i(0)).attr("y2",1.2*this.height).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none"),e.append("line").attr("class","y-axis-marker-line2-2").attr("x1",i(0)).attr("y1",0).attr("x2",i(0)).attr("y2",1.2*this.height).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none")},d=()=>{e.append("rect").attr("class","y-axis-marker-rect").attr("width",240).attr("height",60).attr("fill","white").attr("stroke","grey").attr("y",-60).attr("opacity",0),e.append("text").attr("class","y-axis-marker-text-right1").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.rightHoverColor).attr("pointer-events","hanging"),e.append("text").attr("class","y-axis-marker-text-right1-s1").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.rightHoverColor).attr("pointer-events","hanging"),e.append("text").attr("class","y-axis-marker-text-right1-s2").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.rightHoverColor).attr("pointer-events","hanging"),e.append("text").attr("class","y-axis-marker-text-wrong1").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.wrongHoverColor).attr("pointer-events","hanging"),e.append("text").attr("class","y-axis-marker-text-wrong1-s1").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.wrongHoverColor).attr("pointer-events","hanging"),e.append("text").attr("class","y-axis-marker-text-wrong1-s2").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.wrongHoverColor).attr("pointer-events","hanging"),e.append("text").attr("class","y-axis-marker-text-middle1").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","grey").attr("pointer-events","hanging"),e.append("text").attr("class","y-axis-marker-text-middle1-s1").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","grey").attr("pointer-events","hanging"),e.append("text").attr("class","y-axis-marker-text-middle1-s2").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","grey").attr("pointer-events","hanging")};o(),l(),c(),h(),d(),this.drawConfidence(),"overall"==this.selection_mode&&this.drawHover()},drawConfidence(){const t=it["C"](this.$refs.svg),e=t.select(".svg-confidence"),s=this.normalization;e.selectAll("*").remove();const i=this.x,a=this.y,r=this.maxIntervals,n=this.predictions,o=this.selections,{first:l,second:c}=this.selections,h=this.confidence,d=this.addedBandWidthClassifiers.map(t=>t.name);var u=it["A"]().range([0,this.width]).padding(.5).domain(d);this.width,this.height;let p=y(),f={},m=[];if(d.forEach((t,e)=>{f[t]=p[e].data}),"selected"==this.selection_mode&&Object.keys(this.selections).length>0){if(p=[],l){const t=_("1");p.push(t);let e={};d.forEach((s,i)=>{e[s]=t[i]["data"]}),m.push(e)}if(c){const t=_("2");p.push(t);let e={};d.forEach((s,i)=>{e[s]=t[i]["data"]}),m.push(e)}}const g=()=>{var t={};for(var s in d){var r=d[s];t[r]=it["x"]().range([this.height,0]).domain(this.confidence)}const n=e.append("g").selectAll("g").data(d).enter().append("g").attr("transform",(function(t){return"translate("+u(t)+",0)"})).selectAll("rect").data((function(t){return f[t]})).enter();e.selectAll("myAxis").data(d).enter().append("g").style("font","28px times").style("text-anchor","end").style("dominant-baseline","ideographic").attr("transform",(function(t){return"translate("+u(t)+")"})).each((function(e){it["C"](this).call(it["c"](t[e]).scale(t[e]))}));const o=["right","middle","wrong"],l=["tp_interval","mp_interval","fp_interval"],c=["tn_interval","mn_interval","fn_interval"],h=[this.rightColor,"lightgrey",this.wrongColor];o.forEach((t,e)=>{n.append("rect").attr("class","bar-"+t+"1").attr("transform",t=>{let s=0,a=0;while(s<e)a+=t[l[s]],s+=1;return"translate("+i(a)+",0)"}).attr("width",(function(t){return i(t[l[e]])})).attr("y",(function(t){return a(t["confidence"])})).attr("height",(function(t){return a.bandwidth()})).attr("fill",h[e]).on("mouseenter",e=>this.hover={type:t+"1",classifier:e["classifier"],interval:e["confidence"].toString()}).on("mouseleave",this.clearHover).on("click",e=>this.select(e["classifier"],t,"first",e["confidence"].toString())).on("contextmenu",e=>this.select(e["classifier"],t,"second",e["confidence"].toString())),n.append("circle").attr("r",a.bandwidth()/6).attr("class","bar-"+t+"1-circle").attr("transform",t=>{let s=0,r=0;while(s<e)r+=t[l[s]],s+=1;let n=-a.bandwidth()/3+e*(a.bandwidth()/3);return"translate("+i(r)+","+n+")"}).attr("cx",a.bandwidth()/6).attr("cy",(function(t){return a(t["confidence"])+a.bandwidth()/2})).attr("visibility",t=>i(t[l[e]])<a.bandwidth()/6&&t[l[e]]>0?"visible":"hidden").attr("fill",h[e]).on("mouseenter",e=>this.hover={type:t+"1",classifier:e["classifier"],interval:e["confidence"].toString()}).on("mouseleave",this.clearHover).on("click",e=>this.select(e["classifier"],t,"first",e["confidence"].toString())).on("contextmenu",e=>this.select(e["classifier"],t,"second",e["confidence"].toString())),n.append("rect").attr("class","bar-"+t+"2").attr("transform",(function(t){let s=0,a=0;while(s<3)a+=t[l[s]],s+=1;s=0;while(s<e)a+=t[c[s]],s+=1;return"translate("+i(a)+",0)"})).attr("width",(function(t){return i(t[c[e]])})).attr("y",(function(t){return a(t["confidence"])})).attr("height",(function(t){return a.bandwidth()})).attr("fill",h[e]).on("mouseenter",e=>this.hover={type:t+"2",classifier:e["classifier"],interval:e["confidence"].toString()}).on("mouseleave",this.clearHover).on("click",e=>this.select(e["classifier"],t+"2","first",e["confidence"].toString())).on("contextmenu",e=>this.select(e["classifier"],t+"2","second",e["confidence"].toString())),n.append("circle").attr("r",a.bandwidth()/6).attr("class","bar-"+t+"2-circle").attr("transform",(function(t){let s=0,r=0;while(s<3)r+=t[l[s]],s+=1;s=0;while(s<e)r+=t[c[s]],s+=1;let n=-a.bandwidth()/3+e*(a.bandwidth()/3);return"translate("+i(r)+","+n+")"})).attr("cx",a.bandwidth()/6).attr("cy",(function(t){return a(t["confidence"])+a.bandwidth()/2})).attr("visibility",t=>i(t[c[e]])<a.bandwidth()/6&&t[c[e]]>0?"visible":"hidden").attr("fill",h[e]).on("mouseenter",e=>this.hover={type:t+"2",classifier:e["classifier"],interval:e["confidence"].toString()}).on("mouseleave",this.clearHover).on("click",e=>this.select(e["classifier"],t+"2","first",e["confidence"].toString())).on("contextmenu",e=>this.select(e["classifier"],t+"2","second",e["confidence"].toString()))});const p=()=>{const t=a.bandwidth()/4,e=["-selection-1","-selection-2"],s=[this.selection1Color,this.selection2Color];o.forEach((r,o)=>{e.forEach((e,h)=>{n.append("rect").attr("class","bar-"+r+e).attr("transform",t=>{let e=0,s=0;while(e<o)s+=t[l[e]],e+=1;return"translate("+i(s)+",0)"}).attr("y",(function(e){return a(e["confidence"])+.5*a.bandwidth()-t*(1-h)})).attr("height",t).attr("fill",s[h]).attr("stroke","black").attr("stroke-width","1px").attr("pointer-events","none"),n.append("circle").attr("class","circle-"+r+e).attr("transform",t=>{let e=0,s=0;while(e<o)s+=t[l[e]],e+=1;return"translate("+i(s)+",0)"}).attr("cy",(function(e){return a(e["confidence"])+.5*a.bandwidth()-t*(1-h)+t/2})).attr("cx",t/2).attr("r",t/2).attr("fill",s[h]).attr("visibility","hidden"),n.append("rect").attr("class","bar-"+r+"2"+e).attr("transform",(function(t){let e=0,s=0;while(e<3)s+=t[l[e]],e+=1;e=0;while(e<o)s+=t[c[e]],e+=1;return"translate("+i(s)+",0)"})).attr("y",e=>a(e["confidence"])+.5*a.bandwidth()-t*(1-h)).attr("height",t).attr("fill",s[h]).attr("stroke","black").attr("stroke-width","1px").attr("pointer-events","none"),n.append("circle").attr("class","circle-"+r+"2"+e).attr("transform",(function(t){let e=0,s=0;while(e<3)s+=t[l[e]],e+=1;e=0;while(e<o)s+=t[c[e]],e+=1;return"translate("+i(s)+",0)"})).attr("cy",(function(e){return a(e["confidence"])+.5*a.bandwidth()-t*(1-h)+t/2})).attr("cx",t/2).attr("r",t/2).attr("fill",s[h]).attr("visibility","hidden")})})};p()},v=()=>{var t={};for(var s in d){var r=d[s];t[r]=it["x"]().range([this.height,0]).domain(this.confidence)}m.forEach(s=>{const r=e.append("g").selectAll("g").data(d).enter().append("g").attr("transform",(function(t){return"translate("+u(t)+",0)"})).selectAll("rect").data((function(t){return s[t]})).enter();r.append("rect").attr("class","bar-right1").attr("width",(function(t){return i(t["tp_interval"])})).attr("y",(function(t){return"1"==t["type"]?a(t["confidence"])+a.bandwidth()/3:a(t["confidence"])+a.bandwidth()/1.5})).attr("height",(function(t){return a.bandwidth()/3})).attr("fill",t=>"1"==t["type"]?this.selection1Color:this.selection2Color).attr("stroke","black").on("mouseenter",t=>this.hover={type:"right1",selection:t["type"],classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("rect").attr("class","bar-middle1").attr("transform",(function(t){return"translate("+i(t["tp_interval"])+",0)"})).attr("width",(function(t){return i(t["mp_interval"])})).attr("y",(function(t){return"1"==t["type"]?a(t["confidence"])+a.bandwidth()/3:a(t["confidence"])+a.bandwidth()/1.5})).attr("height",(function(t){return a.bandwidth()/3})).attr("fill",t=>"1"==t["type"]?this.selection1Color:this.selection2Color).attr("stroke","black").on("mouseenter",t=>this.hover={type:"middle1",selection:t["type"],classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("rect").attr("class","bar-wrong1").attr("id",t=>"bar-wrong1-"+t["classifier"]+"-"+t["confidence"]).attr("transform",(function(t){return"translate("+i(t["tp_interval"]+t["mp_interval"])+",0)"})).attr("width",(function(t){return i(t["tn_interval"])})).attr("y",(function(t){return"1"==t["type"]?a(t["confidence"])+a.bandwidth()/3:a(t["confidence"])+a.bandwidth()/1.5})).attr("height",(function(t){return a.bandwidth()/3})).attr("fill",t=>"1"==t["type"]?this.selection1Color:this.selection2Color).attr("stroke","black").on("mouseenter",t=>this.hover={type:"wrong1",selection:t["type"],classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("rect").attr("class","bar-right2").attr("id",t=>"bar-right2-"+t["classifier"]+"-"+t["confidence"]).attr("transform",(function(t){return"translate("+-i(t["fn_interval"])+",0)"})).attr("width",(function(t){return i(t["fn_interval"])})).attr("y",(function(t){return"1"==t["type"]?a(t["confidence"])+a.bandwidth()/3:a(t["confidence"])+a.bandwidth()/1.5})).attr("height",(function(t){return a.bandwidth()/3})).attr("fill",t=>"1"==t["type"]?this.selection1Color:this.selection2Color).attr("stroke","black").on("mouseenter",t=>this.hover={type:"right2",selection:t["type"],classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("rect").attr("class","bar-middle2").attr("transform",(function(t){return"translate("+(-i(t["fn_interval"])-i(t["mn_interval"]))+",0)"})).attr("width",(function(t){return i(t["mn_interval"])})).attr("y",(function(t){return"1"==t["type"]?a(t["confidence"])+a.bandwidth()/3:a(t["confidence"])+a.bandwidth()/1.5})).attr("height",(function(t){return a.bandwidth()/3})).attr("fill",t=>"1"==t["type"]?this.selection1Color:this.selection2Color).attr("stroke","black").on("mouseenter",t=>this.hover={type:"middle2",selection:t["type"],classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("rect").attr("class","bar-wrong2").attr("id",t=>"bar-wrong2-"+t["classifier"]+"-"+t["confidence"]).attr("transform",(function(t){return"translate("+(-i(t["fn_interval"])-i(t["fp_interval"])-i(t["mn_interval"]))+",0)"})).attr("width",(function(t){return i(t["fp_interval"])})).attr("y",(function(t){return"1"==t["type"]?a(t["confidence"])+a.bandwidth()/3:a(t["confidence"])+a.bandwidth()/1.5})).attr("height",(function(t){return a.bandwidth()/3})).attr("fill",t=>"1"==t["type"]?this.selection1Color:this.selection2Color).attr("stroke","black").on("mouseenter",t=>this.hover={type:"wrong2",selection:t["type"],classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("circle").attr("r",a.bandwidth()/24).attr("class","bar-right1-circle").attr("cx",a.bandwidth()/6).attr("cy",(function(t){return a(t["confidence"])+a.bandwidth()/2})).attr("visibility",t=>i(t["tp_interval"])<a.bandwidth()/6&&i(t["tp_interval"])>0?"visible":"hidden").attr("fill",this.rightColor1).on("mouseenter",t=>this.hover={type:"right1",classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("circle").attr("r",a.bandwidth()/24).attr("class","bar-middle1-circle").attr("transform",(function(t){return"translate("+i(t["tp_interval"])+",0)"})).attr("cx",a.bandwidth()/6).attr("cy",(function(t){return a(t["confidence"])+a.bandwidth()/2})).attr("visibility",t=>i(t["mp_interval"])<a.bandwidth()/6&&i(t["mp_interval"])>0?"visible":"hidden").attr("fill","lightgrey").on("mouseenter",t=>this.hover={type:"middle1",classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("circle").attr("r",a.bandwidth()/24).attr("class","bar-wrong1-circle").attr("transform",(function(t){return"translate("+i(t["tp_interval"]+t["mp_interval"])+",0)"})).attr("cx",a.bandwidth()/6).attr("cy",(function(t){return a(t["confidence"])+a.bandwidth()/2})).attr("visibility",t=>i(t["tn_interval"])<a.bandwidth()/6&&i(t["tn_interval"])>0?"visible":"hidden").attr("fill",this.wrongColor).on("mouseenter",t=>this.hover={type:"wrong1",classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("circle").attr("r",a.bandwidth()/24).attr("class","bar-right2-circle").attr("cx",-a.bandwidth()/24).attr("cy",(function(t){return a(t["confidence"])+a.bandwidth()/2})).attr("visibility",t=>i(t["fn_interval"])<a.bandwidth()/6&&i(t["fn_interval"])>0?"visible":"hidden").attr("fill",this.rightColor1).on("mouseenter",t=>this.hover={type:"right2",classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("circle").attr("r",a.bandwidth()/24).attr("class","bar-middle2-circle").attr("transform",(function(t){return"translate("+(-i(t["fn_interval"])-i(t["mn_interval"]))+",0)"})).attr("cx",-a.bandwidth()/24).attr("cy",(function(t){return a(t["confidence"])+a.bandwidth()/2})).attr("visibility",t=>i(t["mn_interval"])<a.bandwidth()/6&&i(t["mn_interval"])>0?"visible":"hidden").attr("fill","lightgrey").on("mouseenter",t=>this.hover={type:"middle2",classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),r.append("circle").attr("r",a.bandwidth()/24).attr("class","bar-wrong2-circle").attr("transform",(function(t){return"translate("+(-i(t["fn_interval"])-i(t["fp_interval"])-i(t["mn_interval"]))+",0)"})).attr("cx",-a.bandwidth()/24).attr("cy",(function(t){return a(t["confidence"])+a.bandwidth()/2})).attr("visibility",t=>i(t["fp_interval"])<a.bandwidth()/6&&i(t["fp_interval"])>0?"visible":"hidden").attr("fill",this.wrongColor1).on("mouseenter",t=>this.hover={type:"wrong2",classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover),e.selectAll("myAxis").data(d).enter().append("g").style("font","28px times").style("text-anchor","end").style("dominant-baseline","ideographic").attr("transform",(function(t){return"translate("+u(t)+")"})).each((function(e){it["C"](this).call(it["c"](t[e]).scale(t[e]))}))})};function y(){let t=[],e={};return d.forEach(i=>{let a=n[i].ci_tp,o=n[i].ci_tn,l=n[i].ci_fp,c=n[i].ci_fn,d=n[i].ci_mp,u=n[i].ci_mn,p=[];if("Yes"==s)for(var f in h){let t=(a[f]+l[f]+d[f]+o[f]+c[f]+u[f])/1.5,e=(o[f]+c[f]+u[f]+a[f]+l[f]+d[f])/1.5;p.push({classifier:i,confidence:h[f],tp_interval:0==t?0:a[f]*r/t,fp_interval:0==t?0:l[f]*r/t,tn_interval:0==e?0:o[f]*r/e,fn_interval:0==e?0:c[f]*r/e,mp_interval:0==t?0:d[f]*r/t,mn_interval:0==e?0:u[f]*r/e,threshold:n[i].threshold})}else for(var f in h)p.push({classifier:i,confidence:h[f],tp_interval:a[f],tn_interval:o[f],fp_interval:l[f],fn_interval:c[f],mp_interval:d[f],mn_interval:u[f],threshold:n[i].threshold});t.push({name:i,data:p,threshold:n[i].threshold}),e[i]=p}),t}function _(t){const{first:e,second:s}=o,i="1"==t?e.instances:s.instances;let a=[],l=0;return d.forEach(t=>{h.forEach(e=>{let s=Lt(n[t]["ci_tp_instances"][e].instances,i),a=Lt(n[t]["ci_tn_instances"][e].instances,i),r=Lt(n[t]["ci_fp_instances"][e].instances,i),o=Lt(n[t]["ci_fn_instances"][e].instances,i),c=Lt(n[t]["ci_mp_instances"][e].instances,i),h=Lt(n[t]["ci_mn_instances"][e].instances,i);l=it["t"]([s.size,a.size,r.size,o.size,c.size,h.size])>l?it["t"]([s.size,a.size,r.size,o.size,c.size,h.size]):l})}),d.forEach(e=>{let s=[];h.forEach(a=>{let o=Lt(n[e]["ci_tp_instances"][a].instances,i),c=Lt(n[e]["ci_tn_instances"][a].instances,i),h=Lt(n[e]["ci_fp_instances"][a].instances,i),d=Lt(n[e]["ci_fn_instances"][a].instances,i),u=Lt(n[e]["ci_mp_instances"][a].instances,i),p=Lt(n[e]["ci_mn_instances"][a].instances,i);s.push({classifier:e,confidence:a,type:t,tp_interval:o.size*r/l,tn_interval:c.size*r/l,fp_interval:h.size*r/l,fn_interval:d.size*r/l,mp_interval:u.size*r/l,mn_interval:p.size*r/l,threshold:n[e].threshold})}),a.push({name:e,data:s,threshold:n[e].threshold})}),a}"overall"==this.selection_mode?(g(),this.drawSelections()):v()},drawDistributionLine(){const t=it["C"](this.$refs.svg),e=t.select(".svg-confidence");e.selectAll("*").remove();const s=this.x,i=(this.y,this.addedBandWidthClassifiers.map(t=>t.name));var a=it["A"]().range([0,this.width]).padding(.5).domain(i);const r=it["x"]().domain(this.confidence).range([this.height,0]),n=()=>{var t={};for(var s in i){var r=i[s];t[r]=it["x"]().range([this.height,0]).domain(this.confidence)}e.selectAll("myAxis").data(i).enter().append("g").style("font","20px times").style("text-anchor","end").style("dominant-baseline","ideographic").attr("transform",(function(t){return"translate("+a(t)+")"})).each((function(e){it["C"](this).call(it["c"](t[e]).scale(t[e]))}))},o=()=>{let t=this.confidence,n=this.predictions;function o(e){return it["s"]()(t.map((function(t,i){return[3+a(e)+s(n[e]["ci_tp"][i]+n[e]["ci_tn"][i]),r.bandwidth()/2+r(t)]})))}i.forEach(t=>{e.append("path").attr("class","line-threshold").attr("d",o(t)).style("fill","none").attr("stroke","steelblue").style("stroke-width",3).style("opacity",1)})},l=()=>{e.append("g").attr("class","legend").attr("transform",`translate(\n              ${this.width},\n              ${4*this.height})`);e.append("rect").attr("transform",`translate(${this.width-60}, ${2*-this.margin.top})`).attr("width",120).attr("height",2).attr("fill","steelblue"),e.append("text").attr("transform",`translate(${this.width-120}, ${2*-this.margin.top})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("correctness")};n(),o(),l()},drawOriginalDistribution(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("class","svg-all").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+2*this.margin.top+this.margin.bottom}`).append("g").attr("class","svg-confidence").attr("transform",`translate(${this.margin.left/4}, ${this.margin.bottom})`),e=this.x,s=this.y,i=this.classifiers,a=it["A"]().range([0,this.width]).padding(.5).domain(this.classifiers);var r={};for(var n in i){var o=i[n];r[o]=it["x"]().range([this.height,0]).domain(this.confidence)}this.width;const l=this.height,c=this.maxIntervals;let h=[],d={};this.classifiers.forEach(t=>{let e=this.predictions[t].ci_pred,s=[];for(var i in this.confidence)"Yes"==this.normalization?s.push({classifier:t,confidence:this.confidence[i],pred_interval:0==e[i]?0:c,threshold:this.predictions[t].threshold}):s.push({classifier:t,confidence:this.confidence[i],pred_interval:e[i],threshold:this.predictions[t].threshold});h.push({name:t,data:s,threshold:this.predictions[t].threshold}),d[t]=s});const u=t.append("g").selectAll("g").data(i).enter().append("g").attr("transform",(function(t){return"translate("+a(t)+",0)"})).selectAll("rect").data(t=>d[t]).enter(),p=()=>{t.selectAll("myAxis").data(i).enter().append("g").style("font","28px times").style("text-anchor","end").style("dominant-baseline","ideographic").attr("transform",(function(t){return"translate("+a(t)+")"})).each((function(t){it["C"](this).call(it["c"](r[t]).scale(r[t]))}))},f=()=>{let e=this.classifiers;t.selectAll("myText").data(e).enter().append("text").style("text-anchor","middle").attr("transform",(function(t){return"translate("+a(t)+","+(l+25)+")"})).text(t=>t).style("fill","black").style("font-size","30px")},m=()=>{const e=this.width/8,s=this.margin.top/1.5,i=t.append("g").attr("class","legend").attr("transform",`translate(\n              ${this.width},\n              ${4*-s})`);i.append("rect").attr("width",e).attr("height",2*s).attr("fill",this.rightColor),i.append("text").attr("transform",`translate(${e/2}, ${s})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("prediction")},g=()=>{u.append("rect").attr("class","bar-original").attr("width",(function(t){return e(t["pred_interval"])})).attr("y",(function(t){return s(t["confidence"])})).attr("height",(function(t){return s.bandwidth()})).attr("fill",this.rightColor).on("mouseenter",t=>this.hover_distribution={type:"dist",classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearDistributionHover).on("click",t=>this.select(t["classifier"],"dist","first",t["confidence"].toString())).on("contextmenu",t=>this.select(t["classifier"],"dist","second",t["confidence"].toString())),u.append("circle").attr("class","circle-original").attr("cy",(function(t){return s(t["confidence"])+s.bandwidth()/2})).attr("cx",s.bandwidth()/6).attr("r",s.bandwidth()/6).style("fill",this.rightColor).attr("visibility",(function(t){return e(t["pred_interval"])<s.bandwidth()/3&&t["pred_interval"]>0?"visible":"hidden"}));const t=()=>{const t=s.bandwidth()/4,e=[this.selection1Color,this.selection2Color];e.forEach((e,i)=>{u.append("rect").attr("class","bar-original-selection-"+(i+1)).attr("y",(function(e){return s(e["confidence"])+.5*s.bandwidth()-t+t*i})).attr("height",t).attr("fill",e).attr("stroke","black").attr("stroke-width","1px").attr("pointer-events","none"),u.append("circle").attr("class","circle-pred-selection-"+(i+1)).attr("cy",(function(e){return s(e["confidence"])+.5*s.bandwidth()-t/2+t*i})).attr("cx",t/2).attr("r",t/2).style("fill",e).attr("visibility","hidden")})};t()},v=()=>{t.append("line").attr("class","y-axis-marker-line-dist").attr("x1",e(0)).attr("y1",0).attr("x2",e(0)).attr("y2",1.2*this.height).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none")},y=()=>{t.append("rect").attr("class","y-axis-marker-rect-dist").attr("width",120).attr("height",60).attr("fill","white").attr("stroke","grey").attr("y",-60).attr("opacity",0),t.append("text").attr("class","y-axis-marker-text-pred").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.rightHoverColor).attr("pointer-events","hanging"),t.append("text").attr("class","y-axis-marker-text-pred-s1").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","hanging"),t.append("text").attr("class","y-axis-marker-text-pred-s2").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","red").attr("pointer-events","hanging")};m(),f(),p(),g(),v(),y(),this.drawDistSelections(),this.drawDistributionHover()},drawDistSelections(){const t=it["C"](this.$refs.svg),e=this.y,s=e.bandwidth()/4,i=t.selectAll(".bar-original-selection-1"),a=t.selectAll(".bar-original-selection-2"),r=t.selectAll(".circle-pred-selection-1"),n=t.selectAll(".circle-pred-selection-2"),o=t.selectAll(".y-axis-marker-text-pred-s1"),l=t.selectAll(".y-axis-marker-text-pred-s2"),c=(it["j"](".1f"),this.maxIntervals),h=this.normalization,{first:d,second:u}=(this.x,this.selections),p=(t,e,s,i)=>{const a=new Set([...this.predictions[t]["ci_tp_instances"][e].instances,...this.predictions[t]["ci_fn_instances"][e].instances,...this.predictions[t]["ci_tn_instances"][e].instances,...this.predictions[t]["ci_fp_instances"][e].instances,...this.predictions[t]["ci_mn_instances"][e].instances,...this.predictions[t]["ci_mp_instances"][e].instances]);this.instances.length;const r=Lt(a,s),n="Yes"!=h?r.size:0==a.size?0:r.size*c/a.size;return this.x(n)},f=(t,e,s,i)=>{const a=new Set([...this.predictions[t]["ci_tp_instances"][e].instances,...this.predictions[t]["ci_fn_instances"][e].instances,...this.predictions[t]["ci_tn_instances"][e].instances,...this.predictions[t]["ci_fp_instances"][e].instances,...this.predictions[t]["ci_mn_instances"][e].instances,...this.predictions[t]["ci_mp_instances"][e].instances]);this.instances.length;const r=Lt(a,s),n="Yes"!=h?r.size:0==a.size?0:r.size*c/a.size;return n};var m=it["A"]().range([0,this.width]).padding(.5).domain(this.classifiers);d?(this.hover_distribution.type&&o.attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+m(this.hover_distribution.classifier)+",-40)").text("1st: "+f(this.hover_distribution.classifier,this.hover_distribution.interval,d.instances,1)),i.attr("width",t=>p(t["classifier"],t["confidence"],d.instances,1)),r.attr("visibility",t=>p(t["classifier"],t["confidence"],d.instances,1)>2*s||p(t["classifier"],t["confidence"],d.instances,1)<=0?"hidden":"visible")):(i.attr("width","0"),r.attr("visibility","hidden")),u?(this.hover_distribution.type&&l.attr("fill-opacity",1).attr("fill","red").attr("transform","translate("+m(this.hover_distribution.classifier)+",-25)").text("2nd: "+f(this.hover_distribution.classifier,this.hover_distribution.interval,u.instances,1)),a.attr("width",t=>p(t["classifier"],t["confidence"],u.instances,1)),n.attr("visibility",t=>p(t["classifier"],t["confidence"],u.instances,1)>2*s||p(t["classifier"],t["confidence"],u.instances,1)<=0?"hidden":"visible")):(a.attr("width","0"),n.attr("visibility","hidden"))},drawSelections(){const t=it["C"](this.$refs.svg),e=this.y,s=e.bandwidth()/4,i=t.selectAll(".bar-right-selection-1"),a=t.selectAll(".bar-right-selection-2"),r=t.selectAll(".bar-wrong-selection-1"),n=t.selectAll(".bar-wrong-selection-2"),o=t.selectAll(".bar-middle-selection-1"),l=t.selectAll(".bar-middle-selection-2"),c=t.selectAll(".bar-right2-selection-1"),h=t.selectAll(".bar-right2-selection-2"),d=t.selectAll(".bar-wrong2-selection-1"),u=t.selectAll(".bar-wrong2-selection-2"),p=t.selectAll(".bar-middle2-selection-1"),f=t.selectAll(".bar-middle2-selection-2"),m=t.selectAll(".circle-right-selection-1"),g=t.selectAll(".circle-right-selection-2"),v=t.selectAll(".circle-wrong-selection-1"),y=t.selectAll(".circle-wrong-selection-2"),_=t.selectAll(".circle-middle-selection-1"),x=t.selectAll(".circle-middle-selection-2"),b=t.selectAll(".circle-right2-selection-1"),w=t.selectAll(".circle-right2-selection-2"),C=t.selectAll(".circle-wrong2-selection-1"),k=t.selectAll(".circle-wrong2-selection-2"),S=t.selectAll(".circle-middle2-selection-1"),z=t.selectAll(".circle-middle2-selection-2"),$=t.select(".y-axis-marker-text-right1-s1"),F=t.select(".y-axis-marker-text-wrong1-s1"),T=t.select(".y-axis-marker-text-middle1-s1"),E=t.select(".y-axis-marker-text-right1-s2"),I=t.select(".y-axis-marker-text-wrong1-s2"),P=t.select(".y-axis-marker-text-middle1-s2"),{first:D,second:O}=(t.select(".y-axis-marker-rect"),it["j"](".1f"),this.x,this.selections),A=(t,e,s,i)=>{const a=1==i?this.predictions[t]["ci_tp_instances"][e].instances:this.predictions[t]["ci_tn_instances"][e].instances;this.instances.length;const r=Lt(a,s),n=this.predictions[t]["ci_tp_instances"][e].instances.size+this.predictions[t]["ci_fp_instances"][e].instances.size+this.predictions[t]["ci_mp_instances"][e].instances.size+(this.predictions[t]["ci_tn_instances"][e].instances.size+this.predictions[t]["ci_fn_instances"][e].instances.size+this.predictions[t]["ci_mn_instances"][e].instances.size),o="No"==this.normalization?r.size:0==a.size?0:r.size*this.maxIntervals/(n/1.5);return this.x(o)},B=(t,e,s,i)=>A(t,e,s,i),M=(t,e,s,i)=>{const a=1==i?this.predictions[t]["ci_fp_instances"][e].instances:this.predictions[t]["ci_fn_instances"][e].instances;this.instances.length;const r=Lt(a,s),n=this.predictions[t]["ci_tp_instances"][e].instances.size+this.predictions[t]["ci_fp_instances"][e].instances.size+this.predictions[t]["ci_mp_instances"][e].instances.size+(this.predictions[t]["ci_tn_instances"][e].instances.size+this.predictions[t]["ci_fn_instances"][e].instances.size+this.predictions[t]["ci_mn_instances"][e].instances.size),o="No"==this.normalization?r.size:0==a.size?0:r.size*this.maxIntervals/(n/1.5);return this.x(o)},R=(t,e,s,i)=>{const a=1==i?this.predictions[t]["ci_mp_instances"][e].instances:this.predictions[t]["ci_mn_instances"][e].instances;this.instances.length;const r=Lt(a,s),n=this.predictions[t]["ci_tp_instances"][e].instances.size+this.predictions[t]["ci_fp_instances"][e].instances.size+this.predictions[t]["ci_mp_instances"][e].instances.size+(this.predictions[t]["ci_tn_instances"][e].instances.size+this.predictions[t]["ci_fn_instances"][e].instances.size+this.predictions[t]["ci_mn_instances"][e].instances.size),o="No"==this.normalization?r.size:0==a.size?0:r.size*this.maxIntervals/(n/1.5);return this.x(o)},H=(t,e,s,i)=>{const a=1==i?this.predictions[t]["ci_tp_instances"][e].instances:this.predictions[t]["ci_tn_instances"][e].instances;this.instances.length;const r=Lt(a,s),n=this.predictions[t]["ci_tp_instances"][e].instances.size+this.predictions[t]["ci_fp_instances"][e].instances.size+this.predictions[t]["ci_mp_instances"][e].instances.size+(this.predictions[t]["ci_tn_instances"][e].instances.size+this.predictions[t]["ci_fn_instances"][e].instances.size+this.predictions[t]["ci_mn_instances"][e].instances.size),o="No"==this.normalization?r.size:0==a.size?0:r.size*this.maxIntervals/(n/1.5);return o},V=(t,e,s,i)=>{const a=1==i?this.predictions[t]["ci_fp_instances"][e].instances:this.predictions[t]["ci_fn_instances"][e].instances;this.instances.length;const r=Lt(a,s),n=this.predictions[t]["ci_tp_instances"][e].instances.size+this.predictions[t]["ci_fp_instances"][e].instances.size+this.predictions[t]["ci_mp_instances"][e].instances.size+(this.predictions[t]["ci_tn_instances"][e].instances.size+this.predictions[t]["ci_fn_instances"][e].instances.size+this.predictions[t]["ci_mn_instances"][e].instances.size),o="No"==this.normalization?r.size:0==a.size?0:r.size*this.maxIntervals/(n/1.5);return o},j=(t,e,s,i)=>{const a=1==i?this.predictions[t]["ci_mp_instances"][e].instances:this.predictions[t]["ci_mn_instances"][e].instances;this.instances.length;const r=Lt(a,s),n=this.predictions[t]["ci_tp_instances"][e].instances.size+this.predictions[t]["ci_fp_instances"][e].instances.size+this.predictions[t]["ci_mp_instances"][e].instances.size+(this.predictions[t]["ci_tn_instances"][e].instances.size+this.predictions[t]["ci_fn_instances"][e].instances.size+this.predictions[t]["ci_mn_instances"][e].instances.size),o="No"==this.normalization?r.size:0==a.size?0:r.size*this.maxIntervals/(n/1.5);return o};var K=it["A"]().range([0,this.width]).padding(.5).domain(this.classifiers);D?("right1"==this.hover.type||"wrong1"==this.hover.type||"middle1"==this.hover.type?($.attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+(K(this.hover.classifier)-10)+",-60)").text("1st: "+this.normalization=="Yes"?"(%)":""+H(this.hover.classifier,this.hover.interval,D.instances,1)),T.attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+(K(this.hover.classifier)-10)+",-40)").text("1st: "+this.normalization=="Yes"?"(%)":""+j(this.hover.classifier,this.hover.interval,D.instances,1)),F.attr("fill","steelblue").attr("fill-opacity",1).attr("transform","translate("+(K(this.hover.classifier)-10)+",-20)").text("1st: "+this.normalization=="Yes"?"(%)":""+V(this.hover.classifier,this.hover.interval,D.instances,1))):"right2"!=this.hover.type&&"wrong2"!=this.hover.type&&"middle2"!=this.hover.type||($.attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+(K(this.hover.classifier)-10)+",-60)").text("1st: "+this.normalization=="Yes"?"(%)":""+H(this.hover.classifier,this.hover.interval,D.instances,2)),T.attr("fill-opacity",1).attr("fill","steelblue").attr("transform","translate("+(K(this.hover.classifier)-10)+",-40)").text("1st: "+this.normalization=="Yes"?"(%)":""+j(this.hover.classifier,this.hover.interval,D.instances,2)),F.attr("fill","steelblue").attr("fill-opacity",1).attr("transform","translate("+(K(this.hover.classifier)-10)+",-20)").text("1st: "+this.normalization=="Yes"?"(%)":""+V(this.hover.classifier,this.hover.interval,D.instances,2))),i.attr("width",t=>B(t["classifier"],t["confidence"],D.instances,1)),r.attr("width",t=>M(t["classifier"],t["confidence"],D.instances,1)),o.attr("width",t=>R(t["classifier"],t["confidence"],D.instances,1)),c.attr("width",t=>B(t["classifier"],t["confidence"],D.instances,2)),d.attr("width",t=>M(t["classifier"],t["confidence"],D.instances,2)),p.attr("width",t=>R(t["classifier"],t["confidence"],D.instances,2)),m.attr("visibility",t=>B(t["classifier"],t["confidence"],D.instances,1)>2*s||B(t["classifier"],t["confidence"],D.instances,1)<=0?"hidden":"visible"),v.attr("visibility",t=>M(t["classifier"],t["confidence"],D.instances,1)>2*s||M(t["classifier"],t["confidence"],D.instances,1)<=0?"hidden":"visible"),_.attr("visibility",t=>R(t["classifier"],t["confidence"],D.instances,1)>2*s||R(t["classifier"],t["confidence"],D.instances,1)<=0?"hidden":"visible"),b.attr("visibility",t=>B(t["classifier"],t["confidence"],D.instances,2)>2*s||B(t["classifier"],t["confidence"],D.instances,2)<=0?"hidden":"visible"),C.attr("visibility",t=>M(t["classifier"],t["confidence"],D.instances,2)>2*s||M(t["classifier"],t["confidence"],D.instances,2)<=0?"hidden":"visible"),S.attr("visibility",t=>R(t["classifier"],t["confidence"],D.instances,2)>2*s||R(t["classifier"],t["confidence"],D.instances,2)<=0?"hidden":"visible")):(i.attr("width","0"),r.attr("width","0"),o.attr("width","0"),c.attr("width","0"),d.attr("width","0"),p.attr("width","0"),m.attr("visibility","hidden"),v.attr("visibility","hidden"),_.attr("visibility","hidden"),b.attr("visibility","hidden"),C.attr("visibility","hidden"),S.attr("visibility","hidden")),O?("right1"==this.hover.type||"wrong1"==this.hover.type||"middle1"==this.hover.type?(E.attr("fill-opacity",1).attr("fill","red").attr("transform","translate("+(K(this.hover.classifier)+60)+",-60)").text("2nd: "+this.normalization=="Yes"?"(%)":""+H(this.hover.classifier,this.hover.interval,O.instances,1)),P.attr("fill-opacity",1).attr("fill","red").attr("transform","translate("+(K(this.hover.classifier)+60)+",-40)").text("2nd: "+this.normalization=="Yes"?"(%)":""+j(this.hover.classifier,this.hover.interval,O.instances,1)),I.attr("fill","red").attr("fill-opacity",1).attr("transform","translate("+(K(this.hover.classifier)+60)+",-20)").text("2nd: "+this.normalization=="Yes"?"(%)":""+V(this.hover.classifier,this.hover.interval,O.instances,1))):"right2"!=this.hover.type&&"wrong2"!=this.hover.type&&"middle2"!=this.hover.type||(E.attr("fill-opacity",1).attr("fill","red").attr("transform","translate("+(K(this.hover.classifier)+60)+",-60)").text("2nd: "+this.normalization=="Yes"?"(%)":""+H(this.hover.classifier,this.hover.interval,O.instances,2)),P.attr("fill-opacity",1).attr("fill","red").attr("transform","translate("+(K(this.hover.classifier)+60)+",-40)").text("2nd: "+this.normalization=="Yes"?"(%)":""+j(this.hover.classifier,this.hover.interval,O.instances,2)),I.attr("fill","red").attr("fill-opacity",1).attr("transform","translate("+(K(this.hover.classifier)+60)+",-20)").text("2nd: "+this.normalization=="Yes"?"(%)":""+V(this.hover.classifier,this.hover.interval,O.instances,2))),a.attr("width",t=>B(t["classifier"],t["confidence"],O.instances,1)),n.attr("width",t=>M(t["classifier"],t["confidence"],O.instances,1)),l.attr("width",t=>R(t["classifier"],t["confidence"],O.instances,1)),h.attr("width",t=>B(t["classifier"],t["confidence"],O.instances,2)),u.attr("width",t=>M(t["classifier"],t["confidence"],O.instances,2)),f.attr("width",t=>R(t["classifier"],t["confidence"],O.instances,2)),g.attr("visibility",t=>B(t["classifier"],t["confidence"],O.instances,1)>2*s||B(t["classifier"],t["confidence"],O.instances,1)<=0?"hidden":"visible"),y.attr("visibility",t=>M(t["classifier"],t["confidence"],O.instances,1)>2*s||M(t["classifier"],t["confidence"],O.instances,1)<=0?"hidden":"visible"),x.attr("visibility",t=>R(t["classifier"],t["confidence"],O.instances,1)>2*s||R(t["classifier"],t["confidence"],O.instances,1)<=0?"hidden":"visible"),w.attr("visibility",t=>B(t["classifier"],t["confidence"],O.instances,2)>2*s||B(t["classifier"],t["confidence"],O.instances,2)<=0?"hidden":"visible"),k.attr("visibility",t=>M(t["classifier"],t["confidence"],O.instances,2)>2*s||M(t["classifier"],t["confidence"],O.instances,2)<=0?"hidden":"visible"),z.attr("visibility",t=>R(t["classifier"],t["confidence"],O.instances,2)>2*s||R(t["classifier"],t["confidence"],O.instances,2)<=0?"hidden":"visible")):(a.attr("width","0"),n.attr("width","0"),l.attr("width","0"),h.attr("width","0"),u.attr("width","0"),f.attr("width","0"),g.attr("visibility","hidden"),y.attr("visibility","hidden"),x.attr("visibility","hidden"),w.attr("visibility","hidden"),k.attr("visibility","hidden"),z.attr("visibility","hidden"))},select(t,e,s,i){it["i"].preventDefault(),it["i"].stopPropagation();const a=nt();a.rule=X.RIGHT,a.classifier=t,a.negation="wrong"===e;let r=new Set;if("dist"!=e){const s="right"==e?"ci_tp_instances":"right2"==e?"ci_tn_instances":"wrong"==e?"ci_fp_instances":"wrong2"==e?"ci_fn_instances":"middle"==e?"ci_mp_instances":"ci_mn_instances";r=this.predictions[t][s][i].instances}else r=new Set([...this.predictions[t]["ci_tp_instances"][i].instances,...this.predictions[t]["ci_fn_instances"][i].instances,...this.predictions[t]["ci_tn_instances"][i].instances,...this.predictions[t]["ci_fp_instances"][i].instances,...this.predictions[t]["ci_mn_instances"][i].instances,...this.predictions[t]["ci_mp_instances"][i].instances]);this.confidenceIndex[i];const n=parseFloat(i)-.05<0?0:parseFloat(i)-.05,o=parseFloat(i)+.05>1?1:parseFloat(i)+.05,l=`Instances which ${t} got ${e} with scores between ${n.toFixed(2)} and  ${o.toFixed(2)}`,c={type:"simple",constraints:[a],metric:[]},h={description:l,instances:r,predicate:c};this.$store.dispatch("prependToSelectionHistory",h),this.$store.dispatch("changedMostRecentSelection",s)}}}),ue=de,pe=(s("552c"),s("b73d")),fe=Object(m["a"])(ue,ce,he,!1,null,"202c3122",null),me=fe.exports;v()(fe,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"],VSwitch:pe["a"]});var ge=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Reliability Curve")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Selection Mode"},model:{value:t.selection_mode,callback:function(e){t.selection_mode=e},expression:"selection_mode"}},[s("v-radio",{attrs:{label:"overall curve ",value:"overall"}}),s("v-radio",{attrs:{label:"selection curve",value:"selected"}})],1)],1)])],1)],1),s("div",{attrs:{id:"legend1"}},[s("multiselect",{attrs:{options:t.options,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pick sets",label:"name","track-by":"name","preselect-first":!0},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),s("div",{ref:"svg"})],1)},ve=[],ye=i["a"].extend({name:"Reliability_Curve",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:30,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i="descending",a={classifier:""},r={classifier:"",threshold:""},n="overall";return{svg:"",confidenceClassifierDict:{},value:[],selection_mode:n,accuracySorting:i,height:s,hover:a,click:r,margin:t,curclick:[],panel:[],rightColor:"#b8ddf2",width:e,selectedEval:"",wrongColor:"#f7c8aa",rightColor1:"#9bcae4",wrongColor1:"#ffbb99",rightHoverColor1:"#4ba0ce",wrongHoverColor1:"#ff884d",rightHoverColor:"#4393c3",wrongHoverColor:"#d6604d",selection1Color:"#18FFFF",selection2Color:"#FF4081"}},computed:{saveStatus(){return this.$store.state.saveStatus},options(){let t=[];const e=this.classifiers;return e.forEach(e=>{t.push({name:e})}),t},classifierThresholds(){return this.$store.state.classifierThresholdDict},classes(){return[...this.boxProps.classes]},confidence(){return["0","0.1","0.2","0.3","0.4","0.5","0.6","0.7","0.8","0.9","1.0"]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},confidenceIndex(){let t={};for(let e in this.confidence)t[this.confidence[e]]=parseInt(e);return t},metrics(){const t=this.$store.getters.metrics,e=Object.entries(t).map(([t,e])=>({classifier:t,metrics:e}));return e},predictions(){const t={};var e=[];return this.classifiers.forEach(s=>{t[s]={name:s,threshold:Object.keys(this.classifierThresholds).includes(s)?this.classifierThresholds[s]:0,acc:0,ci_tp:[],ci_fn:[],ci_tn:[],ci_fp:[],ci_tp_instances:{},ci_fp_instances:{},ci_tn_instances:{},ci_fn_instances:{},continuous_pred:[]},this.confidence.forEach(e=>{t[s]["ci_tp_instances"][e]={instances:new Set},t[s]["ci_tn_instances"][e]={instances:new Set},t[s]["ci_fp_instances"][e]={instances:new Set},t[s]["ci_fn_instances"][e]={instances:new Set}}),this.instances.forEach(e=>{let i=Nt(e).continuous_predictions[s],a=Nt(e).actual==Nt(e).predictions[s]?1:0;t[s].continuous_pred.push(parseFloat(i));let r=(i.split(".")[1].substring(0,1)/10).toString();"1"==i.split(".")[0]&&(r="1.0");let n=this.confidenceIndex[r];if(n>0&&n<this.confidence.length){let t=n+1,e=parseFloat(this.confidence[t]);Math.abs(e-parseFloat(i))<Math.abs(parseFloat(i)-parseFloat(r))&&(r=this.confidence[t])}1==a?Nt(e).actual==this.classes[1]?t[s]["ci_tp_instances"][r].instances.add(e):t[s]["ci_tn_instances"][r].instances.add(e):Nt(e).actual==this.classes[1]?t[s]["ci_fp_instances"][r].instances.add(e):t[s]["ci_fn_instances"][r].instances.add(e)}),this.confidence.forEach(i=>{t[s]["ci_tp"].push(t[s]["ci_tp_instances"][i].instances.size),t[s]["ci_tn"].push(t[s]["ci_tn_instances"][i].instances.size),t[s]["ci_fp"].push(t[s]["ci_fp_instances"][i].instances.size),t[s]["ci_fn"].push(t[s]["ci_fn_instances"][i].instances.size),e.push(t[s]["ci_tn_instances"][i].instances.size+t[s]["ci_tp_instances"][i].instances.size+t[s]["ci_fn_instances"][i].instances.size+t[s]["ci_fp_instances"][i].instances.size)})}),this.x.domain([0,2*it["t"](e)]),t},confidenceDict(){let t=[],e={};return this.classifiers.forEach(s=>{let i=this.predictions[s].ci_tp,a=this.predictions[s].ci_tn,r=this.predictions[s].ci_fp,n=this.predictions[s].ci_fn,o=[];for(var l in this.confidence)o.push({classifier:s,confidence:this.confidence[l],tp_interval:i[l],tn_interval:a[l],fp_interval:r[l],fn_interval:n[l]});t.push({name:s,data:o,threshold:this.predictions[s].threshold}),e[s]=o}),e},selections(){return this.$store.state.overlapSelections},focusItemId(){return this.$store.state.focusItemId},focusDotEmphasis(){return this.$store.state.focusDotEmphasis},x(){const t=it["y"]().range([0,this.width/this.classifiers.length]).domain([0,100]);return t},xRight(){const t=it["y"]().range([0,this.width/this.classifiers.length]).domain([0,1]);return t},y(){const t=it["x"]().range([this.height,0]).padding(.1).domain(this.confidence);return t},outSelections(){return this.$store.state.overlapSelections},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Reliability_Curve"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.selection_mode=e.selection}}),this.drawInitial()},saveStatus(){let t={name:"Reliability_Curve",config:{classifiers:this.value.map(t=>t.name),selection:this.selection_mode}};this.$store.dispatch("changedSaveConfig",t)},click(){this.updateThreshold()},selections(){this.drawInitial()},value(){this.drawInitial()},selection_mode(){this.drawInitial()},outSelections(){"overall"!=this.selection_mode&&this.drawInitial()},hover(){this.drawHover()},instances(){this.drawInitial()},focusItemId(){this.drawInitial()},focusDotEmphasis(){this.drawInitial()}},mounted(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Reliability_Curve"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.selection_mode=e.selection}}),this.drawInitial()},methods:{updateThreshold(){const t=this.click.classifier,e=parseFloat(this.click.threshold).toFixed(2);let s={classifier:t,single_threshold:100*parseFloat(e)};this.$store.dispatch("changedCurveChosenClassifierThresholdTuple",s)},clearHover(){this.hover={classifier:""}},drawHover(){const t=this.hover.classifier;let e=["standard"];this.classifiers.forEach(t=>{e.push(t)});const{first:s,second:i}=this.outSelections;if("overall"==this.selection_mode)""!=this.hover.classifier?(it["C"](".legend_circle_"+t).attr("r",8),it["C"](".legend_text_"+t).style("font-size","20px"),e.forEach(e=>{e!=t&&(it["D"](".line_"+e).style("opacity",.2),it["D"](".dot_"+e).style("opacity",.2))})):e.forEach(t=>{it["D"](".line_"+t).style("opacity",1),it["D"](".dot_"+t).style("opacity",1),it["C"](".legend_circle_"+t).attr("r",6),it["C"](".legend_text_"+t).style("font-size","15px")});else{let a=[];s&&a.push(1),i&&a.push(2),a.forEach(s=>{""!=this.hover.classifier?(it["C"](".legend_circle_"+t).attr("r",8),it["C"](".legend_text_"+t).style("font-size","20px"),it["D"](".line_"+t+"_"+s).style("opacity",1),it["D"](".dot_"+t+"_"+s).style("opacity",1),e.forEach(e=>{e!=t&&(it["D"](".line_"+e+"_"+s).style("opacity",.2),it["D"](".dot_"+e+"_"+s).style("opacity",.2))})):e.forEach(t=>{it["D"](".line_"+t+"_"+s).style("opacity",1),it["D"](".dot_"+t+"_"+s).style("opacity",1),it["C"](".legend_circle_"+t).attr("r",6),it["C"](".legend_text_"+t).style("font-size","15px")})})}},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.bottom}`).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.bottom})`),e=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${.4*(this.height+this.margin.top+this.margin.bottom)}`).append("g").attr("transform",`translate(${this.margin.left}, ${.2*this.margin.top})`),s=it["B"](it["n"]).domain([0,this.classifiers.length]).interpolator((function(t){return it["n"](.8*t)})),i=this.value.map(t=>t.name);this.width;var a=this.height;let r=[],n=[],o={},l=[],c=0;const h=()=>{let t=0;i.forEach(e=>{t+=1;let i=this.predictions[e].ci_tp,a=this.predictions[e].ci_tn,l=this.predictions[e].ci_fp,c=this.predictions[e].ci_fn,h=[],d=[],u=[];for(var p in this.confidence)if(i[p]+l[p]+a[p]+c[p]==0||(i[p]+l[p])/this.instances.size<.01)u.push({name:e,color:s(t),classifier:e,confidence:this.confidence[p],value:null});else{let r=i[p]+l[p]+a[p]+c[p]==0?null:(i[p]+l[p])/(i[p]+l[p]+a[p]+c[p]),n=i[p]+l[p]+a[p]+c[p];h.push({name:e,color:s(t),classifier:e,confidence:this.confidence[p],tp_interval:i[p],tn_interval:a[p],fp_interval:l[p],fn_interval:c[p],threshold:this.predictions[e].threshold,value:r}),d.push([this.confidence[p],r]),u.push({name:e,color:s(t),classifier:e,confidence:this.confidence[p],value:n})}r.push({name:e,color:s(t),cordinates:d,data:h,threshold:this.predictions[e].threshold}),n.push({name:e,color:s(t),data:u,threshold:this.predictions[e].threshold}),o[e]=h});let e=[];for(var a in this.confidence){let t=parseFloat(this.confidence[a]);e.push({name:"standard",color:"grey",classifier:"standard",confidence:this.confidence[a],tp_interval:this.instances.length/2,tn_interval:0,fp_interval:0,fn_interval:this.instances.length/2,threshold:.5,value:t})}r.push({name:"standard",color:"grey",data:e,threshold:.5})},d=()=>{const{first:t,second:e}=this.outSelections;this.instances;let a=[],r={};const n=(t,e)=>{let i=t,r=[],n=[],o=[],l=[];for(var h in this.confidence){let t=this.confidence[h];r.push(Lt(this.predictions[i].ci_tp_instances[t].instances,e).size),n.push(Lt(this.predictions[i].ci_tn_instances[t].instances,e).size),o.push(Lt(this.predictions[i].ci_fp_instances[t].instances,e).size),l.push(Lt(this.predictions[i].ci_fn_instances[t].instances,e).size)}let d=[],u=[];for(var p in this.confidence){if(r[p]+o[p]+n[p]+l[p]==0)continue;let t=r[p]+o[p]+n[p]+l[p]==0?null:(r[p]+o[p])/(r[p]+o[p]+n[p]+l[p]);r[p],o[p],n[p],l[p];d.push({name:i,color:s(c),classifier:i,confidence:this.confidence[p],tp_interval:r[p],tn_interval:n[p],fp_interval:o[p],fn_interval:l[p],threshold:this.predictions[i].threshold,value:t}),u.push([this.confidence[p],t])}return a.push({name:i,color:s(c),cordinates:u,data:d,threshold:this.predictions[i].threshold}),d};c=0;let o=[];if(t){for(var h in c=0,i.forEach(e=>{c+=1,r[e]=n(e,t.instances)}),this.confidence){let t=parseFloat(this.confidence[h]);o.push({name:"standard",color:"grey",classifier:"standard",confidence:this.confidence[h],tp_interval:this.instances.length/2,tn_interval:0,fp_interval:0,fn_interval:this.instances.length/2,threshold:.5,value:t})}a.push({name:"standard",color:"grey",data:o,threshold:.5}),l.push({selection_type:1,data:a,dict:r})}if(e){if(c=0,r={},a=[],i.forEach(t=>{c+=1,r[t]=n(t,e.instances)}),!t){let t=[];for(var h in this.confidence){let e=parseFloat(this.confidence[h]);t.push({name:"standard",color:"grey",classifier:"standard",confidence:this.confidence[h],tp_interval:this.instances.length/2,tn_interval:0,fp_interval:0,fn_interval:this.instances.length/2,threshold:.5,value:e})}a.push({name:"standard",color:"grey",data:t,threshold:.5})}l.push({selection_type:2,data:a,dict:r})}},u=()=>{let t={};for(let e in this.confidence){let s=[],a=0;i.forEach(t=>{s.push(n[a].data[e]),a+=1}),t[this.confidence[e]]=s}const s=t=>t.attr("transform",`translate(0, ${.4*a})`).call(it["b"](o).tickSizeOuter(0)),r=it["y"]().domain([0,this.instances.length]).range([.4*this.height,0]),o=it["x"]().range([0,this.width]).paddingOuter(0).domain(this.confidence),l=it["x"]().range([0,this.width/this.confidence.length]).paddingOuter(.5).paddingInner(0).domain(i),c=it["y"]().domain([0,this.instances.length]).range([.4*this.height,0]),h=l.bandwidth();e.append("g").attr("class","bar-chart").call(s).selectAll("text").attr("text-anchor","start"),e.append("g").attr("class","bar-chart").call(it["c"](r));const d=e.append("g").attr("class","bar-chart").selectAll("g").data(this.confidence).enter().append("g").attr("transform",(function(t){return"translate("+o(t)+",0)"})).selectAll("rect").data((function(e){return t[e]})).enter();this.svg=e,this.confidenceClassifierDict=t,d.append("rect").attr("transform",(function(t){return"translate("+l(t["classifier"])+",0)"})).attr("class",t=>"bar-right-"+t["classifier"]+"-"+t["confidence"]).attr("width",h).attr("height",t=>.4*this.height-c(t["value"])).attr("y",t=>c(t["value"])).attr("fill",t=>t["color"]).on("mouseenter",t=>this.hover={type:"right1",classifier:t["classifier"],interval:t["confidence"].toString()}).on("mouseleave",this.clearHover).on("click",t=>this.select(t["classifier"],"first",t["confidence"].toString())).on("contextmenu",t=>this.select(t["classifier"],"second",t["confidence"].toString()))},p=()=>{const e=it["y"]().domain([0,1]).range([0,this.width]),s=it["y"]().domain([0,1]).range([3*this.height/4,0]);function i(t){t.name;t=t.data;var i="M ",a=0;return t.forEach(t=>{null!=t.value&&0!=t.value||0==a?(i=0==a?i+e(t.confidence)+" "+s(t.value):i+"L "+e(t.confidence)+" "+s(t.value),t.confidence,t.value,a+=1):a+=1}),i}t.append("g").attr("transform","translate(0,"+3*a/4+")").call(it["b"](e)),t.append("g").call(it["c"](s));t.selectAll("myPath").data(r).enter().append("path").attr("d",i).attr("class",(t,e)=>"line_"+t.name).attr("class",(t,e)=>"line_"+t.name).style("fill","none").attr("stroke",t=>t.color).style("stroke-width",3).style("opacity",1).style("stroke-dasharray",t=>"standard"==t["name"]?"3, 3":"0, 0"),t.selectAll(".dot").data(r).enter().selectAll(".circle").data((function(t){return t["data"]})).enter().append("circle").attr("class",(t,e)=>"dot_"+t["name"]).attr("cx",(function(t,s){let i=parseFloat(t["confidence"]);return e(i)})).attr("cy",(function(t,e){let i=t["value"];return s(i)})).attr("r",5).attr("fill",t=>t["color"]).attr("opacity",(function(t,e){return null!=t["value"]&&0!=t["value"]?1:0})).on("click",(t,e)=>this.click={threshold:t["confidence"],classifier:t["classifier"]})},f=()=>{const e=it["y"]().domain([0,1]).range([0,this.width]),s=it["y"]().domain([0,1]).range([3*this.height/4,0]);function i(t){t.name;t=t.data;var i="M ",a=0;return t.forEach(t=>{null!=t.value&&0!=t.value||0==a||(a=0,i+="M "),i=0==a?i+e(t.confidence)+" "+s(t.value):i+"L "+e(t.confidence)+" "+s(t.value),t.confidence,t.value,a+=1}),i}t.append("g").attr("transform","translate(0,"+3*a/4+")").call(it["b"](e)),t.append("g").call(it["c"](s));let r=[];for(var n in this.confidence){let t=parseFloat(this.confidence[n]);r.push({name:"standard",color:"grey",classifier:"standard",confidence:this.confidence[n],tp_interval:this.instances.length/2,tn_interval:0,fp_interval:0,fn_interval:this.instances.length/2,threshold:.5,value:t})}l.forEach(a=>{let r=a.data,n=(a.dict,a.selection_type);t.selectAll("myPath").data(r).enter().append("path").attr("d",i).attr("class",(t,e)=>"line_"+t["name"]+"_"+n).style("fill","none").attr("stroke",(t,e)=>"grey"==t["color"]?t["color"]:1==this.value.length?1==n?this.selection1Color:2==n?this.selection2Color:t["color"]:t["color"]).style("stroke-width",3).style("opacity",1).style("stroke-dasharray","1"==n?"3, 3":"0, 0"),t.selectAll(".dot").data(r).enter().selectAll(".circle").data((function(t){return t["data"]})).enter().append("circle").attr("class",(t,e)=>"dot_"+t["name"]+"_"+n).attr("cx",(function(t,s){let i=parseFloat(t["confidence"]);return e(i)})).attr("cy",(function(t,e){let i=t["value"];return s(i)})).attr("r",5).attr("fill",t=>"grey"==t["color"]?t["color"]:1==this.value.length?1==n?this.selection1Color:2==n?this.selection2Color:t["color"]:t["color"]).attr("opacity",(function(t,e){return null!=t["value"]?1:0})).on("click",(t,e)=>this.click={threshold:t["confidence"],classifier:t["classifier"]})})};"overall"==this.selection_mode?(h(),p(),u(),this.drawDistributionSelections()):(d(),f(),h(),u(),this.drawDistributionSelections());const m=()=>{t.append("text").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("Fraction of Positives"),t.append("text").attr("transform",()=>{const t=this.width/2,e=.9*this.height;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Mean predicted value")};m();const g=()=>{this.evaluationKeys;"overall"!=this.selection_mode&&(r=l[0].data);t.selectAll("myCicle").data(r).enter().append("circle").attr("class",(t,e)=>"legend_circle_"+t.name).attr("cx","roc"==this.evaluationKeys?10:20).attr("cy",(t,e)=>25*e-this.margin.top).attr("r",6).style("fill",t=>t.color).on("mouseenter",t=>this.hover={classifier:t.name}).on("mouseleave",this.clearHover),t.selectAll("myText").data(r).enter().append("text").attr("class",(t,e)=>"legend_text_"+t.name).attr("x","roc"==this.evaluationKeys?30:40).attr("y",(t,e)=>25*e-this.margin.top).text(t=>t.name).style("font-size","15px").attr("alignment-baseline","middle").on("mouseenter",t=>this.hover={classifier:t.name}).on("mouseleave",this.clearHover);"overall"!=this.selection_mode&&(t.append("line").attr("y1",-this.margin.top).attr("x1",100).attr("x2",140).attr("y2",-this.margin.top).attr("stroke","blue").attr("stroke-width","2px").attr("stroke-opacity",.5).style("stroke-dasharray","3, 3"),t.append("text").attr("y",-this.margin.top).attr("x",142).style("font-size","15px").attr("alignment-baseline","middle").text("selection 1"),t.append("line").attr("y1",25-this.margin.top).attr("x1",100).attr("x2",140).attr("y2",25-this.margin.top).attr("stroke","blue").attr("stroke-width","2px").attr("stroke-opacity",.5),t.append("text").attr("y",25-this.margin.top).attr("x",142).style("font-size","15px").attr("alignment-baseline","middle").text("selection 2"))};g()},drawDistributionSelections(){it["C"](this.$refs.svg);const{first:t,second:e}=this.selections,s=this.confidenceClassifierDict,i=this.value.map(t=>t.name),a=it["x"]().range([0,this.width]).paddingOuter(0).domain(this.confidence),r=it["x"]().range([0,this.width/this.confidence.length]).paddingOuter(.5).paddingInner(0).domain(i),n=it["y"]().domain([0,this.instances.length]).range([0,.4*this.height]),o=r.bandwidth(),l=(t,e,s)=>{let i=[],a=[],r=["ci_fn_instances","ci_fp_instances","ci_tn_instances","ci_tp_instances"];r.forEach(s=>{let r=[...this.predictions[t][s][e].instances];r.forEach(t=>{a.push(t),"ci_fp_instances"!=s&&"ci_tp_instances"!=s||i.push(t)})});let o=new Set(a),l=Lt(o,s);return n(l.size)},c=(t,e,s)=>{let i=[],a=[],r=["ci_fn_instances","ci_fp_instances","ci_tn_instances","ci_tp_instances"];r.forEach(s=>{let r=[...this.predictions[t][s][e].instances];r.forEach(t=>{a.push(t),"ci_fp_instances"!=s&&"ci_tp_instances"!=s||i.push(t)})});let n=new Set(a),o=Lt(n,s);for(const l of o)if(this.$store.state.focusItemId===l)return!0;return!1},h=[t,e];h.forEach((t,e)=>{t?this.confidence.forEach(i=>{s[i].forEach(s=>{let n={barCells:this.svg,x:a(i)+r(s["classifier"])+(e+1)*o/4,y:.4*this.height-l(s["classifier"],s["confidence"],t.instances),width:o/4,height:l(s["classifier"],s["confidence"],t.instances),r:o/8,color:0==e?this.selection1Color:this.selection2Color,circle_visibility:l(s["classifier"],s["confidence"],t.instances)>0&&l(s["classifier"],s["confidence"],t.instances)<.01*this.height?"visible":"hidden",cx:a(i)+r(s["classifier"])+o/2+(e-.5)*o/4,cy:.4*this.height-o/8,selection_type:e,focused:c(s["classifier"],s["confidence"],t.instances),view_name:this.name};this.$store.dispatch("drawSelections",n)})}):(this.svg.selectAll("selection-rect-"+e).attr("height","0"),this.svg.selectAll("selection-circle-"+e).attr("visibility","hidden"))})},select(t,e,s){it["i"].preventDefault(),it["i"].stopPropagation();const i=nt();i.rule=X.RIGHT,i.classifier=t;let a=[],r=["ci_tp_instances","ci_tn_instances","ci_fp_instances","ci_fn_instances"];r.forEach(e=>{let i=[...this.predictions[t][e][s].instances];i.forEach(t=>{a.push(t)})});const n=new Set(a),o=`Instances which ${t} in interval ${s}`,l={type:"simple",constraints:[i],metric:[]},c={description:o,instances:n,predicate:l};this.$store.dispatch("prependToSelectionHistory",c),this.$store.dispatch("changedMostRecentSelection",e)}}}),_e=ye,xe=(s("647d"),Object(m["a"])(_e,ge,ve,!1,null,"55929ecc",null)),be=xe.exports;v()(xe,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var we=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("(Trinary) Instance Distribuion")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Selection Mode"},model:{value:t.selection_mode,callback:function(e){t.selection_mode=e},expression:"selection_mode"}},[s("v-radio",{attrs:{label:"overall confidence ",value:"overall"}}),s("v-radio",{attrs:{label:"selection confidence",value:"selected"}})],1)],1),s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Distribution Mode"},model:{value:t.distribution_mode,callback:function(e){t.distribution_mode=e},expression:"distribution_mode"}},[s("v-radio",{attrs:{label:"by score ",value:"score"}}),s("v-radio",{attrs:{label:"by correctness",value:"correctness"}})],1)],1),s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Performance Type"},model:{value:t.weightedPerformance,callback:function(e){t.weightedPerformance=e},expression:"weightedPerformance"}},[s("v-radio",{attrs:{label:"normal",value:"normal"}}),s("v-radio",{attrs:{label:"weighted",value:"weighted"}})],1)],1)])],1)],1),s("v-switch",{staticClass:"ml-8",attrs:{label:"normalize"},model:{value:t.normalization_switch,callback:function(e){t.normalization_switch=e},expression:"normalization_switch"}}),s("div",{ref:"svg"})],1)},Ce=[],ke=i["a"].extend({name:"Trinary_Instance_Distribuion",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:150,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i={type:"",classifier:""},a={type:"",selection:"",classifier:""},r="normal";return{svg:"",weightedPerformance:r,selection_mode:"overall",distribution_mode:"score",thresholdRange:{},normalization:"No",height:s,hover:i,hoverNormalization:a,margin:t,panel:[],rightColor:"#d1e5f0",rightHoverColor:"#4393c3",selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e,wrongColor:"#fddbc7",wrongHoverColor:"#d6604d",selection1Right:"#81AED7",selection1Wrong:"#D7AA81",selection1mid:"#C1BFC3",selection2Right:"#B981D7",selection2Wrong:"#D78E81",selection2mid:"#C1BFC3",classNumber:[...this.boxProps.classes].length}},computed:{continuous_metrics(){return this.$store.state.continuous_metrics},weighted_metrics(){return this.$store.state.weighted_metrics},addedThresholdClassifiers(){return"continuous"!=this.$store.state.datasetType?[]:this.$store.state.addedThresholdClassifiers.map(t=>t.name)},addedBandWidthClassifiers(){if(0==this.$store.state.addedBandWidthClassifiers.length){const t=Object.keys(this.$store.state.classifierThresholdDict).map(t=>{let e=this.$store.state.classifierThresholdDict[t]/100;return{name:t+"("+(e-.05<0?0:e-.05).toFixed(2)+","+(e+.05>1?1:e+.05).toFixed(2)+")"}});return t}return this.$store.state.addedBandWidthClassifiers},normalization_switch:{set(){"Yes"==this.normalization?this.normalization="No":this.normalization="Yes"},get(){return"Yes"===this.normalization}},classifierBandWidthDict(){return this.boxProps.classifierBandWidthDict},bandWidthChangedClassifierName(){return this.$store.state.bandWidthChangedClassifierName},classes(){return this.classNumber=[...this.boxProps.classes].length,[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},thresholdClassifierNameList(){return this.$store.state.thresholdClassifierNameList},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},predictionKeys(){this.evaluationKeys;const t=this.classifiers.slice();return t},continuousPredictionKeys(){return this.addedBandWidthClassifiers.map(t=>t.name)},evaluationKeys(){return"accuracy"},classifierThresholdDict(){return this.$store.state.classifierThresholdDict},continuousClassifierName(){var t={};return this.classifiers.forEach(e=>{"continuous"==this.$store.state.datasetType?t[e]=e+"_"+this.classifierThresholdDict[e]/100:t[e]=e}),t},predictions(){const t={};this.addedBandWidthClassifiers.forEach(e=>{let s=e.name.split("(")[0];t[e.name]={name:e.name,threshold:Object.keys(this.classifierThresholdDict).includes(s)?this.classifierThresholdDict[s]:0,right:new Set,right_wrong:new Set,right_right:new Set,wrong:new Set,wrong_wrong:new Set,wrong_right:new Set,middle_wrong:new Set,middle_right:new Set,middle_tp:new Set,middle_tn:new Set,middle_fp:new Set,middle_fn:new Set,accuracy:0,total_size:0,right_size:0,wrong_size:0,middle_right_size:0,middle_wrong_size:0}});const e="normal"==this.weightedPerformance?this.$store.state.continuous_metrics:this.$store.state.weighted_metrics,s={middle_fn:"m_fn_instances",middle_fp:"m_fp_instances",middle_tp:"m_tp_instances",middle_tn:"m_tn_instances",right_right:"tp_instances",wrong_wrong:"tn_instances",wrong_right:"fp_instances",right_wrong:"fn_instances",m_fp:"m_fp",m_tp:"m_tp",m_fn:"m_fn",m_tn:"m_tn",tp:"tp",tn:"tn",fp:"fp",fn:"fn"};return this.addedBandWidthClassifiers.forEach(i=>{let a=i.name.split("(")[0],r=parseFloat(i.name.substring(i.name.length-10,i.name.length-6)).toFixed(2),n=parseFloat(i.name.substring(i.name.length-5,i.name.length-1)).toFixed(2),o=(parseFloat(n)+parseFloat(r))/2;if(r==e[a]["cur_left_edge"].toFixed(2)&&n==e[a]["cur_right_edge"].toFixed(2)){t[i.name].threshold=o;for(let r in s)t[i.name][r]=e[a][s[r]];t[i.name]["right_size"]=e[a]["tp"]+e[a]["fn"],t[i.name]["wrong_size"]=e[a]["fp"]+e[a]["tn"],t[i.name]["middle_right_size"]=e[a]["m_tp"]+e[a]["m_fp"],t[i.name]["middle_wrong_size"]=e[a]["m_tn"]+e[a]["m_fn"]}else{if(this.instances.forEach(e=>{const s=Nt(e),o=s.actual==this.classes[1]?1:0,l=s.continuous_predictions[a];l<n&&l>r?0==o?l<t[i.name].threshold?t[i.name].middle_tn.add(e):t[i.name].middle_fp.add(e):l>=t[i.name].threshold?t[i.name].middle_tp.add(e):t[i.name].middle_fn.add(e):0==o?l<r?t[i.name].wrong_wrong.add(e):t[i.name].wrong_right.add(e):l>=n?t[i.name].right_right.add(e):t[i.name].right_wrong.add(e)}),"normal"==this.weightedPerformance)t[i.name]["m_fp"]=t[i.name]["middle_fp"].size,t[i.name]["m_tp"]=t[i.name]["middle_tp"].size,t[i.name]["m_fn"]=t[i.name]["middle_fn"].size,t[i.name]["m_tn"]=t[i.name]["middle_tn"].size,t[i.name]["fp"]=t[i.name]["wrong_right"].size,t[i.name]["tp"]=t[i.name]["right_right"].size,t[i.name]["fn"]=t[i.name]["right_wrong"].size,t[i.name]["tn"]=t[i.name]["wrong_wrong"].size;else{let e={},s=this.$store.state.selectionHistory,a=[["right_right","tp"],["wrong_wrong","tn"],["right_wrong","fn"],["wrong_right","fp"],["middle_tp","m_tp"],["middle_tn","m_tn"],["middle_fp","m_fn"],["middle_fn","m_fp"]];this.instances.forEach(t=>{e[t]=1}),s.forEach(t=>{let s=[...t.instances],i=parseFloat(t.weight.toString());s.forEach(t=>{e[t]+=i})}),a.forEach(s=>{let a=[...t[i.name][s[0]]],r=s[1],n=0;a.forEach(t=>{n+=e[t]}),t[i.name][r]=n})}t[i.name]["right_size"]=t[i.name]["tp"]+t[i.name]["fn"],t[i.name]["wrong_size"]=t[i.name]["fp"]+t[i.name]["tn"],t[i.name]["middle_right_size"]=t[i.name]["m_tp"]+t[i.name]["m_fp"],t[i.name]["middle_wrong_size"]=t[i.name]["m_tn"]+t[i.name]["m_fn"]}t[i.name]["middle_right"]=new Set([...t[i.name]["middle_tp"],...t[i.name]["middle_fp"]]),t[i.name]["middle_wrong"]=new Set([...t[i.name]["middle_tn"],...t[i.name]["middle_fn"]]),t[i.name]["right"]=new Set([...t[i.name]["right_wrong"],...t[i.name]["right_right"]]),t[i.name]["wrong"]=new Set([...t[i.name]["wrong_wrong"],...t[i.name]["wrong_right"]]),t[i.name]["total_size"]=t[i.name]["right_size"]+t[i.name]["wrong_size"]+t[i.name]["middle_right_size"]+t[i.name]["middle_wrong_size"]}),this.addedBandWidthClassifiers.forEach(e=>{t[e.name].accuracy=t[e.name].right_size/(t[e.name].right_size+t[e.name].wrong_size)}),t},selections(){return this.$store.state.overlapSelections},focusItemId(){return this.$store.state.focusItemId},focusDotEmphasis(){return this.$store.state.focusDotEmphasis},x(){const t=it["x"]().domain(this.continuousPredictionKeys).range([0,.8*this.width]).paddingOuter(1).paddingInner(.3);return t},y(){const t=it["y"]().domain([0,1]).range([this.height,0]);return t},xScale(){const t=it["y"]().domain([0,160]).range([10,160]).clamp(!0);return t},yScale(){const t=it["x"]().range([this.height+this.margin.bottom,0]).padding(.1).domain(this.predictionKeys);return t},saveStatus(){return this.$store.state.saveStatus},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Trinary_Instance_Distribuion"==t.name&&t.config){let e=t.config;this.selection_mode=e.selection,this.distribution_mode=e.distribution}}),this.drawInitial()},saveStatus(){let t={name:"Trinary_Instance_Distribuion",config:{selection:this.selection_mode,distribution:this.distribution_mode}};this.$store.dispatch("changedSaveConfig",t)},weightedPerformance(){this.drawInitial()},addedBandWidthClassifiers(){this.drawInitial()},selection_mode(){"weighted"==this.weightedPerformance&&"selected"==this.selection_mode&&(this.weightedPerformance="normal"),this.drawInitial()},weighted_metrics(){"weighted"==this.weightedPerformance&&this.drawInitial()},distribution_mode(){this.drawInitial()},hoverNormalization(){this.drawHoverNormalization()},normalization(){"Yes"==this.normalization?this.drawNormalization():this.drawInitial()},accuracySorting(){this.drawInitial()},evaluationSelection(){this.drawInitial()},hover(){this.drawHover()},instances(){this.drawInitial()},selections(){"Yes"==this.normalization?this.drawNormalization():this.drawInitial()},focusItemId(){this.drawInitial()},focusDotEmphasis(){this.drawInitial()}},mounted(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Trinary_Instance_Distribuion"==t.name&&t.config){let e=t.config;this.selection_mode=e.selection,this.distribution_mode=e.distribution}}),this.drawInitial()},methods:{clearHover(){this.hover={type:"",slection:"",classifier:""}},clearHoverNormalization(){this.hoverNormalization={type:"",classifier:""}},drawHover(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-right-right"),s=t.selectAll(".bar-wrong-wrong"),i=t.selectAll(".bar-right-wrong"),a=t.selectAll(".bar-wrong-right"),r=t.selectAll(".bar-middle-yes"),n=t.select(".y-axis-marker-rect"),o=t.select(".y-axis-marker-line-1"),l=t.select(".y-axis-marker-line-2"),c=t.select(".y-axis-marker-line-3"),h=t.select(".y-axis-marker-line-4"),d=t.select(".y-axis-marker-text-1"),u=t.select(".y-axis-marker-text-2"),p=t.select(".y-axis-marker-text-3"),f=t.select(".y-axis-marker-text-4"),m=t.select(".y-axis-marker-text-5"),g=t.select(".y-axis-marker-text-1-s1"),v=t.select(".y-axis-marker-text-2-s1"),y=t.select(".y-axis-marker-text-3-s1"),_=t.select(".y-axis-marker-text-4-s1"),x=t.select(".y-axis-marker-text-5-s1"),b=t.select(".y-axis-marker-text-1-s2"),w=t.select(".y-axis-marker-text-2-s2"),C=t.select(".y-axis-marker-text-3-s2"),k=t.select(".y-axis-marker-text-4-s2"),S=t.select(".y-axis-marker-text-5-s2"),{first:z,second:$}=this.selections,F=this.predictions,T=(t,e,s)=>{let i=F[t][e];"middle"==e&&(i=new Set([...F[t]["middle_wrong"],...F[t]["middle_right"]]));var a=0;a=F[t].total_size;const r=Lt(i,s),n=r.size/a*100;return n.toFixed(1)};"right_right"===this.hover.type&&""==this.hover.selection?e.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hover.classifier?this.rightHoverColor:this.rightColor):"overall"==this.selection_mode&&e.attr("fill",this.rightColor),"wrong_wrong"===this.hover.type&&""==this.hover.selection?s.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hover.classifier?this.rightHoverColor:this.rightColor):"overall"==this.selection_mode&&s.attr("fill",this.rightColor),"wrong_right"===this.hover.type&&""==this.hover.selection?a.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hover.classifier?this.wrongHoverColor:this.wrongColor):"overall"==this.selection_mode&&a.attr("fill",this.wrongColor),"right_wrong"===this.hover.type&&""==this.hover.selection?i.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hover.classifier?this.wrongHoverColor:this.wrongColor):"overall"==this.selection_mode&&i.attr("fill",this.wrongColor),"middle-yes"===this.hover.type&&""==this.hover.selection?r.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hover.classifier?"grey":"lightgrey"):"overall"==this.selection_mode&&r.attr("fill","lightgrey");const E=500,I=1e3;this.hover.type?(n.transition().duration(E).attr("stroke-opacity",1),o.transition().duration(E).attr("stroke-opacity",1).attr("y1",this.y(F[this.hover.classifier].fp/F[this.hover.classifier].total_size)).attr("x2",this.width).attr("y2",this.y(F[this.hover.classifier].fp/F[this.hover.classifier].total_size)),l.transition().duration(E).attr("stroke-opacity",1).attr("y1","correctness"!=this.distribution_mode?this.y((F[this.hover.classifier].fp+F[this.hover.classifier].tn)/F[this.hover.classifier].total_size):this.y((F[this.hover.classifier].fp+F[this.hover.classifier].fn)/F[this.hover.classifier].total_size)).attr("x2",this.width).attr("y2","correctness"!=this.distribution_mode?this.y((F[this.hover.classifier].fp+F[this.hover.classifier].tn)/F[this.hover.classifier].total_size):this.y((F[this.hover.classifier].fp+F[this.hover.classifier].fn)/F[this.hover.classifier].total_size)),c.transition().duration(E).attr("stroke-opacity",1).attr("y1","correctness"!=this.distribution_mode?this.y((F[this.hover.classifier].fp+F[this.hover.classifier].tn+F[this.hover.classifier].middle_wrong_size+F[this.hover.classifier].middle_right_size)/F[this.hover.classifier].total_size):this.y((F[this.hover.classifier].fp+F[this.hover.classifier].fn+F[this.hover.classifier].middle_wrong_size+F[this.hover.classifier].middle_right_size)/F[this.hover.classifier].total_size)).attr("x2",this.width).attr("y2","correctness"!=this.distribution_mode?this.y((F[this.hover.classifier].fp+F[this.hover.classifier].tn+F[this.hover.classifier].middle_wrong_size+F[this.hover.classifier].middle_right_size)/F[this.hover.classifier].total_size):this.y((F[this.hover.classifier].fp+F[this.hover.classifier].fn+F[this.hover.classifier].middle_wrong_size+F[this.hover.classifier].middle_right_size)/F[this.hover.classifier].total_size)),h.transition().duration(E).attr("stroke-opacity",1).attr("y1",this.height-this.y(F[this.hover.classifier].tp/F[this.hover.classifier].total_size)).attr("x2",this.width).attr("y2",this.height-this.y(F[this.hover.classifier].tp/F[this.hover.classifier].total_size)),d.transition().duration(E).attr("fill-opacity",1).text("tp: "+(F[this.hover.classifier].tp/F[this.hover.classifier].total_size*100).toFixed(1)+"%"),u.transition().duration(E).attr("fill-opacity",1).text("correctness"!=this.distribution_mode?"fn: "+(F[this.hover.classifier].fn/F[this.hover.classifier].total_size*100).toFixed(1)+"%":"tn: "+(F[this.hover.classifier].tn/F[this.hover.classifier].total_size*100).toFixed(1)+"%"),p.transition().duration(E).attr("fill-opacity",1).text("?: "+((F[this.hover.classifier].middle_right_size+F[this.hover.classifier].middle_wrong_size)/F[this.hover.classifier].total_size*100).toFixed(1)+"%"),f.transition().duration(E).attr("fill-opacity",1).text("correctness"!=this.distribution_mode?"tn: "+(F[this.hover.classifier].tn/F[this.hover.classifier].total_size*100).toFixed(1)+"%":"fn: "+(F[this.hover.classifier].fn/F[this.hover.classifier].total_size*100).toFixed(1)+"%"),m.transition().duration(E).attr("fill-opacity",1).text("fp: "+(F[this.hover.classifier].fp/F[this.hover.classifier].total_size*100).toFixed(1)+"%"),z&&(g.transition().duration(E).attr("fill-opacity",1).text("1st: "+T(this.hover.classifier,"right_right",z.instances)),v.transition().duration(E).attr("fill-opacity",1).text("correctness"!=this.distribution_mode?"1st: "+T(this.hover.classifier,"right_wrong",z.instances):"1st: "+T(this.hover.classifier,"wrong_wrong",z.instances)),y.transition().duration(E).attr("fill-opacity",1).text("1st: "+T(this.hover.classifier,"middle",z.instances)),_.transition().duration(E).attr("fill-opacity",1).text("correctness"!=this.distribution_mode?"1st: "+T(this.hover.classifier,"wrong_wrong",z.instances):"1st: "+T(this.hover.classifier,"right_wrong",z.instances)),x.transition().duration(E).attr("fill-opacity",1).text("1st: "+T(this.hover.classifier,"wrong_right",z.instances))),$&&(b.transition().duration(E).attr("fill-opacity",1).text("2nd: "+T(this.hover.classifier,"right_right",$.instances)),w.transition().duration(E).attr("fill-opacity",1).text("correctness"!=this.distribution_mode?"2nd: "+T(this.hover.classifier,"right_wrong",$.instances):"2nd: "+T(this.hover.classifier,"wrong_wrong",$.instances)),C.transition().duration(E).attr("fill-opacity",1).text("2nd: "+T(this.hover.classifier,"middle",$.instances)),k.transition().duration(E).attr("fill-opacity",1).text("correctness"!=this.distribution_mode?"2nd: "+T(this.hover.classifier,"wrong_wrong",$.instances):"2nd: "+T(this.hover.classifier,"right_wrong",$.instances)),S.transition().duration(E).attr("fill-opacity",1).text("2nd: "+T(this.hover.classifier,"wrong_right",$.instances)))):(n.transition().duration(E).attr("stroke-opacity",0),o.transition().duration(I).attr("stroke-opacity",0),l.transition().duration(I).attr("stroke-opacity",0),c.transition().duration(I).attr("stroke-opacity",0),h.transition().duration(I).attr("stroke-opacity",0),d.transition().duration(I).attr("fill-opacity",0),u.transition().duration(I).attr("fill-opacity",0),p.transition().duration(I).attr("fill-opacity",0),f.transition().duration(I).attr("fill-opacity",0),m.transition().duration(I).attr("fill-opacity",0),g.transition().duration(I).attr("fill-opacity",0),v.transition().duration(I).attr("fill-opacity",0),y.transition().duration(I).attr("fill-opacity",0),_.transition().duration(I).attr("fill-opacity",0),x.transition().duration(I).attr("fill-opacity",0),b.transition().duration(I).attr("fill-opacity",0),w.transition().duration(I).attr("fill-opacity",0),C.transition().duration(I).attr("fill-opacity",0),k.transition().duration(I).attr("fill-opacity",0),S.transition().duration(I).attr("fill-opacity",0))},drawHoverNormalization(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-right-right-norm"),s=t.selectAll(".bar-wrong-wrong-norm"),i=t.selectAll(".bar-right-wrong-norm"),a=t.selectAll(".bar-wrong-right-norm"),r=t.selectAll(".bar-middle-yes-norm"),n=t.select(".y-axis-marker-rect-norm"),o=t.select(".y-axis-marker-line-1-norm"),l=t.select(".y-axis-marker-line-2-norm"),c=t.select(".y-axis-marker-line-3-norm"),h=t.select(".y-axis-marker-line-4-norm"),d=t.select(".y-axis-marker-text-1-norm"),u=t.select(".y-axis-marker-text-2-norm"),p=t.select(".y-axis-marker-text-3-norm"),f=t.select(".y-axis-marker-text-4-norm"),m=t.select(".y-axis-marker-text-5-norm"),g=t.select(".y-axis-marker-text-1-s1-norm"),v=t.select(".y-axis-marker-text-2-s1-norm"),y=t.select(".y-axis-marker-text-3-s1-norm"),_=t.select(".y-axis-marker-text-4-s1-norm"),x=t.select(".y-axis-marker-text-5-s1-norm"),b=t.select(".y-axis-marker-text-1-s2-norm"),w=t.select(".y-axis-marker-text-2-s2-norm"),C=t.select(".y-axis-marker-text-3-s2-norm"),k=t.select(".y-axis-marker-text-4-s2-norm"),S=t.select(".y-axis-marker-text-5-s2-norm"),{first:z,second:$}=this.selections,F=this.predictions,T=(t,e,s)=>{let i=F[t][e];"middle"==e&&(i=new Set([...F[t]["middle_wrong"],...F[t]["middle_right"]]));F[t].total_size;const a=Lt(i,s),r=0==i.size?0:a.size/i.size*100;return r.toFixed(1)};"right_right"===this.hoverNormalization.type?e.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hoverNormalization.classifier?this.rightHoverColor:this.rightColor):e.attr("fill",this.rightColor),"wrong_wrong"===this.hoverNormalization.type?s.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hoverNormalization.classifier?this.rightHoverColor:this.rightColor):s.attr("fill",this.rightColor),"wrong_right"===this.hoverNormalization.type?a.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hoverNormalization.classifier?this.wrongHoverColor:this.wrongColor):a.attr("fill",this.wrongColor),"right_wrong"===this.hoverNormalization.type?i.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hoverNormalization.classifier?this.wrongHoverColor:this.wrongColor):i.attr("fill",this.wrongColor),"middle-yes"===this.hoverNormalization.type?r.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hoverNormalization.classifier?"grey":"lightgrey"):r.attr("fill","lightgrey");const E=500,I=1e3;this.hoverNormalization.type?(n.transition().duration(E).attr("stroke-opacity",1),o.transition().duration(E).attr("stroke-opacity",1).attr("y1",this.y(.2)).attr("x2",this.width).attr("y2",this.y(.2)),l.transition().duration(E).attr("stroke-opacity",1).attr("y1",this.y(.4)).attr("x2",this.width).attr("y2",this.y(.4)),c.transition().duration(E).attr("stroke-opacity",1).attr("y1",this.y(.6)).attr("x2",this.width).attr("y2",this.y(.6)),h.transition().duration(E).attr("stroke-opacity",1).attr("y1",this.y(.8)).attr("x2",this.width).attr("y2",this.y(.8)),d.transition().duration(E).attr("fill-opacity",1).text("tp-norm"),u.transition().duration(E).attr("fill-opacity",1).text("correctness"!=this.distribution_mode?"fn-norm":"tn-norm"),p.transition().duration(E).attr("fill-opacity",1).text("uncertain-norm"),f.transition().duration(E).attr("fill-opacity",1).text("correctness"!=this.distribution_mode?"tn-norm":"fn-norm"),m.transition().duration(E).attr("fill-opacity",1).text("fp-norm"),z&&(g.transition().duration(E).attr("fill-opacity",1).text("1st: "+T(this.hoverNormalization.classifier,"right_right",z.instances)),v.transition().duration(E).attr("fill-opacity",1).text("1st: "+T(this.hoverNormalization.classifier,"right_wrong",z.instances)),y.transition().duration(E).attr("fill-opacity",1).text("1st: "+T(this.hoverNormalization.classifier,"middle",z.instances)),_.transition().duration(E).attr("fill-opacity",1).text("1st: "+T(this.hoverNormalization.classifier,"wrong_wrong",z.instances)),x.transition().duration(E).attr("fill-opacity",1).text("1st: "+T(this.hoverNormalization.classifier,"wrong_right",z.instances))),$&&(b.transition().duration(E).attr("fill-opacity",1).text("2nd: "+T(this.hoverNormalization.classifier,"right_right",$.instances)),w.transition().duration(E).attr("fill-opacity",1).text("2nd: "+T(this.hoverNormalization.classifier,"right_wrong",$.instances)),C.transition().duration(E).attr("fill-opacity",1).text("2nd: "+T(this.hoverNormalization.classifier,"middle",$.instances)),k.transition().duration(E).attr("fill-opacity",1).text("2nd: "+T(this.hoverNormalization.classifier,"wrong_wrong",$.instances)),S.transition().duration(E).attr("fill-opacity",1).text("2nd: "+T(this.hoverNormalization.classifier,"wrong_right",$.instances)))):(n.transition().duration(E).attr("stroke-opacity",0),o.transition().duration(I).attr("stroke-opacity",0),l.transition().duration(I).attr("stroke-opacity",0),c.transition().duration(I).attr("stroke-opacity",0),h.transition().duration(I).attr("stroke-opacity",0),d.transition().duration(I).attr("fill-opacity",0),u.transition().duration(I).attr("fill-opacity",0),p.transition().duration(I).attr("fill-opacity",0),f.transition().duration(I).attr("fill-opacity",0),m.transition().duration(I).attr("fill-opacity",0),g.transition().duration(I).attr("fill-opacity",0),v.transition().duration(I).attr("fill-opacity",0),y.transition().duration(I).attr("fill-opacity",0),_.transition().duration(I).attr("fill-opacity",0),x.transition().duration(I).attr("fill-opacity",0),b.transition().duration(I).attr("fill-opacity",0),w.transition().duration(I).attr("fill-opacity",0),C.transition().duration(I).attr("fill-opacity",0),k.transition().duration(I).attr("fill-opacity",0),S.transition().duration(I).attr("fill-opacity",0))},drawNormalization(){it["C"](this.$refs.svg).selectAll("*").remove();const t=this.x,e=this.y,s=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${1.2*(this.height+this.margin.top+this.margin.bottom)}`),i=s.append("g").attr("transform",`translate(${1.2*this.margin.left}, ${1.5*this.margin.top})`),a=()=>{const s=e=>e.attr("transform",`translate(0, ${this.height})`).call(it["b"](t).tickSizeOuter(0));i.append("g").call(s).attr("font-size",20).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start");const a=t=>t.call(it["c"](e).ticks(5).tickFormat(it["j"](".0%")));i.append("g").call(a).attr("font-size",20)};a();const r=()=>{i.append("text").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("Fraction of instances"),i.append("text").attr("x",.4*this.width).attr("y",-100).attr("dy","1em").style("text-anchor","middle").style("font-size","32px").text("Instance Distribution")};r();const n=()=>{const t=this.width/6,e=this.margin.top/2,s=it["C"](this.$refs.svg).select("svg").append("g").attr("class","legend").attr("transform",`translate(\n              ${this.margin.left+.8*this.width},\n              ${e/3})`);s.append("rect").attr("width",t).attr("height",e/2).attr("fill",this.rightColor).style("visibility","visible"),s.append("rect").attr("y",e/2).attr("width",t).attr("height",e/2).attr("fill",this.wrongColor).style("visibility","visible"),s.append("rect").attr("y",e).attr("width",t).attr("height",e/2).attr("fill","lightgrey").style("visibility","visible"),s.append("rect").attr("y",1.5*e).attr("width",t).attr("height",e/2).attr("fill",this.rightColor).style("visibility","visible"),s.append("rect").attr("y",2*e).attr("width",t).attr("height",e/2).attr("fill",this.wrongColor).style("visibility","visible"),s.append("text").attr("transform",`translate(${t/2}, ${e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("tp").style("visibility","visible"),s.append("text").attr("transform",`translate(${t/2}, ${3*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("fn").style("visibility","visible"),s.append("text").attr("transform",`translate(${t/2}, ${5*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("uncertain").style("visibility","visible"),s.append("text").attr("transform",`translate(${t/2}, ${7*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("tn").style("visibility","visible"),s.append("text").attr("transform",`translate(${t/2}, ${9*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("fp").style("visibility","visible")};n();const o=()=>{const s=i.selectAll(".cell").data(this.continuousPredictionKeys).join("g").attr("class","cell").attr("transform",(function(e){return`translate(${t(e)}, 0)`}));this.svg=i;const a=t.bandwidth();s.append("rect").attr("class","bar-right-right-norm").attr("y",t=>e(1)).attr("width",(function(t){return a})).attr("height",t=>this.height/5).attr("fill",this.rightColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hoverNormalization={type:"right_right",classifier:t}).on("mouseleave",this.clearHoverNormalization).on("click",t=>this.select(t,"right_right","first")).on("contextmenu",t=>this.select(t,"right_right","second")),s.append("rect").attr("class","bar-right-wrong-norm").attr("y",t=>this.height/5).attr("width",(function(t){return a})).attr("height",t=>this.height/5).attr("fill",this.wrongColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hoverNormalization={type:"right_wrong",classifier:t}).on("mouseleave",this.clearHoverNormalization).on("click",t=>this.select(t,"right_wrong","first")).on("contextmenu",t=>this.select(t,"right_wrong","second")),s.append("rect").attr("class","bar-middle-yes-norm").attr("y",t=>this.height/5*2).attr("width",(function(t){return a})).attr("height",t=>this.height/5).attr("fill","lightgrey").attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hoverNormalization={type:"middle-yes",classifier:t}).on("mouseleave",this.clearHoverNormalization).on("click",t=>this.select(t,"middle-yes","first")).on("contextmenu",t=>this.select(t,"middle-yes","second")),s.append("rect").attr("class","bar-wrong-wrong-norm").attr("y",t=>this.height/5*3).attr("width",a).attr("height",t=>this.height/5).attr("fill",this.rightColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hoverNormalization={type:"wrong_wrong",classifier:t}).on("mouseleave",this.clearHoverNormalization).on("click",t=>this.select(t,"wrong_wrong","first")).on("contextmenu",t=>this.select(t,"wrong_wrong","second")),s.append("rect").attr("class","bar-wrong-right-norm").attr("y",t=>this.height/5*4).attr("width",a).attr("height",t=>this.height/5).attr("fill",this.wrongColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hoverNormalization={type:"wrong_right",classifier:t}).on("mouseleave",this.clearHoverNormalization).on("click",t=>this.select(t,"wrong_right","first")).on("contextmenu",t=>this.select(t,"wrong_right","second"))},l=()=>{i.append("line").attr("class","y-axis-marker-line-1-norm").attr("x2",this.width).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none"),i.append("line").attr("class","y-axis-marker-line-2-norm").attr("x2",this.width).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none"),i.append("line").attr("class","y-axis-marker-line-3-norm").attr("x2",this.width).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none"),i.append("line").attr("class","y-axis-marker-line-4-norm").attr("x2",this.width).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none")},c=()=>{i.append("rect").attr("class","y-axis-marker-rect-norm").attr("width","260").attr("height","150").attr("x",this.width-this.margin.right-250).attr("fill","white").attr("stroke","lightgrey").attr("stroke-width","2px").attr("pointer-events","none").transition().duration(1e3).attr("fill-opacity",0),i.append("text").attr("class","y-axis-marker-text-1-norm").attr("transform","translate("+(this.width-this.margin.right-250)+", 0)").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.rightHoverColor).attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-2-norm").attr("transform","translate("+(this.width-this.margin.right-250)+", 40)").attr("font-size",20).attr("fill","correctness"!=this.distribution_mode?this.wrongHoverColor:this.rightHoverColor).attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-3-norm").attr("transform","translate("+(this.width-this.margin.right-250)+", 70)").attr("font-size",20).attr("fill","grey").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-4-norm").attr("transform","translate("+(this.width-this.margin.right-250)+", 100)").attr("font-size",20).attr("fill","correctness"!=this.distribution_mode?this.rightHoverColor:this.wrongHoverColor).attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-5-norm").attr("transform","translate("+(this.width-this.margin.right-250)+", 130)").attr("font-size",20).attr("fill",this.wrongHoverColor).attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-1-s1-norm").attr("transform","translate("+(this.width-this.margin.right-160)+", 0)").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-2-s1-norm").attr("transform","translate("+(this.width-this.margin.right-160)+", 40)").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-3-s1-norm").attr("transform","translate("+(this.width-this.margin.right-160)+", 70)").attr("font-size",20).attr("fill","grey").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-4-s1-norm").attr("transform","translate("+(this.width-this.margin.right-160)+", 100)").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-5-s1-norm").attr("transform","translate("+(this.width-this.margin.right-160)+", 130)").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-1-s2-norm").attr("transform","translate("+(this.width-this.margin.right-70)+", 0)").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","red").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-2-s2-norm").attr("transform","translate("+(this.width-this.margin.right-70)+", 40)").attr("font-size",20).attr("fill","red").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-3-s2-norm").attr("transform","translate("+(this.width-this.margin.right-70)+", 70)").attr("font-size",20).attr("fill","grey").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-4-s2-norm").attr("transform","translate("+(this.width-this.margin.right-70)+", 100)").attr("font-size",20).attr("fill","red").attr("pointer-events","none"),i.append("text").attr("class","y-axis-marker-text-5-s2-norm").attr("transform","translate("+(this.width-this.margin.right-70)+", 130)").attr("font-size",20).attr("fill","red").attr("pointer-events","none")};o(),l(),c(),this.drawDistSelections(),this.drawHoverNormalization()},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${1.2*(this.height+this.margin.top+this.margin.bottom)}`),e=t.append("g").attr("transform",`translate(${1.2*this.margin.left}, ${1.5*this.margin.top})`),s=this.x,i=this.y,a=this.continuousClassifierName;if(0==Object.keys(this.thresholdRange).length){const t={};this.classifiers.forEach(e=>{t[a[e]]={name:e,threshold:Object.keys(this.classifierThresholdDict).includes(e)?this.classifierThresholdDict[e]:0,left_range:Object.keys(this.classifierThresholdDict).includes(e)?0==Object.keys(this.classifierBandWidthDict).length?this.classifierThresholdDict[e]/100-.05:this.classifierBandWidthDict[e].left_range:0,right_range:Object.keys(this.classifierThresholdDict).includes(e)?0==Object.keys(this.classifierBandWidthDict).length?this.classifierThresholdDict[e]/100+.05:this.classifierBandWidthDict[e].right_range:0}}),this.thresholdRange=t}for(let m in this.thresholdRange){let t=m.split("_"),e=m.substring(0,m.length-t[t.length-1].length-1),s=parseFloat(t[t.length-1]),i=this.thresholdRange[m].left_range,r=this.thresholdRange[m].right_range;if(s==this.classifierThresholdDict[e]/100)continue;let n=s-i,o=r-s;delete this.thresholdRange[m],this.thresholdRange[a[e]]={name:e,threshold:this.classifierThresholdDict[e],left_range:this.classifierThresholdDict[e]/100-n,right_range:this.classifierThresholdDict[e]/100+o}}const r=this.predictions,n=()=>{const t=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](s).tickSizeOuter(0));e.append("g").call(t).attr("font-size",20).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start");const a=t=>t.call(it["c"](i).ticks(5).tickFormat(it["j"](".0%")));e.append("g").call(a).attr("font-size",20)};n();const o=()=>{e.append("text").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("Fraction of instances"),e.append("text").attr("x",.4*this.width).attr("y",-100).attr("dy","1em").style("text-anchor","middle").style("font-size","32px").text("Instance Distribution")};o();const l=()=>{const t=this.width/6,e=this.margin.top/2,s=it["C"](this.$refs.svg).select("svg").append("g").attr("class","legend").attr("transform",`translate(\n              ${this.margin.left+.8*this.width},\n              ${e/3})`);s.append("rect").attr("width",t).attr("height",e/2).attr("fill",this.rightColor).style("visibility","visible"),s.append("rect").attr("y",e/2).attr("width",t).attr("height",e/2).attr("fill","score"==this.distribution_mode?this.wrongColor:this.rightColor).style("visibility","visible"),"correctness2"!=this.distribution_mode&&s.append("rect").attr("y",e).attr("width",t).attr("height",e/2).attr("fill","lightgrey").style("visibility","visible"),s.append("rect").attr("y","correctness2"!=this.distribution_mode?1.5*e:e).attr("width",t).attr("height",e/2).attr("fill","score"!=this.distribution_mode?this.wrongColor:this.rightColor).style("visibility","visible"),s.append("rect").attr("y","correctness2"!=this.distribution_mode?2*e:1.5*e).attr("width",t).attr("height",e/2).attr("fill",this.wrongColor).style("visibility","visible"),s.append("text").attr("transform",`translate(${t/2}, ${e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("tp").style("visibility","visible"),"correctness2"!=this.distribution_mode&&s.append("text").attr("transform",`translate(${t/2}, ${5*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("uncertain").style("visibility","visible"),s.append("text").attr("transform",`translate(${t/2}, ${3*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("score"!=this.distribution_mode?"tn":"fn").style("visibility","visible"),s.append("text").attr("transform","correctness2"!=this.distribution_mode?`translate(${t/2}, ${7*e/4})`:`translate(${t/2}, ${5*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("score"!=this.distribution_mode?"fn":"tn").style("visibility","visible"),s.append("text").attr("transform","correctness2"!=this.distribution_mode?`translate(${t/2}, ${9*e/4})`:`translate(${t/2}, ${7*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("fp").style("visibility","visible")},c=()=>{const t=this.width/6,e=this.margin.top/2,s=[1,2],i=it["C"](this.$refs.svg).select("svg").append("g").attr("class","legend").attr("transform",`translate(\n                ${this.margin.left+.8*this.width},\n                ${e/3})`);s.forEach(s=>{const i=it["C"](this.$refs.svg).select("svg").append("g").attr("class","legend").attr("transform",`translate(\n                ${this.margin.left+.8*this.width+s*t*.28},\n                ${e/3})`);i.append("text").attr("transform",`translate(${t/8}, -10)`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("s"+s).style("visibility","visible"),i.append("rect").attr("width",t/4).attr("height",e/2).attr("fill",1==s?this.selection1Right:this.selection2Right).style("visibility","visible"),i.append("rect").attr("y",e/2).attr("width",t/4).attr("height",e/2).attr("fill",1==s?this.selection1Wrong:this.selection2Wrong).style("visibility","visible"),i.append("rect").attr("y",e).attr("width",t/4).attr("height",e/2).attr("fill",1==s?this.selection1mid:this.selection2mid).style("visibility","visible"),i.append("rect").attr("y",1.5*e).attr("width",t/4).attr("height",e/2).attr("fill",1==s?this.selection1Right:this.selection2Right).style("visibility","visible"),i.append("rect").attr("y",2*e).attr("width",t/4).attr("height",e/2).attr("fill",1==s?this.selection1Wrong:this.selection2Wrong).style("visibility","visible")}),i.append("text").attr("transform",`translate(0, ${e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("tp").style("visibility","visible"),i.append("text").attr("transform",`translate(0, ${3*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("fp").style("visibility","visible"),i.append("text").attr("transform",`translate(0, ${5*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("uncertain").style("visibility","visible"),i.append("text").attr("transform",`translate(0, ${7*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("tn").style("visibility","visible"),i.append("text").attr("transform",`translate(0, ${9*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("fn").style("visibility","visible")};"overall"==this.selection_mode?l():c();const h=()=>{const t=e.selectAll(".cell").data(this.continuousPredictionKeys).join("g").attr("class","cell").attr("transform",(function(t){return`translate(${s(t)}, 0)`}));this.svg=e;const a=s.bandwidth();t.append("rect").attr("class","bar-right-right").attr("y",t=>i(1)).attr("width",(function(t){return a})).attr("height",t=>this.height-i(r[t].tp/r[t].total_size)).attr("fill",this.rightColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_right",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"right_right","first")).on("contextmenu",t=>this.select(t,"right_right","second")),t.append("rect").attr("class","bar-right-wrong").attr("y",t=>this.height-i(r[t].tp/r[t].total_size)).attr("width",(function(t){return a})).attr("height",t=>this.height-i(r[t].fn/r[t].total_size)).attr("fill",this.wrongColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"right_wrong","first")).on("contextmenu",t=>this.select(t,"right_wrong","second")),t.append("rect").attr("class","bar-wrong-wrong").attr("y",t=>this.height-i((r[t].right_size+r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size)).attr("width",a).attr("height",t=>this.height-i(r[t].tn/r[t].total_size)).attr("fill",this.rightColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong_wrong","first")).on("contextmenu",t=>this.select(t,"wrong_wrong","second")),t.append("rect").attr("class","bar-wrong-right").attr("y",t=>i(r[t].fp/r[t].total_size)).attr("width",a).attr("height",t=>this.height-i(r[t].fp/r[t].total_size)).attr("fill",this.wrongColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_right",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong_right","first")).on("contextmenu",t=>this.select(t,"wrong_right","second")),t.append("rect").attr("class","bar-middle-yes").attr("y",t=>this.height-i(r[t].right_size/r[t].total_size)).attr("width",(function(t){return a})).attr("height",t=>this.height-i((r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size)).attr("fill","lightgrey").attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"middle-yes",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"middle-yes","first")).on("contextmenu",t=>this.select(t,"middle-yes","second")),t.append("circle").attr("class","bar-right-right-circle").attr("cx",a/2-a/4).attr("cy",t=>i(1)+a/8).attr("r",a/8).attr("fill",this.rightColor).attr("stroke","grey").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_right",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"right_right","first")).on("contextmenu",t=>this.select(t,"right_right","second")).attr("visibility",t=>this.height-i(r[t].tp/r[t].total_size)>0&&this.height-i(r[t].tp/r[t].total_size)<a/4?"visible":"hidden"),t.append("circle").attr("class","bar-right-wrong-circle").attr("cx",a/2).attr("cy",t=>this.height-i(r[t].tp/r[t].total_size)+a/8).attr("r",a/8).attr("fill",this.wrongColor).attr("stroke","grey").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"right_wrong","first")).on("contextmenu",t=>this.select(t,"right_wrong","second")).attr("visibility",t=>this.height-i(r[t].fn/r[t].total_size)>0&&this.height-i(r[t].fn/r[t].total_size)<a/4?"visible":"hidden"),t.append("circle").attr("class","bar-wrong-wrong-circle").attr("cx",a/2-a/4).attr("cy",t=>this.height-i((r[t].right_size+r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size)+a/8).attr("r",a/8).attr("fill",this.rightColor).attr("stroke","grey").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong_wrong","first")).on("contextmenu",t=>this.select(t,"wrong_wrong","second")).attr("visibility",t=>this.height-i(r[t].tn/r[t].total_size)>0&&this.height-i(r[t].tn/r[t].total_size)<a/4?"visible":"hidden"),t.append("circle").attr("class","bar-wrong-right-circle").attr("cx",a/2).attr("cy",t=>i(0)-a/8).attr("r",a/8).attr("fill",this.wrongColor).attr("stroke","grey").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_right",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong_right","first")).on("contextmenu",t=>this.select(t,"wrong_right","second")).attr("visibility",t=>this.height-i(r[t].fp/r[t].total_size)>0&&this.height-i(r[t].fp/r[t].total_size)<a/4?"visible":"hidden"),t.append("circle").attr("class","bar-middle-yes-circle").attr("cx",a/2+a/4).attr("cy",t=>this.height-i((r[t].right_size+r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size)-a/8).attr("r",a/8).attr("fill","lightgrey").attr("stroke","grey").style("paint-order","stroke").attr("visibility",t=>this.height-i((r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size)>0&&this.height-i((r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size)<a/4?"visible":"hidden").on("mouseenter",t=>this.hover={type:"middle-yes",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"middle-yes","first")).on("contextmenu",t=>this.select(t,"middle-yes","second"))},d=()=>{const t=e.selectAll(".cell").data(this.continuousPredictionKeys).join("g").attr("class","cell").attr("transform",(function(t){return`translate(${s(t)}, 0)`}));this.svg=e;const a=s.bandwidth();t.append("rect").attr("class","bar-right-right").attr("y",t=>i(1)).attr("width",(function(t){return a})).attr("height",t=>"correctness"==this.distribution_mode?this.height-i(r[t].tp/r[t].total_size):this.height-i((r[t].tp+r[t].m_tp)/r[t].total_size)).attr("fill",this.rightColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_right",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"right_right","first")).on("contextmenu",t=>this.select(t,"right_right","second")),t.append("rect").attr("class","bar-wrong-wrong").attr("y",t=>"correctness"==this.distribution_mode?this.height-i(r[t].tp/r[t].total_size):this.height-i((r[t].tp+r[t].m_tp)/r[t].total_size)).attr("width",a).attr("height",t=>"correctness"==this.distribution_mode?this.height-i(r[t].tn/r[t].total_size):this.height-i((r[t].tn+r[t].m_tn)/r[t].total_size)).attr("fill",this.rightColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong_wrong","first")).on("contextmenu",t=>this.select(t,"wrong_wrong","second")),t.append("rect").attr("class","bar-right-wrong").attr("y",t=>"correctness"==this.distribution_mode?this.height-i((r[t].tp+r[t].tn+r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size):this.height-i((r[t].tp+r[t].tn+r[t].m_tp+r[t].m_tn)/r[t].total_size)).attr("width",(function(t){return a})).attr("height",t=>"correctness"==this.distribution_mode?this.height-i(r[t].fn/r[t].total_size):this.height-i((r[t].fn+r[t].m_fp)/r[t].total_size)).attr("fill",this.wrongColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"right_wrong","first")).on("contextmenu",t=>this.select(t,"right_wrong","second")),t.append("rect").attr("class","bar-wrong-right").attr("y",t=>"correctness"==this.distribution_mode?i(r[t].fp/r[t].total_size):i((r[t].fp+r[t].m_fn)/r[t].total_size)).attr("width",a).attr("height",t=>"correctness"==this.distribution_mode?this.height-i(r[t].fp/r[t].total_size):this.height-i((r[t].fp+r[t].m_fn)/r[t].total_size)).attr("fill",this.wrongColor).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_right",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong_right","first")).on("contextmenu",t=>this.select(t,"wrong_right","second")),"correctness"==this.distribution_mode&&t.append("rect").attr("class","bar-middle-yes").attr("y",t=>this.height-i((r[t].tp+r[t].tn)/r[t].total_size)).attr("width",(function(t){return a})).attr("height",t=>this.height-i((r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size)).attr("fill","lightgrey").attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"middle-yes",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"middle-yes","first")).on("contextmenu",t=>this.select(t,"middle-yes","second")),t.append("circle").attr("class","bar-right-right-circle").attr("cx",a/2-a/4).attr("cy",t=>i(1)+a/8).attr("r",a/8).attr("fill",this.rightColor).attr("stroke","grey").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_right",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"right_right","first")).on("contextmenu",t=>this.select(t,"right_right","second")).attr("visibility",t=>this.height-i(r[t].tp/r[t].total_size)>0&&this.height-i(r[t].tp/r[t].total_size)<a/4?"visible":"hidden"),t.append("circle").attr("class","bar-right-wrong-circle").attr("cx",a/2-a/4).attr("cy",t=>"correctness"==this.distribution_mode?this.height-i((r[t].tp+r[t].tn+r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size):this.height-i((r[t].tp+r[t].tn+r[t].m_tp+r[t].m_tn)/r[t].total_size)).attr("r",a/8).attr("fill",this.wrongColor).attr("stroke","grey").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"right_wrong","first")).on("contextmenu",t=>this.select(t,"right_wrong","second")).attr("visibility",t=>this.height-i(r[t].fn/r[t].total_size)>0&&this.height-i(r[t].fn/r[t].total_size)<a/4?"visible":"hidden"),t.append("circle").attr("class","bar-wrong-wrong-circle").attr("cx",a/2).attr("cy",t=>"correctness"==this.distribution_mode?this.height-i(r[t].tp/r[t].total_size):this.height-i((r[t].tp+r[t].m_tp)/r[t].total_size)).attr("r",a/8).attr("fill",this.rightColor).attr("stroke","grey").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_wrong",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong_wrong","first")).on("contextmenu",t=>this.select(t,"wrong_wrong","second")).attr("visibility",t=>this.height-i(r[t].tn/r[t].total_size)>0&&this.height-i(r[t].tn/r[t].total_size)<a/4?"visible":"hidden"),t.append("circle").attr("class","bar-wrong-right-circle").attr("cx",a/2).attr("cy",t=>i(0)-a/8).attr("r",a/8).attr("fill",this.wrongColor).attr("stroke","grey").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_right",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"wrong_right","first")).on("contextmenu",t=>this.select(t,"wrong_right","second")).attr("visibility",t=>this.height-i(r[t].fp/r[t].total_size)>0&&this.height-i(r[t].fp/r[t].total_size)<a/4?"visible":"hidden"),"correctness"==this.distribution_mode&&t.append("circle").attr("class","bar-middle-yes-circle").attr("cx",a/2+a/4).attr("cy",t=>this.height-i((r[t].tp+r[t].tn)/r[t].total_size)).attr("r",a/8).attr("fill","lightgrey").attr("stroke","grey").style("paint-order","stroke").attr("visibility",t=>this.height-i((r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size)>0&&this.height-i((r[t].middle_right_size+r[t].middle_wrong_size)/r[t].total_size)<a/4?"visible":"hidden").on("mouseenter",t=>this.hover={type:"middle-yes",classifier:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"middle-yes","first")).on("contextmenu",t=>this.select(t,"middle-yes","second"))},u=()=>{const t=e.selectAll(".cell").data(this.continuousPredictionKeys).join("g").attr("class","cell").attr("transform",(function(t){return`translate(${s(t)}, 0)`})),a=s.bandwidth(),{first:n,second:o}=this.selections,l=this.continuousPredictionKeys;let c=[];function h(t){const e="1"==t?n.instances:o.instances;let s={};return l.forEach(i=>{let a=Lt(e,r[i].right_right),n=Lt(e,r[i].right_wrong),o=Lt(e,r[i].wrong_wrong),l=Lt(e,r[i].wrong_right),c=Lt(e,r[i].middle_right),h=Lt(e,r[i].middle_wrong),d=Lt(e,r[i].right),u=Lt(e,r[i].wrong);s[i]={right_right:a,right_wrong:n,wrong_wrong:o,wrong_right:l,middle_right:c,middle_wrong:h,right:d,wrong:u,selected_type:t}}),s}n&&c.push(h("1")),o&&c.push(h("2")),t.append("rect").attr("class","bar-right-right").attr("y",t=>i(1)).attr("width",(function(t){return a})).attr("height",t=>this.height-i(r[t].tp/this.instances.length)).attr("fill",this.rightColor).attr("opacity",.5).on("mouseenter",t=>this.hover={type:"right_right",classifier:t}).on("mouseleave",this.clearHover),t.append("rect").attr("class","bar-right-wrong").attr("y",t=>this.height-i(r[t].tp/this.instances.length)).attr("width",(function(t){return a})).attr("height",t=>this.height-i(r[t].fn/this.instances.length)).attr("fill",this.wrongColor).attr("opacity",.5).on("mouseenter",t=>this.hover={type:"right_wrong",classifier:t}).on("mouseleave",this.clearHover),t.append("rect").attr("class","bar-wrong-wrong").attr("y",t=>this.height-i((r[t].right_size+r[t].middle_right_size+r[t].middle_wrong_size)/this.instances.length)).attr("width",a).attr("height",t=>this.height-i(r[t].tn/this.instances.length)).attr("fill",this.rightColor).attr("opacity",.5).on("mouseenter",t=>this.hover={type:"wrong_wrong",classifier:t}).on("mouseleave",this.clearHover),t.append("rect").attr("class","bar-wrong-right").attr("y",t=>i(r[t].fp/this.instances.length)).attr("width",a).attr("height",t=>this.height-i(r[t].fp/this.instances.length)).attr("fill",this.wrongColor).attr("opacity",.5).on("mouseenter",t=>this.hover={type:"wrong_right",classifier:t}).on("mouseleave",this.clearHover),t.append("rect").attr("class","bar-middle-yes").attr("y",t=>this.height-i(r[t].right_size/this.instances.length)).attr("width",(function(t){return a})).attr("height",t=>this.height-i((r[t].middle_right_size+r[t].middle_wrong_size)/this.instances.length)).attr("fill","lightgrey").style("paint-order","stroke").style("opacity",.5).on("mouseenter",t=>this.hover={type:"middle-yes",classifier:t}).on("mouseleave",this.clearHover),c.forEach(e=>{t.append("rect").attr("class","bar-right-right").attr("x",t=>"1"==e[t].selected_type?a/4:a/2).attr("y",t=>i((e[t].wrong.size+e[t].middle_right.size+e[t].middle_wrong.size+e[t].right_wrong.size+e[t].right_right.size)/this.instances.length)).attr("width",(function(t){return a/4})).attr("height",t=>this.height-i(e[t].right_right.size/this.instances.length)).attr("fill",t=>"1"==e[t].selected_type?this.selection1Right:this.selection2Right).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_right",selection:e[t].selected_type,classifier:t}).on("mouseleave",this.clearHover),t.append("rect").attr("class","bar-right-wrong").attr("x",t=>"1"==e[t].selected_type?a/4:a/2).attr("y",t=>i((e[t].wrong.size+e[t].middle_right.size+e[t].middle_wrong.size+e[t].right_wrong.size)/this.instances.length)).attr("width",(function(t){return a/4})).attr("height",t=>this.height-i(e[t].right_wrong.size/this.instances.length)).attr("fill",t=>"1"==e[t].selected_type?this.selection1Wrong:this.selection2Wrong).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"right_wrong",selection:e[t].selected_type,classifier:t}).on("mouseleave",this.clearHover),t.append("rect").attr("class","bar-wrong-wrong").attr("x",t=>"1"==e[t].selected_type?a/4:a/2).attr("y",t=>i((e[t].wrong_right.size+e[t].wrong_wrong.size)/this.instances.length)).attr("width",a/4).attr("height",t=>this.height-i(e[t].wrong_wrong.size/this.instances.length)).attr("fill",t=>"1"==e[t].selected_type?this.selection1Right:this.selection2Right).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_wrong",selection:e[t].selected_type,classifier:t}).on("mouseleave",this.clearHover),t.append("rect").attr("class","bar-wrong-right").attr("x",t=>"1"==e[t].selected_type?a/4:a/2).attr("y",t=>i(e[t].wrong_right.size/this.instances.length)).attr("width",a/4).attr("height",t=>this.height-i(e[t].wrong_right.size/this.instances.length)).attr("fill",t=>"1"==e[t].selected_type?this.selection1Wrong:this.selection2Wrong).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"wrong_right",selection:e[t].selected_type,classifier:t}).on("mouseleave",this.clearHover),t.append("rect").attr("class","bar-middle-yes").attr("x",t=>"1"==e[t].selected_type?a/4:a/2).attr("y",t=>i((e[t].wrong.size+e[t].middle_right.size+e[t].middle_wrong.size)/this.instances.length)).attr("width",(function(t){return a/4})).attr("height",t=>this.height-i((e[t].middle_right.size+e[t].middle_wrong.size)/this.instances.length)).attr("fill",t=>"1"==e[t].selected_type?this.selection1mid:this.selection2mid).attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"middle-yes",selection:e[t].selected_type,classifier:t}).on("mouseleave",this.clearHover)})},p=()=>{e.append("line").attr("class","y-axis-marker-line-1").attr("y1",i(1)).attr("x2",this.width).attr("y2",i(1)).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("opacity","0.5").attr("pointer-events","none"),e.append("line").attr("class","y-axis-marker-line-2").attr("y1",i(1)).attr("x2",this.width).attr("y2",i(1)).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("opacity","0.5").attr("pointer-events","none"),e.append("line").attr("class","y-axis-marker-line-3").attr("y1",i(1)).attr("x2",this.width).attr("y2",i(1)).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("opacity","0.5").attr("pointer-events","none"),e.append("line").attr("class","y-axis-marker-line-4").attr("y1",i(1)).attr("x2",this.width).attr("y2",i(1)).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("opacity","0.5").attr("pointer-events","none")},f=()=>{e.append("rect").attr("class","y-axis-marker-rect").attr("width","260").attr("height","150").attr("x",this.width-this.margin.right-250).attr("fill","white").attr("stroke","lightgrey").attr("stroke-width","2px").attr("pointer-events","none").transition().duration(1e3).attr("fill-opacity",0),e.append("text").attr("class","y-axis-marker-text-1").attr("transform","translate("+(this.width-this.margin.right-250)+", 0)").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.rightHoverColor).attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-2").attr("transform","translate("+(this.width-this.margin.right-250)+", 40)").attr("font-size",20).attr("fill","score"==this.distribution_mode?this.wrongHoverColor:this.rightHoverColor).attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-3").attr("transform","translate("+(this.width-this.margin.right-250)+", 70)").attr("font-size",20).attr("fill","grey").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-4").attr("transform","translate("+(this.width-this.margin.right-250)+", 100)").attr("font-size",20).attr("fill","score"==this.distribution_mode?this.rightHoverColor:this.wrongHoverColor).attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-5").attr("transform","translate("+(this.width-this.margin.right-250)+", 130)").attr("font-size",20).attr("fill",this.wrongHoverColor).attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-1-s1").attr("transform","translate("+(this.width-this.margin.right-160)+", 0)").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-2-s1").attr("transform","translate("+(this.width-this.margin.right-160)+", 40)").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-3-s1").attr("transform","translate("+(this.width-this.margin.right-160)+", 70)").attr("font-size",20).attr("fill","grey").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-4-s1").attr("transform","translate("+(this.width-this.margin.right-160)+", 100)").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-5-s1").attr("transform","translate("+(this.width-this.margin.right-160)+", 130)").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-1-s2").attr("transform","translate("+(this.width-this.margin.right-70)+", 0)").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","red").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-2-s2").attr("transform","translate("+(this.width-this.margin.right-70)+", 40)").attr("font-size",20).attr("fill","red").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-3-s2").attr("transform","translate("+(this.width-this.margin.right-70)+", 70)").attr("font-size",20).attr("fill","grey").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-4-s2").attr("transform","translate("+(this.width-this.margin.right-70)+", 100)").attr("font-size",20).attr("fill","red").attr("pointer-events","none"),e.append("text").attr("class","y-axis-marker-text-5-s2").attr("transform","translate("+(this.width-this.margin.right-70)+", 130)").attr("font-size",20).attr("fill","red").attr("pointer-events","none")};"overall"==this.selection_mode?"score"==this.distribution_mode?(h(),this.drawSelections()):(d(),this.drawSelections()):u(),p(),f(),this.drawHover()},drawDistSelections(){it["C"](this.$refs.svg),it["j"](".1f");const t=this.x.bandwidth()/8,{first:e,second:s}=this.selections,i=this.predictions,a=(t,e,s)=>{const a=i[t][e];i[t].total_size;const r=Lt(a,s),n=0==a.size?0:r.size/a.size;return this.y(n)},r=(t,e,s)=>{i[t][e];return(this.height-a(t,e,s))/5},n=(t,e,s)=>{const a=i[t][e];i[t].total_size;const r=Lt(a,s),n=0==a.size?0:r.size/a.size;return(this.height-this.y(n))/5},o=(t,e,s)=>{const a=new Set([...i[t].middle_right]),r=new Set([...i[t].middle_wrong]);i[t].total_size;const n=Lt(a,s),o=Lt(r,s),l=a.size+r.size==0?0:(n.size+o.size)/(a.size+r.size);return(this.height-this.y(l))/5},l=this.x,c=this.y,h=l.bandwidth(),d=l.bandwidth()/8,u=["right_right","right_wrong","wrong_wrong","wrong_right","middle"],p=[e,s];p.forEach((e,s)=>{e?this.continuousPredictionKeys.forEach(i=>{u.forEach((a,u)=>{let p={barCells:this.svg,x:l(i)+h/2+(s-1)*d,y:"right_right"==a?c(1):"right_wrong"==a?this.height/5:"wrong_wrong"==a?this.height/5*3:"wrong_right"==a?this.height/5*4:this.height/5*2,width:d,height:"right_right"==a||"right_wrong"==a?r(i,a,e.instances):"wrong_wrong"==a||"wrong_right"==a?n(i,a,e.instances):o(i,a,e.instances),r:d/2,color:0==s?this.selection1Color:this.selection2Color,circle_visibility:("right_right"==a||"right_wrong"==a)&&r(i,a,e.instances)>0&&r(i,a,e.instances)<t||("wrong_wrong"==a||"wrong_right"==a)&&n(i,a,e.instances)>0&&n(i,a,e.instances)<t||o(i,a,e.instances)>0&&o(i,a,e.instances)<t?"visible":"hidden",cx:l(i)+h/2+(s-.5)*d,cy:"right_right"==a?c(1):"right_wrong"==a?this.height/5:"wrong_wrong"==a?this.height/5*3:"wrong_right"==a?this.height/5*4:this.height/5*2,selection_type:s,view_name:this.name};this.$store.dispatch("drawSelections",p)})}):(this.svg.selectAll("selection-rect-"+s).attr("height","0"),this.svg.selectAll("selection-circle-"+s).attr("visibility","hidden"))})},drawSelections(){it["C"](this.$refs.svg),it["j"](".1f");const t=this.x.bandwidth()/8,{first:e,second:s}=this.selections,i=this.predictions;let a={},r=[...this.$store.getters.filteredInstances],n=this.$store.state.selectionHistory;r.forEach(t=>{a[t]=1}),"weighted"==this.weightedPerformance&&n.forEach(t=>{let e=[...t.instances],s=parseFloat(t.weight.toString());e.forEach(t=>{a[t]+=s})});const o=t=>{let e=0;return t.forEach(t=>{e+=a[t]}),e},l=(t,e,s)=>{const a=i[t][e],r=new Set(this.instances),n=Lt(a,s),l=o([...n])/o([...r]);return this.y(l)},c=(t,e,s)=>{i[t][e];return this.height-l(t,e,s)},h=(t,e,s)=>{const a=i[t][e],r=new Set(this.instances),n=Lt(a,s),l=o([...n])/o([...r]);return this.height-this.y(l)},d=(t,e,s)=>{const a=new Set([...i[t].middle_right]),r=new Set([...i[t].middle_wrong]),n=new Set(this.instances),l=Lt(a,s),c=Lt(r,s),h=(o([...l])+o([...c]))/o([...n]);return this.height-this.y(h)},u=this.x,p=this.y,f=u.bandwidth(),m=u.bandwidth()/8,g=["right_right","right_wrong","wrong_wrong","wrong_right","middle"],v=[e,s];v.forEach((e,s)=>{e?this.continuousPredictionKeys.forEach(a=>{g.forEach((r,n)=>{let o="hidden";"middle"!=r?"right_right"==r||"right_wrong"==r?c(a,r,e.instances)>0&&c(a,r,e.instances)<t&&(o="visible"):"wrong_wrong"!=r&&"wrong_right"!=r||h(a,r,e.instances)>0&&h(a,r,e.instances)<t&&(o="visible"):d(a,r,e.instances)>0&&d(a,r,e.instances)<t&&(o="visible");let l={barCells:this.svg,x:u(a)+f/2+(s-1)*m,y:"right_right"==r?p(1):"right_wrong"==r&&"score"==this.distribution_mode?this.height-p(i[a].tp/i[a].total_size):"right_wrong"==r&&"score"!=this.distribution_mode?this.height-p((i[a].tp+i[a].tn+i[a].middle_right_size+i[a].middle_wrong_size)/i[a].total_size):"wrong_wrong"==r&&"score"==this.distribution_mode?this.height-p((i[a].right_size+i[a].middle_right_size+i[a].middle_wrong_size)/i[a].total_size):"wrong_wrong"==r&&"score"!=this.distribution_mode?this.height-p(i[a].tp/i[a].total_size):"wrong_right"==r?p(i[a].fp/i[a].total_size):"middle"==r&&"score"==this.distribution_mode?this.height-p(i[a].right_size/i[a].total_size):this.height-p((i[a].tp+i[a].tn)/i[a].total_size),width:m,height:"right_right"==r||"right_wrong"==r?c(a,r,e.instances):"wrong_wrong"==r||"wrong_right"==r?h(a,r,e.instances):d(a,r,e.instances),r:m/2,color:0==s?this.selection1Color:this.selection2Color,circle_visibility:o,cx:u(a)+f/2+(s-.5)*m,cy:"right_right"==r?p(1):"right_wrong"==r&&"score"==this.distribution_mode?this.height-p(i[a].tp/i[a].total_size):"right_wrong"==r&&"score"!=this.distribution_mode?this.height-p((i[a].tp+i[a].tn+i[a].middle_right_size+i[a].middle_wrong_size)/i[a].total_size):"wrong_wrong"==r&&"score"==this.distribution_mode?this.height-p((i[a].right_size+i[a].middle_right_size+i[a].middle_wrong_size)/i[a].total_size):"wrong_wrong"==r&&"score"!=this.distribution_mode?this.height-p(i[a].tp/i[a].total_size):"wrong_right"==r?p(i[a].fp/i[a].total_size):"middle"==r&&"score"==this.distribution_mode?this.height-p(i[a].right_size/i[a].total_size):this.height-p((i[a].tp+i[a].tn)/i[a].total_size),selection_type:s,view_name:this.name};this.$store.dispatch("drawSelections",l)})}):(this.svg.selectAll("selection-rect-"+s).attr("height","0"),this.svg.selectAll("selection-circle-"+s).attr("visibility","hidden"))})},select(t,e,s){it["i"].preventDefault(),it["i"].stopPropagation();const i=nt();i.rule=X.RIGHT,i.classifier=t,i.negation="wrong"===e;let a=this.predictions,r=a[t][e];"middle-yes"==e&&(r=new Set([...a[t].middle_right].concat([...a[t].middle_wrong])));const n={right_right:"tp",right_wrong:"fn",wrong_wrong:"tn",wrong_right:"fp"},o=`Instances which ${t} got ${n[e]}`,l={type:"simple",constraints:[i],metric:[]},c={description:o,instances:r,predicate:l};this.$store.dispatch("prependToSelectionHistory",c),this.$store.dispatch("changedMostRecentSelection",s)}}}),Se=ke,ze=(s("eeeb"),Object(m["a"])(Se,we,Ce,!1,null,"72316b6c",null)),$e=ze.exports;v()(ze,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"],VSwitch:pe["a"]});var Fe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("(Trinary) Bandwidth Assessment")])],1)]),s("v-expansion-panel-content",[s("v-radio-group",{attrs:{label:"Evaluation method"},model:{value:t.evaluationSelection,callback:function(e){t.evaluationSelection=e},expression:"evaluationSelection"}},[s("v-radio",{attrs:{label:"accuracy",value:"accuracy"}}),s("v-radio",{attrs:{id:"mcc",label:"mcc",value:"mcc"}}),s("v-radio",{attrs:{label:"f1",value:"f1"}}),s("v-radio",{attrs:{label:"precision",value:"precision"}}),s("v-radio",{attrs:{label:"recall",value:"recall"}})],1)],1)],1)],1),s("multiselect",{attrs:{options:t.options,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pick sets",label:"name","track-by":"name","preselect-first":!0},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.values,a=e.isOpen;return[i.length&&!a?s("span",{staticClass:"multiselect__single"},[t._v(" "+t._s(i.length)+" options selected ")]):t._e()]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),s("div",{ref:"svg"})],1)},Te=[],Ee=i["a"].extend({name:"Trinary_Bandwidth_Assessment",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:150,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i={type:"",classifier:"",selectedClassifier:""},a={classifier:"",threshold:""},r="accuracy",n={type:"",classifier:"",threshold:.5,value:0,left_diff:.05,right_diff:.05},o={bandwidth:""},l={threshold:""},c={threshold:""},h=[...this.boxProps.classifiers][3],d=["0.00","0.10","0.20","0.30","0.40","0.50","0.60","0.70","0.80","0.90","1.00"],u=["rgb(37,102,118)","rgb(138,225,249)"],p=["rgb(181,29,73)","rgb(251,137,155)"],f=["rgb(64,57,150)","rgb(119,136,153)"],m={left:.05,right:.05},g={left:.05,right:.05},v="",y=[m];return{currentRemovedbandwidth:v,barHover:l,evaluationSelection:r,accHover:c,bandwidthHover:o,leftThreshold:0,rightThreshold:1,streamData:{},currentBandwidth:g,currentSetbandwidth:m,withinClassifierBandwidths:y,value:[],height:s,click:a,hover:i,thresholdRangeChange:n,margin:t,panel:[],rightColor:"#d1e5f0",rightHoverColor:"#4393c3",selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e,wrongColor:"#fddbc7",wrongHoverColor:"#d6604d",classNumber:[...this.boxProps.classes].length,curveClassifier:h,numberOfBins:11,thresholds:d,thresholdRangeRecords:{},upperColors:u,middleColors:f,lowerColors:p}},computed:{addedBandWidthClassifiers(){return this.$store.state.addedBandWidthClassifiers},confidenceIndex(){let t={};for(let e in this.thresholds)t[this.thresholds[e]]=parseInt(e);return t},options(){let t=[];const e=this.classifiers;return e.forEach(e=>{t.push({name:e})}),t},classifierThresholds(){return this.$store.state.classifierThresholdDict},classifierBandWidthDict(){return this.boxProps.classifierBandWidthDict},classes(){return this.classNumber=[...this.boxProps.classes].length,[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},thresholdClassifierNameList(){return this.$store.state.thresholdClassifierNameList},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},predictionKeys(){const t=this.classifiers.slice();return t},continuousPredictionKeys(){if("continuous"==this.$store.state.datasetType){var t=[];return this.predictionKeys.forEach(e=>{t.push(e+"_"+this.$store.state.classifierThresholdDict[e]/100)}),t}return this.predictionKeys},continuousClassifierName(){var t={};return this.classifiers.forEach(e=>{"continuous"==this.$store.state.datasetType?t[e]=e+"_"+this.$store.state.classifierThresholdDict[e]/100:t[e]=e}),t},thresholdRange(){const t={};return this.classifiers.forEach(e=>{t[this.continuousClassifierName[e]]={name:e,threshold:Object.keys(this.classifierThresholds).includes(e)?this.classifierThresholds[e]:0,left_range:Object.keys(this.classifierThresholds).includes(e)?this.classifierThresholds[e]/100-.05:0,right_range:Object.keys(this.classifierThresholds).includes(e)?this.classifierThresholds[e]/100+.05:0}}),t},accumulations(){const t={};var e=[];return this.classifiers.forEach(s=>{t[s]={name:s,threshold:Object.keys(this.classifierThresholds).includes(s)?this.classifierThresholds[s]:0,acc:0,ci_tp:[],ci_fn:[],ci_tn:[],ci_fp:[],ci_m:[],ci_m_y:[],ci_m_n:[],ci_tp_instances:{},ci_fp_instances:{},ci_tn_instances:{},ci_fn_instances:{},middle_instances:{},middle_y_instances:{},middle_n_instances:{},continuous_pred:{}},this.thresholds.forEach(e=>{t[s]["ci_tp_instances"][e]={instances:new Set},t[s]["ci_tn_instances"][e]={instances:new Set},t[s]["ci_fp_instances"][e]={instances:new Set},t[s]["ci_fn_instances"][e]={instances:new Set},t[s]["middle_instances"][e]={instances:new Set},t[s]["middle_y_instances"][e]={instances:new Set},t[s]["middle_n_instances"][e]={instances:new Set},t[s]["continuous_pred"][e]={instances:new Set}}),this.thresholds.forEach(e=>{let i=parseFloat(e)-this.currentSetbandwidth.left<0?0:parseFloat(e)+(parseFloat(e)-this.currentSetbandwidth.left),a=parseFloat(e)-this.currentSetbandwidth.right>1?1:parseFloat(e)+(parseFloat(e)+this.currentSetbandwidth.right);this.instances.forEach(r=>{let n=Nt(r).continuous_predictions[s],o=n<=e?this.classes[0]:this.classes[1],l=Nt(r).actual==o?1:0,c=e;n>i&&n<a?(t[s]["middle_instances"][e].instances.add(r),t[s].continuous_pred[e].instances.add(parseFloat(n)),1==l?t[s]["middle_y_instances"][e].instances.add(r):t[s]["middle_n_instances"][e].instances.add(r)):n>=a?Nt(r).actual==this.classes[1]?t[s]["ci_tp_instances"][c].instances.add(r):t[s]["ci_fp_instances"][c].instances.add(r):Nt(r).actual==this.classes[0]?t[s]["ci_tn_instances"][c].instances.add(r):t[s]["ci_fn_instances"][c].instances.add(r)})}),this.thresholds.forEach(i=>{t[s]["ci_tp"].push(t[s]["ci_tp_instances"][i].instances.size),t[s]["ci_tn"].push(t[s]["ci_tn_instances"][i].instances.size),t[s]["ci_fp"].push(t[s]["ci_fp_instances"][i].instances.size),t[s]["ci_fn"].push(t[s]["ci_fn_instances"][i].instances.size),t[s]["ci_m"].push(t[s]["middle_instances"][i].instances.size),t[s]["ci_m_y"].push(t[s]["middle_y_instances"][i].instances.size),t[s]["ci_m_n"].push(t[s]["middle_n_instances"][i].instances.size),e.push(t[s]["ci_tn_instances"][i].instances.size+t[s]["ci_tp_instances"][i].instances.size+t[s]["ci_fn_instances"][i].instances.size+t[s]["ci_fp_instances"][i].instances.size)})}),t},selections(){return this.$store.state.overlapSelections},yThreshold(){const t=it["y"]().domain(["mcc"==this.evaluationSelection?-1:0,1]).range([this.height,0]);return t},x(){const t=it["x"]().domain(this.continuousPredictionKeys).range([0,.8*this.width]).paddingOuter(1).paddingInner(.3);return t},y(){const t=it["y"]().domain([0,1]).range([this.height,0]);return t},xScale(){const t=it["y"]().domain([0,200]).range([0,200]).clamp(!0);return t},saveStatus(){return this.$store.state.saveStatus},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Trinary_Bandwidth_Assessment"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.evaluationSelection=e.evaluation}}),this.drawWithinInitial()},saveStatus(){let t={name:"Trinary_Bandwidth_Assessment",config:{classifiers:this.value.map(t=>t.name),evaluation:this.evaluationSelection}};this.$store.dispatch("changedSaveConfig",t)},click(){this.updateThreshold()},barHover(){this.drawBarHover()},accHover(){this.drawAccHover()},bandwidthHover(){this.drawBandwidthHover()},rightThreshold(){this.updateThresholdBound()},leftThreshold(){this.updateThresholdBound()},currentSetbandwidth(){this.withinClassifierBandwidths.push({left:this.currentSetbandwidth.left,right:this.currentSetbandwidth.right})},currentBandwidth(){this.updateTmpChartData(),this.drawStreamChart()},currentRemovedbandwidth(){let t=[];this.withinClassifierBandwidths.forEach(e=>{e.left==this.currentRemovedbandwidth.left&&e.right==this.currentRemovedbandwidth.right||t.push(e)}),this.withinClassifierBandwidths=t},withinClassifierBandwidths(){this.updateStreamChartData(),this.drawStreamChart()},evaluationSelection(){this.drawWithinInitial(),this.drawStreamChart()},value(){this.value.length>1&&(this.value=[this.value[this.value.length-1]]),this.updateStreamChartData(),this.drawStreamChart()},hover(){this.drawHover()},thresholdRangeChange(){this.currentBandwidth={left:this.thresholdRangeChange.left_diff.toFixed(2),right:this.thresholdRangeChange.right_diff.toFixed(2)},this.updateAdjusterBar()},numberOfBins(){this.updateThresholdBound(),this.updatenumberOfBins()},instances(){this.drawWithinInitial(),this.updateStreamChartData(),this.drawStreamChart()},selections(){this.drawSelections()}},mounted(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Trinary_Bandwidth_Assessment"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.evaluationSelection=e.evaluation}}),this.drawWithinInitial()},methods:{updateThreshold(){const t=this.click.classifier,e=parseFloat(this.click.threshold).toFixed(2);let s={classifier:t,single_threshold:100*parseFloat(e)};this.$store.dispatch("changedCurveChosenClassifierThresholdTuple",s)},clearBandwitdth(){this.withinClassifierBandwidths=[this.currentSetbandwidth]},addDefault(){this.withinClassifierBandwidths=[{left:.1,right:.1},{left:.05,right:.05},{left:.02,right:.02}]},clearHover(){this.hover={type:"",classifier:"",selectedClassifier:""}},clearBarHover(){this.barHover={threshold:""}},clearAccHover(){this.accHover={threshold:""}},clearThresholdBound(){this.leftThreshold=0,this.rightThreshold=1,this.numberOfBins=11,this.thresholds=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],this.updateStreamChartData(),this.drawStreamChart()},updatenumberOfBins(){const t=it["C"](this.$refs.svg);t.select(".svg-curve"),t.select(".slider-threshold-bin").attr("transform","translate("+this.xScale(10*this.numberOfBins)+", -7.5)"),t.select(".bin-text").text("number of bins: "+this.numberOfBins)},updateThresholdBound(){var t=[],e=(parseFloat(this.rightThreshold)-parseFloat(this.leftThreshold))/parseFloat(this.numberOfBins),s=parseFloat(this.leftThreshold);for(var i in Object(it["v"])(this.numberOfBins)){if(1,s>this.rightThreshold)break;let i=""+s.toFixed(2);t.includes(i)||t.push(i),s+=e}this.thresholds=t,this.updateStreamChartData(),this.drawStreamChart()},removeBandwidthHover(){const t=it["C"](this.$refs.svg);this.thresholds.forEach((e,s)=>{this.withinClassifierBandwidths.forEach((e,i)=>{t.select(".bar-threshold-band-"+i+"-"+s).attr("opacity","1"),t.select(".circle-threshold-band-"+i+"-"+s).attr("opacity","1"),t.select(".upline-band-"+i+"-"+s).attr("opacity","1"),t.select(".midline-band-"+i+"-"+s).attr("opacity","1"),t.select(".lowline-band-"+i+"-"+s).attr("opacity","1"),t.select(".line-band-"+i+"-"+s).attr("opacity","1")})})},drawBandwidthHover(){let t=this.bandwidthHover.bandwidth.split("-")[1];const e=it["C"](this.$refs.svg);"bandwidth-"==this.bandwidthHover.bandwidth?this.removeBandwidthHover():this.thresholds.forEach((s,i)=>{this.withinClassifierBandwidths.forEach((t,s)=>{e.select(".bar-threshold-band-"+s+"-"+i).attr("opacity","0.2"),e.select(".circle-threshold-band-"+s+"-"+i).attr("opacity","0.2"),e.select(".upline-band-"+s+"-"+i).attr("opacity","0.2"),e.select(".midline-band-"+s+"-"+i).attr("opacity","0.2"),e.select(".lowline-band-"+s+"-"+i).attr("opacity","0.2"),e.select(".line-band-"+s+"-"+i).attr("opacity","0.2")}),e.select(".bar-threshold-band-"+t+"-"+i).attr("opacity","1"),e.select(".circle-threshold-band-"+t+"-"+i).attr("opacity","1"),e.select(".upline-band-"+t+"-"+i).attr("opacity","1"),e.select(".midline-band-"+t+"-"+i).attr("opacity","1"),e.select(".lowline-band-"+t+"-"+i).attr("opacity","1"),e.select(".line-band-"+t+"-"+i).attr("opacity","1")})},drawAccHover(){const t=it["C"](this.$refs.svg),e=this.accHover.threshold.split("-")[1],s=this.streamData;let i=[];this.withinClassifierBandwidths.forEach(t=>{i.push(t)});const a=i.sort((t,e)=>t.right+t.left<e.right+e.left?1:t.right+t.left>e.right+e.left?-1:0);this.accHover.threshold?(this.thresholds.forEach((e,s)=>{a.forEach((e,i)=>{t.select(".bar-threshold-band-"+i+"-"+s).attr("opacity","0.2"),t.select(".circle-threshold-band-"+i+"-"+s).attr("opacity","0.2"),t.select(".upline-band-"+i+"-"+s).attr("opacity","0.2"),t.select(".midline-band-"+i+"-"+s).attr("opacity","0.2"),t.select(".lowline-band-"+i+"-"+s).attr("opacity","0.2"),t.select(".line-band-"+i+"-"+s).attr("opacity","0.2")})}),t.select(".y-axis-marker-rect").attr("opacity",1),a.forEach((i,a)=>{let r=e,n=s[a].ci_tp[r],o=s[a].ci_fp[r],l=s[a].ci_tn[r],c=s[a].ci_fn[r],h=(s[a].ci_m_y[r],s[a].ci_m_n[r],s[a].ci_m[r],n+o!=0?n/(n+o):0==n?1:0),d=n+c!=0?n/(n+c):0==l?1:0,u=h+d!=0?2*h*d/(h+d):h*d==0?1:0,p=0;(n+o)*(n+c)*(l+o)*(l+c)!=0&&(p=(n*l-o*c)/Math.sqrt((n+o)*(n+c)*(l+o)*(l+c))),t.select(".bar-threshold-band-"+a+"-"+e).attr("opacity","1"),t.select(".circle-threshold-band-"+a+"-"+e).attr("opacity","1"),t.select(".upline-band-"+a+"-"+e).attr("opacity","1"),t.select(".midline-band-"+a+"-"+e).attr("opacity","1"),t.select(".lowline-band-"+a+"-"+e).attr("opacity","1"),t.select(".line-band-"+a+"-"+e).attr("opacity","1"),t.select(".y-axis-marker-text-1-"+a).text("acc+: "+((this.streamData[a].ci_tp[e]+this.streamData[a].ci_tn[e]+this.streamData[a].ci_m[e])/this.instances.length).toFixed(2)).attr("opacity","accuracy"==this.evaluationSelection?1:0),t.select(".y-axis-marker-text-1-s1-"+a).text("accuracy"==this.evaluationSelection?"acc: "+((this.streamData[a].ci_tp[e]+this.streamData[a].ci_tn[e])/(this.instances.length-this.streamData[a].ci_m[e])).toFixed(2):"precision"==this.evaluationSelection?"precision: "+h.toFixed(2):"recall"==this.evaluationSelection?"recall: "+d.toFixed(2):"mcc"==this.evaluationSelection?"mcc: "+p.toFixed(2):"f1: "+u.toFixed(2)).attr("opacity",1),t.select(".y-axis-marker-text-1-s2-"+a).text("acc-: "+((this.streamData[a].ci_tp[e]+this.streamData[a].ci_tn[e])/this.instances.length).toFixed(2)).attr("opacity","accuracy"==this.evaluationSelection?1:0)})):(t.select(".y-axis-marker-rect").attr("opacity",0),this.thresholds.forEach((e,s)=>{a.forEach((e,i)=>{t.select(".bar-threshold-band-"+i+"-"+s).attr("opacity","1"),t.select(".circle-threshold-band-"+i+"-"+s).attr("opacity","1"),t.select(".upline-band-"+i+"-"+s).attr("opacity","1"),t.select(".midline-band-"+i+"-"+s).attr("opacity","1"),t.select(".lowline-band-"+i+"-"+s).attr("opacity","1"),t.select(".line-band-"+i+"-"+s).attr("opacity","1"),t.select(".y-axis-marker-text-1-"+i).text(i).attr("opacity",0),t.select(".y-axis-marker-text-1-s1-"+i).text(i).attr("opacity",0),t.select(".y-axis-marker-text-1-s2-"+i).text(i).attr("opacity",0)})}))},drawBarHover(){const t=this.barHover.threshold.split("-")[1],e=(t,e,s)=>{const i=this.streamData[t]["middle_instances"][this.thresholds[e]].instances,a=Lt(i,s);var r=0;r=this.instances.length;const n=a.size/r;return n.toFixed(2)},{first:s,second:i}=this.selections;let a=[];this.withinClassifierBandwidths.forEach(t=>{a.push(t)});const r=a.sort((t,e)=>t.right+t.left<e.right+e.left?1:t.right+t.left>e.right+e.left?-1:0),n=it["C"](this.$refs.svg);this.streamData;this.barHover.threshold?(this.thresholds.forEach((t,e)=>{r.forEach((t,s)=>{n.select(".bar-threshold-band-"+s+"-"+e).attr("opacity","0.2"),n.select(".bar-hover-box-1-"+s+"-"+e).attr("opacity","0"),n.select(".bar-hover-box-2-"+s+"-"+e).attr("opacity","0"),n.select(".bar-hover-text-1-"+s+"-"+e).attr("opacity","0"),n.select(".bar-hover-text-2-"+s+"-"+e).attr("opacity","0"),n.select(".circle-threshold-band-"+s+"-"+e).attr("opacity","0.2"),n.select(".upline-band-"+s+"-"+e).attr("opacity","0.2"),n.select(".midline-band-"+s+"-"+e).attr("opacity","0.2"),n.select(".lowline-band-"+s+"-"+e).attr("opacity","0.2"),n.select(".line-band-"+s+"-"+e).attr("opacity","0.2")})}),n.select(".y-axis-marker-rect").attr("opacity",1),r.forEach((a,r)=>{n.select(".bar-threshold-band-"+r+"-"+t).attr("opacity","1"),n.select(".bar-hover-box-1-"+r+"-"+t).attr("opacity","1"),n.select(".bar-hover-box-2-"+r+"-"+t).attr("opacity","1"),n.select(".bar-hover-text-1-"+r+"-"+t).attr("opacity","1"),n.select(".bar-hover-text-2-"+r+"-"+t).attr("opacity","1"),n.select(".circle-threshold-band-"+r+"-"+t).attr("opacity","1"),n.select(".upline-band-"+r+"-"+t).attr("opacity","1"),n.select(".midline-band-"+r+"-"+t).attr("opacity","1"),n.select(".lowline-band-"+r+"-"+t).attr("opacity","1"),n.select(".line-band-"+r+"-"+t).attr("opacity","1"),n.select(".y-axis-marker-text-1-"+r).text("uncertain: "+(this.streamData[r].ci_m[t]/this.instances.length).toFixed(2)).attr("opacity",1),s?n.select(".y-axis-marker-text-1-s1-"+r).text("select1: "+e(r,t,s.instances)).attr("opacity",1):n.select(".y-axis-marker-text-1-s1-"+r).attr("opacity",0),i?n.select(".y-axis-marker-text-1-s2-"+r).text("select2: "+e(r,t,i.instances)).attr("opacity",1):n.select(".y-axis-marker-text-1-s2-"+r).attr("opacity",0)})):(n.select(".y-axis-marker-rect").attr("opacity",0),this.thresholds.forEach((t,e)=>{r.forEach((t,s)=>{n.select(".bar-threshold-band-"+s+"-"+e).attr("opacity","1"),n.select(".bar-hover-box-1-"+s+"-"+e).attr("opacity","0"),n.select(".bar-hover-box-2-"+s+"-"+e).attr("opacity","0"),n.select(".bar-hover-text-1-"+s+"-"+e).attr("opacity","0"),n.select(".bar-hover-text-2-"+s+"-"+e).attr("opacity","0"),n.select(".circle-threshold-band-"+s+"-"+e).attr("opacity","1"),n.select(".upline-band-"+s+"-"+e).attr("opacity","1"),n.select(".midline-band-"+s+"-"+e).attr("opacity","1"),n.select(".lowline-band-"+s+"-"+e).attr("opacity","1"),n.select(".line-band-"+s+"-"+e).attr("opacity","1"),n.select(".y-axis-marker-text-1-"+s).text(s).attr("opacity",0),n.select(".y-axis-marker-text-1-s1-"+s).text(s).attr("opacity",0),n.select(".y-axis-marker-text-1-s2-"+s).text(s).attr("opacity",0)})}))},drawHover(){const t=it["C"](this.$refs.svg),e=this.hover.selectedClassifier,s=t.selectAll(".bar-threshold-right-"+e),i=t.select(".y-axis-marker-line-curve-low"),a=t.select(".y-axis-marker-line-curve-up"),r=t.select(".y-axis-marker-line-curve-bar"),n=t.select(".y-axis-marker-line-curve"),o=t.select(".y-axis-marker-text-curve-bar"),l=t.select(".y-axis-marker-text-curve"),c=t.select(".y-axis-marker-text-curve-low"),h=t.select(".y-axis-marker-text-curve-up"),d=t.select(".y-axis-marker-text-classifier"),u=t.select(".y-axis-marker-text-s1"),p=t.select(".y-axis-marker-text-s2"),f=t.select(".y-axis-marker-rect"),m=this.value.map(t=>t.name),{first:g,second:v}=this.selections,y=it["x"]().domain(this.thresholds).range([0,.8*this.width]).paddingOuter(.2),_=(t,e,s)=>{const i=this.accumulations[t].middle_instances[e].instances;var a=0;a=this.instances.length;const r=Lt(i,s),n=r.size/a*100;return n.toFixed(2)+"%"};m.forEach(e=>{t.selectAll(".bar-threshold-right-"+e).attr("fill","lightgrey")}),"curve-bar"===this.hover.type?s.data(this.thresholds).attr("fill",(t,e)=>e===this.hover.classifier?"grey":"lightgrey"):s.attr("fill","lightgrey");const x=500,b=1e3;this.hover.type?(f.transition().duration(x).attr("opacity",1).attr("fill","white").attr("transform",`translate(\n            ${y(this.thresholds[this.hover.classifier])},\n            -150)`),d.transition().duration(x).attr("fill-opacity",1).attr("transform",`translate(\n            ${y(this.thresholds[this.hover.classifier])+80},\n            -130)`).text("classifier: "+e),r.transition().duration(x).attr("stroke-opacity",1).attr("y1",this.y(this.accumulations[e].ci_m[this.hover.classifier]/this.instances.length)).attr("x2",this.width).attr("y2",this.y(this.accumulations[e].ci_m[this.hover.classifier]/this.instances.length)),o.transition().duration(x).attr("fill-opacity",1).attr("transform",`translate(\n            ${y(this.thresholds[this.hover.classifier])+80},\n            -110)`).text("Fraction: "+(this.accumulations[e].ci_m[this.hover.classifier]/this.instances.length*100).toFixed(1)+"%"),n.transition().duration(x).attr("stroke-opacity",1).attr("y1",this.y((this.accumulations[e].ci_tp[this.hover.classifier]+this.accumulations[e].ci_tn[this.hover.classifier])/(this.instances.length-this.accumulations[e].ci_m[this.hover.classifier]))).attr("x2",this.width).attr("y2",this.y((this.accumulations[e].ci_tp[this.hover.classifier]+this.accumulations[e].ci_tn[this.hover.classifier])/(this.instances.length-this.accumulations[e].ci_m[this.hover.classifier]))),l.transition().duration(x).attr("fill-opacity",1).attr("transform",`translate(\n            ${y(this.thresholds[this.hover.classifier])+80},\n            -70)`).text("accuracy"==this.evaluationSelection?"acc: ":"precision"==this.evaluationSelection?"precision: ":"recall"==this.evaluationSelection?"recall: ":"mcc"==this.evaluationSelection?"mcc: ":"f1"+((this.accumulations[e].ci_tp[this.hover.classifier]+this.accumulations[e].ci_tn[this.hover.classifier])/(this.instances.length-this.accumulations[e].ci_m[this.hover.classifier])*100).toFixed(1)+"%"),i.transition().duration(x).attr("stroke-opacity",1).attr("y1",this.y((this.accumulations[e].ci_tp[this.hover.classifier]+this.accumulations[e].ci_tn[this.hover.classifier])/this.instances.length)).attr("x2",this.width).attr("y2",this.y((this.accumulations[e].ci_tp[this.hover.classifier]+this.accumulations[e].ci_tn[this.hover.classifier])/this.instances.length)).attr("visibility","accuracy"==this.evaluationSelection?"visible":"hidden"),c.transition().duration(x).attr("fill-opacity",1).attr("transform",`translate(\n            ${y(this.thresholds[this.hover.classifier])+80},\n            -50)`).text("acc-: "+((this.accumulations[e].ci_tp[this.hover.classifier]+this.accumulations[e].ci_tn[this.hover.classifier])/this.instances.length*100).toFixed(1)+"%").attr("visibility","accuracy"==this.evaluationSelection?"visible":"hidden"),a.transition().duration(x).attr("stroke-opacity",1).attr("y1",this.y((this.accumulations[e].ci_tp[this.hover.classifier]+this.accumulations[e].ci_tn[this.hover.classifier]+this.accumulations[e].ci_m[this.hover.classifier])/this.instances.length)).attr("x2",this.width).attr("y2",this.y((this.accumulations[e].ci_tp[this.hover.classifier]+this.accumulations[e].ci_tn[this.hover.classifier]+this.accumulations[e].ci_m[this.hover.classifier])/this.instances.length)).attr("visibility","accuracy"==this.evaluationSelection?"visible":"hidden"),h.transition().duration(x).attr("fill-opacity",1).attr("transform",`translate(\n            ${y(this.thresholds[this.hover.classifier])+80},\n            -90)`).text("acc+: "+((this.accumulations[e].ci_tp[this.hover.classifier]+this.accumulations[e].ci_tn[this.hover.classifier]+this.accumulations[e].ci_m[this.hover.classifier])/this.instances.length*100).toFixed(1)+"%").attr("visibility","accuracy"==this.evaluationSelection?"visible":"hidden"),g&&u.transition().duration(x).attr("fill-opacity",1).attr("transform",`translate(\n            ${y(this.thresholds[this.hover.classifier])+80},\n            -20)`).text("1st: "+_(this.hover.selectedClassifier,this.thresholds[this.hover.classifier],g.instances)),v&&p.transition().duration(x).attr("fill-opacity",1).attr("transform",`translate(\n              ${y(this.thresholds[this.hover.classifier])+80},\n              0)`).text("2nd: "+_(this.hover.selectedClassifier,this.thresholds[this.hover.classifier],v.instances))):(d.transition().duration(b).attr("fill-opacity",0),u.transition().duration(b).attr("fill-opacity",0),p.transition().duration(b).attr("fill-opacity",0),f.transition().duration(b).attr("opacity",0),r.transition().duration(b).attr("stroke-opacity",0),n.transition().duration(b).attr("stroke-opacity",0),a.transition().duration(b).attr("stroke-opacity",0),i.transition().duration(b).attr("stroke-opacity",0),o.transition().duration(b).attr("fill-opacity",0),l.transition().duration(b).attr("fill-opacity",0),c.transition().duration(b).attr("fill-opacity",0),h.transition().duration(b).attr("fill-opacity",0))},updateAdjusterBar(){this.thresholdRangeChange.threshold,0==this.value.length||this.value[this.value.length-1].name;const t=this.thresholdRangeChange.type,e=(""==this.thresholdRangeChange.type||parseFloat(this.thresholdRangeChange.value),it["C"](this.$refs.svg));it["C"](".slider-circle-time-"+t),it["C"](".range-text-"+t),e.select(".legend-text1"),e.select(".legend-text2"),e.select(".legend_line2");"left"==t?(it["C"](".slider-circle-time-left").attr("transform","translate("+(100-100*this.thresholdRangeChange.left_diff/.1)+", -140)"),it["C"](".range-text-left").text("("+(-this.thresholdRangeChange.left_diff).toFixed(2)+",")):(it["C"](".slider-circle-time-right").attr("transform","translate("+(100+100*this.thresholdRangeChange.right_diff/.1)+", -140)"),it["C"](".range-text-right").text(this.thresholdRangeChange.right_diff.toFixed(2)+")"))},updateTmpChartData(){let t={},e=0,s=this.currentBandwidth;const i=0==this.value.length?"":this.value[this.value.length-1].name,a=it["B"](it["o"]).domain([0,2*(this.withinClassifierBandwidths.length+1)]).interpolator((function(t){return it["o"](t)}));let r=0;for(let n in this.streamData){if(r>=this.withinClassifierBandwidths.length)break;r+=1,t[n]=this.streamData[n],t[n].color=a(e+1),e+=1}t[e]={left:s.left,right:s.right,threshold:this.thresholds[e],threshold_idx:e,color:a(e+1),ci_tp:[],ci_fn:[],ci_tn:[],ci_fp:[],ci_m:[],ci_m_y:[],ci_m_n:[],ci_tp_instances:{},ci_fp_instances:{},ci_tn_instances:{},ci_fn_instances:{},middle_instances:{},middle_y_instances:{},middle_n_instances:{}},this.thresholds.forEach(s=>{t[e]["ci_tp_instances"][s]={instances:new Set},t[e]["ci_tn_instances"][s]={instances:new Set},t[e]["ci_fp_instances"][s]={instances:new Set},t[e]["ci_fn_instances"][s]={instances:new Set},t[e]["middle_instances"][s]={instances:new Set},t[e]["middle_y_instances"][s]={instances:new Set},t[e]["middle_n_instances"][s]={instances:new Set}}),this.thresholds.forEach(a=>{let r=parseFloat(a)-parseFloat(s.left)<0?0:parseFloat(a)-parseFloat(s.left),n=parseFloat(a)+parseFloat(s.right)>1?1:parseFloat(a)+parseFloat(s.right);this.instances.forEach(s=>{let o=Nt(s).continuous_predictions[i],l=o<=parseFloat(a)?this.classes[0]:this.classes[1],c=Nt(s).actual==l?1:0,h=a;o>r&&o<n?(t[e]["middle_instances"][a].instances.add(s),1==c?t[e]["middle_y_instances"][a].instances.add(s):t[e]["middle_n_instances"][a].instances.add(s)):o>=n?Nt(s).actual==this.classes[1]?t[e]["ci_tp_instances"][h].instances.add(s):t[e]["ci_fp_instances"][h].instances.add(s):Nt(s).actual==this.classes[0]?t[e]["ci_tn_instances"][h].instances.add(s):t[e]["ci_fn_instances"][h].instances.add(s)})}),this.thresholds.forEach(s=>{t[e]["ci_tp"].push(t[e]["ci_tp_instances"][s].instances.size),t[e]["ci_tn"].push(t[e]["ci_tn_instances"][s].instances.size),t[e]["ci_fp"].push(t[e]["ci_fp_instances"][s].instances.size),t[e]["ci_fn"].push(t[e]["ci_fn_instances"][s].instances.size),t[e]["ci_m"].push(t[e]["middle_instances"][s].instances.size),t[e]["ci_m_y"].push(t[e]["middle_y_instances"][s].instances.size),t[e]["ci_m_n"].push(t[e]["middle_n_instances"][s].instances.size)}),this.streamData=t},updateStreamChartData(){const t=0==this.value.length?"":this.value[this.value.length-1].name,e=it["B"](it["o"]).domain([0,2*this.withinClassifierBandwidths.length]).interpolator((function(t){return it["o"](t)}));let s={};this.withinClassifierBandwidths.forEach((i,a)=>{s[a]={left:i.left,right:i.right,threshold:this.thresholds[a],threshold_idx:a,color:e(a+1),ci_tp:[],ci_fn:[],ci_tn:[],ci_fp:[],ci_m:[],ci_m_y:[],ci_m_n:[],ci_tp_instances:{},ci_fp_instances:{},ci_tn_instances:{},ci_fn_instances:{},middle_instances:{},middle_y_instances:{},middle_n_instances:{}},this.thresholds.forEach(t=>{s[a]["ci_tp_instances"][t]={instances:new Set},s[a]["ci_tn_instances"][t]={instances:new Set},s[a]["ci_fp_instances"][t]={instances:new Set},s[a]["ci_fn_instances"][t]={instances:new Set},s[a]["middle_instances"][t]={instances:new Set},s[a]["middle_y_instances"][t]={instances:new Set},s[a]["middle_n_instances"][t]={instances:new Set}}),this.thresholds.forEach(e=>{let r=parseFloat(e)-parseFloat(i.left)<0?0:parseFloat(e)-parseFloat(i.left),n=parseFloat(e)+parseFloat(i.right)>1?1:parseFloat(e)+parseFloat(i.right);this.instances.forEach(i=>{let o=Nt(i).continuous_predictions[t],l=o<=parseFloat(e)?this.classes[0]:this.classes[1],c=Nt(i).actual==l?1:0,h=e;o>r&&o<n?(s[a]["middle_instances"][e].instances.add(i),1==c?s[a]["middle_y_instances"][e].instances.add(i):s[a]["middle_n_instances"][e].instances.add(i)):o>=n?Nt(i).actual==this.classes[1]?s[a]["ci_tp_instances"][h].instances.add(i):s[a]["ci_fp_instances"][h].instances.add(i):Nt(i).actual==this.classes[0]?s[a]["ci_tn_instances"][h].instances.add(i):s[a]["ci_fn_instances"][h].instances.add(i)})}),this.thresholds.forEach(t=>{s[a]["ci_tp"].push(s[a]["ci_tp_instances"][t].instances.size),s[a]["ci_tn"].push(s[a]["ci_tn_instances"][t].instances.size),s[a]["ci_fp"].push(s[a]["ci_fp_instances"][t].instances.size),s[a]["ci_fn"].push(s[a]["ci_fn_instances"][t].instances.size),s[a]["ci_m"].push(s[a]["middle_instances"][t].instances.size),s[a]["ci_m_y"].push(s[a]["middle_y_instances"][t].instances.size),s[a]["ci_m_n"].push(s[a]["middle_n_instances"][t].instances.size)})}),this.streamData=s},drawWithinInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=this.value.map(t=>t.name)[this.value.length-1],e=(this.thresholds,this.instances,this.accumulations,this.x,this.y,it["x"]().domain(this.thresholds).range([0,.8*this.width]).paddingOuter(.2).paddingInner(.2)),s=this.yThreshold,i=(e.bandwidth(),it["C"](this.$refs.svg).append("svg").attr("class","initail_svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${1.2*(this.height+this.margin.top+this.margin.bottom)}`)),a=i.append("g").attr("transform",`translate(0, ${1.2*this.margin.top})`),r=i.append("g").attr("class","svg-curve").attr("transform",`translate(${this.margin.left}, ${1.2*this.margin.top})`),n=this.evaluationSelection,o=this.width/6,l=this.margin.top/2,c=a.append("g").attr("class","legend").attr("transform",`translate(\n              ${this.width-this.margin.left},\n              ${2*-l})`),h=c.append("g").attr("transform","translate("+(2*o-200-40)+",0)"),d=c.append("g").attr("transform","translate("+(2*o-140)+",40)"),u=()=>{d.append("line").attr("class","acc1").style("stroke","grey").style("stroke-opacity","1").style("stroke-width","6").attr("x1",90).attr("x2",100).attr("y1",0).attr("y2",0).attr("visibility","accuracy"==this.evaluationSelection?"visible":"hidden"),d.append("line").attr("class","acc2").style("stroke","grey").style("stroke-opacity","1").style("stroke-width","6").attr("x1",90).attr("x2",100).attr("y1",20).attr("y2",20),d.append("line").attr("class","acc3").style("stroke","grey").style("stroke-opacity","1").style("stroke-width","6").attr("x1",90).attr("x2",100).attr("y1",40).attr("y2",40).attr("visibility","accuracy"==this.evaluationSelection?"visible":"hidden"),d.append("line").attr("class","acc3").style("stroke","grey").style("stroke-opacity","1").style("stroke-width","2").attr("x1",95).attr("x2",95).attr("y1",0).attr("y2",40).attr("visibility","accuracy"==this.evaluationSelection?"visible":"hidden"),d.append("text").attr("class","bin-text").attr("transform","translate(-240,0)").attr("font-size","24px").attr("text-anchor","left").attr("alignment-baseline","middle").attr("fill","steelblue").text("acc+ (uncertainty as right)").attr("visibility","accuracy"==this.evaluationSelection?"visible":"hidden"),d.append("text").attr("class","bin-text").attr("transform","translate(-240,20)").attr("font-size","24px").attr("text-anchor","left").attr("alignment-baseline","middle").attr("fill","steelblue").text("accuracy"==this.evaluationSelection?"acc (uncertainty as uncertain)":"precision"==this.evaluationSelection?"precision":"recall"==this.evaluationSelection?"recall":"mcc"==this.evaluationSelection?"mcc":"f1"),d.append("text").attr("class","bin-text").attr("transform","translate(-240,40)").attr("font-size","24px").attr("text-anchor","left").attr("alignment-baseline","middle").attr("fill","steelblue").text("acc- (uncertainty as wrong)").attr("visibility","accuracy"==this.evaluationSelection?"visible":"hidden"),h.append("line").attr("class","track").style("stroke","lightgrey").style("stroke-opacity","1").style("stroke-width","6").attr("x1",this.xScale.range()[0]).attr("x2",this.xScale.range()[1]).attr("y1",0).attr("y2",0);let t=h.append("rect").attr("width",20).attr("height",15).attr("rx",6).attr("ry",6).style("fill","steelblue").style("stroke","none").attr("class","slider-threshold-bin").attr("transform","translate(100,-7.5)").call(it["h"]().on("start.interrupt",(function(){t.interrupt()})).on("start drag",t=>this.numberOfBins=Math.round(.1*this.xScale.invert(it["i"].x))));h.append("text").attr("class","bin-text").attr("transform","translate(-100,0)").attr("font-size","24px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("number of bins: "+this.numberOfBins)};u();const p=()=>{a.append("rect").attr("width","205").attr("height",70).attr("fill","white").attr("stroke","lightgrey").attr("stroke-width","4px").attr("x","2").attr("y","-180");var t=Math.sqrt(3),e={draw:function(e,s){var i=-Math.sqrt(s/(3*t));e.moveTo(2*-i,0),e.lineTo(i,-t*i),e.lineTo(i,t*i),e.closePath()}},s={draw:function(e,s){var i=-Math.sqrt(s/(3*t));e.moveTo(2*i,0),e.lineTo(-i,-t*i),e.lineTo(-i,t*i),e.closePath()}};let i=it["E"]().type(s).size(180),r=it["E"]().type(e).size(180),n=this.xScale,o=(this.yScale,a.append("rect").attr("rx",6).attr("ry",6).attr("x",3).attr("y",-180).attr("width",140).attr("height",30).attr("fill","#f2f2f2").attr("stroke","lightgrey"),a.append("text").attr("class","slider-text").text("Range Adjuster").attr("y",-160).attr("x",5).attr("font-size","20px").attr("fill","grey"),a.append("rect").attr("class","set-button").attr("rx",6).attr("ry",6).attr("x",150).attr("y",-180).attr("width",40).attr("height",30).attr("fill","#f2f2f2").attr("stroke","lightgrey").on("mouseenter",t=>{it["C"](".set-button").attr("fill","grey"),it["C"](".set-text").attr("fill","white")}).on("mouseleave",t=>{it["C"](".set-button").attr("fill","#f2f2f2"),it["C"](".set-text").attr("fill","grey")}).on("click",(t,e)=>this.currentSetbandwidth={left:this.thresholdRangeChange.left_diff.toFixed(2),right:this.thresholdRangeChange.right_diff.toFixed(2)}),a.append("text").attr("class","set-text").text("set").attr("y",-160).attr("x",153).attr("font-size","20px").attr("fill","grey").on("mouseenter",t=>{it["C"](".set-button").attr("fill","grey"),it["C"](".set-text").attr("fill","white")}).on("mouseleave",t=>{it["C"](".set-button").attr("fill","#f2f2f2"),it["C"](".set-text").attr("fill","grey")}).on("click",(t,e)=>this.currentSetbandwidth={left:this.thresholdRangeChange.left_diff.toFixed(2),right:this.thresholdRangeChange.right_diff.toFixed(2)}),a.append("line").attr("class","track").style("stroke","#777").style("stroke-opacity","1").style("stroke-width","5").attr("x1",2).attr("x2",202).attr("y1",-140).attr("y2",-140),a.append("path").attr("d",i).style("fill","red").style("stroke","none").attr("class","slider-circle-time-left").attr("transform",t=>{let e=100-100*this.thresholdRangeChange.left_diff/.1+2;return"translate("+e+",-140)"}).call(it["h"]().on("start.interrupt",(function(){o.interrupt()})).on("start drag",t=>this.thresholdRangeChange={type:"left",classifier:"all",threshold:t,value:n.invert(it["i"].x),left_diff:Math.abs((parseFloat(n.invert(it["i"].x))-100)/100*.1),right_diff:this.thresholdRangeChange.right_diff}))),l=a.append("path").attr("d",r).style("fill","green").style("stroke","none").attr("class","slider-circle-time-right").attr("transform",t=>{let e=100+this.thresholdRangeChange.right_diff/.1*100+2;return"translate("+e+",-140)"}).call(it["h"]().on("start.interrupt",(function(){l.interrupt()})).on("start drag",t=>this.thresholdRangeChange={type:"right",classifier:"all",threshold:t,value:n.invert(it["i"].x),left_diff:this.thresholdRangeChange.left_diff,right_diff:Math.abs((parseFloat(n.invert(it["i"].x))-100)/100*.1)}));a.append("text").attr("class","range-text-left").text("("+-this.thresholdRangeChange.left_diff.toFixed(2)+",").attr("y",-120).attr("x",5).attr("font-size","18px").attr("fill","grey"),a.append("text").attr("class","range-text-right").text(this.thresholdRangeChange.right_diff.toFixed(2)+")").attr("y",-120).attr("x",60).attr("font-size","18px").attr("fill","grey")},f=()=>{r.append("text").attr("transform",()=>{const t=.4*this.width,e=this.height+this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Threshold"),r.append("text").attr("transform","rotate(-90)").attr("x",-this.height/1.5).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("Fraction of instances"),r.append("text").attr("transform","rotate(-90)").attr("x",-this.height/4).attr("y",60+.8*this.width).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("accuracy"==this.evaluationSelection?"Accuracy ":"precision"==this.evaluationSelection?"Precision ":"recall"==this.evaluationSelection?"Recall":"mcc"==this.evaluationSelection?"MCC":"F1"),r.append("text").attr("class","curve-title").attr("x",.4*this.width).attr("y",-100).attr("dy","1em").style("text-anchor","middle").style("font-size","32px").text("Performance ("+t+")")},m=()=>{const t=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](e).tickSizeOuter(0)).attr("class","xAxis-curve");r.append("g").call(t).attr("font-size",20).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start").on("click",t=>this.leftThreshold=parseFloat(t).toFixed(2)).on("contextmenu",t=>this.rightThreshold=parseFloat(t).toFixed(2));const i=it["y"]().domain([0,1]).range([this.height,0]),a=t=>t.call(it["c"](i).ticks(5).tickFormat("mcc"!=n?it["j"](".0%"):it["j"](".0")));r.append("g").call(a).attr("font-size",20);const o=t=>t.attr("transform",`translate(${.8*this.width}, 0)`).call(it["c"](s).ticks(5).tickFormat(it["j"](".0%")));r.append("g").call(o).attr("font-size",20).selectAll("text").attr("transform","translate(20, 0)").attr("text-anchor","start")};m(),f(),p()},drawStreamChart(){const t=it["C"](this.$refs.svg),e=0==this.value.length?"":this.value[this.value.length-1].name,s=it["x"]().domain(this.thresholds).range([0,.8*this.width]).paddingOuter(.2).paddingInner(.2),i=this.yThreshold,a=t.select(".svg-curve");a.selectAll("*").remove();const r=a.selectAll(".cell").data(this.thresholds).join("g").attr("class","curve-cell").attr("transform",(function(t){return`translate(${s(t)}, 0)`})),n=(this.x,this.y),o=s.bandwidth(),l=s.bandwidth()/8,c=this.streamData,h=this.instances,d=this.thresholds,u=(this.accumulations,this.evaluationSelection),p=it["y"]().domain([0,1]).range([this.height,0]);let f=[];this.withinClassifierBandwidths.forEach(t=>{f.push(t)});let m=this.currentBandwidth;Object.keys(c).length>f.length&&f.push(m);const g=f.sort((t,e)=>t.right+t.left<e.right+e.left?1:t.right+t.left>e.right+e.left?-1:0),v=()=>{function t(t,e){return it["s"]()(d.map((function(t,e){if("accuracy"==u)return[s(t)+o/4,i((c[0].ci_tp[e]+c[0].ci_tn[e])/(h.length-c[0].ci_m[e]))];if("recall"==u)return[s(t)+o/4,i(c[0].ci_tp[e]+c[0].ci_fn[e]!=0?c[0].ci_tp[e]/(c[0].ci_tp[e]+c[0].ci_fn[e]):0==c[0].ci_tp[e]?1:0)];if("precision"==u)return[s(t)+o/4,i(c[0].ci_tp[e]+c[0].ci_fp[e]==0?0:c[0].ci_tp[e]/(c[0].ci_tp[e]+c[0].ci_fp[e]))];if("f1"==u){let a=c[0].ci_tp[e]+c[0].ci_fn[e]!=0?c[0].ci_tp[e]/(c[0].ci_tp[e]+c[0].ci_fn[e]):0==c[0].ci_tp[e]?1:0,r=c[0].ci_tp[e]+c[0].ci_fp[e]!=0?c[0].ci_tp[e]/(c[0].ci_tp[e]+c[0].ci_fp[e]):0==c[0].ci_tp[e]?1:0;return[s(t)+o/4,i(a+r!=0?2*a*r/(a+r):a*r!=0?0:1)]}{let a=c[0].ci_tp[e],r=c[0].ci_fp[e],n=c[0].ci_tn[e],l=c[0].ci_fn[e];return(a+r)*(a+l)*(n+r)*(n+l)!=0?[s(t)+o/4,i((a*n-r*l)/Math.sqrt((a+r)*(a+l)*(n+r)*(n+l)))]:[s(t)+o/4,i(0)]}})))}a.append("path").attr("class","line-threshold").attr("d",t).style("fill","none").attr("stroke","grey").style("stroke-width",3).style("opacity",1)},y=()=>{g.forEach((t,s)=>{let a=s;r.append("rect").attr("class",(t,e)=>"bar-threshold-band-"+s+"-"+e).attr("y",(t,e)=>p(this.streamData[s].ci_m[e]/this.instances.length)).attr("width",o/1.2).attr("height",(t,e)=>this.height-p(this.streamData[s].ci_m[e]/this.instances.length)).attr("fill",this.streamData[s].color).attr("stroke","black").style("paint-order","stroke").on("mouseenter",(t,e)=>this.barHover={threshold:"threshold-"+e}).on("mouseleave",this.clearBarHover).on("click",(e,i)=>this.select(s,i,"first",t)).on("contextmenu",(e,i)=>this.select(s,i,"second",t)).on("dblclick",(e,i)=>this.select(s,i,"first",t,"certainty"));r.append("line").attr("class",(t,e)=>"upline-band-"+s+"-"+e).attr("x1",o/6*(a+1)-6).attr("y1",(t,e)=>i((this.streamData[s].ci_tp[e]+this.streamData[s].ci_tn[e]+this.streamData[s].ci_m[e])/this.instances.length)).attr("x2",o/6*(a+1)+6).attr("y2",(t,e)=>i((this.streamData[s].ci_tp[e]+this.streamData[s].ci_tn[e]+this.streamData[s].ci_m[e])/this.instances.length)).attr("stroke",this.streamData[s].color).attr("stroke-width","6px").on("mouseenter",(t,e)=>this.accHover={threshold:"threshold-"+e}).on("mouseleave",this.clearAccHover).attr("visibility","accuracy"==u?"visible":"hidden").on("click",(t,s)=>this.click={threshold:this.thresholds[s],classifier:e}),r.append("line").attr("class",(t,e)=>"midline-band-"+s+"-"+e).attr("x1",o/6*(a+1)-6).attr("y1",(t,e)=>{let a=c[s].ci_tp[e],r=c[s].ci_fp[e],n=c[s].ci_tn[e],o=c[s].ci_fn[e],l=(c[s].ci_m_y[e],c[s].ci_m_n[e],c[s].ci_m[e]);if("accuracy"==u)return i((a+n)/(this.instances.length-l));if("recall"==u)return i(a/(a+o));if("precision"==u)return i(a/(a+r));if("f1"==u){let t=a/(a+r),e=a/(a+o);return i(2*t*e/(t+e))}return i((a+r)*(a+o)*(n+r)*(n+o)!=0?(a*n-r*o)/Math.sqrt((a+r)*(a+o)*(n+r)*(n+o)):0)}).attr("x2",o/6*(a+1)+6).attr("y2",(t,e)=>{let a=c[s].ci_tp[e],r=c[s].ci_fp[e],n=c[s].ci_tn[e],o=c[s].ci_fn[e],l=(c[s].ci_m_y[e],c[s].ci_m_n[e],c[s].ci_m[e]);if("accuracy"==u)return i((a+n)/(this.instances.length-l));if("recall"==u)return i(a/(a+o));if("precision"==u)return i(a/(a+r));if("f1"==u){let t=a/(a+r),e=a/(a+o);return i(2*t*e/(t+e))}return i((a+r)*(a+o)*(n+r)*(n+o)!=0?(a*n-r*o)/Math.sqrt((a+r)*(a+o)*(n+r)*(n+o)):0)}).attr("stroke",this.streamData[s].color).attr("stroke-width","6px").on("mouseenter",(t,e)=>this.accHover={threshold:"threshold-"+e}).on("mouseleave",this.clearAccHover).on("click",(t,s)=>this.click={threshold:this.thresholds[s],classifier:e}),r.append("line").attr("class",(t,e)=>"lowline-band-"+s+"-"+e).attr("x1",o/6*(a+1)-6).attr("y1",(t,e)=>i((this.streamData[s].ci_tp[e]+this.streamData[s].ci_tn[e])/this.instances.length)).attr("x2",o/6*(a+1)+6).attr("y2",(t,e)=>i((this.streamData[s].ci_tp[e]+this.streamData[s].ci_tn[e])/this.instances.length)).attr("stroke",this.streamData[s].color).attr("stroke-width","6px").on("mouseenter",(t,e)=>this.accHover={threshold:"threshold-"+e}).on("mouseleave",this.clearAccHover).attr("visibility","accuracy"==u?"visible":"hidden").on("click",(t,s)=>this.click={threshold:this.thresholds[s],classifier:e});r.append("line").attr("class",(t,e)=>"line-band-"+s+"-"+e).attr("x1",o/6*(a+1)-1).attr("y1",(t,e)=>i((this.streamData[s].ci_tp[e]+this.streamData[s].ci_tn[e]+this.streamData[s].ci_m[e])/this.instances.length)).attr("x2",o/6*(a+1)-1).attr("y2",(t,e)=>i((this.streamData[s].ci_tp[e]+this.streamData[s].ci_tn[e])/this.instances.length)).attr("stroke",this.streamData[s].color).attr("stroke-width","4px").attr("visibility","accuracy"==u?"visible":"hidden"),a+=1}),g.forEach((t,e)=>{r.append("circle").attr("r",o/2.4/g.length).attr("class",(t,s)=>"circle-threshold-band-"+e+"-"+s).attr("cx",o/1.2/g.length*(e+.5)).attr("cy",this.height-o/2.4/g.length).attr("visibility",(t,s)=>0!=this.streamData[e].ci_m[s]&&g.length>=2||this.height-i(this.streamData[e].ci_m[s]/this.instances.length)>0&&this.height-i(this.streamData[e].ci_m[s]/this.instances.length)<o/3?"visible":"hidden").attr("fill",this.streamData[e].color).attr("stroke","black").attr("stroke-width","0.5px").on("mouseenter",(t,e)=>this.barHover={threshold:"threshold-"+e}).on("mouseleave",this.clearBarHover).on("click",(s,i)=>this.select(e,i,"first",t)).on("contextmenu",(s,i)=>this.select(e,i,"second",t)).on("dblclick",(s,i)=>this.select(e,i,"first",t,"certainty")),r.append("rect").attr("class",(t,s)=>"bar-right-right-selection-1-"+e+"-"+s).attr("y",t=>n(1)).attr("x",o/2.4-l).attr("width",l).attr("fill",this.selection1Color).attr("stroke","black").attr("stroke-width","1px").attr("visibility","hidden"),r.append("rect").attr("class",(t,s)=>"bar-right-right-selection-2-"+e+"-"+s).attr("y",t=>n(1)).attr("x",o/2.4).attr("width",l).attr("fill",this.selection2Color).attr("stroke","black").attr("stroke-width","1px").attr("visibility","hidden")})},_=()=>{a.selectAll("myCicle").data(this.withinClassifierBandwidths).enter().append("circle").attr("class",(t,e)=>"bandwidth-"+e).attr("cx",this.width-10).attr("cy",(t,e)=>this.height+25*(e+2)).attr("r",6).style("fill",(t,e)=>this.streamData[e]["color"]).on("mouseenter",(t,e)=>{this.bandwidthHover={bandwidth:"bandwidth-"+e}}).on("mouseleave",(t,e)=>this.bandwidthHover={bandwidth:"bandwidth-"}).on("click",(t,e)=>this.currentRemovedbandwidth=t),a.selectAll("myText").data(this.withinClassifierBandwidths).enter().append("text").attr("class",(t,e)=>"bandwidth-text-"+e).attr("x",this.width-180).attr("y",(t,e)=>this.height+25*(e+2)).text((t,e)=>"bandwidth: "+this.streamData[e]["left"]+"-"+this.streamData[e]["right"]).style("font-size","15px").attr("alignment-baseline","middle").on("mouseenter",(t,e)=>this.bandwidthHover={bandwidth:"bandwidth-"+e}).on("mouseleave",(t,e)=>this.bandwidthHover={bandwidth:"bandwidth-"}).on("click",(t,e)=>this.currentRemovedbandwidth=t)},x=()=>{a.append("text").attr("transform",()=>{const t=.4*this.width,e=this.height+this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Threshold"),a.append("text").attr("transform","rotate(-90)").attr("x",-this.height/1.5).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("Fraction of instances"),a.append("text").attr("transform","rotate(-90)").attr("x",-this.height/4).attr("y",60+.8*this.width).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("accuracy"==this.evaluationSelection?"Accuracy ":"precision"==this.evaluationSelection?"Precision":"recall"==this.evaluationSelection?"Recall ":"mcc"==this.evaluationSelection?"MCC ":"F1"),a.append("text").attr("class","curve-title").attr("x",.4*this.width).attr("y",-100).attr("dy","1em").style("text-anchor","middle").style("font-size","32px").text("Performance ("+e+")")},b=()=>{const t=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](s).tickSizeOuter(0)).attr("class","xAxis-curve");a.append("g").call(t).attr("font-size",20).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start").on("click",t=>this.leftThreshold=parseFloat(t).toFixed(2)).on("contextmenu",t=>this.rightThreshold=parseFloat(t).toFixed(2));const e=it["y"]().domain([0,1]).range([this.height,0]),r=t=>t.call(it["c"](e).ticks(5).tickFormat(it["j"](".0%")));a.append("g").call(r).attr("font-size",20);const n=t=>t.attr("transform",`translate(${.8*this.width}, 0)`).call(it["c"](i).ticks(5).tickFormat(it["j"](".0%")));a.append("g").call(n).attr("font-size",20).selectAll("text").attr("transform","translate(20, 0)").attr("text-anchor","start"),a.append("rect").attr("transform",`translate(-100, ${this.height})`).attr("width",60).attr("height",30).attr("fill","lightgrey").on("click",t=>this.clearThresholdBound()),a.append("text").attr("transform",`translate(-70, ${this.height+15})`).attr("class","legend-text-hist").attr("font-size","24px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("reset").on("click",t=>this.clearThresholdBound()),a.append("rect").attr("transform",`translate(${this.width-120}, ${this.height})`).attr("width",120).attr("height",30).attr("fill","lightgrey").on("click",t=>this.clearBandwitdth()),a.append("text").attr("transform",`translate(${this.width-60}, ${this.height+15})`).attr("class","legend-text-hist").attr("font-size","24px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("remove all").on("click",t=>this.clearBandwitdth()),a.append("rect").attr("transform",`translate(${this.width-120}, ${this.height-45})`).attr("width",120).attr("height",30).attr("fill","lightgrey").on("click",t=>this.addDefault()),a.append("text").attr("transform",`translate(${this.width-60}, ${this.height-30})`).attr("class","legend-text-hist").attr("font-size","24px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("add default").on("click",t=>this.addDefault())},w=()=>{let t=a;t.append("rect").attr("class","y-axis-marker-rect").attr("width","400").attr("height",40*g.length).attr("x",this.width-this.margin.right-400).attr("y",-55).attr("fill","white").attr("stroke","lightgrey").attr("stroke-width","2px").transition().duration(1e3).attr("opacity",0);let e=0;g.forEach((s,i)=>{t.append("text").attr("class","y-axis-marker-text-1-"+i).attr("transform","translate("+(this.width-this.margin.right-400)+", "+(22*e-50)+")").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","grey").attr("pointer-events","none").attr("opacity",0),t.append("text").attr("class","y-axis-marker-text-1-s1-"+i).attr("transform","translate("+(this.width-this.margin.right-250)+", "+(22*e-50)+")").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","steelblue").attr("pointer-events","none").attr("opacity",0),t.append("text").attr("class","y-axis-marker-text-1-s2-"+i).attr("transform","translate("+(this.width-this.margin.right-120)+", "+(22*e-50)+")").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill","red").attr("pointer-events","none").attr("opacity",0),e++})};b(),x(),_(),y(),v(),w(),this.drawSelections()},drawSelections(){const t=it["C"](this.$refs.svg),{first:e,second:s}=(it["j"](".1f"),this.selections),i=it["y"]().domain([0,1]).range([this.height,0]),a=(t,e,s)=>{const a=this.streamData[t]["middle_instances"][this.thresholds[e]].instances,r=Lt(a,s);var n=0;n=this.instances.length;const o=r.size/n;return i(o)};let r=[];this.withinClassifierBandwidths.forEach(t=>{r.push(t)});const n=r.sort((t,e)=>t.right+t.left<e.right+e.left?1:t.right+t.left>e.right+e.left?-1:0);n.forEach((i,r)=>{this.thresholds.forEach((i,n)=>{e?t.select(".bar-right-right-selection-1-"+r+"-"+n).attr("height",t=>this.height-a(r,n,e.instances)).attr("y",t=>a(r,n,e.instances)).attr("visibility","visible"):t.select(".bar-right-right-selection-1-"+r+"-"+n).attr("visibility","hidden"),s?t.select(".bar-right-right-selection-2-"+r+"-"+n).attr("height",t=>this.height-a(r,n,s.instances)).attr("y",t=>a(r,n,s.instances)).attr("visibility","visible"):t.select(".bar-right-right-selection-2-"+r+"-"+n).attr("visibility","hidden")})})},select(t,e,s,i,a){it["i"].preventDefault(),it["i"].stopPropagation();const r=nt();r.rule=X.RIGHT,r.classifier=0==this.value.length?"":this.value[this.value.length-1].name;let n=this.streamData[t]["middle_instances"][this.thresholds[e]].instances,o=(parseFloat(this.thresholds[e])-parseFloat(i["left"])).toFixed(2),l=(parseFloat(this.thresholds[e])+parseFloat(i["right"])).toFixed(2),c=`Instances which ${r.classifier} got uncertain under${o} and ${l}`;if("certainty"==a){let s=[...this.streamData[t]["ci_tp_instances"][this.thresholds[e]].instances];[...this.streamData[t]["ci_fp_instances"][this.thresholds[e]].instances].forEach(t=>{s.push(t)}),[...this.streamData[t]["ci_tn_instances"][this.thresholds[e]].instances].forEach(t=>{s.push(t)}),[...this.streamData[t]["ci_fn_instances"][this.thresholds[e]].instances].forEach(t=>{s.push(t)}),n=new Set(s),c=`Instances which ${r.classifier} got certain under${o} and ${l}`}const h={type:"simple",constraints:[r],metric:[]},d={description:c,instances:n,predicate:h};this.$store.dispatch("prependToSelectionHistory",d),this.$store.dispatch("changedMostRecentSelection",s)}}}),Ie=Ee,Pe=(s("472f"),Object(m["a"])(Ie,Fe,Te,!1,null,"5606a6ef",null)),De=Pe.exports;v()(Pe,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var Oe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Performance (Selection)")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Sort by accuracy"},model:{value:t.accuracySorting,callback:function(e){t.accuracySorting=e},expression:"accuracySorting"}},[s("v-radio",{attrs:{label:"ascending",value:"ascending"}}),s("v-radio",{attrs:{label:"descending",value:"descending"}}),s("v-radio",{attrs:{label:"alphabetical",value:"alphabetical"}}),s("v-radio",{attrs:{label:"none",value:""}})],1)],1),s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Evaluation method"},model:{value:t.evaluationSelection,callback:function(e){t.evaluationSelection=e},expression:"evaluationSelection"}},[s("v-radio",{attrs:{label:"accuracy",value:"accuracy"}}),s("v-radio",{attrs:{id:"mcc",label:"mcc",value:"mcc"}}),t.classNumber>2?s("v-radio",{attrs:{label:"microf1",value:"microf1"}}):t._e(),t.classNumber>2?s("v-radio",{attrs:{label:"macrof1",value:"macrof1"}}):t._e(),t.classNumber<=2?s("v-radio",{attrs:{label:"f1",value:"f1"}}):t._e(),t.classNumber<=2?s("v-radio",{attrs:{label:"precision",value:"precision"}}):t._e(),t.classNumber<=2?s("v-radio",{attrs:{label:"recall",value:"recall"}}):t._e(),"continuous"==t.datasetType?s("v-radio",{attrs:{label:"auc",value:"auc"}}):t._e(),"continuous"==t.datasetType?s("v-radio",{attrs:{label:"mse",value:"mse"}}):t._e()],1)],1)])],1)],1),s("div",{ref:"svg"})],1)},Ae=[],Be=i["a"].extend({name:"Performance_Selection",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:150,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i="",a="accuracy",r={type:"",classifier:""};return{accuracySorting:i,evaluationSelection:a,height:s,hover:r,margin:t,panel:[],rightColor:"#d1e5f0",rightHoverColor:"#4393c3",selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e,wrongColor:"#fddbc7",wrongHoverColor:"#d6604d",classNumber:[...this.boxProps.classes].length}},computed:{addedThresholdClassifiers(){return"continuous"!=this.$store.state.datasetType?[]:this.$store.state.addedThresholdClassifiers.map(t=>t.name)},datasetType(){var t=this.$store.state.datasetType;return t},classes(){return[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},classifierThresholdDict(){return this.$store.state.classifierThresholdDict},continuousPredictionKeys(){if("continuous"==this.$store.state.datasetType){var t=[];return this.predictionKeys.forEach(e=>{t.push(e+"_"+this.classifierThresholdDict[e]/100)}),this.addedThresholdClassifiers.forEach(e=>{t.push(e)}),t}return this.predictionKeys},continuousClassifierName(){var t={};return this.classifiers.forEach(e=>{"continuous"==this.$store.state.datasetType?t[e]=e+"_"+this.classifierThresholdDict[e]/100:t[e]=e}),t},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},predictionKeys(){this.evaluationKeys;const t=this.classifiers.slice();return t},evaluationKeys(){var t="";switch(this.evaluationSelection){case"accuracy":t="accuracy";break;case"f1":t="f1";break;case"microf1":t="microf1";break;case"macrof1":t="macrof1";break;case"mcc":t="mcc";break;case"precision":t="precision";break;case"recall":t="recall";break;case"auc":t="auc";break;case"mse":t="mse";break}return t},predictions(){const t={};this.classifiers.forEach(e=>{t[this.continuousClassifierName[e]]={threshold:Object.keys(this.classifierThresholdDict).includes(e)?this.classifierThresholdDict[e]:0,right:new Set,wrong:new Set,fp:new Set,fn:new Set,tp:new Set,tn:new Set,f1:0,micro_f1:0,macro_f1:0,mcc:0,precision:0,recall:0,accuracy:0,auc:0,mse:0}}),this.addedThresholdClassifiers.forEach(e=>{t[e]={threshold:e.substring(e.length-4,e.legend),right:new Set,wrong:new Set,fp:new Set,fn:new Set,tp:new Set,tn:new Set,f1:0,micro_f1:0,macro_f1:0,mcc:0,precision:0,recall:0,accuracy:0,auc:0,mse:0}}),this.instances.forEach(e=>{const s=Nt(e);this.classifiers.forEach(i=>{var a=t[this.continuousClassifierName[i]].threshold/100,r=s.continuous_predictions[i],n=s.actual;s.predictions[i];n==this.classes[1]?r>a?(t[this.continuousClassifierName[i]].tp.add(e),t[this.continuousClassifierName[i]].right.add(e)):(t[this.continuousClassifierName[i]].fn.add(e),t[this.continuousClassifierName[i]].wrong.add(e)):r>a?(t[this.continuousClassifierName[i]].fp.add(e),t[this.continuousClassifierName[i]].wrong.add(e)):(t[this.continuousClassifierName[i]].tn.add(e),t[this.continuousClassifierName[i]].right.add(e))}),this.addedThresholdClassifiers.forEach(i=>{let a=i.substring(4,i.length-5),r=this.classifiers;if(r.filter(t=>t===a).length>0){var n=parseFloat(i.substring(i.length-4,i.legend)),o=s.continuous_predictions[a],l=s.actual;s.predictions[a];l==this.classes[1]?o>n?(t[i].tp.add(e),t[i].right.add(e)):(t[i].fn.add(e),t[i].wrong.add(e)):o>n?(t[i].fp.add(e),t[i].wrong.add(e)):(t[i].tn.add(e),t[i].right.add(e))}})});var e={};return this.classifiers.forEach(e=>{var s=t[this.continuousClassifierName[e]].tp.size,i=t[this.continuousClassifierName[e]].fp.size,a=t[this.continuousClassifierName[e]].fn.size,r=t[this.continuousClassifierName[e]].tn.size;t[this.continuousClassifierName[e]].precision=s/(s+i),t[this.continuousClassifierName[e]].recall=s/(s+a),t[this.continuousClassifierName[e]].accuracy=t[this.continuousClassifierName[e]].right.size/(t[this.continuousClassifierName[e]].right.size+t[this.continuousClassifierName[e]].wrong.size),t[this.continuousClassifierName[e]].f1=2*t[this.continuousClassifierName[e]].precision*t[this.continuousClassifierName[e]].recall/(t[this.continuousClassifierName[e]].precision+t[this.continuousClassifierName[e]].recall),t[this.continuousClassifierName[e]].mcc=(s+i)*(s+a)*(r+i)*(r+a)!=0?(s*r-i*a)/Math.sqrt((s+i)*(s+a)*(r+i)*(r+a)):0}),this.addedThresholdClassifiers.forEach(e=>{var s=t[e].tp.size,i=t[e].fp.size,a=t[e].fn.size,r=t[e].tn.size;t[e].precision=s/(s+i),t[e].recall=s/(s+a),t[e].accuracy=t[e].right.size/(t[e].right.size+t[e].wrong.size),t[e].f1=2*t[e].precision*t[e].recall/(t[e].precision+t[e].recall),t[e].mcc=(s+i)*(s+a)*(r+i)*(r+a)!=0?(s*r-i*a)/Math.sqrt((s+i)*(s+a)*(r+i)*(r+a)):0}),this.classes.length>2&&this.classifiers.forEach(s=>{var i=0,a=0,r=0,n=0,o=0;this.classes.forEach(t=>{var l=e[s][t].tp.length,c=e[s][t].fp.length,h=e[s][t].tn.length,d=e[s][t].fn.length;i+=l,a+=c,r+=h,n+=d;var u=l/(l+c),p=l/(l+d);o+=u+p==0?0:2*u*p/(u+p)}),t[this.continuousClassifierName[s]].micro_f1=o/this.classes.length;var l=i/(i+n),c=i/(i+a);t[this.continuousClassifierName[s]].macro_f1=l+c==0?0:l*c*2/(l+c),t[this.continuousClassifierName[s]].mcc=(i+a)*(i+n)*(r+a)*(r+n)!=0?(i*r-a*n)/Math.sqrt((i+a)*(i+n)*(r+a)*(r+n)):0}),t},selections(){return this.$store.state.overlapSelections},x(){const t=it["x"]().domain(this.continuousPredictionKeys).range([0,this.width]).paddingOuter(1).paddingInner(.3);return t},y(){const t=it["y"]().domain(["mcc"==this.evaluationKeys?-1:0,"mse"==this.evaluationKeys?this.instances.length:1]).range([this.height,0]);return t}},watch:{addedThresholdClassifiers(){this.drawInitial()},accuracySorting(){this.drawInitial()},evaluationSelection(){this.drawInitial()},hover(){this.drawHover()},instances(){this.drawInitial()},selections(){this.drawSelections()}},mounted(){this.drawInitial()},methods:{clearHover(){this.hover={type:"",classifier:""}},drawHover(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-right-selection-1"),s=t.selectAll(".bar-right-selection-2"),i=t.select(".y-axis-marker-line"),a=t.select(".y-axis-marker-text-right");t.select(".y-axis-marker-text-wrong");let r="";const n=500,o=1e3,{first:l,second:c}=this.selections,h=(t,e)=>{let s=[],i={},a=0;const r=t,n=it["j"](".2f");i[r]=[],e.forEach(t=>{const e=Nt(t);i[r].includes(e.continuous_predictions[r])||i[r].push(e.continuous_predictions[r])}),i[r].sort(),i[r].forEach(t=>{t=n(t);let i=0,a=0,o=0,l=0;e.forEach(e=>{const s=Nt(e),n=s.continuous_predictions[r]<parseFloat(t)?this.classes[0]:this.classes[1];s.actual==this.classes[1]?n==s.actual?i+=1:o+=1:n==s.actual?l+=1:a+=1}),s.push({x:a/(a+l),y:i/(i+o)})});let o=0,l=0;return s.sort((function(t,e){return it["a"](t.x,e.x)})),s.forEach(t=>{a+=(t.y+l)*(t.x-o)/2,o=t.x,l=t.y}),a},d=(t,e)=>{let s=0;return e.forEach(e=>{const i=Nt(e),a=i.actual==this.classes[1]?1:0,r=t;s+=(i.continuous_predictions[r]-a)*(i.continuous_predictions[r]-a)}),s},u=(t,e)=>{const s=Lt(this.predictions[t].tp,e).size,i=Lt(this.predictions[t].fp,e).size,a=Lt(this.predictions[t].fn,e).size,n=Lt(this.predictions[t].tn,e).size,o=Lt(this.predictions[t].right,e).size,l=s/(s+i),c=s/(s+a);if("accuracy"==this.evaluationKeys)return r+=o/e.size,this.y(o/e.size);if("mcc"==this.evaluationKeys)return(s+i)*(s+a)*(n+i)*(n+a)!=0?(r+=(s*n-i*a)/Math.sqrt((s+i)*(s+a)*(n+i)*(n+a)),this.y((s*n-i*a)/Math.sqrt((s+i)*(s+a)*(n+i)*(n+a)))):(r+=0,this.y(0));if("precision"==this.evaluationKeys)return r+=l,this.y(l);if("auc"==this.evaluationKeys){const s=h(t,e);return r+=s,this.y(s)}if("mse"==this.evaluationKeys){const s=d(t,e);return r+=s,this.y(s)}return"recall"==this.evaluationKeys?(r+=c,this.y(c)):"f1"==this.evaluationKeys||"microf1"==this.evaluationKeys||"macrof1"==this.evaluationKeys?(r+=2*l*c/(l+c),this.y(2*l*c/(l+c))):void 0};"select1"===this.hover.type?e.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hover.classifier?this.rightHoverColor:this.selection1Color):e.attr("fill",this.selection1Color),"select2"===this.hover.type?s.data(this.continuousPredictionKeys).attr("fill",t=>t===this.hover.classifier?this.wrongHoverColor:this.selection2Color):s.attr("fill",this.selection2Color),this.hover.type?"select1"==this.hover.type?(i.transition().duration(n).attr("stroke-opacity",1).attr("y1",u(this.hover.classifier,l.instances)).attr("x2",this.width).attr("y2",u(this.hover.classifier,l.instances)),a.transition().attr("transform",`translate(40, ${u(this.hover.classifier,l.instances)})`).duration(n).attr("fill-opacity",1).text(parseFloat(r).toFixed(3)+"")):(i.transition().duration(n).attr("stroke-opacity",1).attr("y1",u(this.hover.classifier,c.instances)).attr("x2",this.width).attr("y2",u(this.hover.classifier,c.instances)),a.transition().attr("transform",`translate(40, ${u(this.hover.classifier,c.instances)})`).duration(n).attr("fill-opacity",1).text(parseFloat(r).toFixed(3)+"")):(i.transition().duration(o).attr("stroke-opacity",0),a.transition().duration(o).attr("fill-opacity",0))},drawHoverExternal(){},drawInitial(){console.log(this.predictions),console.log(this.continuousPredictionKeys),it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+this.margin.bottom}`).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),e=this.x,s=this.y,i=()=>{const i=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](e).tickSizeOuter(0));t.append("g").call(i).attr("font-size",20).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start");const a=t=>t.call(it["c"](s).ticks(5).tickFormat("mse"==this.evaluationKeys?it["j"](".0"):it["j"](".0%")));t.append("g").call(a).attr("font-size",20)};i();const a=()=>{t.append("text").attr("transform",()=>{const t=this.width/2,e=this.height+.8*this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Classifier"),t.append("text").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("accuracy"==this.evaluationKeys?"Accuracy value":"mcc"==this.evaluationKeys?"MCC value":"precision"==this.evaluationKeys?"Precision value":"auc"==this.evaluationKeys?"AUC value":"mse"==this.evaluationKeys?"MSE value":"recall"==this.evaluationKeys?"Recall value":"microf1"==this.evaluationKeys?"Micro F1 value":"macrof1"==this.evaluationKeys?"Macro F1 value":"F1 value")};a();const r=()=>{const t=this.width/4,e=this.margin.top/2,s=it["C"](this.$refs.svg).select("svg").append("g").attr("class","legend").attr("transform",`translate(\n              ${this.margin.left+3*this.width/4},\n              ${e/3})`);s.append("rect").attr("width",t).attr("height",e/2).attr("fill",this.selection1Color),s.append("rect").attr("y",e/2).attr("width",t).attr("height",e/2).attr("fill",this.selection2Color),s.append("text").attr("transform",`translate(${t/2}, ${e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("Selection1"),s.append("text").attr("transform",`translate(${t/2}, ${3*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("Selection2")};r();const n=()=>{const s=t.selectAll(".cell").data(this.continuousPredictionKeys).join("g").attr("class","cell").attr("transform",t=>`translate(${e(t)}, 0)`),{first:i,second:a}=this.selections,r=e.bandwidth(),n=()=>{e.bandwidth();s.append("rect").attr("class","bar-right-selection-1").attr("x",0).attr("width",r/2).attr("fill",this.selection1Color).attr("stroke","black").attr("stroke-width","2px").on("mouseenter",t=>{this.hover={type:"select1",classifier:t}}).on("mouseleave",this.clearHover),s.append("rect").attr("class","bar-right-selection-2").attr("x",r/2).attr("width",r/2).attr("fill",this.selection2Color).attr("stroke","black").attr("stroke-width","2px").on("mouseenter",t=>this.hover={type:"select2",classifier:t}).on("mouseleave",this.clearHover),s.append("circle").attr("class","circle-right-selection-1").attr("cx",r/4).attr("cy",this.height-15).attr("r","15px").style("fill",this.selection1Color).attr("stroke","grey").on("mouseenter",t=>this.hover={type:"select1",classifier:t}).on("mouseleave",this.clearHover),s.append("circle").attr("class","circle-right-selection-2").attr("cy",this.height-15).attr("cx",3*r/4).attr("r","15px").style("fill",this.selection2Color).attr("stroke","grey").on("mouseenter",t=>this.hover={type:"select2",classifier:t}).on("mouseleave",this.clearHover)};n()},o=()=>{t.append("line").attr("class","y-axis-marker-line").attr("y1",s(1)).attr("x2",this.width).attr("y2",s(1)).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none")},l=()=>{t.append("text").attr("class","y-axis-marker-text-right").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.rightHoverColor).attr("pointer-events","none")};n(),o(),l(),this.drawSelections(),this.drawHover(),this.drawHoverExternal()},drawSelections(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-right-selection-1"),s=t.selectAll(".bar-right-selection-2"),i=t.selectAll(".circle-right-selection-1"),a=t.selectAll(".circle-right-selection-2"),{first:r,second:n}=this.selections,o=(t,e)=>{const s=Lt(this.predictions[t].tp,e).size,i=Lt(this.predictions[t].fp,e).size,a=Lt(this.predictions[t].fn,e).size,r=Lt(this.predictions[t].tn,e).size,n=Lt(this.predictions[t].right,e).size,o=s/(s+i),l=s/(s+a);if("accuracy"==this.evaluationKeys)return this.y(n/e.size);if("mcc"==this.evaluationKeys)return(s+i)*(s+a)*(r+i)*(r+a)!=0?this.y((s*r-i*a)/Math.sqrt((s+i)*(s+a)*(r+i)*(r+a))):this.y(0);if("precision"==this.evaluationKeys)return this.y(o);if("auc"==this.evaluationKeys){const s=h(t,e);return this.y(s)}if("mse"==this.evaluationKeys){const s=c(t,e);return this.y(s)}return"recall"==this.evaluationKeys?this.y(l):"f1"==this.evaluationKeys||"microf1"==this.evaluationKeys||"macrof1"==this.evaluationKeys?this.y(2*o*l/(o+l)):void 0},l=(t,e)=>this.height-o(t,e),c=(t,e)=>{let s=0;return e.forEach(e=>{const i=Nt(e),a=i.actual==this.classes[1]?1:0,r=t;s+=(i.continuous_predictions[r]-a)*(i.continuous_predictions[r]-a)}),s},h=(t,e)=>{let s=[],i={},a=0;const r=t,n=it["j"](".2f");i[r]=[],e.forEach(t=>{const e=Nt(t);i[r].includes(e.continuous_predictions[r])||i[r].push(e.continuous_predictions[r])}),i[r].sort(),i[r].forEach(t=>{t=n(t);let i=0,a=0,o=0,l=0;e.forEach(e=>{const s=Nt(e),n=s.continuous_predictions[r]<parseFloat(t)?this.classes[0]:this.classes[1];s.actual==this.classes[1]?n==s.actual?i+=1:o+=1:n==s.actual?l+=1:a+=1}),s.push({x:a/(a+l),y:i/(i+o)})});let o=0,l=0;return s.sort((function(t,e){return it["a"](t.x,e.x)})),s.forEach(t=>{a+=(t.y+l)*(t.x-o)/2,o=t.x,l=t.y}),a};r?(e.data(this.continuousPredictionKeys).attr("y",t=>o(t,r.instances)).attr("height",t=>l(t,r.instances)),i.attr("visibility",t=>isNaN(l(t,r.instances))||0==l(t,r.instances)||l(t,r.instances)/this.height>.05?"hidden":"visible")):(e.attr("height","0"),i.attr("visibility","hidden")),n?(s.data(this.continuousPredictionKeys).attr("y",t=>o(t,n.instances)).attr("height",t=>l(t,n.instances)),a.attr("visibility",t=>isNaN(l(t,r.instances))||0==l(t,n.instances)||l(t,n.instances)/this.height>.05?"hidden":"visible")):(s.attr("height","0"),a.attr("visibility","hidden"))},select(t,e,s){it["i"].preventDefault(),it["i"].stopPropagation();const i=nt();i.rule=X.RIGHT,i.classifier=t,i.negation="wrong"===e;const a=this.predictions[t][e],r=`Instances which ${t} got ${e}`,n={type:"simple",constraints:[i],metric:[]},o={description:r,instances:a,predicate:n};this.$store.dispatch("prependToSelectionHistory",o),this.$store.dispatch("changedMostRecentSelection",s)}}}),Me=Be,Re=(s("6d4b"),Object(m["a"])(Me,Oe,Ae,!1,null,"2fe25134",null)),He=Re.exports;v()(Re,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var Ve=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Performance (Per-Class)")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Sort by accuracy"},model:{value:t.accuracySorting,callback:function(e){t.accuracySorting=e},expression:"accuracySorting"}},[s("v-radio",{attrs:{label:"ascending",value:"ascending"}}),s("v-radio",{attrs:{label:"descending",value:"descending"}}),s("v-radio",{attrs:{label:"alphabetical",value:"alphabetical"}}),s("v-radio",{attrs:{label:"none",value:""}})],1)],1),s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Evaluation method"},model:{value:t.evaluationSelection,callback:function(e){t.evaluationSelection=e},expression:"evaluationSelection"}},[s("v-radio",{attrs:{label:"accuracy",value:"accuracy"}}),s("v-radio",{attrs:{label:"precision",value:"precision"}}),s("v-radio",{attrs:{label:"recall",value:"recall"}}),s("v-radio",{attrs:{label:"f1",value:"f1"}}),s("v-radio",{attrs:{label:"mcc",value:"mcc"}})],1)],1)])],1)],1),s("div",{ref:"svg"})],1)},je=[],Ke=i["a"].extend({name:"Performance_Per_Class",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:150,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i="",a="accuracy",r={type:"",classifier:"",classes:"",value:0};return{accuracySorting:i,evaluationSelection:a,height:s,hover:r,margin:t,panel:[],bar1Color:"#d1e5f0",bar1HoverColor:"#4393c3",selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e,bar2Color:"#fddbc7",bar2HoverColor:"#d6604d"}},computed:{classes(){return[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},predictionKeys(){const t=(t,e)=>{var s=0,i=0;for(var a in this.predictions[t])s+=this.predictions[t][a].right.size;for(var a in this.predictions[e])i+=this.predictions[e][a].right.size;return s-i},e=(e,s)=>-t(e,s),s=this.classifiers.slice();switch(this.accuracySorting){case"ascending":s.sort(t);break;case"descending":s.sort(e);break;case"alphabetical":s.sort();break}return s},evaluationKeys(){var t="";switch(this.evaluationSelection){case"precision":t="precision";break;case"recall":t="recall";break;case"accuracy":t="accuracy";break;case"f1":t="f1";break;case"mcc":t="mcc";break}return t},predictions(){const t={};return this.classifiers.forEach(e=>{t[e]={},this.classes.forEach(s=>{t[e][s]={class:new String,right:new Set,wrong:new Set,fp:new Set,fn:new Set,tp:new Set,tn:new Set,pred:new Set,actual:new Set}})}),this.instances.forEach(e=>{const s=Nt(e);this.classifiers.forEach(i=>{var a=s.actual,r=s.predictions[i],n=i;t[n][r].pred.add(e),t[n][a].actual.add(e),s.predictions[i]==s.actual?(t[i][a].right.add(e),t[n][a].tp.add(e),this.classes.forEach(s=>{s!=r&&t[n][s].tn.add(e)})):(t[i][a].wrong.add(e),t[i][r].fp.add(e),t[n][a].fn.add(e))})}),console.log(t),t},curData(){const t=this.predictionKeys,e=this.classes,s=[];return t.forEach(t=>{const i=[];e.forEach(e=>{let s=this.predictions[t][e].tp.size/(this.predictions[t][e].tp.size+this.predictions[t][e].fp.size),a=this.predictions[t][e].tp.size/(this.predictions[t][e].tp.size+this.predictions[t][e].fn.size);if("precision"==this.evaluationKeys)i.push(s);else if("recall"==this.evaluationKeys)i.push(a);else if("f1"==this.evaluationKeys){let t=s+a==0?0:2*s*a/(s+a);i.push(t)}else if("mcc"==this.evaluationKeys){var r=this.predictions[t][e].tp.size,n=this.predictions[t][e].fp.size,o=this.predictions[t][e].fn.size,l=this.predictions[t][e].tn.size;if(0==Math.sqrt((r+n)*(r+o)*(l+n)*(l+o))){let t=0;t=r*l-r*o<0?-1:1,i.push(t)}else{let t=(r*l-r*o)/Math.sqrt((r+n)*(r+o)*(l+n)*(l+o));i.push(t)}}else{let s=this.predictions[t][e].right.size/(this.predictions[t][e].right.size+this.predictions[t][e].wrong.size);i.push(s)}}),s.push(i)}),s},curData_reverse(){this.predictionKeys,this.classes;const t=[];return this.curData.forEach(e=>{const s=[];e.forEach(t=>{s.push(1-t)}),t.push(s)}),console.log(t),t},hoverData(){const t=[];for(var e in this.predictionKeys)for(var s in this.classes){let i={classifier:this.predictionKeys[e],class:this.classes[s],value:this.curData[e][s]};t.push(i)}return t},selections(){return this.$store.state.overlapSelections},x(){const t=it["x"]().domain(this.predictionKeys).range([0,this.width]).paddingOuter(1).paddingInner(.1);return t},y(){const t=it["y"]().domain(["mcc"==this.evaluationKeys?-1:0,1]).range([this.height,0]);return t}},watch:{accuracySorting(){this.drawInitial()},evaluationSelection(){this.drawInitial()},hover(){this.drawHover()},instances(){this.drawInitial()},selections(){this.drawSelections()}},mounted(){this.drawInitial()},methods:{clearHover(){this.hover={type:"",classifier:"",classes:"",value:0}},drawHover(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-right"),s=t.selectAll(".bar-wrong"),i=t.select(".y-axis-marker-line"),a=t.select(".y-axis-marker-text-right"),r=t.select(".y-axis-marker-text-wrong"),n=t.select(".bar-selectedBarText");this.hover.classifier&&this.hover.classes&&n.text(this.hover.classifier+": "+this.hover.classes).style("visibility","visible"),"right"===this.hover.type?e.data(this.hoverData).attr("fill",t=>t["classifier"]===this.hover.classifier&&t["class"]===this.hover.classes?this.bar1HoverColor:this.bar1Color):e.attr("fill",this.bar1Color),"wrong"===this.hover.type?s.data(this.hoverData).attr("fill",t=>t["classifier"]===this.hover.classifier&&t["class"]===this.hover.classes?this.bar2HoverColor:this.bar2Color):s.attr("fill",this.bar2Color);const o=500,l=1e3;this.hover.type?(i.transition().duration(o).attr("stroke-opacity",1).attr("y1",t=>this.y(this.hover.value)).attr("x2",this.width).attr("y2",t=>this.y(this.hover.value)),a.transition().duration(o).attr("fill-opacity",1).attr("transform",`translate(\n          ${this.x.paddingOuter()*this.x.bandwidth()/2},\n          ${this.y(this.hover.value)+10})`).text((100*this.hover.value).toFixed(1)+"%"),r.transition().duration(o).attr("fill-opacity",1).attr("transform",`translate(\n          ${this.x.paddingOuter()*this.x.bandwidth()/2},\n          ${this.y(this.hover.value)-10})`).text((100*(1-this.hover.value)).toFixed(1)+"%").style("visibility","f1"==this.evaluationKeys||"mcc"==this.evaluationKeys?"hidden":"visible")):(i.transition().duration(l).attr("stroke-opacity",0),a.transition().duration(l).attr("fill-opacity",0),r.transition().duration(l).attr("fill-opacity",0).style("visibility","f1"==this.evaluationKeys||"mcc"==this.evaluationKeys?"hidden":"visible"))},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+this.margin.bottom}`).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),e=this.x,s=this.y,i=(it["z"]().range(["#d1e5f0","#fddbc7"]),this.predictionKeys),a=this.classes,r=[],n=[];for(var o in this.curData)r.push(this.curData[o]);for(var o in this.curData_reverse)n.push(this.curData_reverse[o]);const l=it["x"]().domain(i).range([0,this.width]).paddingInner(.1),c=it["x"]().domain(a).rangeRound([0,l.bandwidth()]).padding(.05),h=()=>{const e=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](l).tickSizeOuter(0));t.append("g").call(e).attr("font-size",20).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start");const i=t=>t.call(it["c"](s).ticks(5).tickFormat(it["j"](".0%")));t.append("g").call(i).attr("font-size",20)};h();const d=()=>{t.append("text").attr("transform",()=>{const t=this.width/2,e=this.height+this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Classifier"),t.append("text").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("f1"==this.evaluationKeys?"F1 Vale":"mcc"==this.evaluationKeys?"MCC value":"Fraction of instances")};d();const u=()=>{const t=this.width/4,e=this.margin.top/2,s=it["C"](this.$refs.svg).select("svg").append("g").attr("class","legend").attr("transform",`translate(\n              ${this.margin.left+3*this.width/4},\n              ${e/3})`);s.append("rect").attr("width",t).attr("height",e/2).attr("fill",this.bar2Color).style("visibility","f1"==this.evaluationKeys||"mcc"==this.evaluationKeys?"hidden":"visible"),s.append("rect").attr("y",e/2).attr("width",t).attr("height",e/2).attr("fill",this.bar1Color).style("visibility","f1"==this.evaluationKeys||"mcc"==this.evaluationKeys?"hidden":"visible"),s.append("text").attr("transform",`translate(${t/2}, ${e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("accuracy"==this.evaluationKeys?"misclassified":"precision"==this.evaluationKeys?"FP":"FN").style("visibility","f1"==this.evaluationKeys||"mcc"==this.evaluationKeys?"hidden":"visible"),s.append("text").attr("transform",`translate(${t/2}, ${3*e/4})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("accuracy"==this.evaluationKeys?"correctly classified":(this.evaluationKeys,"TP")).style("visibility","f1"==this.evaluationKeys||"mcc"==this.evaluationKeys?"hidden":"visible");const i=it["C"](this.$refs.svg).select("svg").append("g").attr("class","selectedBarText").attr("transform",`translate(\n              ${this.margin.left},\n              ${e/3})`);i.append("text").attr("class","bar-selectedBarText").attr("transform",`translate(0, ${1*e/4})`).attr("font-size","16px").text("name selected Bar").style("visibility","hidden")};u();const p=()=>{const o=e.bandwidth(),h=t.append("g").selectAll("g").data(r).enter().append("g").attr("transform",(t,e)=>`translate(${l(i[e])},0)`).selectAll("rect").data(t=>t).enter(),d=h.append("rect").attr("class","bar-right").attr("x",(t,e)=>c(a[e])).attr("y",t=>s(t)).attr("width",c.bandwidth()).attr("height",t=>this.height-s(t)).attr("fill","#d1e5f0").data(this.hoverData).on("mouseenter",t=>this.hover={type:"right",classifier:t["classifier"],classes:t["class"],value:t["value"]}).on("mouseleave",this.clearHover).on("click",t=>this.select(t["classifier"],"right","first",t["class"])).on("contextmenu",t=>this.select(t["classifier"],"right","second",t["class"]));h.append("circle").attr("class","bar-right-circle").attr("cx",(t,e)=>c(a[e])+o/4).attr("cy",t=>this.height-10).attr("r","10px").style("fill","#d1e5f0").attr("stroke","grey").attr("visibility",t=>(console.log(t),0==t||t>.2?"hidden":"visible")).data(this.hoverData).on("mouseenter",t=>this.hover={type:"right",classifier:t["classifier"],classes:t["class"],value:t["value"]}).on("mouseleave",this.clearHover).on("click",t=>this.select(t["classifier"],"right","first",t["class"])).on("contextmenu",t=>this.select(t["classifier"],"right","second",t["class"]));const u=t.append("g").selectAll("g").data(n).enter().append("g").attr("transform",(t,e)=>`translate(${l(i[e])},0)`).selectAll("rect").data(t=>t).enter(),p=u.append("rect").attr("class","bar-wrong").attr("x",(t,e)=>c(a[e])).attr("y",t=>s(1)).attr("width",c.bandwidth()).attr("height",t=>this.height-s(t)).attr("fill","#fddbc7").data(this.hoverData).on("mouseenter",t=>this.hover={type:"wrong",classifier:t["classifier"],classes:t["class"],value:t["value"]}).on("mouseleave",this.clearHover).on("click",t=>this.select(t["classifier"],"wrong","first",t["class"])).on("contextmenu",t=>this.select(t["classifier"],"wrong","second",t["class"])).style("visibility","f1"==this.evaluationKeys||"mcc"==this.evaluationKeys?"hidden":"visible");u.append("circle").attr("cx",(t,e)=>c(a[e])+o/4).attr("cy",t=>s(1)+10).attr("r","10px").style("fill","#fddbc7").attr("stroke","grey").attr("visibility",t=>"f1"==this.evaluationKeys||"mcc"==this.evaluationKeys?"hidden":(console.log(t),0==t||t>.2?"hidden":"visible")).data(this.hoverData).on("mouseenter",t=>this.hover={type:"wrong",classifier:t["classifier"],classes:t["class"],value:t["value"]}).on("mouseleave",this.clearHover).on("click",t=>this.select(t["classifier"],"wrong","first",t["class"]));const f=()=>{console.log("call sleections");const t=e.bandwidth()/8;d.append("rect").attr("class","bar-right-selection-1").attr("x",o/2-t).attr("width",t).attr("fill",this.selection1Color).attr("stroke","black").attr("stroke-width","2px").attr("pointer-events","none"),d.append("rect").attr("class","bar-right-selection-2").attr("x",o/2).attr("width",t).attr("fill",this.selection2Color).attr("stroke","black").attr("stroke-width","2px").attr("pointer-events","none"),p.append("rect").attr("class","bar-wrong-selection-1").attr("x",o/2-t).attr("width",t).attr("fill",this.selection1Color).attr("stroke","black").attr("stroke-width","2px").attr("pointer-events","none"),p.append("rect").attr("class","bar-wrong-selection-2").attr("x",o/2).attr("width",t).attr("fill",this.selection2Color).attr("stroke","black").attr("stroke-width","2px").attr("pointer-events","none"),d.append("circle").attr("class","circle-right-selection-1").attr("cx",o/2-t).attr("r","10px").style("fill",this.selection1Color).attr("stroke","grey"),d.append("circle").attr("class","circle-right-selection-2").attr("cx",o/2).attr("r","10px").style("fill",this.selection2Color).attr("stroke","grey"),p.append("circle").attr("class","circle-wrong-selection-1").attr("cx",o/2-t).attr("r","10px").style("fill",this.selection1Color).attr("stroke","grey"),p.append("circle").attr("class","circle-wrong-selection-2").attr("cx",o/2).attr("r","10px").style("fill",this.selection2Color).attr("stroke","grey")};f()},f=()=>{t.append("line").attr("class","y-axis-marker-line").attr("y1",s(1)).attr("x2",this.width).attr("y2",s(1)).attr("stroke","black").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none")},m=()=>{t.append("text").attr("class","y-axis-marker-text-right").attr("text-anchor","middle").attr("alignment-baseline","hanging").attr("font-size",20).attr("fill",this.bar1HoverColor).attr("pointer-events","none"),t.append("text").attr("class","y-axis-marker-text-wrong").attr("text-anchor","middle").attr("font-size",20).attr("fill",this.bar2HoverColor).attr("pointer-events","none")};p(),f(),m(),this.drawHover(),this.drawSelections()},drawSelections(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-right-selection-1"),s=t.selectAll(".bar-right-selection-2"),i=t.selectAll(".bar-wrong-selection-1"),a=t.selectAll(".bar-wrong-selection-2"),r=t.selectAll(".circle-right-selection-1"),n=t.selectAll(".circle-right-selection-2"),o=t.selectAll(".circle-wrong-selection-1"),l=t.selectAll(".circle-wrong-selection-2"),{first:c,second:h}=this.selections,d=(t,e)=>{const s=Lt(t,e),i=s.size/this.instances.length;return this.y(i)},u=(t,e)=>this.height-d(t,e),p=(t,e)=>{const s=Lt(t,e),i=s.size/this.instances.length;return this.height-this.y(i)};c?(e.data(this.hoverData).attr("y",t=>d(this.predictions[t["classifier"]][t["class"]].right,c.instances)).attr("height",t=>u(this.predictions[t["classifier"]][t["class"]].right,c.instances)),i.data(this.hoverData).attr("height",t=>p(this.predictions[t["classifier"]][t["class"]].wrong,c.instances)),r.data(this.hoverData).attr("cy",this.height-10).attr("visibility",t=>0==u(this.predictions[t["classifier"]][t["class"]].right,c.instances)||u(this.predictions[t["classifier"]][t["class"]].right,c.instances)/this.height>.1?"hidden":"visible"),o.attr("cy",10).data(this.hoverData).attr("visibility",t=>(console.log("  wrong height",p(this.predictions[t["classifier"]][t["class"]].wrong,c.instances)/this.height),0==p(this.predictions[t["classifier"]][t["class"]].wrong,c.instances)||p(this.predictions[t["classifier"]][t["class"]].wrong,c.instances)/this.height>.1?"hidden":"visible"))):(e.attr("height","0"),i.attr("height","0"),r.attr("visibility","hidden"),o.attr("visibility","hidden")),h?(s.data(this.hoverData).attr("y",t=>d(this.predictions[t["classifier"]][t["class"]].right,h.instances)).attr("height",t=>u(this.predictions[t["classifier"]][t["class"]].right,h.instances)),a.data(this.hoverData).attr("height",t=>p(this.predictions[t["classifier"]][t["class"]].wrong,h.instances)),n.data(this.hoverData).attr("cy",this.height-10).attr("visibility",t=>0==u(this.predictions[t["classifier"]][t["class"]].right,h.instances)||u(this.predictions[t["classifier"]][t["class"]].right,h.instances)/this.height>.1?"hidden":"visible"),l.attr("cy",10).data(this.hoverData).attr("visibility",t=>0==p(this.predictions[t["classifier"]][t["class"]].wrong,h.instances)||p(this.predictions[t["classifier"]][t["class"]].wrong,h.instances)/this.height>.1?"hidden":"visible")):(s.attr("height","0"),a.attr("height","0"),n.attr("visibility","hidden"),l.attr("visibility","hidden"))},select(t,e,s,i){console.log("trigger select",this.predictions[t][i]),it["i"].preventDefault(),it["i"].stopPropagation();const a=nt();a.rule=X.RIGHT,a.classifier=t,a.negation="wrong"===e;const r=this.predictions[t][i][e],n=`${t} ${i}Instances which ${t} got ${e}`,o={type:"simple",constraints:[a],metric:this.predictions[t][i]},l={description:n,instances:r,predicate:o,classifier:t,className:i};this.$store.dispatch("prependToSelectionHistory",l),this.$store.dispatch("changedMostRecentSelection",s)}}}),Ne=Ke,Le=(s("c648"),Object(m["a"])(Ne,Ve,je,!1,null,"030bae07",null)),We=Le.exports;v()(Le,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var qe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-container"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Confusion Matrices")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-checkbox",{attrs:{label:"Oracle",value:"Oracle"},model:{value:t.filterDummyClassifiers,callback:function(e){t.filterDummyClassifiers=e},expression:"filterDummyClassifiers"}}),s("v-checkbox",{attrs:{label:"Majority Classifier",value:"Majority Classifier"},model:{value:t.filterDummyClassifiers,callback:function(e){t.filterDummyClassifiers=e},expression:"filterDummyClassifiers"}}),s("v-checkbox",{attrs:{label:"Random Classifier",value:"Random Classifier"},model:{value:t.filterDummyClassifiers,callback:function(e){t.filterDummyClassifiers=e},expression:"filterDummyClassifiers"}})],1)])],1)],1),s("svg",{ref:"svg",attrs:{width:"100%",viewBox:"0 0 "+t.dimensions.total.width+" "+t.dimensions.total.height}})],1)},Ue=[],Ye=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"chart"})},Ge=[],Qe=i["a"].extend({name:"ColorLegend",props:{height:{type:Number,default:100},lowerBound:{type:Number,default:0},title:{type:String,required:!0},upperBound:{type:Number,default:1},width:{type:Number,default:500}},data(){const t={top:10,right:20,bottom:60,left:20},e=this.width-t.left-t.right,s=this.height-t.top-t.bottom;return{dimensions:{height:s,width:e},margin:t}},computed:{gradientId(){return Kt()}},watch:{upperBound(){this.draw()}},mounted(){this.draw()},methods:{draw(){const t=it["y"]().domain([this.lowerBound,Math.max(1,this.upperBound)]).range([0,this.dimensions.width]),e=it["C"](this.$refs.chart);e.selectAll("*").remove();const s=e.append("svg").attr("width",this.dimensions.width+this.margin.left+this.margin.right).attr("height",this.dimensions.height+this.margin.top+this.margin.bottom).attr("viewBox",`\n            0 0\n            ${this.dimensions.width+this.margin.left+this.margin.right}\n            ${this.dimensions.height+this.margin.top+this.margin.bottom}`).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),i=()=>{const t=e.select("svg").append("defs").append("linearGradient").attr("id",this.gradientId).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%"),i=100/(this.colors.length-1);this.colors.forEach((e,s)=>{t.append("stop").attr("offset",s*i+"%").attr("stop-color",e)}),s.append("rect").attr("width",this.dimensions.width).attr("height",this.dimensions.height).attr("stroke","black").attr("stroke-width","0.5px").style("fill",`url(#${this.gradientId})`)};i();const a=()=>{s.append("g").attr("transform",`translate(0 ${this.dimensions.height})`).call(it["b"](t).ticks(5)).attr("font-size",16)};a();const r=()=>{s.append("text").attr("transform",`translate(\n              ${this.dimensions.width/2},\n              ${this.dimensions.height+this.margin.bottom/2}\n            )`).attr("dy","1em").attr("text-anchor","middle").style("font-size","16px").text(this.title)};r()}}}),Je=Qe,Xe=Object(m["a"])(Je,Ye,Ge,!1,null,"0a859ee7",null),Ze=Xe.exports,ts=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"chart",on:{mouseleave:function(e){return t.onHoverChange(["",""],"")}}})},es=[],ss=i["a"].extend({name:"ConfusionMatrixMinimal",props:{boxProps:{type:Object,required:!0,validator:t=>1===t.classifiers.size},colorScales:{type:Object},hoverInfo:{type:Object,required:!0},onHoverChange:{type:Function,required:!0},sideLength:{type:Number,required:!0},updateMaxBucketedInstances:{type:Function,required:!0}},computed:{bucketedInstances(){const t=this.classes,e=[];t.forEach(s=>{t.forEach(t=>{e.push(new Set)})});const s=this.instances;return s.forEach(s=>{const i=Nt(s),a=t.length,r=t.indexOf(i.actual),n=t.indexOf(i.predictions[this.classifier]);if(-1===r||-1===n)return;const o=r*a+n;e[o].add(s)}),e},cellHeight(){const t=this.y.bandwidth();return t},cellWidth(){const t=this.x.bandwidth();return t},classes(){return[...this.boxProps.classes]},classifier(){return[...this.boxProps.classifiers][0]},instances(){return[...this.boxProps.instances]},instanceSelection(){return this.$store.state.selections.instance},maxBucketedInstances(){const t={diagonal:[],nondiagonal:[]};this.bucketedInstances.forEach((e,s)=>{this.onMainDiagonal(s)?t.diagonal.push(e.size):t.nondiagonal.push(e.size)});const e={diagonal:Math.max(...t.diagonal),nondiagonal:Math.max(...t.nondiagonal)};return this.updateMaxBucketedInstances(e),e},overlapSelections(){return this.$store.state.overlapSelections},topmostSelection(){return this.$store.state.selectionHistory[0].instances},x(){const t=it["x"]().domain(this.classes).range([0,this.sideLength]);return t},y(){const t=it["x"]().domain(this.classes).range([0,this.sideLength]);return t}},watch:{bucketedInstances(){this.drawInitial()},overlapSelections(){this.drawInitial()}},mounted(){this.drawInitial()},methods:{cellDescription(t,e){return t===e?`Instances of class '${e}' correctly classified by classifier '${this.classifier}'`:`Instances of class '${e}' misclassified as class '${t}' by classifier '${this.classifier}'`},drawInitial(){const t=this.colorScales.diagonal,e=this.colorScales.nondiagonal;it["C"](this.$refs.chart).selectAll("*").remove();const s=it["C"](this.$refs.chart).append("svg").attr("width",this.sideLength).attr("height",this.sideLength),i=(s,i)=>this.onMainDiagonal(i)?t(s):e(s),a=it["f"](this.classes,this.classes),r=s.selectAll("matrix-cell").data(a).join("g").attr("class","matrix-cell").attr("transform",t=>""+this.translateCell(t)).on("click",(t,e)=>this.updateUserSelection(t,e)).on("mouseenter",t=>this.onHoverChange(t,this.classifier)),n=this.cellWidth,o=this.cellHeight,l=()=>{r.append("rect").attr("width",n).attr("height",o).attr("fill",(t,e)=>i(this.bucketedInstances[e].size,e)).attr("stroke-width","0.5px").attr("stroke","black")};l(),this.drawHoverOutline();const c=()=>{const t=this.overlapSelections.first;if(null===t)return;const e=t.instances;r.append("rect").attr("y",4*o/6).attr("width",n).attr("height",o/6).attr("fill",Ot.overlapSelections.background).html((t,s)=>{const i=Wt(e,this.bucketedInstances[s]);return`\n              <title>\n                ${i} instance(s) overlap.\n              </title>\n            `}),r.append("rect").attr("y",4*o/6).attr("width",(t,s)=>n*qt(e,this.bucketedInstances[s])).attr("height",o/6).attr("fill",Ot.overlapSelections.first).attr("pointer-events","none")};c();const h=()=>{const t=this.overlapSelections.second;if(null===t)return;const e=t.instances;r.append("rect").attr("y",5*o/6).attr("width",n).attr("height",o/6).attr("fill",Ot.overlapSelections.background).html((t,s)=>{const i=Wt(e,this.bucketedInstances[s]);return`\n              <title>\n                ${i} instance(s) overlap.\n              </title>\n            `}),r.append("rect").attr("y",5*o/6).attr("width",(t,s)=>n*qt(e,this.bucketedInstances[s])).attr("height",o/6).attr("fill",Ot.overlapSelections.second).attr("pointer-events","none")};h()},drawHoverOutline(){if(""===this.hoverInfo.classes.actual||""===this.hoverInfo.classes.predicted||""===this.hoverInfo.classifier)return;const{actual:t,predicted:e}=this.hoverInfo.classes,s=it["C"](this.$refs.chart).select("svg");s.append("rect").attr("transform",this.translateCell([t,e])).attr("width",this.cellWidth).attr("height",this.cellHeight).attr("fill","none").attr("stroke-width","3px").attr("stroke","#FF9800").attr("pointer-events","none"),s.append("text").attr("x",this.x(e)+this.cellWidth/2).attr("y",this.y(t)+this.cellHeight/2).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("font-size",12).attr("pointer-events","none").html(()=>{const s=this.classes.indexOf(t),i=this.classes.indexOf(e),a=s*this.classes.length+i,r=this.bucketedInstances[a].size;return""+r})},onMainDiagonal(t){const e=this.boxProps.classes.size,s=Math.floor(t/e),i=t%e;return s===i},translateCell(t){return`translate(${this.x(t[1])}, ${this.y(t[0])})`},updateUserSelection(t,e){const[s,i]=t;console.log("user selection updated:",t,e);const a={instances:this.bucketedInstances[e],description:this.cellDescription(i,s)};this.$store.dispatch("prependToSelectionHistory",a)}}}),is=ss,as=(s("47a9"),Object(m["a"])(is,ts,es,!1,null,"c267964c",null)),rs=as.exports,ns=i["a"].extend({name:"ConfusionMatrixGrid",components:{ColorLegend:Ze,ConfusionMatrixMinimal:rs},data(){const t=1e3,e=900,s={width:t,height:e},i={xOffset:0,yOffset:0,width:.7*t,height:150},a={xOffset:i.width,yOffset:0,width:t-i.width,height:i.height},r={xOffset:0,yOffset:i.height,width:200,height:e-i.height},n={xOffset:r.width,yOffset:r.yOffset,width:t-r.width,height:r.height};return{colors:Ot,dimensions:{actualClassLegend:r,colorLegend:a,matrixGrid:n,predictedClassLegend:i,total:s},filterDummyClassifiers:[],hoverInfo:{classes:{actual:"",predicted:""},classifier:""},panel:[]}},props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},computed:{actualClassScale(){const t=it["x"]().domain(this.classes).range([0,this.y.bandwidth()]).paddingInner(0);return t},allBucketedInstances(){const t={};return this.classifiers.forEach(e=>{t[e]=this.bucketedInstancesByClassifier(e)}),t},classes(){return[...this.boxProps.classes]},classCross(){const t=it["f"](this.classes,this.classes);return t},classifierClassCross(){const t=(t,e)=>[].concat(...t.map(t=>e.map(e=>[].concat(t,e)))),e=(s,i,...a)=>i?e(t(s,i),...a):s,s=e(this.classifiers,this.classes,this.classes);return s},classifiers(){const t=[...this.boxProps.classifiers].filter(t=>!this.filterDummyClassifiers.includes(t));return t},colorScales(){const t={diagonal:it["y"]().domain([0,this.maxBucketedInstances.diagonal]).range([this.colors.goodLight,Ot.goodDark]),nondiagonal:it["y"]().domain([0,this.maxBucketedInstances.nondiagonal]).range([this.colors.badLight,Ot.badDark])};return t},gradientId(){return{correctlyClassified:Kt(),misclassified:Kt()}},margin(){const t={top:.05*this.dimensions.matrixGrid.height,right:.05*this.dimensions.matrixGrid.width,bottom:.05*this.dimensions.matrixGrid.height,left:.05*this.dimensions.matrixGrid.width},e={top:.25*this.dimensions.colorLegend.height,right:.1*this.dimensions.colorLegend.width,bottom:.25*this.dimensions.colorLegend.height,left:.1*this.dimensions.colorLegend.width},s={top:.2*this.dimensions.actualClassLegend.height,right:.6*this.dimensions.actualClassLegend.width,bottom:.1*this.dimensions.actualClassLegend.height,left:.1*this.dimensions.actualClassLegend.width},i={top:.6*this.dimensions.predictedClassLegend.height,right:.1*this.dimensions.predictedClassLegend.width,bottom:.1*this.dimensions.predictedClassLegend.height,left:.25*this.dimensions.predictedClassLegend.width};return{colorLegend:e,grid:t,sideBar:s,topBar:i}},instances(){return[...this.boxProps.instances]},matricesPerRow(){const t=Math.ceil(Math.sqrt(this.classifiers.length));return t},maxBucketedInstances(){const t={diagonal:1,nondiagonal:1};return this.classifiers.forEach(e=>{const s=this.maxBucketedInstancesByClassifier(e);t.diagonal=Math.max(s.diagonal,t.diagonal),t.nondiagonal=Math.max(s.nondiagonal,t.nondiagonal)}),t},nRows(){const t=this.matricesPerRow;return t},predictedClassScale(){const t=it["x"]().domain(this.classes).range([0,this.x.bandwidth()]).paddingInner(0);return t},selections(){return this.$store.state.overlapSelections},x(){const t=this.margin.grid,e=this.dimensions.matrixGrid.width-t.left-t.right,s=[];for(let a=0;a<this.matricesPerRow;a++)s.push(a.toString());const i=it["x"]().domain(s).range([0,e]).paddingInner(.2);return i},y(){const t=this.margin.grid,e=this.dimensions.matrixGrid.height-t.top-t.bottom,s=[];for(let a=0;a<this.nRows;a++)s.push(a.toString());const i=it["x"]().domain(s).range([0,e]).paddingInner(.2);return i}},watch:{boxProps(){this.drawInitial()},classifiers(){this.drawInitial()},hoverInfo(){this.drawHover()},instances(){this.drawInitial()},matricesPerRow(){this.drawGrid()},selections(){this.drawSelections()}},mounted(){this.drawInitial()},methods:{bucketedInstancesByClassifier(t){const e=this.classes,s=[];e.forEach(t=>{e.forEach(t=>{s.push(new Set)})});const i=this.instances;return i.forEach(i=>{const a=Nt(i),r=e.length,n=e.indexOf(a.actual),o=e.indexOf(a.predictions[t]);if(-1===n||-1===o)return;const l=n*r+o;s[l].add(i)}),s},cachedBucketedInstancesByClassifier(t){return this.allBucketedInstances[t]},cellDescription(t){const[e,s,i]=t;return i===s?`Instances of class '${s}' correctly classified by classifier '${e}'`:`Instances of class '${s}' misclassified as class '${i}' by classifier '${e}'`},drawInitial(){this.drawColorLegend(),this.drawSidebar(),this.drawTopBar(),this.drawGrid(),this.drawSelections()},drawColorLegend(){const t=this.margin.colorLegend,e=this.dimensions.colorLegend.width-t.left-t.right,s=this.dimensions.colorLegend.height-t.top-t.bottom,i=it["C"](this.$refs.svg),a=[{id:this.gradientId.misclassified,colorDark:Ot.badDark,colorLight:Ot.badLight},{id:this.gradientId.correctlyClassified,colorDark:Ot.goodDark,colorLight:Ot.goodLight}],r=()=>{i.selectAll(".color-legend-defs").remove();const t=i.append("defs").attr("class","color-legend-defs"),e=t.selectAll("linearGradient").data(a).join("linearGradient").attr("id",t=>t.id).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");e.append("stop").attr("offset","0%").attr("stop-color",t=>t.colorLight).attr("stop-opacity",1),e.append("stop").attr("offset","100%").attr("stop-color",t=>t.colorDark).attr("stop-opacity",1)};r(),i.selectAll(".color-legend").remove();const n=i.append("g").attr("class","color-legend").attr("transform",`translate(\n          ${this.dimensions.colorLegend.xOffset+t.left},\n          ${this.dimensions.colorLegend.yOffset+t.top})`),o=()=>{n.selectAll("rect").data(a).join("rect").attr("y",(t,e)=>e*s/2).attr("width",e).attr("height",s/2).attr("stroke","black").attr("stroke-width","0.5px").style("fill",t=>`url(#${t.id})`)};o();const l=()=>{const t=it["y"]().domain([0,this.maxBucketedInstances.diagonal]).range([0,e]);n.append("g").call(it["e"](t).ticks(3)).attr("font-size",16);const i=it["y"]().domain([0,this.maxBucketedInstances.nondiagonal]).range([0,e]);n.append("g").attr("transform",`translate(0 ${s})`).call(it["b"](i).ticks(3)).attr("font-size",16)};l();const c=()=>{n.append("text").attr("transform",`translate(\n              ${e/2},\n              ${s/4}\n            )`).attr("text-anchor","middle").attr("alignment-baseline","middle").style("font-size",16).text("misclassified"),n.append("text").attr("transform",`translate(\n              ${e/2},\n              ${3*s/4}\n            )`).attr("text-anchor","middle").attr("alignment-baseline","middle").style("font-size",16).text("correctly classified")};c()},drawHover(){},drawGrid(){const t=this.margin.grid,e=this.classes,s=this.classifiers,i=(this.instances,it["C"](this.$refs.svg));i.selectAll(".matrix-grid").remove();const a=i.append("g").attr("class","matrix-grid").attr("transform",`translate(\n          ${this.dimensions.matrixGrid.xOffset+t.left},\n          ${this.dimensions.matrixGrid.yOffset+t.top})`).on("mouseleave",()=>this.updateHoverCell(["","",""])),r=this.x,n=this.y,o=t=>Math.floor(t/this.matricesPerRow),l=t=>t%this.matricesPerRow,c=a.selectAll(".matrix").data(s).join("g").attr("class","matrix").attr("transform",(t,e)=>`translate(\n            ${r(l(e).toString())},\n            ${n(o(e).toString())}\n          )`);c.append("rect").attr("width",r.bandwidth()).attr("height",n.bandwidth()).attr("fill","black").attr("stroke","black");const h=this.actualClassScale,d=this.predictedClassScale,u=this.classCross;c.selectAll(".matrix-cell").data(u).join("g").attr("class","matrix-cell").attr("transform",t=>`translate(\n            ${d(t[1])},\n            ${h(t[0])}\n          )`);const p=this.classifierClassCross,f=a.selectAll(".matrix-cell").data(p).on("mouseenter",t=>this.updateHoverCell(t)).on("click",t=>this.select(t,"first")).on("contextmenu",t=>this.select(t,"second")),m=()=>{const t=d.bandwidth(),s=h.bandwidth();f.append("rect").attr("class","matrix-cell-rect").attr("width",t).attr("height",6*s/8).attr("fill",t=>{let s="";const[i,a,r]=t,n=e.indexOf(a),o=e.indexOf(r),l=n*e.length+o,c=this.cachedBucketedInstancesByClassifier(i)[l].size;return 0===c?"white":(s=a===r?this.colorScales.diagonal(c):this.colorScales.nondiagonal(c),s)}).style("paint-order","stroke");const i=()=>{const e=h.bandwidth()/8,i=e/3;f.append("rect").attr("class","selection-background-rect").attr("y",6*s/8).attr("width",t).attr("height",2*e).attr("fill","black"),f.append("rect").attr("class","bar-selection-1").attr("y",6*s/8).attr("width",0).attr("height",s/8).attr("fill",Ot.overlapSelections.first).attr("stroke","black"),f.append("circle").attr("class","dot-selection-1").attr("cx",t/2).attr("cy",6*s/8+s/16).attr("r",i).attr("fill",Ot.overlapSelections.first).attr("fill-opacity",0),f.append("rect").attr("class","bar-selection-2").attr("y",7*s/8).attr("width",0).attr("height",s/8).attr("fill",Ot.overlapSelections.second).attr("stroke","black"),f.append("circle").attr("class","dot-selection-2").attr("cx",t/2).attr("cy",7*s/8+s/16).attr("r",i).attr("fill",Ot.overlapSelections.second).attr("fill-opacity",0)};i()};m();const g=()=>{c.data(this.classifiers).append("text").attr("transform",()=>{const t=r.bandwidth()/2,e=-10;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text(t=>t)};g();const v=()=>{f.append("circle").attr("class","hover-dot").attr("cx",d.bandwidth()/2).attr("cy",h.bandwidth()/2).attr("r",Math.min(d.bandwidth(),h.bandwidth())/6).attr("fill","black").attr("fill-opacity",0)};v()},drawSelections(){console.log("drawing selections");this.classifierClassCross;const t=it["C"](this.$refs.svg),e=t.selectAll(".bar-selection-1"),s=t.selectAll(".bar-selection-2"),i=t.selectAll(".dot-selection-1"),a=t.selectAll(".dot-selection-2"),{first:r,second:n}=this.selections,o=this.predictedClassScale.bandwidth(),l=(this.actualClassScale.bandwidth(),.2),c=(t,e)=>{const s=this.instancesByCross(t),i=Lt(s,e.instances),a=i.size/s.size;return a<l?0:a*o},h=(t,e)=>{const s=this.instancesByCross(t),i=Lt(s,e.instances),a=i.size/s.size;return a>0&&a<l?1:0};r?(e.data(this.classifierClassCross).attr("width",t=>c(t,r)),i.data(this.classifierClassCross).attr("fill-opacity",t=>h(t,r))):(e.attr("width",0),i.attr("fill-opacity",0)),n?(s.data(this.classifierClassCross).attr("width",t=>c(t,n)),a.data(this.classifierClassCross).attr("fill-opacity",t=>h(t,n))):(s.attr("width",0),a.attr("fill-opacity",0))},drawSidebar(){const t=this.margin.sideBar,e=this.dimensions.actualClassLegend.width-t.left-t.right,s=this.dimensions.actualClassLegend.height-t.top-t.bottom,i=this.classes,a=it["x"]().domain(i).range([0,s]).paddingInner(.2),r=it["C"](this.$refs.svg);r.selectAll(".actual-class-legend").remove();const n=r.append("g").attr("class","actual-class-legend").attr("transform",`translate(\n          ${this.dimensions.actualClassLegend.xOffset+t.left},\n          ${this.dimensions.actualClassLegend.yOffset+t.top})`),o=n.selectAll("legend-entry").data(i).join("g").attr("class","legend-entry").attr("transform",(t,e)=>`translate(0, ${a(t)})`);o.append("rect").attr("class","hover-indicator-rect").attr("width",e).attr("height",a.bandwidth()).attr("fill",t=>this.hoverInfo.classes.actual===t?"orange":"lightgray"),n.append("g").attr("class","side-axis").attr("transform",`translate(${e}, 0)`).call(it["d"](a)).selectAll("text").style("text-anchor","start").style("font-size",14),n.selectAll(".side-axis").select(".domain").attr("stroke-opacity","0");const l=()=>{n.append("text").attr("transform",`translate(0, ${-t.top/2})`).attr("text-anchor","start").attr("alignment-baseline","middle").style("font-size",20).text("Actual class")};l()},drawTopBar(){const t=this.margin.topBar,e=this.dimensions.predictedClassLegend.width-t.left-t.right,s=this.dimensions.predictedClassLegend.height-t.top-t.bottom,i=this.classes,a=it["x"]().domain(i).range([0,e]).paddingInner(.2),r=it["C"](this.$refs.svg);r.selectAll(".predicted-class-legend").remove();const n=r.append("g").attr("class","predicted-class-legend").attr("transform",`translate(\n          ${this.dimensions.predictedClassLegend.xOffset+t.left},\n          ${this.dimensions.predictedClassLegend.yOffset+t.top})`),o=n.selectAll("legend-entry").data(i).join("g").attr("class","legend-entry").attr("transform",(t,e)=>`translate(${a(t)}, 0)`);o.append("rect").attr("class","hover-indicator-rect").attr("width",a.bandwidth()).attr("height",s).attr("fill",t=>this.hoverInfo.classes.predicted===t?"orange":"lightgray"),n.append("g").attr("class","top-axis").call(it["e"](a)).selectAll("text").attr("x","0.7em").attr("y","-0.7em").attr("transform","rotate(-30)").style("text-anchor","start").style("font-size",14),n.selectAll(".top-axis").select(".domain").attr("stroke-opacity","0");const l=()=>{n.append("text").attr("transform",`translate(${-t.left/2}, ${s/2})`).attr("text-anchor","middle").attr("alignment-baseline","middle").style("font-size",20).text("Predicted class")};l()},instancesByCross(t){const[e,s,i]=t,a=this.classes,r=a.indexOf(s),n=a.indexOf(i),o=r*a.length+n,l=this.cachedBucketedInstancesByClassifier(e)[o];return l},maxBucketedInstancesByClassifier(t){const e={diagonal:[],nondiagonal:[]};this.cachedBucketedInstancesByClassifier(t).forEach((t,s)=>{this.onMainDiagonal(s)?e.diagonal.push(t.size):e.nondiagonal.push(t.size)});const s={diagonal:Math.max(...e.diagonal),nondiagonal:Math.max(...e.nondiagonal)};return s},onMainDiagonal(t){const e=this.boxProps.classes.size,s=Math.floor(t/e),i=t%e;return s===i},select(t,e){it["i"].preventDefault(),it["i"].stopPropagation();const[s,i,a]=t,r=this.classes,n=r.indexOf(i),o=r.indexOf(a),l=n*r.length+o,c=nt();c.rule=X.ACTUAL,c.target=i;const h=nt();h.rule=X.PREDICTED,h.classifier=s,h.target=a;const d=this.cachedBucketedInstancesByClassifier(s)[l],u=this.cellDescription(t),p={type:"simple",constraints:[c,h],metric:[]},f={description:u,instances:d,predicate:p};this.$store.dispatch("prependToSelectionHistory",f),this.$store.dispatch("changedMostRecentSelection",e)},updateHoverCell(t){const[e,s,i]=t;this.hoverInfo.classes.actual===s&&this.hoverInfo.classes.predicted===i&&this.hoverInfo.classifier===e||(this.hoverInfo={classes:{actual:s,predicted:i},classifier:e})}}}),os=ns,ls=(s("3f5e"),s("ac7c")),cs=Object(m["a"])(os,qe,Ue,!1,null,"18cb8c7c",null),hs=cs.exports;v()(cs,{VCheckbox:ls["a"],VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"]});var ds=s("310e"),us=s.n(ds),ps=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Cumulative Accuracy")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Sort by how many classifiers correctly classified an instance"},model:{value:t.sorting,callback:function(e){t.sorting=e},expression:"sorting"}},[s("v-radio",{attrs:{label:"ascending",value:"ascending"}}),s("v-radio",{attrs:{label:"descending",value:"descending"}})],1)],1)])],1)],1),s("div",{ref:"svg"})],1)},fs=[],ms=i["a"].extend({name:"CumulativeAccuracy",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:50,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=500-t.top-t.bottom,i="descending",a={type:"",count:-1};return{svg:"",height:s,hover:a,width:e,margin:t,panel:[],selection1Color:"#18FFFF",selection2Color:"#FF4081",sorting:i}},computed:{agreementKeys(){const t=Object.keys(this.agreements).map(Number).sort();return"descending"===this.sorting&&t.reverse(),t},agreements(){const t={};for(let e=0;e<=this.classifiers.length;e++)t[e]=new Set;return this.instances.forEach(e=>{const s=Nt(e),i=this.classifiers.filter(t=>s.predictions[t]===s.actual),a=i.length;t[a].add(e)}),t},classes(){return[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},cumulativeAgreements(){const t={};return this.agreementKeys.forEach((e,s)=>{t[e]=new Set,this.agreementKeys.slice(0,s+1).forEach(s=>{t[e]=Ut(t[e],this.agreements[s])})}),t},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},selections(){return this.$store.state.overlapSelections},focusItemId(){return this.$store.state.focusItemId},focusDotEmphasis(){return this.$store.state.focusDotEmphasis},x(){const t=it["x"]().domain(this.agreementKeys).range([0,this.width]).paddingOuter(1).paddingInner(.1);return t},y(){const t=it["y"]().domain([0,1]).range([this.height,0]);return t}},watch:{hover(){this.drawHover()},instances(){this.drawInitial()},selections(){this.drawInitial()},focusItemId(){this.drawInitial()},focusDotEmphasis(){this.drawInitial()},sorting(){this.drawInitial()}},mounted(){this.drawInitial()},methods:{barYOffset(t){const e=this.agreements[t].size,s=e/this.instances.length;return this.y(s)},clearHover(){this.hover={type:"",count:-1}},circleYOffset(t){const e=this.cumulativeAgreements[t].size,s=e/this.instances.length;return this.y(s)},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+this.margin.bottom}`).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),e=this.x,s=this.y,i=()=>{const i=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](e).tickSizeOuter(0));t.append("g").call(i).attr("font-size",20);const a=t=>t.call(it["c"](s).ticks(5).tickFormat(it["j"](".0%")));t.append("g").call(a).attr("font-size",20)};i();const a=()=>{t.append("text").attr("transform",()=>{const t=this.width/2,e=this.height+.8*this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("How many classifiers correctly classified an instance"),t.append("text").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("Fraction of instances")};a();const r=()=>{const s=t.selectAll(".cell").data(this.agreementKeys).join("g").attr("class","cell").attr("transform",t=>`translate(${e(t)}, 0)`).on("mouseenter",t=>this.hover={type:"individual",count:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"individual","first")).on("contextmenu",t=>this.select(t,"individual","second"));this.svg=t;const i=e.bandwidth(),a=this.barYOffset,r=t=>this.height-a(t);s.append("rect").attr("class","bar").attr("y",t=>a(t)).attr("width",i).attr("height",t=>r(t)).attr("fill","lightgray").attr("stroke","black").style("paint-order","stroke"),s.append("circle").attr("class","bar-circle").attr("cx",i/2).attr("cy",this.height-15).attr("r","15px").attr("visibility",t=>r(t)/this.height==0||r(t)/this.height>.05?"hidden":"visible").style("fill","lightgray").attr("stroke","grey")},n=()=>{const s=e.bandwidth()/2,i=this.circleYOffset,a=Math.min(this.width/30,e.bandwidth()/10);t.selectAll("circle").data(this.agreementKeys).join("circle").attr("class","cumulative").attr("cx",t=>e(t)+s).attr("cy",t=>i(t)).attr("r",a).attr("fill","lightgray").attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hover={type:"cumulative",count:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"cumulative","first")).on("contextmenu",t=>this.select(t,"cumulative","second"))},o=()=>{const i=it["s"]().x(t=>t[0]).y(t=>t[1]),a=[],r=e.bandwidth()/2,n=t=>{const e=this.cumulativeAgreements[t].size,i=e/this.instances.length;return s(i)};this.agreementKeys.forEach(t=>{const s=e(t)+r,i=n(t);a.push([s,i])}),t.append("path").datum(a).attr("d",i).attr("fill","none").attr("stroke","lightgray").attr("stroke-width","2px")},l=()=>{t.append("line").attr("class","y-axis-marker-line").attr("y1",s(1)).attr("x2",this.width).attr("y2",s(1)).attr("stroke","red").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none")},c=()=>{t.append("text").attr("class","y-axis-marker-text").attr("text-anchor","middle").attr("font-size",20).attr("pointer-events","none")};o(),n(),r(),l(),c(),this.drawHover(),this.drawSelections()},drawHover(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar"),s=t.selectAll(".cumulative"),i=t.select(".y-axis-marker-line"),a=t.select(".y-axis-marker-text"),r=500,n=1e3;switch(this.hover.type){case"individual":e.data(this.agreementKeys).transition().duration(r).attr("fill",t=>t===this.hover.count?"black":"lightgray"),s.transition().duration(r).attr("fill","lightgray"),i.transition().duration(r).attr("stroke-opacity",1).attr("y1",this.barYOffset(this.hover.count)).attr("x2",this.width).attr("y2",this.barYOffset(this.hover.count)),a.transition().duration(r).attr("transform",`translate(\n              ${this.x.paddingOuter()*this.x.bandwidth()/2},\n              ${this.barYOffset(this.hover.count)-10})`).text((this.agreements[this.hover.count].size/this.instances.length*100).toFixed(1)+"%");break;case"cumulative":const t=this.agreementKeys.indexOf(this.hover.count);e.data(this.agreementKeys).transition().duration(r).attr("fill",(e,s)=>s<=t?"black":"lightgray"),s.data(this.agreementKeys).transition().duration(r).attr("fill",t=>t===this.hover.count?"black":"lightgray"),i.transition().duration(r).attr("stroke-opacity",1).attr("y1",this.circleYOffset(this.hover.count)).attr("x2",this.x(this.hover.count)+this.x.bandwidth()/2).attr("y2",this.circleYOffset(this.hover.count)),a.transition().duration(r).attr("transform",`translate(\n              ${this.x.paddingOuter()*this.x.bandwidth()/2},\n              ${this.circleYOffset(this.hover.count)-10})`).text((this.cumulativeAgreements[this.hover.count].size/this.instances.length*100).toFixed(1)+"%");break;default:e.transition().duration(n).attr("fill","lightgray"),s.transition().duration(n).attr("fill","lightgray"),i.transition().duration(n).attr("stroke-opacity",0),a.transition().duration(n).text("");break}},drawSelections(){it["C"](this.$refs.svg);const{first:t,second:e}=this.selections,s=(t,e)=>{const s=Lt(t,e),i=s.size/this.instances.length;return this.y(i)},i=(t,e)=>this.height-s(t,e),a=(t,e)=>{const s=Lt(t,e);for(const i of s)if(this.$store.state.focusItemId===i)return!0;return!1},r=[t,e],n=this.x,o=n.bandwidth(),l=o/8;r.forEach((t,e)=>{t?this.agreementKeys.forEach(r=>{let c={barCells:this.svg,x:n(r)+o/2+(e-1)*l,y:s(this.agreements[r],t.instances),width:l,height:i(this.agreements[r],t.instances),r:l/2,color:0==e?this.selection1Color:this.selection2Color,circle_visibility:0==i(this.agreements[r],t.instances)||i(this.agreements[r],t.instances)/this.height>.05?"hidden":"visible",cx:n(r)+o/2+(e-.5)*l,cy:this.height-l/2,selection_type:e,focused:a(this.agreements[r],t.instances),view_name:this.name};this.$store.dispatch("drawSelections",c)}):(this.svg.selectAll("selection-rect-"+e).attr("height","0"),this.svg.selectAll("selection-circle-"+e).attr("visibility","hidden"))})},select(t,e,s){it["i"].preventDefault(),it["i"].stopPropagation();const i="individual"===e?this.agreements[t]:this.cumulativeAgreements[t],a="individual"===e?`Instances which exactly ${t} classifiers correctly classified`:`Instances which at least ${t} classifiers correctly classified`;this.$store.dispatch("prependToSelectionHistory",{instances:i,description:a}),this.$store.dispatch("changedMostRecentSelection",s)}}}),gs=ms,vs=(s("69e9"),Object(m["a"])(gs,ps,fs,!1,null,"1393318d",null)),ys=vs.exports;v()(vs,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var _s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-expansion-panels",{attrs:{multiple:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},["continuous"==t.datasetType?s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("Threshold Set")]),s("v-expansion-panel-content",[s("ContinuousMode")],1)],1):t._e(),"continuous"==t.datasetType?s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("BandWidth Set (Trinary Mode)")]),s("v-expansion-panel-content",[s("UncertainAdjuster")],1)],1):t._e(),s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("Selection History")]),s("v-expansion-panel-content",[s("SetHistory")],1)],1),"continuous"==t.datasetType?s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("Instance Sampling")]),s("v-expansion-panel-content",[s("RandomSampling"),s("StratifiedSampling"),s("BootstrapSampling")],1)],1):t._e(),"continuous"==t.datasetType?s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("K-Fold Validation")]),s("v-expansion-panel-content",[s("KfoldValidation")],1)],1):t._e()],1)},xs=[],bs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-expansion-panels",{attrs:{multiple:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("Classes")]),s("v-expansion-panel-content",[s("v-list",{attrs:{dense:""}},t._l(t.classList,(function(e){return s("v-list-item",{key:e,on:{click:t.applyFilter}},[s("v-list-item-title",[s("v-checkbox",{attrs:{value:e,label:e},model:{value:t.checkedBoxes,callback:function(e){t.checkedBoxes=e},expression:"checkedBoxes"}})],1)],1)})),1)],1)],1)],1)},ws=[],Cs=i["a"].extend({name:"ClassFilter",data(){return{panel:[],checkedBoxes:[]}},computed:{classList(){return[...this.$store.getters.classes]}},methods:{applyFilter(){const t={entityType:W.Class,newFilter:{type:U.Exclude,set:new Set(this.checkedBoxes)}};console.log("class checkboxes",t),this.$store.dispatch("changedFilter",t)}}}),ks=Cs,Ss=Object(m["a"])(ks,bs,ws,!1,null,null,null),zs=Ss.exports;v()(Ss,{VCheckbox:ls["a"],VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VList:C["a"],VListItem:k["a"],VListItemTitle:S["c"]});var $s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-expansion-panels",{attrs:{multiple:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("Classifiers")]),s("v-expansion-panel-content",[s("v-list",t._l(t.classifierThresholdList,(function(e){return s("v-list-item",{key:e,on:{click:t.applyFilter}},[s("v-list-item-title",[s("v-checkbox",{attrs:{value:e,label:e},model:{value:t.checkedBoxes,callback:function(e){t.checkedBoxes=e},expression:"checkedBoxes"}})],1)],1)})),1)],1)],1)],1)},Fs=[],Ts=i["a"].extend({name:"ClassifierFilter",data(){return{panel:[],checkedBoxes:[]}},computed:{classifierThresholdList(){return[...this.$store.getters.classifiers]},datasetType(){return this.$store.state.datasetType}},methods:{applyFilter(){const t={entityType:W.Classifier,newFilter:{type:U.Exclude,set:new Set(this.checkedBoxes)}};console.log("classifier checkboxes",t),this.$store.dispatch("changedFilter",t),"continuous"==this.datasetType&&this.$store.dispatch("changedContinuousMetrics")}}}),Es=Ts,Is=Object(m["a"])(Es,$s,Fs,!1,null,null,null),Ps=Is.exports;v()(Is,{VCheckbox:ls["a"],VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VList:C["a"],VListItem:k["a"],VListItemTitle:S["c"]});var Ds=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticStyle:{"margin-left":"20px"}}),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.instances,pagination:t.pagination,"disable-initial-sort":""},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[s("tr",{class:{"hover-instance":e.item===t.$store.state.hoverInstance},style:t.styleTableRow(e.item),on:{mouseenter:function(s){return t.changedHoverInstance(e.item.id)},mouseleave:t.clearHoverInstance,click:function(s){return s.stopPropagation(),s.preventDefault(),t.select(e.item.id,"first")},contextmenu:function(s){return s.stopPropagation(),s.preventDefault(),t.select(e.item.id,"second")}}},[s("td",[t._v(t._s(e.item.id))]),s("td",[t._v(t._s(e.item.actual))]),t._l(t.classifiers,(function(i){return s("td",{key:i},[t._v(" "+t._s(e.item.predictions[i])+" ")])})),t._l(t.features,(function(i){return s("td",{key:i},[t._v(" "+t._s(e.item.features[i])+" ")])}))],2)]}}])})],1)},Os=[],As=i["a"].extend({name:"InstanceList",data(){return{sortBy:"",pagination:{rowsPerPage:10}}},computed:{classifiers(){const t=[...this.$store.getters.filteredClassifiers];return t},features(){const t=[...this.$store.getters.features];return t},headers(){const t=[{text:"Id",value:"id"},{text:"Actual class",value:"actualClass"}];return this.classifiers.forEach(e=>{t.push({text:e.replace(/_/g," "),value:e})}),this.$store.getters.features.forEach(e=>{t.push({text:e,value:e})}),t},instances(){const t=[];this.$store.getters.filteredInstances.forEach(e=>{const s=Nt(e),i=Object.assign({id:e},s);t.push(i)});const{first:e,second:s}=this.selections,i={first:(t,s)=>{let i=0,a=0;return e&&e.instances.has(t.id)&&i++,e&&e.instances.has(s.id)&&a++,a-i},second:(t,e)=>{let i=0,a=0;return s&&s.instances.has(t.id)&&i++,s&&s.instances.has(e.id)&&a++,a-i},common:(t,i)=>{let a=0,r=0;return e&&e.instances.has(t.id)&&a++,e&&e.instances.has(i.id)&&r++,s&&s.instances.has(t.id)&&a++,s&&s.instances.has(i.id)&&r++,r-a}};return this.sortBy&&t.sort(i[this.sortBy]),t},selections(){return this.$store.state.overlapSelections}},watch:{selections(){const{first:t,second:e}=this.selections;this.sortBy=t&&e?"common":t?"first":e?"second":""}},methods:Object.assign(Object.assign({},Object(d["b"])(["changedHoverInstance","clearHoverInstance"])),{select(t,e){const s=new Set([t]),i="Instance #"+t;this.$store.dispatch("prependToSelectionHistory",{instances:s,description:i}),this.$store.dispatch("changedMostRecentSelection",e)},styleTableRow(t){const{first:e,second:s}=Ot.overlapSelections,{first:i,second:a}=this.selections,r=i&&i.instances.has(t.id),n=a&&a.instances.has(t.id);return r&&n?`\n          background: -webkit-linear-gradient(top, ${e}, ${s});\n          color: white;\n        `:r?`\n          background-color: ${e};\n        `:n?`\n          background-color: ${s};\n          color: white;\n        `:""}})}),Bs=As,Ms=(s("3d07"),s("8fea")),Rs=Object(m["a"])(Bs,Ds,Os,!1,null,"47878edb",null),Hs=Rs.exports;v()(Rs,{VDataTable:Ms["a"]});var Vs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticStyle:{padding:"10px"}},[s("div",{staticClass:"buttons"},[s("div",{staticStyle:{display:"table"}},[s("v-radio-group",{attrs:{label:"Base dataset",row:""},on:{change:t.continuousChange},model:{value:t.$store.state.baseDataset,callback:function(e){t.$set(t.$store.state,"baseDataset",e)},expression:"$store.state.baseDataset"}},[s("v-radio",{attrs:{label:"training",value:"train"}}),s("v-radio",{attrs:{label:"testing",value:"test"}}),s("v-radio",{attrs:{label:"all",value:"both"}}),"continuous"==t.datasetType?s("v-radio",{attrs:{label:"sample",value:"sample"}}):t._e()],1)],1),s("div",{staticStyle:{display:"table"}},[s("span",{staticStyle:{display:"table-cell","vertically-align":"middle","font-size":"12px"}},[t._v("Current selections")]),t._l(["first","second"],(function(e){return s("v-menu",{key:e,attrs:{"open-on-hover":"",bottom:"","offset-y":"","max-height":"500px"},scopedSlots:t._u([{key:"activator",fn:function(i){var a=i.on;return[s("v-btn",t._g({class:{"white--text":"second"===e},attrs:{color:t.colors.overlapSelections[e],fab:"",small:""}},a),[t._v(" "+t._s(t.overlapSelectionDescription(e))+" ")])]}}],null,!0)},[s("v-list",[s("v-list-item",{on:{click:function(s){return t.setOverlapSelection({whichOverlap:e,selection:null})}}},[s("v-list-item-title",[t._v("None")])],1),t._l(t.selectionHistory,(function(i){return s("v-list-item",{key:i.id,on:{click:function(s){return t.setOverlapSelection({whichOverlap:e,selection:i})}}},[s("v-list-item-title",[t._v(t._s(i.id))])],1)}))],2)],1)})),s("v-btn",{attrs:{dark:"",small:""},on:{click:t.clearOverlapSelections}},[t._v(" Clear both ")])],2),s("div",{staticStyle:{display:"table","margin-top":"25px"}},[s("span",{staticStyle:{display:"table-cell","vertically-align":"middle","font-size":"12px"}},[t._v("Operations")]),t._l(t.operations,(function(e){return s("v-btn",{key:e.description,style:"font-size: 24px; margin-right: 10px; "+e.style,attrs:{dark:"",fab:"",small:""},on:{click:function(s){return t.composeUserSelections(e.id)}}},[t._v(" "+t._s(e.icon)+" ")])}))],2)]),s("InstanceVennDiagram")],1),s("br"),s("v-btn",{attrs:{dark:"",small:""},on:{click:function(e){return t.$store.dispatch("resetSelectionHistory")}}},[t._v(" Reset history ")]),s("span",{staticStyle:{"font-size":"12px","font-weight":"bold",padding:"10px"}},[t._v("Past selections")]),s("div",{staticClass:"table-container"},[s("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.selectionHistory,options:t.pagination,"disable-sort":"",dense:""},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body",fn:function(e){var i=e.items;return[s("tbody",t._l(i,(function(e){return s("tr",{key:e.id,style:t.styleTableRow(e)},[s("td",{on:{click:function(s){return t.setOverlapSelection({whichOverlap:"first",selection:e})},contextmenu:function(s){return s.preventDefault(),t.setOverlapSelection({whichOverlap:"second",selection:e})}}},[t._v(t._s(e.id)+" ")]),s("td",{on:{click:function(s){return t.setOverlapSelection({whichOverlap:"first",selection:e})},contextmenu:function(s){return s.preventDefault(),t.setOverlapSelection({whichOverlap:"second",selection:e})}}},[t._v(t._s(e.instances.size))]),s("td",{on:{click:function(s){return t.setOverlapSelection({whichOverlap:"first",selection:e})},contextmenu:function(s){return s.preventDefault(),t.setOverlapSelection({whichOverlap:"second",selection:e})}}},[t._v(t._s(e.description))]),"continuous"==t.datasetType?s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.weight,expression:"item.weight"}],attrs:{placeholder:"item.weight"},domProps:{value:e.weight},on:{input:function(s){s.target.composing||t.$set(e,"weight",s.target.value)}}})]):t._e()])})),0)]}}])})],1),"continuous"==t.datasetType?s("v-btn",{attrs:{small:""},on:{click:function(e){return t.$store.dispatch("updateWeightedMetrics")}}},[t._v(" Weighted performance ")]):t._e()],1)},js=[],Ks=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("svg",{ref:"svg",attrs:{width:"100%",viewBox:"0 0 "+(t.width+t.margin.left+t.margin.right)+" "+(t.height+t.margin.top+t.margin.bottom)}})])},Ns=[],Ls=i["a"].extend({name:"InstanceVennDiagram",data(){const t={top:50,right:20,bottom:50,left:20},e=400-t.left-t.bottom,s=200-t.top-t.bottom;return{height:s,margin:t,width:e}},computed:{barHeight(){return this.height/3},barWidth(){return this.width},complement(){return Vt(this.instances,this.firstSecondUnion)},first(){const t=this.selections.first?this.selections.first.instances:new Set;return t},firstOnly(){return Vt(this.first,this.second)},firstSecondUnion(){return Ut(this.first,this.second)},firstSecondIntersection(){return Lt(this.first,this.second)},gradientId(){return Kt()},instances(){return this.$store.getters.filteredInstances},interBarHeight(){return this.height-2*this.barHeight},second(){const t=this.selections.second?this.selections.second.instances:new Set;return t},secondOnly(){return Vt(this.second,this.first)},selections(){return this.$store.state.overlapSelections},xTotal(){const t=it["y"]().domain([0,this.instances.size]).range([0,this.barWidth]);return t},xSelection(){const t=it["y"]().domain([0,Math.max(1,this.firstSecondUnion.size)]).range([0,this.barWidth]);return t}},watch:{instances(){this.drawInitial()},selections(){this.drawHover()}},mounted(){this.drawInitial()},methods:{drawHover(){const t=it["C"](this.$refs.svg),e=1e3,s=()=>{const s=t.select(".rect-complement"),i=t.select(".rect-union"),a=t.select(".rect-first-only"),r=t.select(".rect-intersection"),n=t.select(".rect-second-only");i.transition().duration(e).attr("x",0).attr("width",this.xTotal(this.firstSecondUnion.size)),s.transition().duration(e).attr("x",this.xTotal(this.firstSecondUnion.size)).attr("width",this.barWidth-this.xTotal(this.firstSecondUnion.size)),a.transition().duration(e).attr("width",this.xSelection(this.firstOnly.size)),r.transition().duration(e).attr("x",this.xSelection(this.firstOnly.size)).attr("width",this.xSelection(this.firstSecondIntersection.size)),n.transition().duration(e).attr("x",this.xSelection(this.first.size)).attr("width",this.xSelection(this.secondOnly.size))};s();const i=()=>{const s=t.select(".left-line"),i=t.select(".right-line");this.firstSecondUnion.size?(s.transition().duration(e).attr("stroke-opacity",1),i.transition().duration(e).attr("stroke-opacity",1).attr("x1",this.xTotal(this.firstSecondUnion.size)).attr("x2",this.barWidth)):(s.transition().duration(e).attr("stroke-opacity",0),i.transition().duration(e).attr("stroke-opacity",0).attr("x1",0).attr("x2",0))};i();const a=()=>{const s=t.select(".text-complement"),i=t.select(".text-union"),a=t.select(".text-first-only"),r=t.select(".text-intersection"),n=t.select(".text-second-only");i.html(this.percentageText(this.firstSecondUnion.size,this.instances.size)).transition().duration(e).attr("x",this.xTotal(this.firstSecondUnion.size)/2),s.html(this.percentageText(this.complement.size,this.instances.size)).transition().duration(e).attr("x",this.xTotal(this.firstSecondUnion.size)+(this.barWidth-this.xTotal(this.firstSecondUnion.size))/2),a.html(this.percentageText(this.firstOnly.size,this.firstSecondUnion.size)).transition().duration(e).attr("x",this.xSelection(this.firstOnly.size)/2),r.html(this.percentageText(this.firstSecondIntersection.size,this.firstSecondUnion.size)).transition().duration(e).attr("x",this.xSelection(this.firstOnly.size)+this.xSelection(this.firstSecondIntersection.size)/2),n.html(this.percentageText(this.secondOnly.size,this.firstSecondUnion.size)).transition().duration(e).attr("x",this.xSelection(this.first.size)+this.xSelection(this.secondOnly.size)/2)};a()},drawInitial(){const t=it["C"](this.$refs.svg);t.selectAll("*").remove();const e=()=>{const e=t.append("defs"),s=e.append("linearGradient").attr("id",this.gradientId).attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");s.append("stop").attr("offset","0%").attr("stop-color",Ot.overlapSelections.first).attr("stop-opacity",1),s.append("stop").attr("offset","100%").attr("stop-color",Ot.overlapSelections.second).attr("stop-opacity",1)};e();const s=t.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),i=()=>{const t=s.append("g").attr("class","bar-whole").attr("transform","translate(0, 0)"),e=s.append("g").attr("class","bar-union").attr("transform",`translate(0, ${this.barHeight+this.interBarHeight})`);e.append("rect").attr("class","rect-outline").attr("width",this.barWidth).attr("height",this.barHeight).attr("fill","none").attr("stroke","black"),t.append("rect").attr("class","rect-union").attr("x",0).attr("width",this.xTotal(this.firstSecondUnion.size)).attr("height",this.barHeight).attr("fill","black").attr("stroke","black").on("click",()=>this.select("union",this.selections.first,this.selections.second)),t.append("rect").attr("class","rect-complement").attr("x",this.xTotal(this.firstSecondUnion.size)).attr("width",this.barWidth-this.xTotal(this.firstSecondUnion.size)).attr("height",this.barHeight).attr("fill","lightgray").attr("stroke","black").on("click",()=>this.select("complement",this.selections.first,this.selections.second)),e.append("rect").attr("class","rect-first-only").attr("width",this.xSelection(this.firstOnly.size)).attr("height",this.barHeight).attr("fill",Ot.overlapSelections.first).attr("stroke","black").on("click",()=>this.select("difference",this.selections.first,this.selections.second)),e.append("rect").attr("class","rect-intersection").attr("x",this.xSelection(this.firstOnly.size)).attr("width",this.xSelection(this.firstSecondIntersection.size)).attr("height",this.barHeight).attr("fill",`url(#${this.gradientId})`).attr("stroke","black").on("click",()=>this.select("intersection",this.selections.first,this.selections.second)),e.append("rect").attr("class","rect-second-only").attr("x",this.xSelection(this.first.size)).attr("width",this.xSelection(this.secondOnly.size)).attr("height",this.barHeight).attr("fill",Ot.overlapSelections.second).attr("stroke","black").on("click",()=>this.select("difference",this.selections.second,this.selections.first));const i=()=>{t.append("text").attr("class","text-union").attr("x",this.xTotal(this.firstSecondUnion.size)/2).attr("y",-10).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("font-size",12).html(this.percentageText(this.firstSecondUnion.size,this.instances.size)),t.append("text").attr("class","text-complement").attr("x",this.xTotal(this.firstSecondUnion.size)+(this.barWidth-this.xTotal(this.firstSecondUnion.size))/2).attr("y",-10).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("font-size",12).html(this.percentageText(this.complement.size,this.instances.size)),e.append("text").attr("class","text-first-only").attr("x",this.xSelection(this.firstOnly.size)/2).attr("y",this.barHeight+10).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("font-size",12).html(this.percentageText(this.firstOnly.size,this.firstSecondUnion.size)),e.append("text").attr("class","text-intersection").attr("x",this.xSelection(this.firstOnly.size)+this.xSelection(this.firstSecondIntersection.size)/2).attr("y",this.barHeight+10).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("font-size",12).html(this.percentageText(this.firstSecondIntersection.size,this.firstSecondUnion.size)),e.append("text").attr("class","text-second-only").attr("x",this.xSelection(this.first.size)+this.xSelection(this.secondOnly.size)/2).attr("y",this.barHeight+10).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("font-size",12).html(this.percentageText(this.secondOnly.size,this.firstSecondUnion.size))};i()};i();const a=()=>{s.append("line").attr("class","left-line").attr("x1",0).attr("y1",this.barHeight).attr("x2",0).attr("y2",this.barHeight+this.interBarHeight).attr("stroke","black").attr("stroke-opacity",0),s.append("line").attr("class","right-line").attr("x1",this.xTotal(this.firstSecondUnion.size)).attr("y1",this.barHeight).attr("x2",this.width).attr("y2",this.barHeight+this.interBarHeight).attr("stroke","black").attr("stroke-opacity",0)};a()},percentageText(t,e){if(!t)return"";const s=t/e*100;return s>1?s.toFixed(0)+"%":s.toFixed(1)+"%"},select(t,e,s){if(!e||!s)return void console.error(`invalid operand1 (${e}) or operand2 (${s}) to select in InstanceVennDiagram`);let i=new Set;switch(t){case"complement":i=Vt(this.instances,Ut(e.instances,s.instances));break;case"difference":i=Vt(e.instances,s.instances);break;case"intersection":i=Lt(e.instances,s.instances);break;case"union":i=Ut(e.instances,s.instances);break}const a="complement"===t?`${t}(${e.id})`:`${t}(${e.id}, ${s.id})`,r={instances:i,description:a},n=e.predicate,o=s.predicate;if(n)if(o){const e=ut(n,o,t);console.log("composed predicate is",e),r.predicate=e}else console.error("ERROR: Cannot compose. Predicate of operand2 is not defined!");else console.error("ERROR: Cannot compose. Predicate of operand1 is not defined!");this.$store.dispatch("prependToSelectionHistory",r),this.$store.dispatch("changedMostRecentSelection","first"),this.$store.dispatch("changedOverlapSelection",{selection:null,whichOverlap:"second"})}}}),Ws=Ls,qs=Object(m["a"])(Ws,Ks,Ns,!1,null,null,null),Us=qs.exports,Ys=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{width:"100%"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("v-btn",{attrs:{slot:"activator",fab:"",flat:"",large:"",color:t.colors.red},slot:"activator"},[s("v-icon",[t._v("add")])],1),s("v-card",{attrs:{height:"90vh"}},[s("v-card-title",[t._l(t.buttons,(function(e,i){return s("v-tooltip",{key:i,attrs:{bottom:""}},[s("template",{slot:"activator"},[s("v-btn",{attrs:{fab:"",depressed:"",small:"",color:e.color},on:{click:e.action}},[s("v-icon",[t._v(t._s(e.icon))])],1)],1),s("span",[t._v(t._s(e.tooltip))])],2)})),s("span",{staticClass:"title ml-4"},[t._v(" "+t._s(t.title)+" ")])],2),s("v-card-text",[s("v-container",{attrs:{fluid:""}},[s("v-layout",[s("v-flex",{attrs:{xs6:""}},[s("v-btn",{attrs:{fab:"",flat:"",small:"",color:t.colors.green},on:{click:t.addNewConstraint}},[s("v-icon",[t._v("add")])],1),t._v(" New constraint "),s("v-list",{attrs:{subheader:""}},[s("v-subheader",[t._v("Constraints")]),t._l(t.constraints,(function(e,i){return s("div",{key:i},[s("v-btn",{attrs:{fab:"",flat:"",small:"",color:t.colors.red},on:{click:function(e){return t.constraints.splice(i,1)}}},[s("v-icon",[t._v("close")])],1),s("v-btn",{attrs:{flat:"",fab:"",small:"",color:e.negation?t.colors.orange:t.colors.gray},on:{click:function(t){e.negation=!e.negation}}},[e.negation?s("v-icon",[t._v("indeterminate_check_box")]):s("v-icon",[t._v("check_box_outline_blank")])],1),s("span",[e.rule?e.rule===t.rules.ACTUAL?s("ActualTargetClass",{attrs:{boxProps:t.regularBoxProps,constraint:e}}):e.rule===t.rules.AGREE?s("ClassifiersAgree",{attrs:{boxProps:t.regularBoxProps,constraint:e}}):e.rule===t.rules.PREDICTED?s("ClassifierPredicted",{attrs:{boxProps:t.regularBoxProps,constraint:e}}):e.rule===t.rules.RIGHT?s("ClassifierRight",{attrs:{boxProps:t.regularBoxProps,constraint:e}}):e.rule===t.rules.FEATURE_EQ?s("FeatureEquals",{attrs:{boxProps:t.regularBoxProps,constraint:e}}):e.rule===t.rules.FEATURE_GT?s("FeatureGreaterThan",{attrs:{boxProps:t.regularBoxProps,constraint:e}}):e.rule===t.rules.FEATURE_LT?s("FeatureLessThan",{attrs:{boxProps:t.regularBoxProps,constraint:e}}):s("span",[t._v(" "+t._s(e.rule)+" "+t._s(e.text)+" ")]):s("ChooseRule",{attrs:{constraint:e}})],1)],1)}))],2)],1),s("v-flex",{attrs:{xs6:""}},[s("ConstrainedInstanceList",{attrs:{boxProps:t.constrainedInstanceListBoxProps}})],1)],1)],1)],1)],1)],1)},Gs=[],Qs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[t._v(" True target class was "),s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.target?s("span",[t._v(t._s(t.constraint.target))]):s("span",[t._v(t._s(t.placeholders.target))])]),s("v-list",t._l(t.classes,(function(e){return s("v-list-tile",{key:e,on:{click:function(s){t.constraint.target=e}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1)],1)},Js=[],Xs=i["a"].extend({name:"ActualTargetClass",props:{boxProps:{type:Object,required:!0},constraint:{type:Object,required:!0}},data(){return{rules:X,placeholders:J}},computed:{classes(){return[...this.boxProps.classes]}}}),Zs=Xs,ti=s("e449"),ei=Object(m["a"])(Zs,Qs,Js,!1,null,null,null),si=ei.exports;v()(ei,{VBtn:y["a"],VList:C["a"],VMenu:ti["a"]});var ii=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[t._v(" Choose: "),s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.rule?s("span",[t._v(t._s(t.constraint.rule))]):s("span",[t._v(t._s(t.placeholders.rule))])]),s("v-list",t._l(Object.values(t.rules).filter((function(t){return t})),(function(e){return s("v-list-tile",{key:e,on:{click:function(s){t.constraint.rule=e}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1)],1)},ai=[],ri=i["a"].extend({name:"ChooseRule",props:{constraint:{type:Object,required:!0}},data(){return{rules:X,placeholders:J}}}),ni=ri,oi=Object(m["a"])(ni,ii,ai,!1,null,null,null),li=oi.exports;v()(oi,{VBtn:y["a"],VList:C["a"],VMenu:ti["a"]});var ci=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.classifier?s("span",[t._v(t._s(t.constraint.classifier))]):s("span",[t._v(t._s(t.placeholders.classifier))])]),s("v-list",t._l(t.classifiers,(function(e,i){return s("v-list-tile",{key:i,on:{click:function(s){t.constraint.classifier=e}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" predicted "),s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.target?s("span",[t._v(t._s(t.constraint.target))]):s("span",[t._v(t._s(t.placeholders.target))])]),s("v-list",t._l(t.classes,(function(e){return s("v-list-tile",{key:e,on:{click:function(s){t.constraint.target=e}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" target class ")],1)},hi=[],di=i["a"].extend({name:"ClassifierPredicted",props:{boxProps:{type:Object,required:!0},constraint:{type:Object,required:!0}},data(){return{rules:X,placeholders:J}},computed:{classes(){return[...this.boxProps.classes]},classifiers(){return[...this.boxProps.classifiers]}}}),ui=di,pi=Object(m["a"])(ui,ci,hi,!1,null,null,null),fi=pi.exports;v()(pi,{VBtn:y["a"],VList:C["a"],VMenu:ti["a"]});var mi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.classifier?s("span",[t._v(t._s(t.constraint.classifier))]):s("span",[t._v(t._s(t.placeholders.classifier))])]),s("v-list",t._l(t.classifiers,(function(e,i){return s("v-list-tile",{key:i,on:{click:function(s){t.constraint.classifier=e}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" was right ")],1)},gi=[],vi=i["a"].extend({name:"ClassifierRight",props:{boxProps:{type:Object,required:!0},constraint:{type:Object,required:!0}},data(){return{rules:X,placeholders:J}},computed:{classifiers(){return[...this.boxProps.classifiers]}}}),yi=vi,_i=Object(m["a"])(yi,mi,gi,!1,null,null,null),xi=_i.exports;v()(_i,{VBtn:y["a"],VList:C["a"],VMenu:ti["a"]});var bi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.classifier?s("span",[t._v(t._s(t.constraint.classifier))]):s("span",[t._v(t._s(t.placeholders.classifier))])]),s("v-list",t._l(t.classifiers,(function(e,i){return s("v-list-tile",{key:i,on:{click:function(s){t.constraint.classifier=e}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" and "),s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.classifier2?s("span",[t._v(t._s(t.constraint.classifier2))]):s("span",[t._v(t._s(t.placeholders.classifier))])]),s("v-list",t._l(t.classifiers,(function(e){return s("v-list-tile",{key:e,on:{click:function(s){t.constraint.classifier2=e}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" agree. ")],1)},wi=[],Ci=i["a"].extend({name:"ClassifiersAgree",props:{boxProps:{type:Object,required:!0},constraint:{type:Object,required:!0}},data(){return{rules:X,placeholders:J}},computed:{classifiers(){return[...this.boxProps.classifiers]}}}),ki=Ci,Si=Object(m["a"])(ki,bi,wi,!1,null,null,null),zi=Si.exports;v()(Si,{VBtn:y["a"],VList:C["a"],VMenu:ti["a"]});var $i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.feature?s("span",[t._v(t._s(t.constraint.feature))]):s("span",[t._v(t._s(t.placeholders.feature))])]),s("v-list",t._l(t.features,(function(e){return s("v-list-tile",{key:e,on:{click:function(s){t.constraint.feature=e,t.constraint.value=""}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" equals "),s("span",{staticClass:"mx-3"},[t.constraint.feature?t.isFeatureCategoricalOrNominal?s("span",[s("v-flex",{attrs:{"d-inline-flex":""}},[s("v-autocomplete",{attrs:{"hide-no-data":"",items:t.featureValues},model:{value:t.constraint.value,callback:function(e){t.$set(t.constraint,"value",e)},expression:"constraint.value"}})],1)],1):t.isFeatureOrdinal?s("span",[t._v(" [ ordinal detected ] ")]):t.isFeatureIntervalOrRatio?s("span",[s("v-flex",{attrs:{"d-inline-flex":""}},[s("v-slider",{attrs:{"always-dirty":"",max:t.featureValuesMax,min:t.featureValuesMin,step:t.featureValuesStep,"thumb-label":"","thumb-size":"70"},model:{value:t.constraint.value,callback:function(e){t.$set(t.constraint,"value",e)},expression:"constraint.value"}})],1),t._v(" "+t._s(t.constraint.value)+" ")],1):s("span",[t._v(" "+t._s(t.featureType)+" ")]):s("span",[t._v(" ... ")])])],1)},Fi=[],Ti=i["a"].extend({name:"FeatureEquals",props:{boxProps:{type:Object,required:!0},constraint:{type:Object,required:!0}},data(){return{rules:X,placeholders:J}},computed:{features(){return[...this.boxProps.features]},featureType(){return this.constraint.feature?jt(this.constraint.feature).type:""},featureValues(){if(!this.constraint.feature)return[];const t=this.constraint.feature,e=this.instances.map(e=>{const s=Nt(e);return s.features[t]}),s=[...new Set(e)];return s},featureValueBounds(){const t=[0,0];if(!this.constraint.feature)return t;const e=jt(this.constraint.feature),s=()=>{const t=this.featureValues,e=[Math.min(...t),Math.max(...t)];return e};switch(this.featureType){case"interval":const i=e.bounds;return i||s();case"ratio":const a=e.bounds;return a||s();default:return t}},featureValuesMax(){return this.featureValueBounds[1]},featureValuesMin(){return this.featureValueBounds[0]},featureValuesStep(){const t=this.featureValuesMax-this.featureValuesMin,e=t/20;return e},instances(){return[...this.boxProps.instances]},isFeatureCategoricalOrNominal(){return["categorical","nominal"].includes(this.featureType)},isFeatureOrdinal(){return"ordinal"===this.featureType},isFeatureIntervalOrRatio(){return["interval","ratio"].includes(this.featureType)}}}),Ei=Ti,Ii=s("c6a6"),Pi=s("ba0d"),Di=Object(m["a"])(Ei,$i,Fi,!1,null,null,null),Oi=Di.exports;v()(Di,{VAutocomplete:Ii["a"],VBtn:y["a"],VFlex:b["a"],VList:C["a"],VMenu:ti["a"],VSlider:Pi["a"]});var Ai=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.feature?s("span",[t._v(t._s(t.constraint.feature))]):s("span",[t._v(t._s(t.placeholders.feature))])]),s("v-list",t._l(t.features,(function(e){return s("v-list-tile",{key:e,on:{click:function(s){t.constraint.feature=e,t.constraint.value=""}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" greater than "),s("span",{staticClass:"mx-3"},[t.constraint.feature?t.isFeatureCategoricalOrNominal?s("span",[s("v-flex",{attrs:{"d-inline-flex":""}},[s("v-autocomplete",{attrs:{"hide-no-data":"",items:t.featureValues},model:{value:t.constraint.value,callback:function(e){t.$set(t.constraint,"value",e)},expression:"constraint.value"}})],1)],1):t.isFeatureOrdinal?s("span",[t._v(" [ ordinal detected ] ")]):t.isFeatureIntervalOrRatio?s("span",[s("v-flex",{attrs:{"d-inline-flex":""}},[s("v-slider",{attrs:{"always-dirty":"",max:t.featureValuesMax,min:t.featureValuesMin,step:t.featureValuesStep,"thumb-label":"","thumb-size":"70"},model:{value:t.constraint.value,callback:function(e){t.$set(t.constraint,"value",e)},expression:"constraint.value"}})],1),t._v(" "+t._s(t.constraint.value)+" ")],1):s("span",[t._v(" "+t._s(t.featureType)+" ")]):s("span",[t._v(" ... ")])])],1)},Bi=[],Mi=i["a"].extend({name:"FeatureGreaterThan",props:{boxProps:{type:Object,required:!0},constraint:{type:Object,required:!0}},data(){return{rules:X,placeholders:J}},computed:{features(){const t=[...this.boxProps.features],e=["ordinal","interval","ratio"],s=t.filter(t=>{const s=jt(t);return e.includes(s.type)});return s},featureType(){return this.constraint.feature?jt(this.constraint.feature).type:""},featureValues(){if(!this.constraint.feature)return[];const t=this.constraint.feature,e=this.instances.map(e=>{const s=Nt(e);return s.features[t]}),s=[...new Set(e)];return s},featureValueBounds(){const t=[0,0];if(!this.constraint.feature)return t;const e=jt(this.constraint.feature),s=()=>{const t=this.featureValues,e=[Math.min(...t),Math.max(...t)];return e};switch(this.featureType){case"interval":const i=e.bounds;return i||s();case"ratio":const a=e.bounds;return a||s();default:return t}},featureValuesMax(){return this.featureValueBounds[1]},featureValuesMin(){return this.featureValueBounds[0]},featureValuesStep(){const t=this.featureValuesMax-this.featureValuesMin,e=t/20;return e},instances(){return[...this.boxProps.instances]},isFeatureCategoricalOrNominal(){return["categorical","nominal"].includes(this.featureType)},isFeatureOrdinal(){return"ordinal"===this.featureType},isFeatureIntervalOrRatio(){return["interval","ratio"].includes(this.featureType)}}}),Ri=Mi,Hi=Object(m["a"])(Ri,Ai,Bi,!1,null,null,null),Vi=Hi.exports;v()(Hi,{VAutocomplete:Ii["a"],VBtn:y["a"],VFlex:b["a"],VList:C["a"],VMenu:ti["a"],VSlider:Pi["a"]});var ji=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[s("v-menu",{attrs:{bottom:"","offset-y":"","max-height":"70vh"}},[s("v-btn",{attrs:{slot:"activator"},slot:"activator"},[t.constraint.feature?s("span",[t._v(t._s(t.constraint.feature))]):s("span",[t._v(t._s(t.placeholders.feature))])]),s("v-list",t._l(t.features,(function(e){return s("v-list-tile",{key:e,on:{click:function(s){t.constraint.feature=e,t.constraint.value=""}}},[s("v-list-tile-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" less than "),s("span",{staticClass:"mx-3"},[t.constraint.feature?t.isFeatureCategoricalOrNominal?s("span",[s("v-flex",{attrs:{"d-inline-flex":""}},[s("v-autocomplete",{attrs:{"hide-no-data":"",items:t.featureValues},model:{value:t.constraint.value,callback:function(e){t.$set(t.constraint,"value",e)},expression:"constraint.value"}})],1)],1):t.isFeatureOrdinal?s("span",[t._v(" [ ordinal detected ] ")]):t.isFeatureIntervalOrRatio?s("span",[s("v-flex",{attrs:{"d-inline-flex":""}},[s("v-slider",{attrs:{"always-dirty":"",max:t.featureValuesMax,min:t.featureValuesMin,step:t.featureValuesStep,"thumb-label":"","thumb-size":"70"},model:{value:t.constraint.value,callback:function(e){t.$set(t.constraint,"value",e)},expression:"constraint.value"}})],1),t._v(" "+t._s(t.constraint.value)+" ")],1):s("span",[t._v(" "+t._s(t.featureType)+" ")]):s("span",[t._v(" ... ")])])],1)},Ki=[],Ni=i["a"].extend({name:"FeatureLessThan",props:{boxProps:{type:Object,required:!0},constraint:{type:Object,required:!0}},data(){return{rules:X,placeholders:J}},computed:{features(){const t=[...this.boxProps.features],e=["ordinal","interval","ratio"],s=t.filter(t=>{const s=jt(t);return e.includes(s.type)});return s},featureType(){return this.constraint.feature?jt(this.constraint.feature).type:""},featureValues(){if(!this.constraint.feature)return[];const t=this.constraint.feature,e=this.instances.map(e=>{const s=Nt(e);return s.features[t]}),s=[...new Set(e)];return s},featureValueBounds(){const t=[0,0];if(!this.constraint.feature)return t;const e=jt(this.constraint.feature),s=()=>{const t=this.featureValues,e=[Math.min(...t),Math.max(...t)];return e};switch(this.featureType){case"interval":const i=e.bounds;return i||s();case"ratio":const a=e.bounds;return a||s();default:return t}},featureValuesMax(){return this.featureValueBounds[1]},featureValuesMin(){return this.featureValueBounds[0]},featureValuesStep(){const t=this.featureValuesMax-this.featureValuesMin,e=t/20;return e},instances(){return[...this.boxProps.instances]},isFeatureCategoricalOrNominal(){return["categorical","nominal"].includes(this.featureType)},isFeatureOrdinal(){return"ordinal"===this.featureType},isFeatureIntervalOrRatio(){return["interval","ratio"].includes(this.featureType)}}}),Li=Ni,Wi=Object(m["a"])(Li,ji,Ki,!1,null,null,null),qi=Wi.exports;v()(Wi,{VAutocomplete:Ii["a"],VBtn:y["a"],VFlex:b["a"],VList:C["a"],VMenu:ti["a"],VSlider:Pi["a"]});var Ui=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"instance-list-title"},[t._v(" Query selects "),s("b",[t._v(t._s(t.instances.length)+" ")]),t._v(" instances ( or "),s("b",[t._v(t._s(t.instancePercentage))]),t._v(" % ) ")]),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.instances,pagination:t.pagination,"disable-initial-sort":""},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[s("tr",{class:{"hover-instance":e.item===t.$store.state.hoverInstance},style:t.styleTableRow(e.item)},[s("td",[t._v(t._s(e.item.id))]),s("td",[t._v(t._s(e.item.actual))]),t._l(t.classifiers,(function(i){return s("td",{key:i},[t._v(" "+t._s(e.item.predictions[i])+" ")])})),t._l(t.features,(function(i){return s("td",{key:i},[t._v(" "+t._s(e.item.features[i])+" ")])}))],2)]}}])})],1)},Yi=[],Gi=i["a"].extend({name:"ConstrainedInstanceList",props:{boxProps:{type:Object,required:!0}},data(){return{sortBy:"",pagination:{rowsPerPage:10}}},computed:{classifiers(){return[...this.boxProps.classifiers]},features(){return[...this.boxProps.features]},headers(){const t=[{text:"Id",value:"id"},{text:"Actual class",value:"actualClass"}];return this.classifiers.forEach(e=>{t.push({text:e.replace(/_/g," "),value:e})}),this.$store.getters.features.forEach(e=>{t.push({text:e,value:e})}),t},instancePercentage(){const t=this.instances.length,e=this.$store.getters.instances.size,s=(t/e*100).toFixed(2);return s},instances(){const t=[];[...this.boxProps.instances].forEach(e=>{const s=Nt(e),i=Object.assign({id:e},s);t.push(i)});const{first:e,second:s}=this.selections,i={first:(t,s)=>{let i=0,a=0;return e&&e.instances.has(t.id)&&i++,e&&e.instances.has(s.id)&&a++,a-i},second:(t,e)=>{let i=0,a=0;return s&&s.instances.has(t.id)&&i++,s&&s.instances.has(e.id)&&a++,a-i},common:(t,i)=>{let a=0,r=0;return e&&e.instances.has(t.id)&&a++,e&&e.instances.has(i.id)&&r++,s&&s.instances.has(t.id)&&a++,s&&s.instances.has(i.id)&&r++,r-a}};return this.sortBy&&t.sort(i[this.sortBy]),t},selections(){return this.$store.state.overlapSelections}},watch:{selections(){const{first:t,second:e}=this.selections;this.sortBy=t&&e?"common":t?"first":e?"second":""}},methods:Object.assign(Object.assign({},Object(d["b"])(["changedHoverInstance","clearHoverInstance"])),{select(t,e){const s=new Set([t]),i="Instance #"+t;this.$store.dispatch("prependToSelectionHistory",{instances:s,description:i}),this.$store.dispatch("changedMostRecentSelection",e)},styleTableRow(t){const{first:e,second:s}=Ot.overlapSelections,{first:i,second:a}=this.selections,r=i&&i.instances.has(t.id),n=a&&a.instances.has(t.id);return r&&n?`\n          background: -webkit-linear-gradient(top, ${e}, ${s});\n          color: white;\n        `:r?`\n          background-color: ${e};\n        `:n?`\n          background-color: ${s};\n          color: white;\n        `:""}})}),Qi=Gi,Ji=(s("de79"),Object(m["a"])(Qi,Ui,Yi,!1,null,"6acec799",null)),Xi=Ji.exports;v()(Ji,{VDataTable:Ms["a"]});var Zi=i["a"].extend({name:"QueryGenerator",components:{ActualTargetClass:si,ChooseRule:li,ClassifierRight:xi,ClassifierPredicted:fi,ClassifiersAgree:zi,ConstrainedInstanceList:Xi,FeatureEquals:Oi,FeatureGreaterThan:Vi,FeatureLessThan:qi},data(){return{colors:{gray:"#bbbbbb",green:"#0F0",orange:"#ffc400",red:"#F00",yellow:"#FFEB3B"},dialog:!1,constraints:[],rules:X,placeholders:J,title:"Query Creator"}},computed:{buttons(){const t=[{action:this.discardQuery,color:this.colors.red,icon:"close",tooltip:"Discard constraints and close "+this.title},{action:this.resetQuery,color:this.colors.yellow,icon:"refresh",tooltip:"Start from scratch"},{action:this.saveQuery,color:this.colors.green,icon:"check",tooltip:"Save constraints as a query and close "+this.title}];return t},classifiers(){return[...this.$store.getters.classifiers]},classes(){return[...this.$store.getters.classes]},constrainedInstances(){let t=this.instances;return this.constraints.forEach(e=>{const s=mt(e);t=t.filter(s)}),t},thresholdClassifierNameList(){return this.$store.getters.thresholdClassifierNameList},classifierBandWidthDict(){return this.$store.getters.classifierBandWidthDict},constrainedInstanceListBoxProps(){return{classes:new Set(this.classes),classifiers:new Set(this.classifiers),features:new Set(this.features),instances:new Set(this.constrainedInstances),thresholdClassifierNameList:this.thresholdClassifierNameList,classifierBandWidthDict:this.classifierBandWidthDict}},features(){return[...this.$store.getters.features]},instances(){return[...this.$store.getters.instances]},regularBoxProps(){return{classes:new Set(this.classes),classifiers:new Set(this.classifiers),features:new Set(this.features),instances:new Set(this.instances),thresholdClassifierNameList:this.thresholdClassifierNameList,classifierBandWidthDict:this.classifierBandWidthDict}}},methods:{addNewConstraint(){const t=nt();this.constraints.unshift(t)},closeDialog(){this.dialog=!1},discardQuery(){this.closeDialog(),this.resetQuery()},isQueryComplete(){return this.constraints.every(xt)},resetQuery(){this.constraints=[]},saveQuery(){if(!this.isQueryComplete())return void alert("Please delete or fill incomplete constraints before saving.");const t=new Set(this.constrainedInstances),e=[];this.constraints.forEach(t=>{e.push(pt(t))});const s={type:"simple",constraints:this.constraints,metric:[]},i=e.join(" AND "),a={description:i,instances:t,predicate:s};this.$store.dispatch("prependToSelectionHistory",a),this.closeDialog(),this.resetQuery()}}}),ta=Zi,ea=s("a523"),sa=s("e0c7"),ia=s("3a2f"),aa=Object(m["a"])(ta,Ys,Gs,!1,null,null,null),ra=aa.exports;v()(aa,{VBtn:y["a"],VCard:_["a"],VCardText:x["a"],VCardTitle:x["b"],VContainer:ea["a"],VDialog:A["a"],VFlex:b["a"],VIcon:B["a"],VLayout:w["a"],VList:C["a"],VSubheader:sa["a"],VTooltip:ia["a"]});var na=i["a"].extend({name:"SetHistory",components:{InstanceVennDiagram:Us,QueryGenerator:ra},data(){const{first:t,second:e}=Ot.overlapSelections,s="continuous"==this.$store.state.datasetType?[{text:"Id",value:"id"},{text:"Size",value:"size"},{text:"Description",value:"description"},{text:"Weight (1-10)",value:"weight"}]:[{text:"Id",value:"id"},{text:"Size",value:"size"},{text:"Description",value:"description"}];return{colors:Ot,headers:s,operations:[{id:G.OR,description:"Union",function:Ut,icon:"∪"},{id:G.AND,description:"Intersection",function:Lt,icon:"∩"},{id:G.MINUS,description:"Difference",function:Vt,icon:"−",style:`\n            background: -webkit-linear-gradient(left, ${t} 50%, ${e} 50%);\n          `},{id:G.XOR,description:"Exclusive Or",function:Yt,icon:"⊕"}],pagination:{rowsPerPage:10}}},computed:{datasetType(){var t=this.$store.state.datasetType;return t},overlapSelections(){return this.$store.state.overlapSelections},selectionHistory(){let t=this.$store.state.selectionHistory;return t}},methods:{resetWeight(){this.$store.dispatch("updateWeightedMode"),this.selectionHistory.forEach(t=>{t["weight"]=0})},continuousChange(){"continuous"==this.datasetType&&(this.$store.dispatch("changedContinuousMetrics"),this.$store.dispatch("updateContinuousMetrics"))},compareFeatureInterestingness:dt,composeUserSelections(t){const{first:e,second:s}=this.overlapSelections;if(null===e||null==s)return void console.error("Both user selections must be non-null for composition.");const i=this.operations.find(e=>e.id===t);if(void 0===i)return void console.error("Invalid set composition operation.");const a=i.function(e.instances,s.instances),r={instances:a,description:`${t}(s${e.id}, s${s.id})`};this.$store.dispatch("prependToSelectionHistory",r)},clearOverlapSelections(){this.setOverlapSelection({whichOverlap:"first",selection:null}),this.setOverlapSelection({whichOverlap:"second",selection:null})},overlapSelectionDescription(t){const e=this.overlapSelections[t];return null===e?"?":""+e.id},changedBaseSelection(t){this.$store.dispatch("changedBaseSelection",t)},setOverlapSelection(t){this.$store.dispatch("changedOverlapSelection",t)},styleTableRow(t){const{first:e,second:s}=Ot.overlapSelections,{first:i,second:a}=this.overlapSelections,r=i&&i.id===t.id,n=a&&a.id===t.id;return r&&n?`\n          background: -webkit-linear-gradient(top, ${e}, ${s});\n          color: white;\n        `:r?`\n          background-color: ${e};\n        `:n?`\n          background-color: ${s};\n          color: white;\n        `:""}}}),oa=na,la=(s("1f7e"),Object(m["a"])(oa,Vs,js,!1,null,"fc83529a",null)),ca=la.exports;v()(la,{VBtn:y["a"],VDataTable:Ms["a"],VList:C["a"],VListItem:k["a"],VListItemTitle:S["c"],VMenu:ti["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var ha=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-content",[s("v-btn",{staticClass:"button-panel",attrs:{id:"all-instance",color:"all"===t.subset?"primary":"firstColor",small:""},on:{click:t.allInstance}},[t._v("All")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"first-instance",color:"first"===t.subset?"primary":"firstColor",small:""},on:{click:t.firstInstance}},[t._v("Selection 1")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"second-instance",color:"second"===t.subset?"primary":"firstColor",small:""},on:{click:t.secondInstance}},[t._v("Selection 2")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"intersection-instance",color:"intersection"===t.subset?"primary":"firstColor",small:""},on:{click:t.intersectionInstance}},[t._v("Intersection")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"union-instance",color:"union"===t.subset?"primary":"firstColor",small:""},on:{click:t.unionInstance}},[t._v("Union")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"complement-instance",color:"complement"===t.subset?"primary":"firstColor",small:""},on:{click:t.complementInstance}},[t._v("Complement of 1 Union 2")])],1)],1)],1),s("v-list",{attrs:{id:"item-container"}},[s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.prevInstance(t.instances)}}},[t._v("Previous")]),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.nextInstance(t.instances)}}},[t._v("Next")]),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.randInstance(t.instances)}}},[t._v("Random")]),s("v-btn",{staticClass:"button-nav",attrs:{color:"primary",small:""},on:{click:t.emphasize}},[t._v("Emphasize")]),t.focus(t.instances).features.image?s("v-img",{attrs:{contain:"",src:t.focus(t.instances).features.image}}):t._e(),t._l(t.focus(t.instances),(function(e,i){return s("v-list-item",{key:e.id,attrs:{id:"v-for-object"}},[s("v-list-item-content",[s("v-list-item-subtitle",[t._v(t._s(i))]),"object"===typeof e?t._l(e,(function(e,i){return s("v-list",{key:i,attrs:{id:"v-for-object"}},[t._v(" "+t._s(i)+": "+t._s(e)+" ")])})):[t._v(t._s(e))]],2)],1)})),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.prevInstance(t.instances)}}},[t._v("Previous")]),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.nextInstance(t.instances)}}},[t._v("Next")]),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.randInstance(t.instances)}}},[t._v("Random")]),s("v-btn",{staticClass:"button-nav",attrs:{color:"primary",small:""},on:{click:t.emphasize}},[t._v("Emphasize")])],2)],1)},da=[],ua=i["a"].extend({name:"InstanceList",data(){return{panel:[],sortby:[],sortBySel:"",descending:!1,show_predictions:!0,show_features:!0,string_length:7,currentIndex:0,subset:"all"}},mounted(){this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id),this.$store.dispatch("changeFocusSet",this.subset)},computed:{instances(){let t=[];this.$store.getters.filteredInstances.forEach(e=>{const s=Nt(e),i=Object.assign({id:e},s);t.push(i)});const{first:e,second:s}=this.selections;if("all"!==this.subset){let i=[];if("first"===this.subset)if(e)for(const s of e.instances)i.push(t.find(t=>t.id===s));else this.currentIndex=-1,alert("no selection");else if("second"===this.subset)if(s)for(const e of s.instances)i.push(t.find(t=>t.id===e));else this.currentIndex=-1,alert("no second set of selection");else if(e&&s){if("intersection"===this.subset)for(const a of e.instances)s.instances.has(a)&&i.push(t.find(t=>t.id===a));else if("union"===this.subset){for(const s of e.instances)i.push(t.find(t=>t.id===s));for(const a of s.instances)e.instances.has(a)||i.push(t.find(t=>t.id===a))}else if("complement"===this.subset)for(const a of t)e.instances.has(a.id)||s.instances.has(a.id)||i.push(a)}else this.currentIndex=-1,alert("two selected sets are required to perform this action");return i}return t},selections(){return this.$store.state.overlapSelections}},watch:{currentIndex(){this.$store.dispatch("setFocusItem",this.currentIndex<0?null:this.instances[this.currentIndex].id)},selections(){this.$store.dispatch("setFocusItem",this.currentIndex<0?null:this.instances[this.currentIndex].id)},onClose(){console.log("focus closed")}},methods:{focus(t){return t[this.currentIndex]},imageDimensions(t){const e=4;if(console.log(t),t){const s=new Image;return s.src=t,console.log(s.width,s.height),[s.width*e,s.height*e]}return[1/0,1/0]},prevInstance(t){this.currentIndex>0?this.currentIndex--:this.currentIndex=t.length-1},nextInstance(t){this.currentIndex<t.length-1?this.currentIndex++:this.currentIndex=0},randInstance(t){this.currentIndex=Math.floor(Math.random()*t.length)},allInstance(){this.currentIndex=0,this.subset="all",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},firstInstance(){this.currentIndex=0,this.subset="first",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},secondInstance(){this.currentIndex=0,this.subset="second",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},intersectionInstance(){this.currentIndex=0,this.subset="intersection",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},unionInstance(){this.currentIndex=0,this.subset="union",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},complementInstance(){this.currentIndex=0,this.subset="complement",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},emphasize(){this.$store.dispatch("emphasizeFocus")}}}),pa=ua,fa=(s("0417"),s("adda")),ma=Object(m["a"])(pa,ha,da,!1,null,"7b9cb289",null),ga=ma.exports;v()(ma,{VBtn:y["a"],VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanels:Xt["a"],VImg:fa["a"],VList:C["a"],VListItem:k["a"],VListItemContent:S["a"],VListItemSubtitle:S["b"]});var va=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-list",t._l(t.$store.state.views.all,(function(e){return s("v-list-item",{key:e},[s("v-list-item-icon",[s("v-icon",{on:{click:function(){return t.$store.dispatch("openView",e)}}},[t._v("add_box")])],1),s("v-list-item-title",[t._v(t._s(e))])],1)})),1)],1)},ya=[],_a=i["a"].extend({name:"ViewList"}),xa=_a,ba=s("34c3"),wa=Object(m["a"])(xa,va,ya,!1,null,null,null),Ca=wa.exports;v()(wa,{VIcon:B["a"],VList:C["a"],VListItem:k["a"],VListItemIcon:ba["a"],VListItemTitle:S["c"]});var ka=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{attrs:{multiple:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}}),s("label",[t._v("Threshold select ")]),s("multiselect",{attrs:{"tag-placeholder":"Add this as new threshold",placeholder:"Add a threshold",label:"name","track-by":"name",options:t.options,multiple:!0,taggable:!0},on:{tag:t.addTag},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),s("div",{ref:"svg"})],1)},Sa=[],za=s("8e5f"),$a=s.n(za);i["a"].component("multiselect",$a.a);var Fa=i["a"].extend({name:"ContinuousMode",data(){const t={type:"",classifier:"",value:0},e={classifier:"",threshold:.5};return{sliderRange:t,thresholdRange:{},panel:[],threshold:0,value:[],curAddedThresholdClassifier:e,options:[]}},computed:{viewsConfig(){return this.$store.state.viewsConfig},classifierThresholdDict(){return this.$store.state.classifierThresholdDict},curveClassifiers(){return this.$store.getters.curveClassifiers},classifierThresholdCurve(){return this.$store.getters.curveChosenClassifierThresholdTuple},addedThresholdClassifiers(){let t=this.$store.state.addedThresholdClassifiers;return null===t&&(t=[]),t},classifierThresholdList(){return this.$store.getters.classifierThresholdList},classifiers(){return this.$store.getters.classifiers},instances(){return[...this.$store.getters.filteredInstances]},xScale(){const t=it["y"]().domain([0,400]).range([10,410]).clamp(!0);return t},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){const t=this.classifierThresholdList.map(t=>t.classifier);t.forEach(t=>{Object.keys(this.classifierThresholdDict).includes(t)&&this.classifierThresholdDict[t]/100!=.5&&setTimeout(()=>{this.sliderRange={type:"from",classifier:t,value:4*this.classifierThresholdDict[t]}},500)})},viewsConfig(){const t=this.classifierThresholdList.map(t=>t.classifier);t.forEach(t=>{Object.keys(this.classifierThresholdDict).includes(t)&&this.classifierThresholdDict[t]/100!=.5&&setTimeout(()=>{this.sliderRange={type:"from",classifier:t,value:4*this.classifierThresholdDict[t]}},100)})},classifierThresholdCurve(){this.drawUpdateRangesCurve()},sliderRange(){this.drawUpdateRanges()},classifiers(){"continuous"==this.$store.state.datasetType&&this.drawInitial()},curAddedThresholdClassifier(){this.value.push({name:"set_"+this.curAddedThresholdClassifier.classifier+"_"+parseFloat(this.curAddedThresholdClassifier.threshold).toFixed(2)}),this.options.push({name:"set_"+this.curAddedThresholdClassifier.classifier+"_"+parseFloat(this.curAddedThresholdClassifier.threshold).toFixed(2)}),this.$store.dispatch("changedCurAddedThresholdClassifier",this.curAddedThresholdClassifier)},value(){this.$store.dispatch("changedAddedThresholdClassifiers",this.value)}},mounted(){this.drawInitial()},methods:{addTag(t){const e={name:t};this.options.push(e),this.value.push(e)},drawUpdateRangesCurve(){const t=this.classifierThresholdCurve.classifier,e=this.classifierThresholdCurve.single_threshold;this.sliderRange={type:"from",classifier:t,value:4*e}},drawUpdateRanges(){const t=this.sliderRange.classifier,e=this.sliderRange.value,s=this.thresholdRange[t],i=(e/400).toFixed(2)!=s?1:0;let a={};for(let h in this.thresholdRange)a[h]=this.thresholdRange[h];const r=it["C"](this.$refs.svg),n=r.select(".slider-head-"+t),o=r.select(".slider-text-"+t);var l=e/400;a[t]=l<0?0:l>1?1:l.toFixed(2),this.thresholdRange=a,n.attr("transform","translate("+this.xScale(e)+", 55)"),o.text(e=>t+": "+this.thresholdRange[t]);let c={classifier:t,single_threshold:100*this.thresholdRange[t]};1==i&&this.$store.dispatch("changedContinuousThreshold",c)},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox","0 0\n          440\n          "+(140*this.classifierThresholdList.length+20)).append("g").attr("transform","translate(0, 0)"),e=this.classifierThresholdDict,s=this.classifierThresholdList.map(t=>t.classifier);0==Object.keys(this.thresholdRange).length&&s.forEach(t=>{this.thresholdRange[t]=.5}),t.append("rect").attr("class","rect").attr("width",430).attr("height",120*this.classifierThresholdList.length).attr("x",0).attr("y",10).attr("fill","white").attr("stroke","lightgrey").attr("stroke-width","2px");const i=this.xScale,a=t.append("g").selectAll("g").data(s).enter().append("g").attr("transform",(function(t,e){return"translate(0,"+120*e+")"}));a.append("text").attr("transform","translate(30,30)").attr("class",t=>"slider-text-"+t).text(t=>t+": 0.5").attr("x",5).attr("font-size","22px").attr("fill","grey"),a.append("line").attr("transform","translate(0,120)").attr("class","range-border").style("stroke","lightgrey").style("stroke-opacity","1").style("stroke-width","3").attr("x1",0).attr("x2",430).attr("y1",0).attr("y2",0).attr("visibility",t=>t==s[s.length-1]?"hidden":"visible"),a.append("line").attr("transform","translate(0,60)").attr("class","track").style("stroke","#777").style("stroke-opacity","1").style("stroke-width","5").attr("x1",10).attr("x2",410).attr("y1",0).attr("y2",0);let r=a.append("rect").attr("width",20).attr("height",10).attr("rx",6).attr("fill","steelblue").attr("stroke","none").attr("class",t=>"slider-head-"+t).attr("transform",(function(t){return"translate("+i(200)+",55)"})).call(it["h"]().on("start.interrupt",(function(){r.interrupt()})).on("start drag",t=>this.sliderRange={type:"from",classifier:t,value:i.invert(it["i"].x)}));a.append("rect").attr("width",40).attr("height",20).attr("transform","translate(340,85)").attr("class",t=>"add-rect-best-"+t).attr("fill","lightgrey"),a.append("text").attr("transform","translate(345,100)").attr("class",t=>"add-set-"+t).text("add").attr("font-size","18px").attr("fill","grey").on("mouseenter",t=>{it["C"](".add-set-"+t).attr("fill","white"),it["C"](".add-rect-best-"+t).attr("fill","grey")}).on("mouseleave",t=>{it["C"](".add-set-"+t).attr("fill","grey"),it["C"](".add-rect-best-"+t).attr("fill","lightgrey")}).on("click",t=>this.curAddedThresholdClassifier={classifier:t,threshold:this.thresholdRange[t]});s.forEach(t=>{Object.keys(e).includes(t)&&e[t]/100!=.5&&this.drawUpdateRangesCurve()})}}}),Ta=Fa,Ea=Object(m["a"])(Ta,ka,Sa,!1,null,null,null),Ia=Ea.exports;v()(Ea,{VExpansionPanels:Xt["a"]});var Pa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{attrs:{multiple:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("label",[t._v("BandWidth Select ")]),s("multiselect",{attrs:{"tag-placeholder":"Add this as new bandWidth",label:"name","track-by":"name",options:t.options,multiple:!0,taggable:!0},on:{tag:t.addTag},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),s("div",{ref:"svg"})],1)},Da=[],Oa=i["a"].extend({name:"UncertainAdjuster",data(){const t={type:"",classifier:"",value:0},e=this.$store.state.classifierThresholdDict,s={classifier:"",left_range:.45,right_range:.55},i=Object.keys(this.$store.state.classifierThresholdDict).map(t=>({name:t+"("+(this.$store.state.classifierThresholdDict[t]/100-.05<0?0:this.$store.state.classifierThresholdDict[t]/100-.05).toFixed(2)+","+(this.$store.state.classifierThresholdDict[t]/100+.05>1?1:this.$store.state.classifierThresholdDict[t]/100+.05).toFixed(2)+")"})),a=Object.keys(this.$store.state.classifierThresholdDict).map(t=>({name:t+"("+(this.$store.state.classifierThresholdDict[t]/100-.05<0?0:this.$store.state.classifierThresholdDict[t]/100-.05).toFixed(2)+","+(this.$store.state.classifierThresholdDict[t]/100+.05>1?1:this.$store.state.classifierThresholdDict[t]/100+.05).toFixed(2)+")"})),r=Object.keys(this.$store.state.classifierThresholdDict).map(t=>({name:t+"("+(this.$store.state.classifierThresholdDict[t]/100-.05<0?0:this.$store.state.classifierThresholdDict[t]/100-.05).toFixed(2)+","+(this.$store.state.classifierThresholdDict[t]/100+.05>1?1:this.$store.state.classifierThresholdDict[t]/100+.05).toFixed(2)+")"}));return{classifierThresholdDict:e,sliderRange:t,thresholdRange:{},panel:[],threshold:0,curAddedBandWidthClassifier:s,value:a,options:r,origin_value:i,added_value:[]}},computed:{resumedBandwidths(){return this.$store.state.resumedBandwidths},outerBandWidth(){return this.$store.state.outerBandWidth},addedBandWidthClassifiers(){return this.$store.state.addedBandWidthClassifiers},classifierFilters(){return this.$store.state.filters.classifier},curAddedThresholdClassifier(){return this.$store.state.curAddedThresholdClassifier},thresholdClassifierNameList(){return this.$store.getters.thresholdClassifierNameList},classifierThresholdList(){return this.$store.getters.classifierThresholdList},xScale(){const t=it["y"]().domain([0,400]).range([10,410]).clamp(!0);return t},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){this.drawResumedBandwidths(),this.updateValues()},outerBandWidth(){this.drawOuterRanges(),this.updateValues()},classifierFilters(){const t=[...this.classifierFilters.set];this.value=[],this.options=[],this.origin_value.forEach(e=>{let s=e.name,i=s.split("(")[0];t.includes(i)||(this.value.push(e),this.options.push(e))}),this.added_value.forEach(e=>{let s=e.name,i=s.split("(")[0];t.includes(i)||(this.value.push(e),this.options.push(e))})},curAddedThresholdClassifier(){const t=[...this.classifierFilters.set];let e=parseFloat(this.curAddedThresholdClassifier.threshold),s=(e-.05<0?0:e-.05).toFixed(2),i=(e+.05>1?1:e+.05).toFixed(2);this.options=[],this.value=[],this.added_value.push({name:this.curAddedThresholdClassifier.classifier+"("+s+","+i+")"}),this.origin_value.forEach(e=>{let s=e.name,i=s.split("(")[0];t.includes(i)||(this.value.push(e),this.options.push(e))}),this.added_value.forEach(e=>{let s=e.name,i=s.split("(")[0];t.includes(i)||(this.value.push(e),this.options.push(e))})},sliderRange(){this.drawUpdateRanges(),this.updateValues()},classifierThresholdDict(){this.drawInitial()},thresholdClassifierNameList(){this.drawInitial(),this.updateValues()},curAddedBandWidthClassifier(){const t=[...this.classifierFilters.set];this.options=[],this.value=[],this.added_value.push({name:this.curAddedBandWidthClassifier.classifier+"("+this.curAddedBandWidthClassifier.left_range+","+this.curAddedBandWidthClassifier.right_range+")"}),this.origin_value.forEach(e=>{let s=e.name,i=s.split("(")[0];t.includes(i)||(this.value.push(e),this.options.push(e))}),this.added_value.forEach(e=>{let s=e.name,i=s.split("(")[0];t.includes(i)||(this.value.push(e),this.options.push(e))})},value(){let t=this.addedBandWidthClassifiers.map((function(t){return t.name})),e=this.value.map((function(t){return t.name})),s=[],i=[];t.forEach(t=>{e.includes(t)||s.push(t)}),this.added_value.forEach(t=>{s.includes(t.name)||i.push(t)}),this.added_value=i,this.$store.dispatch("changedAddedBandWidthClassifiers",this.value)}},mounted(){this.drawInitial(),this.resumeStatus>0&&(this.drawResumedBandwidths(),this.updateValues())},methods:{addTag(t){const e={name:t};this.options.push(e),this.value.push(e)},updateValues(){const t=[...this.classifierFilters.set];this.options=[],this.value=[],this.origin_value=[];for(let e in this.thresholdRange)this.origin_value.push({name:e+"("+this.thresholdRange[e].left_range.toFixed(2)+","+this.thresholdRange[e].right_range.toFixed(2)+")"});this.origin_value.forEach(e=>{let s=e.name,i=s.split("(")[0];t.includes(i)||(this.value.push(e),this.options.push(e))}),this.added_value.forEach(e=>{let s=e.name,i=s.split("(")[0];t.includes(i)||(this.value.push(e),this.options.push(e))})},drawResumedBandwidths(){const t=Object.keys(this.classifierThresholdDict),e=it["C"](this.$refs.svg);let s={};t.forEach(t=>{s[t]={name:t,threshold:Object.keys(this.classifierThresholdDict).includes(t)?this.classifierThresholdDict[t]:0,left_range:this.resumedBandwidths[t].left_range,right_range:this.resumedBandwidths[t].right_range},e.select(".slider-circle-time-from"+t).attr("transform","translate("+this.xScale(400*s[t].left_range)+", 60)"),e.select(".slider-circle-time-to"+t).attr("transform","translate("+this.xScale(400*s[t].right_range)+", 60)"),e.select(".range-text-"+t).text(e=>"("+s[t].left_range+", "+s[t].right_range+")"),this.$store.dispatch("changedBandWidthClassifier",t)}),this.thresholdRange=s,this.$store.dispatch("changedclassifierBandWidthDict",s)},drawOuterRanges(){const t=this.outerBandWidth.classifier,e=400*this.outerBandWidth.left_range,s=400*this.outerBandWidth.right_range,i=it["C"](this.$refs.svg),a=i.select(".range-text-"+t);let r={};for(let n in this.thresholdRange)r[n]=this.thresholdRange[n];r[t].left_range=this.outerBandWidth.left_range,r[t].right_range=this.outerBandWidth.right_range,this.thresholdRange=r,i.select(".slider-circle-time-from"+t).attr("transform","translate("+this.xScale(e)+", 60)"),i.select(".slider-circle-time-to"+t).attr("transform","translate("+this.xScale(s)+", 60)"),a.text(e=>"("+this.thresholdRange[t].left_range.toFixed(2)+", "+this.thresholdRange[t].right_range.toFixed(2)+")"),this.$store.dispatch("changedclassifierBandWidthDict",r),this.$store.dispatch("changedBandWidthClassifier",t)},drawUpdateRanges(){const t=this.sliderRange.type,e=this.sliderRange.classifier,s=this.sliderRange.value;let i={};for(let c in this.thresholdRange)i[c]=this.thresholdRange[c];const a=it["C"](this.$refs.svg),r=a.select(".slider-circle-time-"+t+e),n=a.select(".range-text-"+e);if("from"==t){var o=s/400;i[e].left_range=o<0?0:o}else{var l=s/400;i[e].right_range=l>1?1:l}this.thresholdRange=i,r.attr("transform","translate("+this.xScale(s)+", 60)"),n.text(t=>"("+this.thresholdRange[e].left_range.toFixed(2)+", "+this.thresholdRange[e].right_range.toFixed(2)+")"),this.$store.dispatch("changedclassifierBandWidthDict",i),this.$store.dispatch("changedBandWidthClassifier",e)},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=Object.keys(this.classifierThresholdDict),e=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox","0 0\n          440\n          "+(120*t.length+20)).append("g").attr("transform","translate(0, 0)");e.append("rect").attr("class","rect").attr("width",430).attr("height",120*t.length).attr("x",0).attr("y",10).attr("fill","white").attr("stroke","lightgrey").attr("stroke-width","2px");var s=Math.sqrt(3),i={draw:function(t,e){var i=-Math.sqrt(e/(3*s));t.moveTo(2*-i,0),t.lineTo(i,-s*i),t.lineTo(i,s*i),t.closePath()}},a={draw:function(t,e){var i=-Math.sqrt(e/(3*s));t.moveTo(2*i,0),t.lineTo(-i,-s*i),t.lineTo(-i,s*i),t.closePath()}};let r=it["E"]().type(a).size(180),n=it["E"]().type(i).size(180);if(0==Object.keys(this.thresholdRange).length){const e={};t.forEach(t=>{e[t]={name:t,threshold:Object.keys(this.classifierThresholdDict).includes(t)?this.classifierThresholdDict[t]:0,left_range:Object.keys(this.classifierThresholdDict).includes(t)?this.classifierThresholdDict[t]/100-.05<0?0:this.classifierThresholdDict[t]/100-.05:0,right_range:Object.keys(this.classifierThresholdDict).includes(t)?this.classifierThresholdDict[t]/100+.05>1?1:this.classifierThresholdDict[t]/100+.05:0}}),this.thresholdRange=e,this.$store.dispatch("changedclassifierBandWidthDict",this.thresholdRange),this.$store.dispatch("changedBandWidthClassifier","")}for(let u in this.thresholdRange){let t=this.thresholdRange[u].name,e=this.thresholdRange[u].threshold/100,s=this.thresholdRange[u].left_range,i=this.thresholdRange[u].right_range;if(e==this.classifierThresholdDict[t]/100)continue;let a=e-s,r=i-e;delete this.thresholdRange[u],this.thresholdRange[t]={name:t,threshold:this.classifierThresholdDict[t],left_range:this.classifierThresholdDict[t]/100-a<0?0:this.classifierThresholdDict[t]/100-a,right_range:this.classifierThresholdDict[t]/100+r>1?1:this.classifierThresholdDict[t]/100+r},this.$store.dispatch("changedclassifierBandWidthDict",this.thresholdRange),this.$store.dispatch("changedBandWidthClassifier","")}const o=this.thresholdRange,l=this.xScale,c=e.append("g").selectAll("g").data(t).enter().append("g").attr("transform",(function(t,e){return"translate(0,"+120*e+")"}));c.append("text").attr("transform","translate(30,30)").attr("class",t=>"slider-text"+t).text(t=>t).attr("x",5).attr("font-size","22px").attr("fill","grey"),c.append("line").attr("transform","translate(0,110)").attr("class","range-border").style("stroke","lightgrey").style("stroke-opacity","1").style("stroke-width","3").attr("x1",0).attr("x2",430).attr("y1",0).attr("y2",0).attr("visibility",e=>e==t[t.length-1]?"hidden":"visible"),c.append("line").attr("transform","translate(0,60)").attr("class","track").style("stroke","#777").style("stroke-opacity","1").style("stroke-width","5").attr("x1",10).attr("x2",410).attr("y1",0).attr("y2",0);let h=c.append("path").attr("d",r).style("fill","red").style("stroke","none").attr("class",t=>"slider-circle-time-from"+t).attr("transform",(function(t){let e=400*o[t].left_range;return"translate("+l(e)+",60)"})).call(it["h"]().on("start.interrupt",(function(){h.interrupt()})).on("start drag",t=>this.sliderRange={type:"from",classifier:t,value:l.invert(it["i"].x)})),d=c.append("path").attr("d",n).style("fill","green").style("stroke","none").attr("class",t=>"slider-circle-time-to"+t).attr("transform",(function(t){let e=400*o[t].right_range;return"translate("+l(e)+",60)"})).call(it["h"]().on("start.interrupt",(function(){d.interrupt()})).on("start drag",t=>this.sliderRange={type:"to",classifier:t,value:l.invert(it["i"].x)}));c.append("text").attr("transform","translate(10,100)").attr("class",t=>"range-text-"+t).text(t=>"("+this.thresholdRange[t].left_range.toFixed(2)+", "+this.thresholdRange[t].right_range.toFixed(2)+")").attr("font-size","18px").attr("fill","grey"),c.append("rect").attr("width",40).attr("height",20).attr("transform","translate(120,82)").attr("class",t=>"add-bandwidth-"+t).attr("fill","lightgrey"),c.append("text").attr("transform","translate(125,100)").attr("class",t=>"add-bandwidth-set-"+t).text("add").attr("font-size","18px").attr("fill","grey").on("mouseenter",t=>{it["C"](".add-bandwidth-set-"+t).attr("fill","white"),it["C"](".add-bandwidth-"+t).attr("fill","grey")}).on("mouseleave",t=>{it["C"](".add-bandwidth-set-"+t).attr("fill","grey"),it["C"](".add-bandwidth-"+t).attr("fill","lightgrey")}).on("click",t=>this.curAddedBandWidthClassifier={classifier:t,left_range:this.thresholdRange[t].left_range.toFixed(2),right_range:this.thresholdRange[t].right_range.toFixed(2)})}}}),Aa=Oa,Ba=Object(m["a"])(Aa,Pa,Da,!1,null,null,null),Ma=Ba.exports;v()(Ba,{VExpansionPanels:Xt["a"]});var Ra=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-expansion-panels",{attrs:{multiple:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("div",{staticClass:"table-container-sample"},[s("v-data-table",{staticClass:"elevation-2",attrs:{headers:t.headers,items:t.sample_value,options:t.pagination,"disable-sort":"",dense:""},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body",fn:function(e){var i=e.items;return[s("tbody",t._l(i,(function(e){return s("tr",{key:e.name,style:t.styleTableRow(e)},[s("td",{on:{click:function(s){return t.setOverlapSampling({whichOverlap:"first",selection:e})},contextmenu:function(s){return s.preventDefault(),t.setOverlapSampling({whichOverlap:"second",selection:e})}}},[t._v(t._s(e.name)+" ")]),s("td",[t._v(t._s(e.size))]),s("td",{on:{click:function(s){return t.onButtonClick({whichOverlap:"first",selection:e})}}},[s("v-btn",{style:t.styleDataChosen(e),attrs:{icon:""}},[s("v-icon",[t._v("mdi-star")])],1)],1)])})),0)]}}])})],1),s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("Random Sampling")]),s("v-expansion-panel-content"),s("div",{ref:"svg_random"})],1)],1)},Ha=[],Va=i["a"].extend({name:"RandomSampling",data(){const t={value:200},e=this.$store.state.classifierThresholdDict,s={sampling:""};return{headers:[{text:"Name",value:"name"},{text:"Size",value:"size"},{text:"Set as Dataset",value:"set"}],pagination:{rowsPerPage:5},addSampling:s,classifierThresholdDict:e,sliderRange:t,thresholdRange:{},panel:[],threshold:0}},computed:{sample_value(){return this.$store.state.sampleList},overlapSelections(){return this.$store.state.overlapSelections},selectedSampleSet(){return this.$store.state.selectedSampleSet},instances(){return[...this.$store.getters.instances]},thresholdClassifierNameList(){return this.$store.getters.thresholdClassifierNameList},classifierThresholdList(){return this.$store.getters.classifierThresholdList},xScale(){const t=it["y"]().domain([0,400]).range([20,420]).clamp(!0);return t}},watch:{addSampling(){let t=this.sample_value.length,e=this.instances,s=100*this.addSampling.sampling,i=l(0,e.length,s/100*e.length),a=[],r=[...this.$store.getters.instances];const n=[...this.$store.getters.features];if(n.includes("train_or_test")){const t="train_or_test";r=r.filter(e=>"test"===Nt(e).features[t]||"0"===Nt(e).features[t])}e.forEach(t=>{i.includes(t)||a.push(t)});let o=[];function l(t,s,i){let a=[],r=new Set,n=0;while(r.size<i){let t=Math.floor(Math.random()*e.length);a.push(t.toString()),n+=1,r=new Set(a)}return[...r]}this.sample_value.forEach(t=>{o.push(t)}),o.push({decription:"random",id:t,name:t+"_random_left_"+s.toFixed(0)+"%",size:i.length,instances:new Set(i)}),o.push({decription:"random",id:t+1,name:t+1+"_random_right_"+(100-parseInt(s.toFixed(0)))+"%",size:e.length-i.length,instances:new Set(a)}),this.$store.dispatch("changedSampledList",o)},sliderRange(){this.drawUpdateRanges()},classifierThresholdDict(){this.drawInitial()},thresholdClassifierNameList(){this.drawInitial()}},mounted(){this.drawInitial()},methods:{onButtonClick(t){console.log(t),this.$store.dispatch("changeCurrentChosenSample",t.selection.name),this.$store.dispatch("changedToSamplingData",t)},setOverlapSampling(t){this.$store.dispatch("changedSampleSelection",t);const e=t.selection.name,s=t.selection.instances,i=nt(),a={type:"simple",constraints:[i],metric:[]},r={description:e,instances:s,predicate:a};this.$store.dispatch("prependToSelectionHistory",r),this.$store.dispatch("changedMostRecentSelection",t.whichOverlap)},styleDataChosen(t){return t.name==this.$store.state.currentChosenSample?"\n          color: pink;\n        ":""},styleTableRow(t){const{first:e,second:s}=Ot.overlapSelections,{first:i,second:a}=this.selectedSampleSet,r=i&&i.id===t.id,n=a&&a.id===t.id;return r&&n?`\n          background: -webkit-linear-gradient(top, ${e}, ${s});\n          color: white;\n        `:r?`\n          background-color: ${e};\n        `:n?`\n          background-color: ${s};\n          color: white;\n        `:""},drawUpdateRanges(){const t=this.sliderRange.value,e=this.sliderRange.value/400*100,s=it["C"](this.$refs.svg_random),i=s.select(".random-slider-rect"),a=s.select(".random-partition-text");this.instances;i.attr("x",this.xScale(t)),a.text("partition: ("+e.toFixed(0)+"%, "+(100-parseInt(e.toFixed(0)))+"%)")},drawInitial(){const t=this.xScale;it["C"](this.$refs.svg_random).selectAll("*").remove();const e=it["C"](this.$refs.svg_random).append("svg").attr("width","100%").attr("viewBox","0 0\n          440\n          120").append("g").attr("transform","translate(0, 0)");e.append("rect").attr("class","random-set-1").attr("width",200).attr("height",40).attr("x",20).attr("y",10).attr("fill","lightgrey").attr("stroke","lightgrey").attr("stroke-width","2px"),e.append("rect").attr("class","random-set-2").attr("width",200).attr("height",40).attr("x",220).attr("y",10).attr("fill","lightgrey").attr("stroke","lightgrey").attr("stroke-width","2px");let s=e.append("rect").attr("class","random-slider-rect").attr("width",10).attr("height",40).attr("x",215).attr("y",10).attr("fill","steelblue").call(it["h"]().on("start.interrupt",(function(){s.interrupt()})).on("start drag",e=>this.sliderRange={value:t.invert(it["i"].x)}));e.append("rect").attr("class","random-set-button").attr("width",40).attr("height",20).attr("x",20).attr("y",90).attr("rx",6).attr("fill","lightgrey").on("mouseenter",t=>{it["C"](".random-slider-text").attr("fill","white"),it["C"](".random-set-button").attr("fill","grey")}).on("mouseleave",t=>{it["C"](".random-slider-text").attr("fill","grey"),it["C"](".random-set-button").attr("fill","lightgrey")}).on("click",t=>this.addSampling={sampling:this.sliderRange.value/400}),e.append("text").attr("x",40).attr("y",105).attr("class","random-slider-text").text("set").style("text-anchor","middle").attr("font-size","18px").attr("fill","grey").on("mouseenter",t=>{it["C"](".random-slider-text").attr("fill","white"),it["C"](".random-set-button").attr("fill","grey")}).on("mouseleave",t=>{it["C"](".random-slider-text").attr("fill","grey"),it["C"](".random-set-button").attr("fill","lightgrey")}).on("click",t=>this.addSampling={sampling:this.sliderRange.value/400}),e.append("text").attr("x",100).attr("y",105).attr("class","random-partition-text").text("partition: (50%, 50%)").style("text-anchor","start").attr("font-size","22px").attr("fill","steelblue")}}}),ja=Va,Ka=Object(m["a"])(ja,Ra,Ha,!1,null,null,null),Na=Ka.exports;v()(Ka,{VBtn:y["a"],VDataTable:Ms["a"],VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"]});var La=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-expansion-panels",{attrs:{multiple:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("Bootstrap Sampling")]),s("div",{staticStyle:{"margin-left":"10%","font-size":"14px",stroke:"'black'","stroke-width":"2px"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.sample_size,expression:"sample_size"}],attrs:{placeholder:"edit me"},domProps:{value:t.sample_size},on:{input:function(e){e.target.composing||(t.sample_size=e.target.value)}}}),s("p",[t._v(" Sample size: "+t._s(t.sample_size))])]),s("div",{ref:"svg_bootstrap"})],1)],1)},Wa=[],qa=i["a"].extend({name:"BootstrapSampling",data(){const t={sampling:""};return{addSampling:t,sample_size:0,panel:[],checkedBoxes:[]}},computed:{value(){return this.$store.state.sampleList},overlapSelections(){return this.$store.state.overlapSelections},instances(){return[...this.$store.getters.instances]},thresholdClassifierNameList(){return this.$store.getters.thresholdClassifierNameList},classifierThresholdList(){return this.$store.getters.classifierThresholdList},xScale(){const t=it["y"]().domain([0,400]).range([20,420]).clamp(!0);return t}},watch:{addSampling(){let t=this.value.length,e=this.sample_size,s=1,i=(this.instances,[...this.$store.getters.instances]),a=[];const r=[...this.$store.getters.features];if(r.includes("train_or_test")){const t="train_or_test";i=i.filter(e=>"test"===Nt(e).features[t]||"0"===Nt(e).features[t])}let n=0;while(n<s){let t=l(0,i.length,e);t.forEach(t=>{a.push(i[t])}),n+=1}let o=[];function l(t,e,s){let a=[],r=0;while(r<s){let t=Math.floor(Math.random()*i.length);a.push(t.toString()),r+=1}return a}this.value.forEach(t=>{o.push(t)}),o.push({decription:"bootstrap",id:t,name:t+"_bootstrap",size:a.length,instances:new Set(a)}),this.$store.dispatch("changedSampledList",o)},classifierThresholdDict(){this.drawInitial()},thresholdClassifierNameList(){this.drawInitial()}},mounted(){this.drawInitial()},methods:{setOverlapSampling(t){this.$store.dispatch("changedToSamplingData",t)},styleTableRow(t){const{first:e,second:s}=Ot.overlapSelections,{first:i,second:a}=this.overlapSelections,r=i&&i.id===t.id,n=a&&a.id===t.id;return r&&n?`\n          background: -webkit-linear-gradient(top, ${e}, ${s});\n          color: white;\n        `:r?`\n          background-color: ${e};\n        `:n?`\n          background-color: ${s};\n          color: white;\n        `:""},drawInitial(){this.xScale;it["C"](this.$refs.svg_bootstrap).selectAll("*").remove();const t=it["C"](this.$refs.svg_bootstrap).append("svg").attr("width","100%").attr("viewBox","0 0\n          440\n          120").append("g").attr("transform","translate(0, 20)");t.append("rect").attr("class","bootstrap-set-button").attr("width",40).attr("height",20).attr("x","10%").attr("y",0).attr("rx",6).attr("fill","lightgrey").on("mouseenter",t=>{it["C"](".bootstrap-slider-text").attr("fill","white"),it["C"](".bootstrap-set-button").attr("fill","grey")}).on("mouseleave",t=>{it["C"](".bootstrap-slider-text").attr("fill","grey"),it["C"](".bootstrap-set-button").attr("fill","lightgrey")}).on("click",t=>this.addSampling={sampling:"set"}),t.append("text").attr("x","15%").attr("y",15).attr("class","bootstrap-slider-text").text("set").style("text-anchor","middle").attr("font-size","18px").attr("fill","grey").on("mouseenter",t=>{it["C"](".bootstrap-slider-text").attr("fill","white"),it["C"](".bootstrap-set-button").attr("fill","grey")}).on("mouseleave",t=>{it["C"](".bootstrap-slider-text").attr("fill","grey"),it["C"](".bootstrap-set-button").attr("fill","lightgrey")}).on("click",t=>this.addSampling={sampling:"set"})}}}),Ua=qa,Ya=Object(m["a"])(Ua,La,Wa,!1,null,null,null),Ga=Ya.exports;v()(Ya,{VExpansionPanel:j["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"]});var Qa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-expansion-panels",{attrs:{multiple:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[t._v("Stratified Sampling")]),s("div",{staticStyle:{"margin-left":"10%","font-size":"14px",stroke:"'black'","stroke-width":"2px"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.sample_size,expression:"sample_size"}],attrs:{placeholder:"edit me"},domProps:{value:t.sample_size},on:{input:function(e){e.target.composing||(t.sample_size=e.target.value)}}}),s("p",[t._v(" Total sample size")])]),s("multiselect",{attrs:{options:t.options,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pick sets",label:"name","track-by":"name","preselect-first":!0},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.values,a=(e.search,e.isOpen);return[i.length&&!a?s("span",{staticClass:"multiselect__single"},[t._v(" "+t._s(i.length)+" options selected ")]):t._e()]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),s("div",{ref:"svg_stratified"})],1)],1)},Ja=[],Xa=i["a"].extend({name:"StratifiedSampling",data(){const t={sampling:""};return{addSampling:t,sample_size:0,pagination:{rowsPerPage:5},headers:[{text:"Name",value:"name"},{text:"Weight",value:"weight"}],value:[],panel:[],checkedBoxes:[]}},computed:{sampled_value(){return this.$store.state.sampleList},sample_weight(){this.$store.getters.features;const t=[...this.$store.getters.features].filter(t=>"categorical"===this.$store.getters.feature(t).type);let e={};return t.forEach(t=>{this.$store.getters.feature(t).categories.forEach(s=>{e[t+"*"+s]=0})}),e},overlapSelections(){return this.$store.state.overlapSelections},instances(){return[...this.$store.getters.instances]},classList(){return[...this.$store.getters.classes]},options(){let t=[];this.$store.getters.features;const e=[...this.$store.getters.features].filter(t=>"categorical"===this.$store.getters.feature(t).type);return e.forEach(e=>{t.push({name:e})}),t.push({name:"target class"}),t}},watch:{addSampling(){let t=this.value.length>0?this.value[0].name:"",e=this.sampled_value.length,s=this.instances;console.log(this.classList);let i={};"target class"!=t?(this.$store.getters.feature(t).categories.forEach(t=>{i[t]=[]}),s.forEach(e=>{const s=Nt(e).features[t];i[s].push(e)})):(this.classList.forEach(t=>{i[t]=[]}),s.forEach(t=>{const e=Nt(t).actual;i[e].push(t)})),console.log("cate_dict",i);let a=[],r=this.sample_size;for(let l in i){console.log(r,i[l].length,s.length);let t=Math.floor(r*i[l].length/s.length),e=o(0,s.length,t,i[l]);e.forEach(t=>{a.push(t)})}let n=[];function o(t,e,s,i){let a=[],r=new Set,n=0;while(r.size<s){let t=Math.floor(Math.random()*i.length);a.push(t.toString()),r=new Set(a),n+=1}return a}n.push({decription:"stratified",id:e,name:e+"_stratified",size:a.length,instances:new Set(a)}),this.$store.dispatch("changedSampledList",n)},classifierThresholdDict(){this.drawInitial()},thresholdClassifierNameList(){this.drawInitial()}},mounted(){this.drawInitial()},methods:{showInput(t){console.log("showinput",t)},setOverlapSampling(t){this.$store.dispatch("changedToSamplingData",t)},styleTableRow(t){const{first:e,second:s}=Ot.overlapSelections,{first:i,second:a}=this.overlapSelections,r=i&&i.id===t.id,n=a&&a.id===t.id;return r&&n?`\n          background: -webkit-linear-gradient(top, ${e}, ${s});\n          color: white;\n        `:r?`\n          background-color: ${e};\n        `:n?`\n          background-color: ${s};\n          color: white;\n        `:""},drawInitial(){this.xScale;it["C"](this.$refs.svg_stratified).selectAll("*").remove();const t=it["C"](this.$refs.svg_stratified).append("svg").attr("width","100%").attr("viewBox","0 0\n          440\n          120").append("g").attr("transform","translate(0, 20)");t.append("rect").attr("class","stratified-set-button").attr("width",40).attr("height",20).attr("x","10%").attr("y",0).attr("rx",6).attr("fill","lightgrey").on("mouseenter",t=>{it["C"](".stratified-slider-text").attr("fill","white"),it["C"](".stratified-set-button").attr("fill","grey")}).on("mouseleave",t=>{it["C"](".stratified-slider-text").attr("fill","grey"),it["C"](".stratified-set-button").attr("fill","lightgrey")}).on("click",t=>this.addSampling={sampling:"set"}),t.append("text").attr("x","15%").attr("y",15).attr("class","stratified-slider-text").text("set").style("text-anchor","middle").attr("font-size","20px").attr("fill","grey").on("mouseenter",t=>{it["C"](".stratified-slider-text").attr("fill","white"),it["C"](".stratified-set-button").attr("fill","grey")}).on("mouseleave",t=>{it["C"](".stratified-slider-text").attr("fill","grey"),it["C"](".stratified-set-button").attr("fill","lightgrey")}).on("click",t=>this.addSampling={sampling:"set"})}}}),Za=Xa,tr=Object(m["a"])(Za,Qa,Ja,!1,null,null,null),er=tr.exports;v()(tr,{VExpansionPanel:j["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"]});var sr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-expansion-panels",{attrs:{multiple:""},model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("div",{staticClass:"table-container-validation"},[s("v-data-table",{staticClass:"elevation-2",attrs:{headers:t.headers,items:t.validation_value,options:t.pagination,"disable-sort":"",dense:""},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body",fn:function(e){var i=e.items;return[s("tbody",t._l(i,(function(e){return s("tr",{key:e.name,style:t.styleTableRow(e)},[s("td",[t._v(t._s(e.name)+" ")]),s("td",{on:{click:function(s){return t.onButtonClick({whichOverlap:"first",selection:e})}}},[s("v-btn",{style:t.styleDataChosen(e),attrs:{icon:""}},[s("v-icon",[t._v("mdi-star")])],1)],1),s("td",{on:{click:function(s){return t.saveStatus({selection:e})}}},[s("v-btn",{attrs:{icon:"",color:"indigo"}},[s("v-icon",{attrs:{dark:""}},[t._v(" mdi-plus ")])],1)],1),s("td",[t._v(t._s(e.parameters)+" ")])])})),0)]}}])}),s("v-btn",{attrs:{small:""},on:{click:function(e){return t.onButtonClick({whichOverlap:"",selection:""})}}},[t._v(" Reset ")])],1),s("v-expansion-panel",[s("div",{staticStyle:{"margin-left":"10%","font-size":"14px",stroke:"'black'","stroke-width":"2px"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.k_size,expression:"k_size"}],attrs:{placeholder:"edit me"},domProps:{value:t.k_size},on:{input:function(e){e.target.composing||(t.k_size=e.target.value)}}}),s("p",[t._v(" K-fold validation: k = "+t._s(t.k_size))])]),s("div",{ref:"svg_validation"})])],1)},ir=[],ar=i["a"].extend({name:"KfoldValidation",data(){const t={sampling:""};return{headers:[{text:"Fold Number",value:"name"},{text:"Shuffle",value:"set"},{text:"Save Status",value:"set"},{text:"Parameters",value:"N/A"}],pagination:{rowsPerPage:5},shuffle:t,k_size:0,panel:[],checkedBoxes:[]}},computed:{addedBandWidthClassifiers(){return this.$store.state.addedBandWidthClassifiers},classifierThresholdDict(){return this.$store.state.classifierThresholdDict},bandWidthClassifiers(){if(0==this.addedBandWidthClassifiers.length){const t=Object.keys(this.classifierThresholdDict).map(t=>{let e=this.classifierThresholdDict[t]/100;return{name:t+"("+(e-.05).toFixed(2)+","+(e+.05).toFixed(2)+")"}});return t}return this.addedBandWidthClassifiers},validation_value(){return this.$store.state.validationList},overlapSelections(){return this.$store.state.overlapSelections},instances(){return[...this.$store.getters.instances]},thresholdClassifierNameList(){return this.$store.getters.thresholdClassifierNameList},classifierThresholdList(){return this.$store.getters.classifierThresholdList},xScale(){const t=it["y"]().domain([0,400]).range([20,420]).clamp(!0);return t}},watch:{addedBandWidthClassifiers(){},shuffle(){let t=this.k_size,e=0,s=[],i=Math.round(this.instances.length/t);while(e<t){let t=[],a=[],r=e*i,n=(e+1)*i;while(r<n&&r<this.instances.length)t.push(this.instances[r]),r+=1;this.instances.forEach(e=>{t.includes(e)||a.push(e)}),s.push({name:"Fold "+(e+1),training:new Set(a),testing:new Set(t),parameters:"N/A"}),e+=1}this.$store.dispatch("changedValidationList",s)},classifierThresholdDict(){},thresholdClassifierNameList(){this.drawInitial()}},mounted(){this.drawInitial()},methods:{onButtonClick(t){""!=t.selection?this.$store.dispatch("changedCurrentChosenFold",t.selection.name):(this.$store.dispatch("changedCurrentChosenFold",""),this.validation_value.forEach(t=>{t.parameters="N/A"}))},saveStatus(t){this.validation_value.forEach(e=>{e.name==t.selection.name&&(e.parameters=this.bandWidthClassifiers)})},styleDataChosen(t){return t.name==this.$store.state.currentChosenFold?"\n          color: pink;\n        ":""},styleTableRow(t){const{first:e,second:s}=Ot.overlapSelections,{first:i,second:a}=this.overlapSelections,r=i&&i.id===t.id,n=a&&a.id===t.id;return r&&n?`\n          background: -webkit-linear-gradient(top, ${e}, ${s});\n          color: white;\n        `:r?`\n          background-color: ${e};\n        `:n?`\n          background-color: ${s};\n          color: white;\n        `:""},drawInitial(){this.xScale;it["C"](this.$refs.svg_validation).selectAll("*").remove();const t=it["C"](this.$refs.svg_validation).append("svg").attr("width","100%").attr("viewBox","0 0\n          440\n          60").append("g").attr("transform","translate(0, 0)");t.append("rect").attr("class","validation-set-button").attr("width",60).attr("height",30).attr("x","10%").attr("y",0).attr("rx",6).attr("fill","lightgrey").on("mouseenter",t=>{it["C"](".validation-slider-text").attr("fill","white"),it["C"](".validation-set-button").attr("fill","grey")}).on("mouseleave",t=>{it["C"](".validation-slider-text").attr("fill","grey"),it["C"](".validation-set-button").attr("fill","lightgrey")}).on("click",t=>this.shuffle={sampling:"set"}),t.append("text").attr("x","17%").attr("y",20).attr("class","validation-slider-text").text("shuffle").style("text-anchor","middle").attr("font-size","18px").attr("fill","grey").on("mouseenter",t=>{it["C"](".validation-slider-text").attr("fill","white"),it["C"](".validation-set-button").attr("fill","grey")}).on("mouseleave",t=>{it["C"](".validation-slider-text").attr("fill","grey"),it["C"](".validation-set-button").attr("fill","lightgrey")}).on("click",t=>this.shuffle={sampling:"set"})}}}),rr=ar,nr=Object(m["a"])(rr,sr,ir,!1,null,null,null),or=nr.exports;v()(nr,{VBtn:y["a"],VDataTable:Ms["a"],VExpansionPanel:j["a"],VExpansionPanels:Xt["a"],VIcon:B["a"]});var lr=i["a"].extend({name:"Sidebar",components:{RandomSampling:Na,BootstrapSampling:Ga,StratifiedSampling:er,ClassFilter:zs,ClassifierFilter:Ps,InstanceList:Hs,SetHistory:ca,FocusItem:ga,ViewList:Ca,ContinuousMode:Ia,UncertainAdjuster:Ma,KfoldValidation:or},data(){return{panel:[0,0,0]}},computed:{datasetType(){var t=this.$store.state.datasetType;return t}}}),cr=lr,hr=(s("31a1"),Object(m["a"])(cr,_s,xs,!1,null,"5c45cbd2",null)),dr=hr.exports;v()(hr,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"]});var ur=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Pairwise Classifier Consensus")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}})])],1)],1),s("div",{ref:"svg"})],1)},pr=[],fr=i["a"].extend({name:"PairwiseClassifierConsensus",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:20,right:200,bottom:100,left:200},e=500,s=500,i={consensusType:"",classifiers:["",""]};return{agreeColor:"#4393c3",backgroundColor:"white",disagreeColor:"#d6604d",height:s,hover:i,hoverColor:"black",margin:t,neutralColor:"white",panel:[],selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e}},computed:{agreeScale(){const t=it["y"]().domain([0,this.consensusMax]).range([this.neutralColor,this.agreeColor]);return t},consensus(){const t={};return this.classifiers.forEach((e,s)=>{t[e]={},this.classifiers.slice(0,s).forEach(s=>{t[e][s]={agree:new Set,disagree:new Set},t[s][e]=t[e][s]})}),this.instances.forEach(e=>{const s=Nt(e);this.classifiers.forEach((i,a)=>{this.classifiers.slice(0,a).forEach(a=>{const r=s.predictions[i]===s.predictions[a]?"agree":"disagree";t[i][a][r].add(e)})})}),t},consensusKeys(){const t=Object.keys(this.consensus);return t},consensusMax(){let t=0;return this.classifiers.forEach((e,s)=>{this.classifiers.slice(0,s).forEach(s=>{t=Math.max(t,this.consensus[e][s].agree.size,this.consensus[e][s].disagree.size)})}),t},classes(){return[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},disagreeScale(){const t=it["y"]().domain([0,this.consensusMax]).range([this.neutralColor,this.disagreeColor]);return t},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},keyCross(){const t=it["f"](this.consensusKeys,this.consensusKeys);return t},selections(){return this.$store.state.overlapSelections},x(){const t=it["x"]().domain(this.consensusKeys).range([0,this.width]).paddingOuter(.05).paddingInner(.1);return t},y(){const t=it["x"]().domain(this.consensusKeys).range([0,this.height]).paddingOuter(.05).paddingInner(.1);return t}},watch:{hover(){this.drawHover()},instances(){this.drawInitial()},selections(){this.drawSelections()}},mounted(){this.drawInitial()},methods:{clearHover(){this.hover={consensusType:"",classifiers:["",""]}},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+this.margin.bottom}`).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),e=()=>{t.append("rect").attr("width",this.width).attr("height",this.height).attr("fill",this.backgroundColor).attr("stroke","black")};e();const s=this.x,i=this.y,a=()=>{const e=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](s));t.append("g").call(e).attr("class","axis").attr("font-size",20).selectAll("text").attr("transform","translate(0, 10) rotate(20)").style("text-anchor","start");const a=t=>t.attr("transform",`translate(${this.width}, 0)`).call(it["d"](i));t.append("g").call(a).attr("class","axis").attr("font-size",20).selectAll("text"),t.selectAll(".axis").selectAll(".domain").remove()};a();const r=()=>{const t=50,e=this.margin.left-2*t,s=this.height-2*t,i=it["C"](this.$refs.svg).select("svg").append("defs"),a=[{id:Kt(),color:this.agreeColor},{id:Kt(),color:this.disagreeColor}],r=i.selectAll("linearGradient").data(a).join("linearGradient").attr("id",t=>t.id).attr("x1","0%").attr("y1","100%").attr("x2","0%").attr("y2","0%");r.append("stop").attr("offset","0%").attr("stop-color",this.neutralColor).attr("stop-opacity",1),r.append("stop").attr("offset","100%").attr("stop-color",t=>t.color).attr("stop-opacity",1);const n=it["C"](this.$refs.svg).select("svg").append("g").attr("class","legend").attr("transform",`translate(${t}, ${this.margin.top+t})`);n.selectAll("rect").data(a).join("rect").attr("x",(t,s)=>s*e/2).attr("width",e/2).attr("height",s).attr("fill",(t,e)=>`url(#${t.id})`).attr("stroke","black"),n.append("text").attr("transform",`translate(${e/2}, ${s+t/2})`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","hanging").text(0),n.append("text").attr("transform",`translate(${e/2}, ${-t/2})`).attr("font-size","20px").attr("text-anchor","middle").text(this.consensusMax),n.append("text").attr("transform",`translate(${-t/2}, ${s/2}) rotate(-90)`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("Number of instances"),n.append("text").attr("transform",`translate(${e/4}, ${s/2}) rotate(-90)`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("agree"),n.append("text").attr("transform",`translate(${3*e/4}, ${s/2}) rotate(-90)`).attr("font-size","20px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("disagree"),console.log("legend draw")};r();const n=()=>{const e=t.selectAll(".cell").data(this.keyCross).join("g").attr("class","cell").attr("transform",t=>`translate(${s(t[0])}, ${i(t[1])})`).on("mouseenter",t=>{const e=this.whichTriangle(t);e&&(this.hover={consensusType:e,classifiers:t})}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"first")).on("contextmenu",t=>this.select(t,"second"));e.append("rect").attr("width",s.bandwidth()).attr("height",i.bandwidth()).attr("fill",t=>{const e=this.whichTriangle(t);if(!e)return this.backgroundColor;const s=this.consensus[t[0]][t[1]][e].size,i="agree"===e?this.agreeScale:this.disagreeScale;return i(s)}).attr("stroke",t=>t[0]===t[1]?"none":"black").style("paint-order","stroke"),e.append("circle").attr("class","hover-circle").attr("cx",s.bandwidth()/2).attr("cy",i.bandwidth()/2).attr("r",Math.min(s.bandwidth(),i.bandwidth())/12).attr("fill","black");const a=()=>{const t=10;e.append("rect").attr("y",this.y.bandwidth()*(t-2)/t).attr("width",t=>t[0]===t[1]?0:this.x.bandwidth()).attr("height",this.y.bandwidth()/t*2).attr("fill","black"),e.append("rect").attr("class","selection-1").attr("y",this.y.bandwidth()*(t-2)/t).attr("height",this.y.bandwidth()/t).attr("fill",this.selection1Color),e.append("rect").attr("class","selection-2").attr("y",this.y.bandwidth()*(t-1)/t).attr("height",this.y.bandwidth()/t).attr("fill",this.selection2Color)};a()},o=()=>{t.append("text").attr("class","hover-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",20).attr("pointer-events","none")};n(),o(),this.drawHover(),this.drawSelections()},drawHover(){const t=it["C"](this.$refs.svg),e=t.select(".hover-text");if(this.hover.consensusType){const[t,s]=this.hover.classifiers,i=this.consensus[t][s][this.hover.consensusType].size;e.attr("fill-opacity",0).attr("transform",`translate(\n            ${this.x(t)+this.x.bandwidth()/2},\n            ${this.y(s)+this.y.bandwidth()/2})`).text(i).transition().duration(500).attr("fill-opacity",1)}else e.text("")},drawSelections(){const t=it["C"](this.$refs.svg),e=t.selectAll(".selection-1"),s=t.selectAll(".selection-2"),{first:i,second:a}=this.selections,r=(t,e)=>{const s=this.whichTriangle(t);if(!s)return 0;const i=this.consensus[t[0]][t[1]][s],a=Lt(i,e.instances),r=a.size/i.size,n=this.x.bandwidth()*r;return n};i?e.data(this.keyCross).attr("width",t=>r(t,i)):e.attr("width",0),a?s.data(this.keyCross).attr("width",t=>r(t,a)):s.attr("width",0)},select(t,e){it["i"].preventDefault(),it["i"].stopPropagation();const s=this.whichTriangle(t);if(!s)return;const[i,a]=t,r=nt();r.rule=X.AGREE,r.negation="disagree"===s,r.classifier=i,r.classifier2=a;const n=this.consensus[i][a][s],o=`Instances on which classifiers ${i} and ${a} ${s}`,l={type:"simple",constraints:[r],metric:[]},c={description:o,instances:n,predicate:l};this.$store.dispatch("prependToSelectionHistory",c),this.$store.dispatch("changedMostRecentSelection",e)},whichTriangle(t){const[e,s]=t,i=this.consensusKeys.indexOf(e),a=this.consensusKeys.indexOf(s);return i<a?"agree":i>a?"disagree":""}}}),mr=fr,gr=(s("6836"),Object(m["a"])(mr,ur,pr,!1,null,"91ee6e68",null)),vr=gr.exports;v()(gr,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"]});var yr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"4px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Metrics Table")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Display Mode"},model:{value:t.display_mode,callback:function(e){t.display_mode=e},expression:"display_mode"}},[s("v-radio",{attrs:{label:"overall mode ",value:"overall"}}),s("v-radio",{attrs:{label:"uncertain mode",value:"uncertain"}})],1)],1),s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"Performance Type"},model:{value:t.weightedPerformance,callback:function(e){t.weightedPerformance=e},expression:"weightedPerformance"}},[s("v-radio",{attrs:{label:"normal",value:"normal"}}),s("v-radio",{attrs:{label:"weighted",value:"weighted"}})],1)],1)])],1)],1),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.metrics,datasetType:t.datasetType,continuous_dict:t.continuous_dict,"multi-sort":"","sort-by":t.sortby},scopedSlots:t._u([{key:"body",fn:function(e){var i=e.items;return[s("tbody",t._l(i,(function(e){return s("tr",{key:e.classifier},[s("td",[t._v(t._s(e.classifier))]),"continuous"==t.datasetType&&"overall"==t.display_mode?s("td",{staticClass:"column0"},[t._v(t._s(""+t.continuous_dict[e.classifier].cur_threshold.toFixed(2)))]):t._e(),"continuous"==t.datasetType&&"uncertain"==t.display_mode?s("td",{staticClass:"column0"},[t._v(t._s(""+t.continuous_dict[e.classifier].cur_uncertain))]):t._e(),"continuous"!=t.datasetType?s("td",{staticClass:"column1"},[t._v(" "+t._s(""+e.metrics.accuracy.toFixed(3)))]):t._e(),"continuous"==t.datasetType&&"uncertain"!=t.display_mode?s("td",{staticClass:"column1"},[t._v(t._s(""+t.continuous_dict[e.classifier].accuracy.toFixed(3)))]):t._e(),"continuous"==t.datasetType&&"uncertain"==t.display_mode?s("td",{staticClass:"column1"},[t._v(t._s(""+t.continuous_dict[e.classifier].m_accuracy.toFixed(3)))]):t._e(),"continuous"!=t.datasetType?s("td",{staticClass:"column2"},[t._v(t._s(""+e.metrics.mcc.average.toFixed(3)))]):t._e(),"continuous"==t.datasetType&&"uncertain"!=t.display_mode?s("td",{staticClass:"column2"},[t._v(t._s(""+t.continuous_dict[e.classifier].mcc.toFixed(3)))]):t._e(),"continuous"==t.datasetType&&"uncertain"==t.display_mode?s("td",{staticClass:"column2"},[t._v(t._s(""+t.continuous_dict[e.classifier].m_mcc.toFixed(3)))]):t._e(),t.classNumber>2?s("td",{staticClass:"column3"},[t._v(t._s(""+e.metrics.microf1.average.toFixed(3)))]):t._e(),t.classNumber>2?s("td",{staticClass:"column4"},[t._v(t._s(""+e.metrics.macrof1.average.toFixed(3)))]):t._e(),t.classNumber<=2&&"continuous"!=t.datasetType?s("td",{staticClass:"column5"},[t._v(t._s(""+e.metrics.precision.average.toFixed(3)))]):t._e(),t.classNumber<=2&&"continuous"!=t.datasetType?s("td",{staticClass:"column6"},[t._v(t._s(""+e.metrics.recall.average.toFixed(3)))]):t._e(),t.classNumber<=2&&"continuous"!=t.datasetType?s("td",{staticClass:"column7"},[t._v(t._s(""+e.metrics.f1.average.toFixed(3)))]):t._e(),t.classNumber<=2&&"continuous"==t.datasetType&&"uncertain"!=t.display_mode?s("td",{staticClass:"column5"},[t._v(t._s(""+t.continuous_dict[e.classifier].precision.toFixed(3)))]):t._e(),t.classNumber<=2&&"continuous"==t.datasetType&&"uncertain"!=t.display_mode?s("td",{staticClass:"column6"},[t._v(t._s(""+t.continuous_dict[e.classifier].recall.toFixed(3)))]):t._e(),t.classNumber<=2&&"continuous"==t.datasetType&&"uncertain"!=t.display_mode?s("td",{staticClass:"column7"},[t._v(t._s(""+t.continuous_dict[e.classifier].f1.toFixed(3)))]):t._e(),t.classNumber<=2&&"continuous"==t.datasetType&&"uncertain"==t.display_mode?s("td",{staticClass:"column5"},[t._v(t._s(""+t.continuous_dict[e.classifier].m_precision.toFixed(3)))]):t._e(),t.classNumber<=2&&"continuous"==t.datasetType&&"uncertain"==t.display_mode?s("td",{staticClass:"column6"},[t._v(t._s(""+t.continuous_dict[e.classifier].m_recall.toFixed(3)))]):t._e(),t.classNumber<=2&&"continuous"==t.datasetType&&"uncertain"==t.display_mode?s("td",{staticClass:"column7"},[t._v(t._s(""+t.continuous_dict[e.classifier].m_f1.toFixed(3)))]):t._e(),"continuous"==t.datasetType&&"uncertain"!=t.display_mode?s("td",{staticClass:"column8"},[t._v(t._s(""+t.continuous_dict[e.classifier].auc_area.toFixed(3)))]):t._e(),"continuous"==t.datasetType&&"uncertain"==t.display_mode?s("td",{staticClass:"column8"},[t._v(t._s(""+t.continuous_dict[e.classifier].ins_per))]):t._e()])})),0)]}}])})],1)},_r=[],xr=i["a"].extend({name:"MetricsTable",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t="normal";return{weightedPerformance:t,display_mode:"overall",pagination:{rowsPerPage:10},panel:[],sortby:[],classNumber:[...this.boxProps.classes].length}},computed:{addedThresholdClassifiers(){return"continuous"!=this.$store.state.datasetType?[]:this.$store.state.addedThresholdClassifiers.map(t=>t.name)},additionalMetrics(){return this.$store.getters.additionMetrics},thresholdClassifierNameList(){return this.$store.state.thresholdClassifierNameList},classifierBandWidthDict(){return this.boxProps.classifierBandWidthDict},classifierThresholds(){let t={};return this.thresholdClassifierNameList.forEach(e=>{let s=e.split("_")[0],i=(parseInt(e.split("_")[1])/100).toFixed(2);t[s]=i}),t},datasetType(){var t=this.$store.state.datasetType;return t},continuousClassifierName(){var t={};return this.classifiers.forEach(e=>{"continuous"==this.$store.state.datasetType?t[e]=e+"_"+this.classifierThresholdDict[e]/100:t[e]=e}),t},weighted_metrics(){const t=this.$store.getters.weighted_metrics,e=Object.entries(t).map(([t,e])=>({classifier:t,continuous_metrics:e}));return e},continuous_metrics(){const t=this.$store.getters.continuous_metrics,e=Object.entries(t).map(([t,e])=>({classifier:t,continuous_metrics:e}));return e},continuous_dict(){const t="normal"==this.weightedPerformance?this.$store.getters.continuous_metrics:this.$store.getters.weighted_metrics,e=["Majority Classifier","Oracle","Random Classifier"];this.classifierBandWidthDict;if("continuous"==this.datasetType){let s={};for(let i in t)if(!e.includes(i))if(s[i]=t[i],"uncertain"==this.display_mode){let t=s[i].tp,e=s[i].tn,a=s[i].fp,r=s[i].fn;s[i].m_accuracy=(t+e)/(t+a+e+r),s[i].m_precision=t/(t+a),s[i].m_recall=t/(t+r),s[i].m_f1=s[i].m_precision+s[i].m_recall==0?0:2*s[i].m_precision*s[i].m_recall/(s[i].m_precision+s[i].m_recall),0==Math.sqrt((t+a)*(t+r)*(e+a)*(e+r))&&(s[i].m_mcc=0),(t+a)*(t+r)*(e+a)*(e+r)!=0&&(s[i].m_mcc=(t*e-a*r)/Math.sqrt((t+a)*(t+r)*(e+a)*(e+r)))}else s[i].m_accuracy=0,s[i].m_precision=0,s[i].m_recall=0,s[i].m_f1=0,s[i].m_mcc=0;return s}return t},metrics(){const t=["Majority Classifier","Oracle","Random Classifier"],e=this.$store.getters.metrics,s=Object.entries(e).map(([t,e])=>({classifier:t,metrics:e}));let i=[];if("continuous"==this.datasetType){const e=this.$store.getters.additionMetrics,a=Object.entries(e).map(([t,e])=>({classifier:t,metrics:e}));for(let r in s)t.includes(s[r].classifier)||i.push(s[r]);for(let s in a)t.includes(a[s].classifier)||i.push(a[s]);return i}return s},classes(){return[...this.boxProps.classes]},classifiers(){return[...this.boxProps.classifiers]},headers(){const t="continuous"!=this.datasetType?[{text:"Classifier",value:"classifier"},{text:("normal"==this.weightedPerformance?"":"Weighted ")+"Accuracy",value:"accuracy"},{text:("normal"==this.weightedPerformance?"":"Weighted ")+"MCC",value:"mcc"}]:"overall"==this.display_mode?[{text:"Classifier",value:"classifier"},{text:"Threshold",value:"threshold"},{text:("normal"==this.weightedPerformance?"":"Weighted ")+"Accuracy",value:"accuracy"},{text:("normal"==this.weightedPerformance?"":"Weighted ")+"MCC",value:"mcc"}]:[{text:"Classifier",value:"classifier"},{text:"Uncertain Range",value:"uncertainty"},{text:("normal"==this.weightedPerformance?"":"Weighted ")+"Accuracy",value:"accuracy"},{text:("normal"==this.weightedPerformance?"":"Weighted ")+"MCC",value:"mcc"}];return this.classes.length<=2?(t.push({text:("normal"==this.weightedPerformance?"":"Weighted ")+"Precision",value:"precision"}),t.push({text:("normal"==this.weightedPerformance?"":"Weighted ")+"Recall",value:"recall"}),t.push({text:("normal"==this.weightedPerformance?"":"Weighted ")+"F1",value:"f1"})):(t.push({text:("normal"==this.weightedPerformance?"":"Weighted ")+"Micro-F1",value:"microf1"}),t.push({text:("normal"==this.weightedPerformance?"":"Weighted ")+"Macro-F1",value:"macrof1"})),"continuous"==this.datasetType&&("overall"==this.display_mode?t.push({text:"AUC",value:"auc_area"}):t.push({text:"Instances Percentage",value:"ins_per"})),t},instances(){return[...this.boxProps.instances]},truncatedInstances(){return this.instances.slice(0,10)}},mounted(){console.log(this.metrics),console.log(this.classes)}}),br=xr,wr=(s("d638"),Object(m["a"])(br,yr,_r,!1,null,"29ea7f8d",null)),Cr=wr.exports;v()(wr,{VDataTable:Ms["a"],VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var kr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Metrics Parallel")])],1)])],1)],1),s("div",{attrs:{id:"legend1"}},[s("v-switch",{attrs:{label:"Filter"},model:{value:t.normalization_switch,callback:function(e){t.normalization_switch=e},expression:"normalization_switch"}})],1),s("div",{ref:"svg"})],1)},Sr=[],zr=i["a"].extend({name:"MetricsParallel",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:30,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom;return{height:s,normalization:"No",margin:t,curclick:[],panel:[],rightColor:"#d1e5f0",rightHoverColor:"#4393c3",selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e,selectedEval:"",wrongColor:"#fddbc7",wrongHoverColor:"#d6604d"}},computed:{normalization_switch:{get:function(){return"Yes"===this.normalization},set:function(){"Yes"==this.normalization?this.normalization="No":this.normalization="Yes"}},classes(){return[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},features(){return[...this.boxProps.features]},instances(){return[...this.boxProps.instances]},evaluationMethods(){const t=["accuracy","mcc"];return this.classes.length>2?(t.push("microf1"),t.push("macrof1")):(t.push("precision"),t.push("recall"),t.push("f1")),t},metrics(){const t=this.$store.getters.metrics,e=Object.entries(t).map(([t,e])=>({classifier:t,metrics:e}));return e},predictions(){const t={};return this.classifiers.forEach(e=>{t[e]={right:new Set,wrong:new Set}}),this.instances.forEach(e=>{const s=Nt(e);this.classifiers.forEach(i=>{s.predictions[i]===s.actual?t[i].right.add(e):t[i].wrong.add(e)})}),t},selections(){return this.$store.state.overlapSelections},x(){const t=it["x"]().domain(this.evaluationMethods).range([0,this.width]).paddingOuter(1).paddingInner(0);return t},y(){const t=it["y"]().domain([0,1]).range([this.height,0]);return t}},watch:{instances(){this.drawInitial()},selections(){this.drawSelections()},normalization_switch(){this.drawInitial()}},mounted(){this.drawInitial()},methods:{drawInitial(){console.log("normalization_switch",this.normalization),it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+this.margin.bottom}`).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),e=(this.x,this.y,()=>{let e=this;const s=it["B"](it["q"]).domain([0,100]).interpolator((function(t){return it["q"](.8*t)}));g("#legend1",s);var i=[];const a=["Oracle","Majority Classifier","Random Classifier"];this.metrics.forEach(t=>{var e={name:t.classifier,accuracy:t.metrics.accuracy?t.metrics.accuracy:0,mcc:t.metrics.mcc.average?t.metrics.mcc.average:0};let s=1;this.classes.length>2?(e["microf1"]=t.metrics.microf1.average?t.metrics.microf1.average:0,e["macrof1"]=t.metrics.macrof1.average?t.metrics.macrof1.average:0,"Yes"==this.normalization&&(e["microf1"]<.5||e["macrof1"]<.5)&&(s=0)):(e["precision"]=t.metrics.precision.average?t.metrics.precision.average:0,e["recall"]=t.metrics.recall.average?t.metrics.recall.average:0,e["f1"]=t.metrics.f1.average?t.metrics.f1.average:0,"Yes"==this.normalization&&(e["precision"]<.5||e["recall"]<.5||e["f1"]<.5)&&(s=0)),"Yes"==this.normalization&&(e["accuracy"]<.5||e["mcc"]<0)&&(s=0),1==s&&i.push(e)});var r=(this.width-this.margin.top-this.margin.bottom)/(2*(i.length+3));t.selectAll("myRect").data(i).enter().append("rect").attr("x",10-this.margin.left).attr("y",(t,e)=>this.width/5+e*(r+2)).attr("width",this.margin.left+50).attr("height",r).attr("fill",(t,e)=>a.includes(t.name)?"lightgrey":"#69b3a2").attr("opacity","1").attr("stroke","black").attr("stroke-width",1).style("text-anchor","middle").attr("class","rect-classifier"),t.selectAll("myRectText").data(i).enter().append("text").style("text-anchor","middle").attr("x",(50-this.margin.left)/3).attr("y",(t,e)=>this.width/5+e*(r+2)+r/3*2).attr("class","text-rect-classifier").text((t,e)=>t.name).style("fill","black").style("font-size","18px").on("mouseenter",(function(t,e){it["C"](this).attr("fill","white"),p(t,e)})).on("mouseleave",(function(t,e){it["C"](this).attr("fill","black"),f(t,e)})),console.log("parallel data",i);const n=it["r"](i[0]).filter((function(t){return"name"!=t}));this.evaluationMethods;var o={};for(var l in n){var c=n[l];"Yes"==this.normalization?o[c]=it["y"]().domain(["mcc"==c?0:.5,1]).range([this.height,0]):o[c]=it["y"]().domain(["mcc"==c?-1:0,1]).range([this.height,0])}var h=it["A"]().range([0,this.width]).padding(.5).domain(n);function d(t){return it["s"]()(n.map((function(e){return[h(e),o[e](t[e])]})))}var u=[];function p(t,e){it["D"](".parallel-path").style("stroke-width",e=>t.name==e["name"]?6:3).attr("stroke-opacity",e=>t.name==e["name"]?"1":"0.2"),it["D"](".rect-classifier").attr("opacity",e=>t.name==e["name"]?"1":"0.2"),it["D"](".text-rect-classifier").attr("opacity",e=>t.name==e["name"]?"1":"0.2")}function f(t,e){it["D"](".parallel-path").style("stroke-width",3).attr("stroke-opacity","1"),it["D"](".rect-classifier").attr("opacity","1"),it["D"](".text-rect-classifier").attr("opacity","1")}function m(t,e,s){const r={top:30,right:20,bottom:90,left:120},o=1e3-r.left-r.right;r.top,r.bottom;var l=(o-r.top-r.bottom)/(2*(i.length+3));const c=it["B"](it["q"]).domain([0,s.classifiers.length-1]).interpolator((function(t){return it["q"](.8*t)})),h=it["D"](".parallel-path"),d=it["D"](".parallel-text").style("fill","grey").style(" font-weight","normal").attr("font-size",22),p=it["D"](".rect-classifier"),f=it["D"](".text-rect-classifier"),m=n[e];var g=[];u.sort((function(t,e){return e[m]-t[m]}));var v=0;while(v<3)g.push(u[v].name),v+=1;var y=u.filter(t=>a.includes(t.name));u=u.filter(t=>!a.includes(t.name)),u=u.concat(y),console.log("curdata",u,y),d.style("fill",(function(t,s){return e===s?"black":"grey"})).style("font-weight",(function(t,s){return e===s?"bold":"normal"})).attr("font-size",(function(t,s){return e===s?24:20}));var _={};for(var x in u)_[u[x]["name"]]=x;h.style("stroke",(t,e)=>a.includes(t["name"])?"grey":c(_[t["name"]])),p.data(u).attr("fill",(t,e)=>a.includes(t["name"])?"lightgrey":c(_[t["name"]])).attr("y",(t,e)=>o/5+e*(l+2)),f.data(u).style("fill",(t,e)=>a.includes(t["name"])?"black":"lightgrey").attr("x",(35-r.left)/3).text((t,e)=>t.name)}function g(t,e){var s=40,i=20,a={top:2,right:2,bottom:0,left:10},r=it["C"](t).style("height",s+"px").style("width",i+"px").style("position","relative").append("canvas").attr("height",s-a.top-a.bottom).attr("width",1).style("height",s-a.top-a.bottom+"px").style("width",i-a.left-a.right+"px").style("border","1px solid #000").style("position","absolute").style("top","120%").style("left","50%").node(),n=r.getContext("2d"),o=it["y"]().range([1,s-a.top-a.bottom]).domain(e.domain()),l=n.createImageData(1,s);it["v"](s).forEach((function(t){var s=it["w"](e(o.invert(t)));l.data[4*t]=s.r,l.data[4*t+1]=s.g,l.data[4*t+2]=s.b,l.data[4*t+3]=255})),n.putImageData(l,0,0)}i.forEach(t=>{u.push(t)}),t.selectAll("myPath").data(i).enter().append("path").attr("d",d).attr("class","parallel-path").attr("id",(t,e)=>t.name).style("fill","none").style("stroke",(t,e)=>a.includes(t.name)?"grey":"#69b3a2").style("stroke-width",3).style("opacity",1).on("mouseenter",(function(t,e){p(t,e)})).on("mouseleave",(function(t,e){f(t,e)})),t.selectAll("myAxis").data(n).enter().append("g").attr("transform",(function(t){return"translate("+h(t)+")"})).each((function(t){it["C"](this).call(it["c"](o[t]).scale(o[t]))})).append("text").attr("class","parallel-text").attr("id",(t,e)=>"parallel-text-"+e).style("text-anchor","middle").attr("y",-9).attr("font-size",22).text((function(t){return t})).style("fill","grey").on("click",(t,s)=>{this.curclick=[t,s],m(t,s,e)}),2==this.curclick.length&&m(this.curclick[0],this.curclick[1],e)});e();const s=()=>{t.append("text").attr("transform",()=>{const t=this.width/2.2,e=this.height+.8*this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Evaluation Methods")};s();this.drawSelections()},drawSelections(){}}}),$r=zr,Fr=(s("15d1"),Object(m["a"])($r,kr,Sr,!1,null,"60649a31",null)),Tr=Fr.exports;v()(Fr,{VExpansionPanel:j["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VSwitch:pe["a"]});var Er=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Uncertainty Heatmap ")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 30px"}},[s("v-radio-group",{attrs:{label:"calculation criteria"},model:{value:t.correlationMode,callback:function(e){t.correlationMode=e},expression:"correlationMode"}},[s("v-radio",{attrs:{label:"accuracy + (consider uncertainty as right)",value:"acc1"}}),s("v-radio",{attrs:{label:"accuracy (consider uncertainty as uncertain)",value:"acc2"}}),s("v-radio",{attrs:{label:"accuracy - (consider uncertainty as wrong)",value:"acc3"}}),s("v-radio",{attrs:{label:"precision - (consider uncertainty as uncertain)",value:"precision"}}),s("v-radio",{attrs:{label:"recall - (consider uncertainty as uncertain)",value:"recall"}}),s("v-radio",{attrs:{label:"f1 - (consider uncertainty as uncertain)",value:"f1"}}),s("v-radio",{attrs:{label:"mcc - (consider uncertainty as uncertain)",value:"mcc"}})],1)],1)])],1)],1),s("multiselect",{attrs:{options:t.options,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pick sets",label:"name","track-by":"name","preselect-first":!0},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.values,a=(e.search,e.isOpen);return[i.length&&!a?s("span",{staticClass:"multiselect__single"},[t._v(" "+t._s(i.length)+" options selected ")]):t._e()]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),s("div",{attrs:{id:"legend1"}}),s("div",{ref:"svg"})],1)},Ir=[],Pr=i["a"].extend({name:"UncertaintyHeatMap",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:30,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i="descending",a={type:"",classifier:""},r="All",n="acc2";return{min:0,max:100,correlationMode:n,value:[],chosenData:r,accuracySorting:i,height:s,correlation_mode:"No",hover:a,margin:t,curclick:[],panel:[],rightColor:"#d1e5f0",rightHoverColor:"#4393c3",selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e,selectedEval:"",wrongColor:"#fddbc7",wrongHoverColor:"#d6604d",correlations:[]}},computed:{selectionHistory(){return this.$store.state.selectionHistory},options(){let t=[];const e=this.classifiers;return e.forEach(e=>{t.push({name:e})}),t},classes(){return[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},uncertaintyRange(){return["0.00","0.01","0.02","0.03","0.04","0.05","0.06","0.07","0.08","0.09","0.10"]},confidenceRange(){return["0","0.05","0.1","0.15","0.2","0.25","0.3","0.35","0.4","0.45","0.5","0.55","0.6","0.65","0.7","0.75","0.8","0.85","0.9","0.95","1.0"]},classifierThresholds(){return this.$store.state.classifierThresholdDict},instances(){return[...this.boxProps.instances]},features(){const t=[...this.boxProps.features],e=["interval","ratio"],s=t=>{const s=this.$store.getters.feature(t);return e.includes(s.type)},i=t.filter(s),a=[...this.boxProps.features].filter(t=>"categorical"===this.$store.getters.feature(t).type);let r=[];return i.forEach(t=>{r.push(t)}),a.forEach(t=>{r.push(t)}),r=r.filter(t=>"train_or_test"!=t),r},InitialCorrelations(){let t=[],e=this.value.map(t=>t.name),s=e[0];return this.confidenceRange.forEach(e=>{this.confidenceRange.forEach(i=>{let a=Object.keys(this.classifierThresholds).includes(s)?this.classifierThresholds[s]/100:.5,r=parseFloat(e),n=parseFloat(i),o=s,l={c:{}};l[o]={tp:0,tn:0,fp:0,fn:0,m_tp:0,m_tn:0,m_fp:0,m_fn:0},r<=n&&(r==n&&(a=e),this.instances.forEach(t=>{let e=Nt(t).continuous_predictions[o];e>r&&e<n?Nt(t).actual==this.classes[1]?e>=a?l[o]["m_tp"]+=1:l[o]["m_fn"]+=1:e<a?l[o]["m_tn"]+=1:l[o]["m_fp"]+=1:e>=n?Nt(t).actual==this.classes[1]?l[o]["tp"]+=1:l[o]["fp"]+=1:Nt(t).actual==this.classes[0]?l[o]["tn"]+=1:l[o]["fn"]+=1}));let c=l[o].m_tp+l[o].m_tn+l[o].m_fp+l[o].m_fn,h=(l[o].tp+l[o].tn+c)/this.instances.length,d=(l[o].tp+l[o].tn+l[o].m_tp+l[o].m_tn)/this.instances.length,u=(l[o].tp+l[o].tn)/this.instances.length,p=l[o].tp+l[o].fp==0?0:l[o].tp/(l[o].tp+l[o].fp),f=l[o].tp+l[o].fn==0?0:l[o].tp/(l[o].tp+l[o].fn),m=p+f==0?0:2*p*f/(p+f),g=l[o].tp,v=l[o].fp,y=l[o].tn,_=l[o].fn,x=0;x=(g+v)*(g+_)*(y+v)*(y+_)!=0?(g*y-v*_)/Math.sqrt((g+v)*(g+_)*(y+v)*(y+_)):0,t.push({group:e,variable:i,value:100*d,acc1:100*h,acc3:100*u,precision:100*p,recall:100*f,f1:100*m,mcc:100*x,uncertainty:c/this.instances.length*100})})}),t},selections(){return this.$store.state.overlapSelections},saveStatus(){return this.$store.state.saveStatus},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("UncertaintyHeatMap"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.correlationMode=e.correlationMode}}),this.drawInitial()},saveStatus(){let t={name:"UncertaintyHeatMap",config:{classifiers:this.value.map(t=>t.name),correlationMode:this.correlationMode}};this.$store.dispatch("changedSaveConfig",t)},value(){this.value.length>1&&(this.value=[this.value[this.value.length-1]]),this.updateCorrelations(),this.drawCorrelation()},instances(){this.updateCorrelations(),this.drawCorrelation()},correlationMode(){this.drawCorrelation()}},mounted(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("UncertaintyHeatMap"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.correlationMode=e.correlationMode}}),this.drawInitial()},methods:{updateCorrelations(){let t=[],e=this.value.map(t=>t.name),s=e[0];this.confidenceRange.forEach(e=>{this.confidenceRange.forEach(i=>{let a=Object.keys(this.classifierThresholds).includes(s)?this.classifierThresholds[s]/100:.5,r=parseFloat(e),n=parseFloat(i),o=s,l={c:{}};l[o]={tp:0,tn:0,fp:0,fn:0,m_tp:0,m_tn:0,m_fp:0,m_fn:0},r<=n&&this.instances.forEach(t=>{let e=Nt(t).continuous_predictions[o];Nt(t).actual,Nt(t).predictions[o];e>r&&e<n?Nt(t).actual==this.classes[1]?e>=a?l[o]["m_tp"]+=1:l[o]["m_fn"]+=1:e<a?l[o]["m_tn"]+=1:l[o]["m_fp"]+=1:e>=n?Nt(t).actual==this.classes[1]?l[o]["tp"]+=1:l[o]["fp"]+=1:Nt(t).actual==this.classes[0]?l[o]["tn"]+=1:l[o]["fn"]+=1});let c=l[o].m_tp+l[o].m_tn+l[o].m_fp+l[o].m_fn,h=(l[o].tp+l[o].tn+c)/this.instances.length,d=c==this.instances.length?0:(l[o].tp+l[o].tn)/(this.instances.length-c),u=(l[o].tp+l[o].tn)/this.instances.length,p=l[o].tp+l[o].fp==0?0:l[o].tp/(l[o].tp+l[o].fp),f=l[o].tp+l[o].fn==0?0:l[o].tp/(l[o].tp+l[o].fn),m=p+f==0?0:2*p*f/(p+f),g=l[o].tp,v=l[o].fp,y=l[o].tn,_=l[o].fn,x=0;x=(g+v)*(g+_)*(y+v)*(y+_)!=0?(g*y-v*_)/Math.sqrt((g+v)*(g+_)*(y+v)*(y+_)):0,t.push({group:e,variable:i,value:100*d,acc1:100*h,acc3:100*u,precision:100*p,recall:100*f,f1:100*m,mcc:100*x,uncertainty:c/this.instances.length*100})})}),this.correlations=t},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+this.margin.bottom+this.margin.left}`),e=t.append("g").attr("class","svg-button").attr("transform",`translate(0, ${this.margin.top})`),s=(t.append("g").attr("class","svg-correlations").attr("transform",`translate(0, ${1.2*this.margin.top+this.margin.left})`),()=>{t.append("text").attr("transform",()=>{const t=.5*this.width,e=this.height+2.5*this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Lowerbound Threshold"),t.append("text").attr("transform",()=>{const t=this.margin.left/4,e=.6*this.height;return`translate(${t}, ${e}),rotate(-90)`}).style("text-anchor","middle").style("font-size","24px").text("Upperbound threshold"),t.append("text").attr("class","view-title").attr("transform",()=>{const t=.5*this.width,e=2*this.margin.top;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","30px").text("acc2"==this.correlationMode?"Accuracy":"acc1"==this.correlationMode?"Accuracy +":"acc3"==this.correlationMode?"Accuracy -":"precision"==this.correlationMode?"Precision":"recall"==this.correlationMode?"Recall":"f1"==this.correlationMode?"F1":"mcc"==this.correlationMode?"MCC":"Uncertainty")});let i=10,a=.5,r="#CCC",n=it["n"],o=n(0),l=it["p"](r,o);function c(t){return t<=a?l(t/a):n((t-a)/(1-a))}for(let d=0;d<i+1;d++){let t=d/i,s=it["n"],n=s(0),o=it["p"](r,n);function c(t){return t<=a?o(t/a):s((t-a)/(1-a))}e.append("rect").attr("x",20*d).attr("y",0).attr("width",20).attr("height",10).style("fill",c(t))}const h=()=>{e.append("circle").attr("r",12).attr("cx",12).attr("cy",36).attr("fill","purple"),e.append("text").attr("x",30).attr("y",42).text("# non-rejected").attr("font-size",18)};s(),h(),this.drawCorrelation()},drawCorrelation(){0==this.correlations.length&&(this.correlations=this.InitialCorrelations);const t=it["C"](this.$refs.svg),e=t.select(".svg-correlations"),s=(t.select(".svg-button"),this.correlationMode,t.select(".view-title"));s.text("acc2"==this.correlationMode?"Accuracy":"acc1"==this.correlationMode?"Accuracy +":"acc3"==this.correlationMode?"Accuracy -":"precision"==this.correlationMode?"Precision":"recall"==this.correlationMode?"Recall":"f1"==this.correlationMode?"F1":"mcc"==this.correlationMode?"MCC":"Uncertainty"),e.selectAll("*").remove();const i=()=>{var t=[],i=[];this.correlations.forEach(e=>{t.includes(e.group)||t.push(e.group),i.includes(e.variable)||i.push(e.variable)});var a=it["x"]().range([0,this.width]).domain(t).padding(.01);const r=t=>t.attr("transform",`translate(${this.margin.left}, ${this.height})`).call(it["b"](a).tickSizeOuter(0));e.append("g").call(r).attr("font-size",20).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start");var n=it["x"]().range([this.height,0]).domain(i).padding(.01);const o=t=>t.attr("transform",`translate(${this.margin.left}, 0)`).call(it["c"](n).tickSizeOuter(0));e.append("g").call(o).attr("font-size",20).selectAll("text").attr("text-anchor","end");var l=this.correlations,c=e.append("rect").attr("width",this.width).attr("height",this.margin.left/4*5-10).attr("x",this.margin.left).attr("y",-this.margin.left-20).attr("rx",5).attr("fill","white").attr("stroke","grey").attr("stroke-width",2).style("opacity",0),h=e.append("text").attr("x",this.margin.left+2).attr("y",(-this.margin.left-60)/2).attr("dy","-0.5em").attr("font-size",32),d=e.append("text").attr("x",this.margin.left+2).attr("y",(-this.margin.left-60)/2).attr("dy","0.5em").attr("font-size",32),u=e.append("text").attr("x",this.margin.left+2).attr("y",(-this.margin.left-60)/2).attr("dy","1.5em").attr("font-size",32),p=e.append("text").attr("x",this.margin.left+2).attr("y",(-this.margin.left-60)/2).attr("dy","2.5em").attr("font-size",32),f=function(t){c.style("opacity",1)},m=function(t){s.attr("visibility","hidden"),h.style("opacity",1),d.style("opacity",1),u.style("opacity",1),p.style("opacity",1),h.text("Uncertain Range: "+t.group+" - "+t.variable),d.text("accuracy+ :"+parseFloat(t.acc1).toFixed(3)+"    accuracy :"+parseFloat(t.value).toFixed(3)+"    accuracy- :"+parseFloat(t.acc3).toFixed(3)),u.text("precision :"+parseFloat(t.precision).toFixed(3)+"    recall   :"+parseFloat(t.recall).toFixed(3)+"    f1 :"+parseFloat(t.f1).toFixed(3)),p.text("mcc :"+parseFloat(t.mcc).toFixed(3)+"    uncertain :"+parseFloat(t.uncertainty).toFixed(3))},g=function(t){c.style("opacity",0),h.style("opacity",0),d.style("opacity",0),u.style("opacity",0),p.style("opacity",0),s.attr("visibility","visible")};let v=.5,y="#CCC",_=it["n"],x=_(0),b=it["p"](y,x);function w(t){return t<=v?b(t/v):_((t-v)/(1-v))}e.selectAll().data(l,(function(t){return t["group"]+":"+t["variable"]})).enter().append("circle").attr("cx",(function(t){return n.bandwidth()/1.5+a(t["group"])})).attr("cy",(function(t){return n.bandwidth()/3+n(t["variable"])})).attr("r",t=>(100-parseFloat(t["uncertainty"]))/100*n.bandwidth()/2).attr("transform","translate("+this.margin.left+",0)").style("fill",t=>parseFloat(t["value"])>=0?"acc2"==this.correlationMode?w(parseFloat(t["value"])/100):"acc1"==this.correlationMode?w(parseFloat(t["acc1"])/100):"acc3"==this.correlationMode?w(parseFloat(t["acc3"])/100):"precision"==this.correlationMode?w(parseFloat(t["precision"])/100):"recall"==this.correlationMode?w(parseFloat(t["recall"])/100):"f1"==this.correlationMode?w(parseFloat(t["f1"])/100):"mcc"==this.correlationMode?w(Math.abs(parseFloat(t["mcc"]))/100):w(parseFloat(t["uncertainty"])/100):w(100*-parseFloat(t["value"]))).attr("visibility",t=>t["group"]>t["variable"]?"hidden":"visible").on("mouseover",f).on("mousemove",m).on("mouseleave",g)};i()}}}),Dr=Pr,Or=(s("4d02"),Object(m["a"])(Dr,Er,Ir,!1,null,"15b659f7",null)),Ar=Or.exports;v()(Or,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var Br=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("InstanceList")])],1)]),s("v-expansion-panel-content",[s("v-switch",{staticClass:"mx-2",attrs:{label:"predictions"},model:{value:t.show_predictions,callback:function(e){t.show_predictions=e},expression:"show_predictions"}}),s("v-switch",{staticClass:"mx-2",attrs:{label:"features"},model:{value:t.show_features,callback:function(e){t.show_features=e},expression:"show_features"}}),s("v-slider",{attrs:{min:"1",max:"100",label:"string length","thumb-label":""},model:{value:t.string_length,callback:function(e){t.string_length=e},expression:"string_length"}}),s("v-radio-group",{attrs:{label:"sort by selection"},model:{value:t.sortBySel,callback:function(e){t.sortBySel=e},expression:"sortBySel"}},[s("v-radio",{key:"none",attrs:{label:"none",value:""}}),s("v-radio",{key:"first",attrs:{label:"first",value:"first"}}),s("v-radio",{key:"second",attrs:{label:"second",value:"second"}}),s("v-radio",{key:"common",attrs:{label:"common",value:"common"}})],1)],1)],1)],1),s("v-data-table",{staticClass:"elevation-1",attrs:{dense:"",headers:t.headers,items:t.instances,"sort-by":t.sortby,"sort-desc":t.descending},on:{"update:sortBy":function(e){t.sortby=e},"update:sort-by":function(e){t.sortby=e},"update:sortDesc":function(e){t.descending=e},"update:sort-desc":function(e){t.descending=e}},scopedSlots:t._u([{key:"body",fn:function(e){var i=e.items;return[s("tbody",t._l(i,(function(e){return s("tr",{key:e.id,class:{"hover-instance":e===t.$store.state.hoverInstance},style:t.styleTableRow(e),on:{mouseenter:function(s){return t.changedHoverInstance(e.id)},mouseleave:t.clearHoverInstance,click:function(s){return s.stopPropagation(),s.preventDefault(),t.click(e)},contextmenu:function(s){return s.stopPropagation(),s.preventDefault(),t.select(e.id,"second")}}},[s("td",{staticClass:"unselectable"},[t._v(t._s(e.id))]),s("td",{staticClass:"unselectable"},[t._v(t._s(e.actual))]),t._l(t.continuousClassifierList,(function(i){return s("td",{key:e.id+i+"-"+e.continuous_predictions[i],staticClass:"unselectable"},[t._v(" "+t._s(e.continuous_predictions[i])+" ")])})),t._l(t.classifiers,(function(i){return s("td",{key:e.id+i+"-"+e.predictions[i],staticClass:"unselectable"},[t._v(" "+t._s(e.predictions[i])+" ")])})),t._l(t.features,(function(i){return s("td",{key:e.id+i+"-"+e.actual,staticClass:"unselectable",attrs:{title:e.features[i]}},[t._v(" "+t._s(t.shorten(e.features[i]))+" ")])}))],2)})),0)]}}])})],1)},Mr=[],Rr=i["a"].extend({name:"InstanceList",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){return{panel:[],sortby:[],sortBySel:"",descending:!1,show_predictions:!0,show_features:!0,string_length:7,clickCount:0,clickTimer:0}},computed:{continuousClassifierList:function(){return"continuous"==this.datasetType?this.classifiers:[]},datasetType(){var t=this.$store.state.datasetType;return t},classifiers(){const t=["Oracle","Majority Classifier","Random Classifier"];if(this.show_predictions){const e=[...this.$store.getters.filteredClassifiers];return"continuous"==this.$store.state.datasetType?e.filter(e=>!t.includes(e)):e}return[]},features(){if(this.show_features){const t=[...this.$store.getters.features];return t}return[]},headers(){const t=[{text:"Id",value:"id"},{text:"Actual class",value:"actualClass"}];return this.show_predictions&&"continuous"==this.$store.state.datasetType&&this.classifiers.forEach(e=>{t.push({text:e.replace(/_/g," ")+"_value",value:e})}),this.show_predictions&&this.classifiers.forEach(e=>{t.push({text:e.replace(/_/g," "),value:e})}),this.show_features&&this.$store.getters.features.forEach(e=>{t.push({text:e,value:e})}),t},instances(){const t=[];this.$store.getters.filteredInstances.forEach(e=>{const s=Nt(e),i=Object.assign({id:e},s);t.push(i)});const{first:e,second:s}=this.selections,i={first:(t,s)=>{let i=0,a=0;return e&&e.instances.has(t.id)&&i++,e&&e.instances.has(s.id)&&a++,a-i},second:(t,e)=>{let i=0,a=0;return s&&s.instances.has(t.id)&&i++,s&&s.instances.has(e.id)&&a++,a-i},common:(t,i)=>{let a=0,r=0;return e&&e.instances.has(t.id)&&a++,e&&e.instances.has(i.id)&&r++,s&&s.instances.has(t.id)&&a++,s&&s.instances.has(i.id)&&r++,r-a}};let a=this.sortby[0],r=t[0].predictions.hasOwnProperty(a)?"predictions":"features";return this.sortby.length>0&&t.sort((t,e)=>{let s=(""+t[r][a]).localeCompare(e[r][a]);return this.descending?-s:s}),this.sortBySel&&t.sort(i[this.sortBySel]),t},selections(){return this.$store.state.overlapSelections}},watch:{sortby(){console.log("sortby ",this.sortby)},descending(){console.log("descending",this.descending)},selections(){const{first:t,second:e}=this.selections;this.sortBy=t&&e?"common":t?"first":e?"second":""}},methods:Object.assign(Object.assign({},Object(d["b"])(["changedHoverInstance","clearHoverInstance"])),{shorten(t){let e=""+t;return e.length>this.string_length?e.substring(0,this.string_length)+"...":e},select(t,e){const s=new Set([t]),i="Instance #"+t;this.$store.dispatch("prependToSelectionHistory",{instances:s,description:i}),this.$store.dispatch("changedMostRecentSelection",e)},click(t){this.clickCount+=1,1===this.clickCount&&(this.clickTimer=setTimeout((function(e){e.clickCount=0,e.select(t.id,"first")}),300,this)),2===this.clickCount&&(clearTimeout(this.clickTimer),this.clickCount=0,this.setFocus(t.id))},setFocus(t){this.$store.dispatch("setFocusItem",t)},styleTableRow(t){const{first:e,second:s}=Ot.overlapSelections,i=Ot.focus,{first:a,second:r}=this.selections,n=a&&a.instances.has(t.id),o=r&&r.instances.has(t.id),l=this.$store.state.focusItemId===t.id;return l?`\n          background-color: ${i};\n        `:n&&o?`\n          background: -webkit-linear-gradient(top, ${e}, ${s});\n          color: white;\n        `:n?`\n          background-color: ${e};\n        `:o?`\n          background-color: ${s};\n          color: white;\n        `:""}})}),Hr=Rr,Vr=(s("29e8"),Object(m["a"])(Hr,Br,Mr,!1,null,"3297c99c",null)),jr=Vr.exports;v()(Vr,{VDataTable:Ms["a"],VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"],VSlider:Pi["a"],VSwitch:pe["a"]});var Kr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Histogram ("+t._s(t.chosenFeature)+")")])],1)]),s("v-expansion-panel-content",[s("div",{staticStyle:{margin:"0px 0px","font-size":"14px",stroke:"'black'","stroke-width":"2px"}},[s("v-select",{attrs:{items:t.pureCategoricalFeatures,label:"Categorical"},model:{value:t.chosenFeature,callback:function(e){t.chosenFeature=e},expression:"chosenFeature"}})],1),s("div",{staticStyle:{margin:"0px 0px","font-size":"14px",stroke:"'black'","stroke-width":"2px"}},[s("v-select",{attrs:{items:t.numericFeatures,label:"Numeric"},model:{value:t.chosenFeature,callback:function(e){t.chosenFeature=e},expression:"chosenFeature"}}),s("v-slider",{staticClass:"numberOfBins",attrs:{max:t.binLimits.max,min:t.binLimits.min,label:"Preferred number of bins: "+t.numberOfBins},model:{value:t.numberOfBins,callback:function(e){t.numberOfBins=e},expression:"numberOfBins"}}),s("div",{staticStyle:{margin:"0px 0px","font-size":"14px",stroke:"'black'","stroke-width":"2px"}},[s("v-select",{attrs:{items:t.classifiers,label:"ClassifierPredictions"},model:{value:t.chosenFeature,callback:function(e){t.chosenFeature=e},expression:"chosenFeature"}})],1)],1),s("v-radio-group",{model:{value:t.chosenFeature,callback:function(e){t.chosenFeature=e},expression:"chosenFeature"}},[s("v-radio",{attrs:{label:"ClassDistribution",value:"ClassDistribution"}})],1)],1)],1)],1),s("v-switch",{staticClass:"ml-8",attrs:{label:"normalize"},model:{value:t.normalization_switch,callback:function(e){t.normalization_switch=e},expression:"normalization_switch"}}),s("div",{ref:"svg"})],1)},Nr=[],Lr=(i["a"],i["a"].extend({name:"Histogram",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:100,right:70,bottom:70,left:150},e=1e3-t.left-t.right,s=500-t.top-t.bottom,i={type:null,count:-1},a="",r={className:""},n="";return{svg:"",numberOfBins:10,binLimits:{max:30,min:1},chosenFeature:"ClassDistribution",selected1:"",selected2:"",categoryFeatures:[],sorting:n,height:s,hoverCategory:a,normalization:"No",hover:i,hoverActual:r,width:e,margin:t,panel:[],panel2:[],panel3:[],panel4:[],selection1Color:"#18FFFF",selection2Color:"#FF4081",categoricalFeaturesNum:0,numericFeaturesNum:0}},computed:{normalization_switch:{set(){"Yes"==this.normalization?this.normalization="No":this.normalization="Yes"},get(){return"Yes"===this.normalization}},normalizationMode(){var t="";switch(this.normalization){case"Yes":t="Yes";break;case"No":t="No";break}return t},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},instances(){return[...this.boxProps.instances]},bins(){const t=it["k"]().domain(this.x.domain()).thresholds(this.numberOfBins).value(t=>{const e=Nt(t),s=e.features[this.chosenFeature];return s})(this.instances);return t},binMax(){const t=this.bins.map(t=>t.length),e=Math.max(...t);return e},features(){return[...this.boxProps.features]},featureValues(){const t=this.$store.getters.filteredInstances,e=t=>this.$store.getters.instance(t),s=[...t].map(t=>e(t).features[this.chosenFeature]);return s},numericFeatures(){const t=[...this.boxProps.features],e=["interval","ratio"],s=t=>{const s=this.$store.getters.feature(t);return e.includes(s.type)};this.numericFeaturesNum=t.filter(s).length;let i=t.filter(s),a=[];for(var r in i){let t={text:i[r],value:i[r]};a.push(t)}return a},pureCategoricalFeatures(){const t=[...this.boxProps.features].filter(t=>"categorical"===this.$store.getters.feature(t).type);return t},categoricalFeatures(){let t=[...this.boxProps.features].filter(t=>"categorical"===this.$store.getters.feature(t).type);for(var e in this.categoricalFeaturesNum=t.length,t)this.categoryFeatures.push(t[e]);for(var e in this.classifiers)t.push(this.classifiers[e]);return t},categories(){if(this.chosenFeature&&this.categoricalFeatures.includes(this.chosenFeature)){var t=[],e=[];if(this.classifiers.includes(this.chosenFeature)){this.classes.forEach(s=>{e.push(s),t.push(s)});const s={};switch(this.classes.forEach(t=>{s[t]=new Set}),this.instances.forEach(t=>{const e=Nt(t).predictions[this.chosenFeature];s[e].add(t)}),this.sorting){case"":return e;case"ascending":t.sort((function(t,e){return it["a"](s[t].size,s[e].size)}));break;case"descending":t.sort((function(t,e){return s[e].size-s[t].size}));break}return t}{this.$store.getters.feature(this.chosenFeature).categories.forEach(s=>{e.push(s),t.push(s)});const s={};switch(t.forEach(t=>{s[t]=new Set}),this.instances.forEach(t=>{const e=Nt(t).features[this.chosenFeature];s[e].add(t)}),this.sorting){case"":return e;case"ascending":t.sort((function(t,e){return it["a"](s[t].size,s[e].size)}));break;case"descending":t.sort((function(t,e){return s[e].size-s[t].size}));break}return t}}return[]},maxByCategory(){let t=0;return this.classifiers.includes(this.chosenFeature),this.categories.forEach(e=>{t=Math.max(t,this.bucketedInstances[e].size)}),t},bucketKeys(){const t=(t,e)=>this.buckets[t].size-this.buckets[e].size,e=(e,s)=>-t(e,s),s=this.classes;switch(this.sorting){case"ascending":s.sort(t);break;case"descending":s.sort(e);break}return s},buckets(){const t={};return this.classes.forEach(e=>{t[e]=new Set}),this.instances.forEach(e=>{const s=Nt(e);t[s.actual].add(e)}),t},bucketedInstances(){if(!this.chosenFeature||!this.categoricalFeatures.includes(this.chosenFeature))return console.log("empty bucketedInstances"),{};const t={};return this.classifiers.includes(this.chosenFeature)?(this.categories.forEach(e=>{t[e]=new Set}),this.instances.forEach(e=>{const s=Nt(e).predictions[this.chosenFeature];void 0===t[s]&&console.log("undefined category",s),t[s].add(e)}),console.log("bucketedInstances",t)):(this.categories.forEach(e=>{t[e]=new Set}),this.instances.forEach(e=>{const s=Nt(e).features[this.chosenFeature];void 0===t[s]&&console.log("undefined category",s),t[s].add(e)}),console.log("not empty bucketedInstances",t)),t},classes(){return[...this.boxProps.classes]},focusItemId(){return this.$store.state.focusItemId},focusDotEmphasis(){return this.$store.state.focusDotEmphasis},selections(){return this.$store.state.overlapSelections},showActualClassDistribution(){var t="No";switch(this.chosenFeature){case"ClassDistribution":t="Yes";break}return t},x(){const t=Math.min(...this.featureValues),e=Math.max(...this.featureValues),s=it["y"]().domain([t,e]).range([0,this.width]);return s},y(){const t=this.binMax,e=it["y"]().domain([0,"Yes"==this.normalizationMode?1:1.1*t]).range([this.height,0]);return e},xCate(){const t=it["x"]().domain(this.categories).range([0,this.width]).paddingOuter(.2).paddingInner(.3);return t},yCate(){const t=this.maxByCategory,e=it["y"]().domain([0,"Yes"==this.normalizationMode?1:1.1*t]).range([this.height,0]);return e},xClass(){const t=it["x"]().domain(this.bucketKeys).range([0,this.width]).paddingOuter(1).paddingInner(.3);return t},yClass(){const t=Object.values(this.buckets).map(t=>t.size),e=Math.max(...t)/this.instances.length,s=it["y"]().domain([0,"Yes"==this.normalizationMode?1:1.1*e]).range([this.height,0]);return s},saveStatus(){return this.$store.state.saveStatus},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Histogram"==t.name&&t.config.length>0){let e=t.config[0];(this.pureCategoricalFeatures.includes(e)||this.numericFeatures.includes(e)||this.classifiers.includes(e))&&(this.chosenFeature=t.config[0])}}),this.drawInitial()},saveStatus(){let t={name:"Histogram",config:[this.chosenFeature]};this.$store.dispatch("changedSaveConfig",t)},chosenFeature(){this.drawInitial()},sorting(){this.drawInitial()},featureValues(){this.drawInitial()},hover(){this.drawHover()},hoverActual(){this.drawHover()},hoverCategory(){this.drawHover()},instances(){this.drawInitial()},numberOfBins(){this.drawInitial()},selections(){this.drawInitial()},focusItemId(){this.drawInitial()},focusDotEmphasis(){this.drawInitial()},normalization(){this.drawInitial()}},mounted(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Histogram"==t.name&&t.config.length>0){let e=t.config[0];(this.pureCategoricalFeatures.includes(e)||this.numericFeatures.includes(e)||this.classifiers.includes(e))&&(this.chosenFeature=t.config[0])}}),this.drawInitial()},methods:{clearHover(){this.hoverActual={className:""}},drawHover(){const t=it["C"](this.$refs.svg),e=t.selectAll(".bar"),s=t.selectAll(".bar"),i=t.selectAll(".bar"),a=t.selectAll(".bar-circle"),r=t.selectAll(".bar-circle"),n=t.selectAll(".text-selection-1"),o=t.selectAll(".text-selection-2"),l=t.selectAll(".selection-rect"),c=t.selectAll(".selection-rect"),h=t.selectAll(".selection-rect"),d=t.select(".y-axis-marker-line"),u=t.select(".y-axis-marker-text");var p=it["j"](".0f");"Yes"==this.normalizationMode&&(p=it["j"](".3f"));const{first:f,second:m}=this.$store.state.overlapSelections,g=(t,e)=>{const s=Lt(t,e);return this.categoricalFeatures.includes(this.chosenFeature),"Yes"==this.normalizationMode?s.size/t.size:s.size},v=this.hover,y=this.hoverCategory;"Yes"==this.showActualClassDistribution?this.hoverActual.className?(i.data(this.bucketKeys).attr("fill",t=>t===this.hoverActual.className?"black":"lightgray"),h.data(this.bucketKeys).attr("visibility",t=>t===this.hoverActual.className?"visible":"hidden"),f?n.data(this.bucketKeys).attr("transform","Yes"!=this.normalizationMode?`translate(\n                      ${this.xClass(this.hoverActual.className)},\n                      ${this.yClass(this.buckets[this.hoverActual.className].size/this.instances.length)-45})`:0==this.buckets[this.hoverActual.className].size?`translate(\n                      ${this.xClass(this.hoverActual.className)},\n                      ${this.yClass(0)-45})`:`translate(\n                      ${this.xClass(this.hoverActual.className)},\n                      ${this.yClass(1)-45})`).style("text-anchor","middle").attr("visibility",t=>(this.hoverActual.className,"visible")).text(t=>"1st: "+p(g(this.buckets[this.hoverActual.className],f.instances))):n.data(this.bucketKeys).attr("visibility","hidden"),m?o.data(this.bucketKeys).attr("transform","Yes"!=this.normalizationMode?`translate(\n                      ${this.xClass(this.hoverActual.className)},\n                      ${this.yClass(this.buckets[this.hoverActual.className].size/this.instances.length)-20})`:0==this.buckets[this.hoverActual.className].size?`translate(\n                      ${this.xClass(this.hoverActual.className)},\n                      ${this.yClass(0)-20})`:`translate(\n                      ${this.xClass(this.hoverActual.className)},\n                      ${this.yClass(1)-20})`).style("text-anchor","middle").attr("visibility",t=>(this.hoverActual.className,"visible")).text(t=>"2rd: "+p(g(this.buckets[this.hoverActual.className],m.instances))):o.data(this.bucketKeys).attr("visibility","hidden"),d.attr("stroke-opacity",1).attr("y1","Yes"!=this.normalizationMode?this.yClass(this.buckets[this.hoverActual.className].size/this.instances.length):0==this.buckets[this.hoverActual.className].size?this.yClass(0):this.yClass(1)).attr("x2",this.width).attr("y2","Yes"!=this.normalizationMode?this.yClass(this.buckets[this.hoverActual.className].size/this.instances.length):0==this.buckets[this.hoverActual.className].size?this.yClass(0):this.yClass(1)),u.attr("fill-opacity",1).attr("transform","Yes"!=this.normalizationMode?`translate(\n                      ${this.xClass(this.hoverActual.className)},\n                      ${this.yClass(this.buckets[this.hoverActual.className].size/this.instances.length)-70})`:0==this.buckets[this.hoverActual.className].size?`translate(\n                      ${this.xClass(this.hoverActual.className)},\n                      ${this.yClass(0)-70})`:`translate(\n                      ${this.xClass(this.hoverActual.className)},\n                      ${this.yClass(1)-70})`).text("Percentage: "+(this.buckets[this.hoverActual.className].size/this.instances.length*100).toFixed(1)+"%")):(i.attr("fill","lightgray"),d.attr("stroke-opacity",0),u.attr("fill-opacity",0),h.attr("visibility","hidden"),n.attr("visibility","hidden"),o.attr("visibility","hidden")):this.categoricalFeatures.includes(this.chosenFeature)?y.toString().length?(s.data(this.categories).attr("fill",t=>t===y?"black":"lightgray"),r.data(this.categories).attr("fill",t=>t===y?"black":"lightgray"),f?n.data(this.categories).attr("transform","Yes"!=this.normalizationMode?`translate(\n                  ${this.xCate.paddingOuter()+this.xCate(y)},\n                  ${this.yCate(this.bucketedInstances[y].size)-45})`:0==this.bucketedInstances[y].size?`translate(\n                  ${this.xCate.paddingOuter()+this.xCate(y)},\n                  ${this.yCate(0)-45})`:`translate(\n                  ${this.xCate.paddingOuter()+this.xCate(y)},\n                  ${this.yCate(1)-45})`).style("text-anchor","middle").attr("visibility",t=>"visible").text(t=>"1st: "+p(g(this.bucketedInstances[y],f.instances))):n.data(this.categories).attr("visibility","hidden"),m?o.data(this.categories).attr("transform","Yes"!=this.normalizationMode?`translate(\n                  ${this.xCate.paddingOuter()+this.xCate(y)},\n                  ${this.yCate(this.bucketedInstances[y].size)-20})`:0==this.bucketedInstances[y].size?`translate(\n                  ${this.xCate.paddingOuter()+this.xCate(y)},\n                  ${this.yCate(0)-20})`:`translate(\n                  ${this.xCate.paddingOuter()+this.xCate(y)},\n                  ${this.yCate(1)-20})`).style("text-anchor","middle").attr("visibility",t=>"visible").text(t=>"2rd: "+p(g(this.bucketedInstances[y],m.instances))):o.data(this.categories).attr("visibility","hidden"),c.data(this.categories).attr("visibility",t=>t===y?"visible":"hidden"),d.attr("stroke-opacity",1).attr("y1","Yes"!=this.normalizationMode?this.yCate(this.bucketedInstances[y].size):0==this.bucketedInstances[y].size?this.yCate(0):this.yCate(1)).attr("x2",this.width).attr("y2","Yes"!=this.normalizationMode?this.yCate(this.bucketedInstances[y].size):0==this.bucketedInstances[y].size?this.yCate(0):this.yCate(1)),u.attr("transform","Yes"!=this.normalizationMode?`translate(\n                  ${this.xCate.paddingOuter()+this.xCate(y)},\n                  ${this.yCate(this.bucketedInstances[y].size)-70})`:0==this.bucketedInstances[y].size?`translate(\n                  ${this.xCate.paddingOuter()+this.xCate(y)},\n                  ${this.yCate(0)-70})`:`translate(\n                  ${this.xCate.paddingOuter()+this.xCate(y)},\n                  ${this.yCate(1)-70})`).text("Yes"!=this.normalizationMode?"Total: "+this.bucketedInstances[y].size:0==this.bucketedInstances[y].size?"Total: 0":"Total: 1")):(s.attr("fill","lightgray"),r.attr("fill","lightgray"),d.attr("stroke-opacity",0),u.text(""),c.attr("visibility","hidden"),n.attr("visibility","hidden"),o.attr("visibility","hidden")):v?(e.data(this.bins).attr("fill",t=>t.x0===v.x0?"black":"lightgray"),a.data(this.bins).attr("fill",t=>t.x0===v.x0?"black":"lightgray"),f?n.data(this.bins).attr("transform","Yes"!=this.normalizationMode?`translate(\n                  ${(this.x(v.x0)+this.x(v.x1))/2-.5*(this.x(v.x1)-this.x(v.x0))-50},\n                  ${this.y(v.length)-45})`:0==v.length?`translate(\n                  ${(this.x(v.x0)+this.x(v.x1))/2-.5*(this.x(v.x1)-this.x(v.x0))-50},\n                  ${this.y(0)-45})`:`translate(\n                  ${(this.x(v.x0)+this.x(v.x1))/2-.5*(this.x(v.x1)-this.x(v.x0))-50},\n                  ${this.y(1)-45})`).style("text-anchor","middle").attr("visibility",t=>(t.x0,v.x0,"visible")).text(t=>"1st: "+p(g(new Set(t),f.instances))):n.data(this.bins).attr("visibility","hidden"),m?o.data(this.bins).attr("transform","Yes"!=this.normalizationMode?`translate(\n                  ${(this.x(v.x0)+this.x(v.x1))/2-.5*(this.x(v.x1)-this.x(v.x0))-50},\n                  ${this.y(v.length)-20})`:0==v.length?`translate(\n                  ${(this.x(v.x0)+this.x(v.x1))/2-.5*(this.x(v.x1)-this.x(v.x0))-50},\n                  ${this.y(0)-20})`:`translate(\n                  ${(this.x(v.x0)+this.x(v.x1))/2-.5*(this.x(v.x1)-this.x(v.x0))-50},\n                  ${this.y(1)-20})`).style("text-anchor","middle").attr("visibility",t=>(t.x0,v.x0,"visible")).text(t=>"2rd: "+p(g(new Set(t),m.instances))):o.data(this.bins).attr("visibility","hidden"),l.data(this.bins).attr("visibility",t=>t.x0===v.x0?"visible":"hidden"),d.attr("stroke-opacity",1).attr("y1","Yes"!=this.normalizationMode?this.y(v.length):0==v.length?this.y(0):this.y(1)).attr("x2",this.width).attr("y2","Yes"!=this.normalizationMode?this.y(v.length):0==v.length?this.y(0):this.y(1)),u.attr("transform","Yes"!=this.normalizationMode?`translate(\n                  ${(this.x(v.x0)+this.x(v.x1))/2-.5*(this.x(v.x1)-this.x(v.x0))-50},\n                  ${this.y(v.length)-70})`:0==v.length?`translate(\n                  ${(this.x(v.x0)+this.x(v.x1))/2-.5*(this.x(v.x1)-this.x(v.x0))-50},\n                  ${this.y(0)-70})`:`translate(\n                  ${(this.x(v.x0)+this.x(v.x1))/2-.5*(this.x(v.x1)-this.x(v.x0))-50},\n                  ${this.y(1)-70})`).text("Yes"!=this.normalizationMode?"Total: "+v.length:0==v.length?"Total: 0":"Total: 1")):(e.attr("fill","lightgray"),a.attr("fill","lightgray"),d.attr("stroke-opacity",0),u.text(""),l.attr("visibility","hidden"),n.attr("visibility","hidden"),o.attr("visibility","hidden"))},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+this.margin.bottom}`).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),e=this.xClass,s=this.yClass;this.svg=t;const i=()=>{const i=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](this.x).tickSizeOuter(0)),a=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](this.xCate).tickSizeOuter(0)),r=t=>t.call(it["c"](this.y)),n=t=>t.call(it["c"](this.yCate)),o=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](e).tickSizeOuter(0)),l=t=>t.call(it["c"](s).ticks(5).tickFormat(it["j"](".0%")));"Yes"==this.showActualClassDistribution?(t.append("g").call(o).attr("font-size",20),t.append("g").call(l).attr("font-size",20)):this.categoricalFeatures.includes(this.chosenFeature)?(t.append("g").call(a).selectAll("text").attr("transform","rotate(45)").attr("text-anchor","start"),t.append("g").call(n)):(t.append("g").call(i),t.append("g").call(r)),t.selectAll("g.tick").style("font-size","16px")};i();const a=()=>{t.append("text").attr("transform",()=>{const t=this.width/2,e=this.height+.8*this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","20px").text(this.chosenFeature),t.append("text").attr("transform","rotate(-90)").attr("x",-this.height/2).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","20px").text("Yes"==this.normalizationMode||"Yes"==this.showActualClassDistribution?"Percentage of Instances":"Number of instances");var e="Yes"==this.normalizationMode?`Percentage of Instances (${this.chosenFeature})`:`Number of Instances (${this.chosenFeature}):`;"Yes"==this.showActualClassDistribution&&(this.normalizationMode,e="Percentage of Instances per Class"),t.append("text").attr("transform",`translate(\n              ${-this.margin.left/2+this.width/2},\n              ${2*-this.margin.top/3}\n            )`).attr("dy","1em").attr("text-anchor","middle").style("font-size","30px").text(e)};a();const r=t=>{const e=this.x(t.x0)+1;return`translate(${e}, 0)`},n=t=>{const e=this.xCate(t);return`translate(${e}, 0)`},o=t.selectAll(".celltmp").data(this.bins).join("g").attr("class","celltmp").attr("transform",t=>r(t)).on("mouseenter",t=>this.hover=t).on("mouseleave",t=>this.hover=null).on("click",t=>this.selecttmp(t,"first")).on("contextmenu",t=>this.selecttmp(t,"second")),l=t.selectAll(".celltmp2").data(this.categories).join("g").attr("class","celltmp2").attr("transform",t=>n(t)).on("mouseenter",t=>this.hoverCategory=t).on("mouseleave",t=>this.hoverCategory="").on("click",t=>this.selecttmp2(t,"first")).on("contextmenu",t=>this.selecttmp2(t,"second")),c=t.selectAll(".cell").data(this.bucketKeys).join("g").attr("class","cell").attr("transform",t=>`translate(${e(t)}, 0)`),h=this.x,d=this.y,u=this.xCate,p=this.yCate,f=t=>h(t.x1)-h(t.x0),m=t=>"Yes"!=this.normalizationMode?this.y(t.length):0==t.length?this.y(0):this.y(1),g=t=>this.height-m(t),v=u.bandwidth(),y=t=>"Yes"!=this.normalizationMode?this.yCate(this.bucketedInstances[t].size):0==this.bucketedInstances[t].size?this.yCate(0):this.yCate(1),_=t=>this.height-y(t),x=()=>{if("Yes"==this.showActualClassDistribution){const t=e.bandwidth();c.append("rect").attr("class","bar").attr("y",t=>"Yes"!=this.normalizationMode?s(this.buckets[t].size/this.instances.length):0==this.buckets[t].size?s(0):s(1)).attr("width",t).attr("height",t=>this.height-("Yes"!=this.normalizationMode?s(this.buckets[t].size/this.instances.length):0==this.buckets[t].size?s(0):s(1))).attr("fill","lightgray").attr("stroke","black").style("paint-order","stroke").on("mouseenter",t=>this.hoverActual={className:t}).on("mouseleave",this.clearHover).on("click",t=>this.select(t,"first")).on("contextmenu",t=>this.select(t,"second")),c.append("circle").attr("cx",t/2).attr("cy",t=>this.height-15).attr("r","15px").style("fill","lightgray").attr("stroke","grey").attr("visibility",t=>0==s(this.buckets[t].size/this.instances.length)||this.buckets[t].size/this.instances.length>.05?"hidden":"visible").on("click",t=>this.select(t,"first")).on("contextmenu",t=>this.select(t,"second")),c.append("rect").attr("class","selection-rect").attr("y",t=>("Yes"!=this.normalizationMode?s(this.buckets[t].size/this.instances.length):0==this.buckets[t].size?s(0):s(1))-90).attr("x",-100).attr("width",200).attr("height",80).attr("stroke","black").attr("stroke-width","1px").attr("fill","white").attr("visibility","hidden")}else this.categoricalFeatures.includes(this.chosenFeature)?(l.append("rect").attr("class","bar").attr("y",t=>y(t)).attr("width",t=>v).attr("height",t=>_(t)).attr("stroke","black").attr("stroke-width","0.5px").attr("fill","lightgray"),l.append("circle").attr("class","bar-circle").attr("cx",t=>v/2).attr("cy",t=>"Yes"==this.normalizationMode?v/15>15?this.height-v/15:this.height-15:v/15>15?p(1)-v/15:p(1)-15).attr("r",t=>v/15>15?v/15:15).attr("visibility",t=>_(t)/this.height==0||_(t)/this.height>.1?"hidden":"visible").style("fill","lightgray"),l.append("rect").attr("class","selection-rect").attr("y",t=>y(t)-90).attr("x",t=>-70).attr("width",140).attr("height",80).attr("stroke","black").attr("stroke-width","1px").attr("fill","white").attr("visibility","hidden")):(o.append("rect").attr("class","bar").attr("y",t=>m(t)).attr("width",t=>f(t)).attr("height",t=>g(t)).attr("stroke","black").attr("stroke-width","0.5px").attr("fill","lightgray"),o.append("circle").attr("class","bar-circle").attr("cx",t=>f(t)/2).attr("cy",t=>f(t)/15>15?this.height-f(t)/15:this.height-15).attr("r",t=>f(t)/15>15?f(t)/15:15).attr("visibility",t=>g(t)/this.height==0||g(t)/this.height>.1?"hidden":"visible").style("fill","lightgray").attr("stroke","grey"),o.append("rect").attr("class","selection-rect").attr("y",t=>m(t)-90).attr("x",-120).attr("width",140).attr("height",80).attr("stroke","black").attr("stroke-width","1px").attr("fill","white").attr("visibility","hidden"))},b=()=>{"Yes"==this.showActualClassDistribution?t.append("line").attr("class","y-axis-marker-line").attr("y1",s(1)).attr("x2",this.width).attr("y2",s(1)).attr("stroke","red").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none"):this.categoricalFeatures.includes(this.chosenFeature)?t.append("line").attr("class","y-axis-marker-line").attr("y1",p(1)).attr("x2",this.width).attr("y2",p(1)).attr("stroke","red").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none"):t.append("line").attr("class","y-axis-marker-line").attr("y1",d(1)).attr("x2",this.width).attr("y2",d(1)).attr("stroke","red").attr("stroke-width","2px").attr("stroke-opacity",0).attr("pointer-events","none")},w=()=>{t.append("text").attr("class","y-axis-marker-text").attr("text-anchor","middle").attr("font-size",20).attr("pointer-events","none")};b(),w(),x(),this.drawHover(),this.drawSelections()},drawSelections(){const{first:t,second:e}=this.selections;var s=it["j"](".0f");"Yes"==this.normalizationMode&&(s=it["j"](".3f"));const i=[t,e],a=(t,e)=>{const s=Lt(t,e);return"Yes"==this.normalizationMode?this.yClass(s.size/t.size):this.yClass(s.size/this.instances.length)},r=(t,e)=>this.height-a(t,e),n=(t,e)=>{const s=Lt(t,e);return this.categoricalFeatures.includes(this.chosenFeature)?"Yes"==this.normalizationMode?this.yCate(s.size/t.size):this.yCate(s.size):"Yes"==this.normalizationMode?this.y(s.size/t.size):this.y(s.size)},o=(t,e)=>this.height-n(t,e),l=(t,e)=>{const s=Lt(t,e);return this.categoricalFeatures.includes(this.chosenFeature),"Yes"==this.normalizationMode?s.size/t.size:s.size},c=(t,e)=>{const s=Lt(t,e);for(const i of s)if(this.$store.state.focusItemId===i)return!0;return!1};i.forEach((t,e)=>{if(t)if("Yes"==this.showActualClassDistribution){let s=this.xClass,i=s.bandwidth(),n=i/8;this.bucketKeys.forEach(o=>{let l={barCells:this.svg,x:s(o)+i/2+(e-1)*n,y:a(this.buckets[o],t.instances),width:n,height:r(this.buckets[o],t.instances),r:n/2,color:0==e?this.selection1Color:this.selection2Color,circle_visibility:0==r(this.buckets[o],t.instances)||r(this.buckets[o],t.instances)/this.height>.05?"hidden":"visible",cx:s(o)+i/2+(e-.5)*n,cy:this.height-n/2,selection_type:e,focused:c(this.buckets[o],t.instances),view_name:this.name};this.$store.dispatch("drawSelections",l)})}else if(this.categoricalFeatures.includes(this.chosenFeature))this.categories.forEach(i=>{let a=this.xCate.bandwidth(),r=a/8,h=this.xCate,d={barCells:this.svg,x:a/2+(e-1)*r+h(i),y:n(this.bucketedInstances[i],t.instances),width:r,height:o(this.bucketedInstances[i],t.instances),r:r/2,color:0==e?this.selection1Color:this.selection2Color,circle_visibility:isNaN(parseInt(s(l(this.bucketedInstances[i],t.instances))))||0==o(this.bucketedInstances[i],t.instances)||o(this.bucketedInstances[i],t.instances)/this.height>.05?"hidden":"visible",cx:h(i)+a/2+(e-.5)*r,cy:this.height-r/2,selection_type:e,focused:c(this.bucketedInstances[i],t.instances),view_name:this.name};this.$store.dispatch("drawSelections",d)});else{let i=t=>{const e=this.x(t.x0)+1;return e};const a=t=>this.x(t.x1)-this.x(t.x0),r=t=>a(t)/8;this.bins.forEach(h=>{let d={barCells:this.svg,x:a(h)/2+(e-1)*r(h)+i(h),y:n(new Set(h),t.instances),width:r(h),height:o(new Set(h),t.instances),r:r(h)/2,color:0==e?this.selection1Color:this.selection2Color,circle_visibility:isNaN(parseInt(s(l(new Set(h),t.instances))))||0==o(new Set(h),t.instances)||o(new Set(h),t.instances)/this.height>.05?"hidden":"visible",cx:i(h)+a(h)/2+(e-.5)*r(h),cy:this.height-r(h)/2,selection_type:e,focused:c(new Set(h),t.instances),view_name:this.name};this.$store.dispatch("drawSelections",d)})}else this.svg.selectAll("selection-rect-"+e).attr("height","0"),this.svg.selectAll("selection-circle-"+e).attr("visibility","hidden")})},selecttmp(t,e){it["i"].preventDefault(),it["i"].stopPropagation();const s=new Set(t),i=`Instances which have "${this.chosenFeature}" between ${t.x0} and ${t.x1}`,a=nt();a.rule=X.FEATURE_LT,a.negation=!0,a.value=String(t.x0);const r=nt();r.rule=X.FEATURE_LT,r.value=String(t.x1);const n={type:"simple",constraints:[a,r],metric:[]},o={description:i,instances:s,predicate:n};this.$store.dispatch("prependToSelectionHistory",o),this.$store.dispatch("changedMostRecentSelection",e)},selecttmp2(t,e){it["i"].preventDefault(),it["i"].stopPropagation();const s=nt();s.rule=X.FEATURE_EQ,s.feature=this.chosenFeature,s.value=t;const i=this.bucketedInstances[t],a=`Instances with feature '${this.chosenFeature}' equal to '${t}')`,r={type:"simple",constraints:[s],metric:[]},n={description:a,instances:i,predicate:r};this.$store.dispatch("prependToSelectionHistory",n),this.$store.dispatch("changedMostRecentSelection",e)},select(t,e){it["i"].preventDefault(),it["i"].stopPropagation();const s=nt();s.rule=X.ACTUAL,s.target=t;const i=this.buckets[t],a="Instances of class "+t,r={type:"simple",constraints:[s],metric:[]},n={description:a,instances:i,predicate:r};this.$store.dispatch("prependToSelectionHistory",n),this.$store.dispatch("changedMostRecentSelection",e)}}})),Wr=Lr,qr=(s("6cb2"),s("b974")),Ur=Object(m["a"])(Wr,Kr,Nr,!1,null,"848054e2",null),Yr=Ur.exports;v()(Ur,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"],VSelect:qr["a"],VSlider:Pi["a"],VSwitch:pe["a"]});var Gr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Scatter Plot ")])],1)])],1)],1),s("div",[s("multiselect",{staticClass:"select_feature",attrs:{options:t.numericFeatures,single:""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),s("div",[s("multiselect",{staticClass:"select_feature_y",attrs:{options:t.numericFeatures,single:""},model:{value:t.value_y,callback:function(e){t.value_y=e},expression:"value_y"}})],1),s("div",{ref:"svg"})],1)},Qr=[],Jr=i["a"].extend({name:"ScatterPlot",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:30,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i="descending",a={type:"",classifier:""},r="All",n="acc2",o={type:"",obejct:""},l="prediction-"+[...this.boxProps.classifiers][3];return{svg:"",zoom:o,min:0,max:100,max_value:0,evaluationSelection:n,value:"",value_y:l,classifierValue:"",chosenData:r,accuracySorting:i,height:s,correlation_mode:"No",hover:a,margin:t,curclick:[],panel:[],rightColor:"#d1e5f0",rightHoverColor:"#4393c3",selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e,selectedEval:"",wrongColor:"#fddbc7",wrongHoverColor:"#d6604d",correlations:[],featureIntervals:Number,featureYIntervals:Number,preCorrelations:[],prefeatureIntervals:Number,prefeatureYIntervals:Number,premax_value:0,clickCount:0,clickTimer:0}},computed:{correlationMode(){var t="";switch(this.evaluationSelection){case"acc1":t="acc1";break;case"acc2":t="acc2";break;case"acc3":t="acc3";break;case"uncertain":t="uncertain";break}return t},selectionHistory(){return this.$store.state.selectionHistory},numericFeatures(){const t=[...this.boxProps.features],e=["interval","ratio"],s=t=>{const s=this.$store.getters.feature(t);return e.includes(s.type)},i=t.filter(s);return this.classifiers.forEach(t=>{i.push("prediction-"+t)}),i},classes(){return[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},uncertaintyRange(){return["0.00","0.01","0.02","0.03","0.04","0.05","0.06","0.07","0.08","0.09","0.10"]},classifierThresholds(){return this.$store.state.classifierThreshods},externalHoverInstance(){return this.$store.state.hoverInstance},instances(){return[...this.boxProps.instances]},features(){const t=[...this.boxProps.features],e=["interval","ratio"],s=t=>{const s=this.$store.getters.feature(t);return e.includes(s.type)},i=t.filter(s),a=[...this.boxProps.features].filter(t=>"categorical"===this.$store.getters.feature(t).type);let r=[];return i.forEach(t=>{r.push(t)}),a.forEach(t=>{r.push(t)}),r=r.filter(t=>"train_or_test"!=t),r},InitialCorrelations(){if(""==this.value&&0!=this.numericFeatures.length&&(this.value=this.numericFeatures[0]),""==this.value||""==this.value_y)return[];""==this.classifierValue&&(this.classifierValue=this.classifiers[0]);let t=this.value,e=this.value_y,s=this.instances,i=[],a=[],r=1e5,n=-1e5,o=1e5,l=-1e5;s.forEach(s=>{let c=0,h=0;if("prediction"==this.value.substring(0,10)){let t=this.value.substring(11,this.value.length);c=Nt(s)["continuous_predictions"][t]}else c=parseFloat(Nt(s)["features"][t].toString());if("prediction"==this.value_y.substring(0,10)){let t=this.value_y.substring(11,this.value_y.length);h=Nt(s)["continuous_predictions"][t]}else h=parseFloat(Nt(s)["features"][e].toString());i.push(c),a.push(h),r=r>Math.floor(c)?Math.floor(c):r,n=n<Math.ceil(c)?Math.ceil(c):n,o=o>Math.floor(h)?Math.floor(h):o,l=l<Math.ceil(h)?Math.ceil(h):l});let c=(n-r)/10,h=(l-o)/10,d=[],u=[],p=0,f=r,m=o;while(p<=10)d.push(parseFloat(f.toFixed(1))),u.push(parseFloat(m.toFixed(1))),f+=c,m+=h,p+=1;let g=[];u.forEach((t,e)=>{g[e]=[],d.forEach((t,s)=>{g[e].push([])})}),s.forEach(s=>{let i=0,a=0;if("prediction"==this.value.substring(0,10)){let t=this.value.substring(11,this.value.length);i=parseFloat(Nt(s)["continuous_predictions"][t])}else i=parseFloat(Nt(s)["features"][t].toString());if("prediction"==this.value_y.substring(0,10)){let t=this.value_y.substring(11,this.value_y.length);a=parseFloat(Nt(s)["continuous_predictions"][t])}else a=parseFloat(Nt(s)["features"][e].toString());let n=parseInt(Math.round((i-r)/c).toString()),l=parseInt(Math.round((a-o)/h).toString());g[l][n].push(s)}),this.featureIntervals=d,this.featureYIntervals=u;let v=[];return g.forEach((t,e)=>[t.forEach((t,s)=>{this.max_value=this.max_value<t.length?t.length:this.max_value,v.push({feature_y:u[e],feature:d[s],featureY_idx:e,feature_idx:s,value:t.length,instances:t,zoom:0})})]),v},selections(){return this.$store.state.overlapSelections},focusItemId(){return this.$store.state.focusItemId},focusDotEmphasis(){return this.$store.state.focusDotEmphasis},x(){const t=it["x"]().domain(this.featureIntervals).range([0,this.width]).paddingOuter(1).paddingInner(.3);return t},y(){const t=it["x"]().domain(this.featureYIntervals).range([this.height,0]).paddingOuter(1).paddingInner(.3);return t},xAxis(){const t=t=>t.attr("transform",`translate(60, ${this.height})`).call(it["b"](this.x).tickSizeOuter(0));return t}},watch:{zoom(){this.updateCorrelations(),this.drawInitial()},selections(){this.drawInitial()},focusItemId(){this.drawInitial()},focusDotEmphasis(){this.drawInitial()},classifierValue(){this.updateCorrelations(),this.drawCorrelation()},value(){this.zoom={type:"",obejct:""},this.updateCorrelations(),this.drawCorrelation()},value_y(){this.zoom={type:"",obejct:""},this.updateCorrelations(),this.drawCorrelation()},instances(){this.drawInitial()},correlationMode(){this.drawCorrelation()}},mounted(){this.drawInitial()},methods:{updateCorrelations(){this.preCorrelations=[],this.prefeatureIntervals=[],this.prefeatureYIntervals=[],this.premax_value=this.max_value;let t=this.value,e=this.value_y,s=""==this.zoom["type"]?this.instances:this.zoom["object"]["instances"],i=[],a=1e5,r=-1e5,n=1e5,o=-1e5;this.max_value=-1e5,this.correlations.forEach(t=>{this.preCorrelations.push(t)}),this.featureIntervals.forEach(t=>{this.prefeatureIntervals.push(t)}),this.featureYIntervals.forEach(t=>{this.prefeatureYIntervals.push(t)}),s.forEach(s=>{let l=0,c=0;if("prediction"==this.value.substring(0,10)){let t=this.value.substring(11,this.value.length);l=parseFloat(Nt(s)["continuous_predictions"][t])}else l=parseFloat(Nt(s)["features"][t].toString());if("prediction"==this.value_y.substring(0,10)){let t=this.value_y.substring(11,this.value_y.length);c=parseFloat(Nt(s)["continuous_predictions"][t])}else c=parseFloat(Nt(s)["features"][e].toString());i.push(c),a=a>l?l:a,r=r<l?l:r,n=n>c?c:n,o=o<c?c:o});let l=(r-a)/10,c=(o-n)/10,h=[],d=[],u=0,p=a,f=n;while(u<=10)h.push(parseFloat(p.toFixed(2))),d.push(parseFloat(f.toFixed(2))),p+=l,f+=c,u+=1;let m=[];d.forEach((t,e)=>{m[e]=[],h.forEach((t,s)=>{m[e].push([])})}),this.featureIntervals=h,this.featureYIntervals=d;let g=[];""==this.zoom.type?(s.forEach(s=>{let i=0,r=0;if("prediction"==this.value.substring(0,10)){let t=this.value.substring(11,this.value.length);i=parseFloat(Nt(s)["continuous_predictions"][t])}else i=parseFloat(Nt(s)["features"][t].toString());if("prediction"==this.value_y.substring(0,10)){let t=this.value_y.substring(11,this.value_y.length);r=parseFloat(Nt(s)["continuous_predictions"][t])}else r=parseFloat(Nt(s)["features"][e].toString());let o=parseInt(Math.round((i-a)/l).toString()),h=parseInt(Math.round((r-n)/c).toString());m[h][o].push(s)}),m.forEach((t,e)=>{t.forEach((t,s)=>{this.max_value=this.max_value<t.length?t.length:this.max_value,g.push({feature_y:d[e],feature:h[s],featureY_idx:e,feature_idx:s,value:t.length,instances:t,zoom:0})})})):s.forEach(s=>{let i=0,a=0;if("prediction"==this.value.substring(0,10)){let t=this.value.substring(11,this.value.length);i=parseFloat(Nt(s)["continuous_predictions"][t])}else i=parseFloat(Nt(s)["features"][t].toString());if("prediction"==this.value_y.substring(0,10)){let t=this.value_y.substring(11,this.value_y.length);a=parseFloat(Nt(s)["continuous_predictions"][t])}else a=parseFloat(Nt(s)["features"][e].toString());g.push({feature_y:a,feature:i,featureY_idx:"",feature_idx:"",value:1,instances:new Set([s]),zoom:0})}),this.correlations=g},drawInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${this.height+this.margin.top+this.margin.bottom+this.margin.left}`);t.append("g").attr("class","svg-correlations").attr("transform",`translate(0, ${this.margin.top+this.margin.left})`);0==this.correlations.length&&(this.correlations=this.InitialCorrelations),this.drawCorrelation()},drawCorrelation(){0==this.correlations.length&&(this.correlations=this.InitialCorrelations);const t=it["C"](this.$refs.svg),e=t.select(".svg-correlations");this.correlationMode;e.selectAll("*").remove();const s=it["B"](it["m"]).domain([0,1.5*this.max_value]).interpolator((function(t){return it["m"](1.5*t)})),i=()=>{e.append("text").attr("transform",()=>{const t=this.width/2,e=this.height+this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Feature: "+this.value),e.append("text").attr("transform",()=>{const t=100,e=-40;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Feature: "+this.value_y)};i();const a=()=>{let t=this.x,i=this.y,a=this.xAxis;e.append("g").call(a).attr("font-size",18).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start"),e.append("g").attr("transform","translate(60,0)").call(it["c"](i)).attr("font-size",18);const r=e.append("g").attr("transform","translate(60, "+-this.height/15+")").selectAll("rects").data(this.correlations).enter();this.svg=e,r.append("rect").attr("x",(function(e){return t(e["feature"])})).attr("y",(function(t){return i(t["feature_y"])})).attr("width",this.width/15).attr("height",this.height/15).style("fill",t=>s(t["value"])).on("click",t=>this.click(t)).on("contextmenu",t=>this.select(t,"second"))},r=()=>{const t=it["y"]().domain([.95*parseFloat(it["u"](this.featureIntervals)),1.05*parseFloat(it["t"](this.featureIntervals))]).range([0,this.width]),s=it["y"]().domain([.95*parseFloat(it["u"](this.featureYIntervals)),1.05*parseFloat(it["t"](this.featureYIntervals))]).range([this.height,0]),i=e=>e.attr("transform",`translate(60, ${this.height})`).call(it["b"](t).tickSizeOuter(0));e.append("g").call(i).attr("font-size",18).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start"),e.append("g").attr("transform","translate(60,0)").call(it["c"](s)).attr("font-size",18);const a=e.append("g").attr("transform","translate(60, "+-this.height/15+")").selectAll("rects").data(this.correlations).enter();a.append("circle").attr("cx",(function(e){return t(e["feature"])})).attr("cy",(function(t){return s(t["feature_y"])})).attr("r",t=>15*t["value"]).style("fill",t=>t["instances"].has(this.$store.state.focusItemId)?Ot.focus:"steelblue").attr("opacity",.5).on("click",t=>{this.$store.dispatch("setFocusItem",[...t["instances"]][0])}).on("contextmenu",t=>{this.select(t,"second")});const r=()=>{var t=it["x"]().domain(this.prefeatureIntervals).range([0,this.width/5]).paddingOuter(1).paddingInner(.3),s=it["x"]().domain(this.prefeatureYIntervals).range([this.height/5,0]).paddingOuter(1).paddingInner(.3),i=e=>e.attr("transform",`translate(${this.width-60}, ${this.height/5})`).call(it["b"](t).tickSizeOuter(0));e.append("g").call(i).attr("font-size",4).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start"),e.append("g").attr("transform","translate("+(this.width-60)+",0)").call(it["c"](s)).attr("font-size",4);const a=e.append("g").attr("transform","translate("+(this.width-60)+","+-this.height/75+")").selectAll("rects").data(this.preCorrelations).enter();a.append("rect").attr("x",(function(e){return t(e["feature"])})).attr("y",(function(t){return s(t["feature_y"])})).attr("width",this.width/75).attr("height",this.height/75).style("fill",t=>this.zoom.object==t?"steelblue":"lightgrey").attr("visibility",t=>0==t["value"]?"hidden":"visible").on("click",t=>this.zoom={type:"",object:""})};r()};""==this.zoom.type?(a(),this.drawSelections()):r()},drawSelections(){0==this.correlations.length&&(this.correlations=this.InitialCorrelations);const{first:t,second:e}=this.selections,s=(t,e)=>{const s=Lt(t,e);return s.size/t.size*(this.height/15)},i=(t,e)=>{const s=Lt(t,e);for(const i of s)if(this.$store.state.focusItemId===i)return!0;return!1},a=[t,e],r=this.x,n=this.y;let o=this.width/15,l=o/6;a.forEach((t,e)=>{t?this.correlations.forEach(a=>{let c={barCells:this.svg,x:60+r(a["feature"])+(e+1)*l,y:-this.height/15+n(a["feature_y"]),width:l,height:s(new Set(a["instances"]),t.instances),r:l/2,color:0==e?this.selection1Color:this.selection2Color,circle_visibility:s(new Set(a["instances"]),t.instances)>0&&s(new Set(a["instances"]),t.instances)<.1*o?"visible":"hidden",cx:60+r(a["feature"])+2*l+(e-.5)*l,cy:-this.height/15+n(a["feature_y"])+l/2,selection_type:e,focused:i(new Set(a["instances"]),t.instances),view_name:this.name};this.$store.dispatch("drawSelections",c)}):(this.svg.selectAll("selection-rect-"+e).attr("height","0"),this.svg.selectAll("selection-circle-"+e).attr("visibility","hidden"))})},select(t,e){"second"===e&&(it["i"].preventDefault(),it["i"].stopPropagation());const s=this.classifierValue,i=this.value,a=this.value_y,r=t["feature"],n=t["feature_y"],o=`Instances whose ${i} are around ${r} and ${a} are around ${n} `,l=new Set(t["instances"]),c=nt();c.rule=X.RIGHT,c.classifier=s;const h={type:"simple",constraints:[c],metric:[]},d={description:o,instances:l,predicate:h};this.$store.dispatch("prependToSelectionHistory",d),this.$store.dispatch("changedMostRecentSelection",e)},click(t){this.clickCount+=1,1===this.clickCount&&(this.clickTimer=setTimeout((function(e){e.clickCount=0,e.select(t,"first")}),300,this)),2===this.clickCount&&(clearTimeout(this.clickTimer),this.clickCount=0,this.zoom={type:"in",object:t})}}}),Xr=Jr,Zr=(s("0959"),Object(m["a"])(Xr,Gr,Qr,!1,null,"31750de6",null)),tn=Zr.exports;v()(Zr,{VExpansionPanel:j["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"]});var en=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("Focus Item")])],1)]),s("v-expansion-panel-content",[s("v-btn",{staticClass:"button-panel",attrs:{id:"all-instance",color:"all"===t.subset?"primary":"firstColor",small:""},on:{click:t.allInstance}},[t._v("All")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"first-instance",color:"first"===t.subset?"primary":"firstColor",small:""},on:{click:t.firstInstance}},[t._v("Selection 1")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"second-instance",color:"second"===t.subset?"primary":"firstColor",small:""},on:{click:t.secondInstance}},[t._v("Selection 2")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"intersection-instance",color:"intersection"===t.subset?"primary":"firstColor",small:""},on:{click:t.intersectionInstance}},[t._v("Intersection")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"union-instance",color:"union"===t.subset?"primary":"firstColor",small:""},on:{click:t.unionInstance}},[t._v("Union")]),s("v-btn",{staticClass:"button-panel",attrs:{id:"complement-instance",color:"complement"===t.subset?"primary":"firstColor",small:""},on:{click:t.complementInstance}},[t._v("Complement of 1 Union 2")])],1)],1)],1),s("v-list",{attrs:{id:"item-container"}},[s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.prevInstance(t.instances)}}},[t._v("Previous")]),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.nextInstance(t.instances)}}},[t._v("Next")]),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.randInstance(t.instances)}}},[t._v("Random")]),s("v-btn",{staticClass:"button-nav emphasize-btn",attrs:{color:"warning",small:""},on:{click:t.emphasize}},[t._v("Emphasize")]),t.focus(t.instances).features.image?s("v-img",{attrs:{src:t.focus(t.instances).features.image}}):t._e(),t._l(t.focus(t.instances),(function(e,i){return s("v-list-item",{key:e.id,attrs:{id:"v-for-object"}},[s("v-list-item-content",[s("v-list-item-subtitle",[t._v(t._s(i))]),"object"===typeof e?t._l(e,(function(e,i){return s("v-list",{key:i,attrs:{id:"v-for-object"}},[i&&e?[t._v(t._s(i)+": "+t._s(e))]:t._e(),[t._v(t._s(i)+": "+t._s(e))]],2)})):[t._v(t._s(e))]],2)],1)})),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.prevInstance(t.instances)}}},[t._v("Previous")]),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.nextInstance(t.instances)}}},[t._v("Next")]),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:function(e){return t.randInstance(t.instances)}}},[t._v("Random")]),s("v-btn",{staticClass:"button-nav",attrs:{small:""},on:{click:t.emphasize}},[t._v("Emphasize")])],2)],1)},sn=[],an=i["a"].extend({name:"InstanceList",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){return{panel:[],sortby:[],sortBySel:"",descending:!1,show_predictions:!0,show_features:!0,string_length:7,currentIndex:0,subset:"all"}},mounted(){this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id),this.$store.dispatch("changeFocusSet",this.subset)},computed:{instances(){let t=[];this.$store.getters.filteredInstances.forEach(e=>{const s=Nt(e),i=Object.assign({id:e},s);t.push(i)});const{first:e,second:s}=this.selections;if("all"!==this.subset){let i=[];if("first"===this.subset)if(e)for(const s of e.instances)i.push(t.find(t=>t.id===s));else this.currentIndex=-1,alert("no selection");else if("second"===this.subset)if(s)for(const e of s.instances)i.push(t.find(t=>t.id===e));else this.currentIndex=-1,alert("no second set of selection");else if(e&&s){if("intersection"===this.subset)for(const a of e.instances)s.instances.has(a)&&i.push(t.find(t=>t.id===a));else if("union"===this.subset){for(const s of e.instances)i.push(t.find(t=>t.id===s));for(const a of s.instances)e.instances.has(a)||i.push(t.find(t=>t.id===a))}else if("complement"===this.subset)for(const a of t)e.instances.has(a.id)||s.instances.has(a.id)||i.push(a)}else this.currentIndex=-1,alert("two selected sets are required to perform this action");return i}return t},selections(){return this.$store.state.overlapSelections},focusItemId(){return this.$store.state.focusItemId}},watch:{currentIndex(){this.$store.dispatch("setFocusItem",this.currentIndex<0?null:this.instances[this.currentIndex].id)},selections(){this.$store.dispatch("setFocusItem",this.currentIndex<0?null:this.instances[this.currentIndex].id)},onClose(){console.log("focus closed")},focusItemId(){this.currentIndex=this.idToIndex(this.instances,this.$store.state.focusItemId),console.log("setFocus to:",this.$store.state.focusItemId),console.log("idToIndex:",this.idToIndex(this.instances,this.$store.state.focusItemId))}},methods:{focus(t){const e=t[this.currentIndex];let s={features:e.features,id:e.id,actual:e.actual,predictions:e.predictions};e.continuous_predictions&&(s["continuous_predictions"]=e.continuous_predictions);for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&s[i][""]&&delete s[i][""];return s},idToIndex(t,e){for(let s=0;s<t.length;s++)if(t[s].id===e)return s;return-1},prevInstance(t){this.currentIndex>0?this.currentIndex--:this.currentIndex=t.length-1},nextInstance(t){this.currentIndex<t.length-1?this.currentIndex++:this.currentIndex=0},randInstance(t){this.currentIndex=Math.floor(Math.random()*t.length)},allInstance(){this.currentIndex=0,this.subset="all",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},firstInstance(){this.currentIndex=0,this.subset="first",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},secondInstance(){this.currentIndex=0,this.subset="second",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},intersectionInstance(){this.currentIndex=0,this.subset="intersection",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},unionInstance(){this.currentIndex=0,this.subset="union",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},complementInstance(){this.currentIndex=0,this.subset="complement",this.$store.dispatch("changeFocusSet",this.subset),this.$store.dispatch("setFocusItem",this.instances[this.currentIndex].id)},emphasize(){this.$store.dispatch("emphasizeFocus")}}}),rn=an,nn=(s("5ae2"),Object(m["a"])(rn,en,sn,!1,null,"15d9b217",null)),on=nn.exports;v()(nn,{VBtn:y["a"],VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VImg:fa["a"],VList:C["a"],VListItem:k["a"],VListItemContent:S["a"],VListItemSubtitle:S["b"]});var ln=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("v-expansion-panels",{model:{value:t.panel,callback:function(e){t.panel=e},expression:"panel"}},[s("v-expansion-panel",[s("v-expansion-panel-header",[s("div",{staticClass:"handle",staticStyle:{"font-size":"20px"}},[s("v-icon",{staticStyle:{"margin-right":"10px"},on:{click:t.onClose}},[t._v("close")]),s("span",[t._v("(Trinary) Rejected Curve")])],1)]),s("v-expansion-panel-content",[s("v-radio-group",{attrs:{label:"Evaluation method"},model:{value:t.evaluationKeys,callback:function(e){t.evaluationKeys=e},expression:"evaluationKeys"}},[s("v-radio",{attrs:{label:"conditional accuracy",value:"c_accuracy"}}),s("v-radio",{attrs:{label:"accuracy",value:"accuracy"}}),s("v-radio",{attrs:{id:"mcc",label:"mcc",value:"mcc"}}),s("v-radio",{attrs:{label:"f1",value:"f1"}}),s("v-radio",{attrs:{label:"precision",value:"precision"}}),s("v-radio",{attrs:{label:"recall",value:"recall"}})],1),s("v-radio-group",{attrs:{label:"Selection Mode"},model:{value:t.selection_mode,callback:function(e){t.selection_mode=e},expression:"selection_mode"}},[s("v-radio",{attrs:{label:"overall curve ",value:"overall"}}),s("v-radio",{attrs:{label:"selection curve",value:"selected"}})],1)],1)],1)],1),s("multiselect",{attrs:{options:t.options,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pick sets",label:"name","track-by":"name","preselect-first":!0},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.values,a=e.isOpen;return[i.length&&!a?s("span",{staticClass:"multiselect__single"},[t._v(" "+t._s(i.length)+" options selected ")]):t._e()]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),s("div",{ref:"svg"})],1)},cn=[],hn=i["a"].extend({name:"Rejected_Curve",props:{boxProps:{type:Object,required:!0},onClose:{type:Function,required:!0}},data(){const t={top:150,right:20,bottom:90,left:120},e=1e3-t.left-t.right,s=600-t.top-t.bottom,i={info:"",idx:"",line_idx:""},a={classifier:"",left_range:"",right_range:""},r={info:"",line_idx:""},n="c_accuracy",o={bandwidth:""},l={threshold:""},c={threshold:""},h={threshold:""},d="overall",u=[...this.boxProps.classifiers][3],p=["rgb(37,102,118)","rgb(138,225,249)"],f=["rgb(181,29,73)","rgb(251,137,155)"],m=["rgb(64,57,150)","rgb(119,136,153)"];return{selectedPred:{},classifierBuckets:{},selection_mode:d,leftRate:0,rightRate:1,multilClassifier:"no",thresholdList:[],currentThresholds:h,tmp_threshold:.5,barHover:l,evaluationKeys:n,accHover:c,bandwidthHover:o,leftThreshold:0,rightThreshold:1,streamData:{},value:[],height:s,hover:i,click:a,lineHover:r,margin:t,panel:[],rightColor:"#d1e5f0",rightHoverColor:"#4393c3",selection1Color:"#18FFFF",selection2Color:"#FF4081",width:e,wrongColor:"#fddbc7",wrongHoverColor:"#d6604d",classNumber:[...this.boxProps.classes].length,curveClassifier:u,numberOfBins:.5,thresholdRangeRecords:{},upperColors:p,middleColors:m,lowerColors:f}},computed:{thresholds(){let t=0,e=.02,s=[];while(t<=1)s.push(t.toFixed(2)),t+=e;return s},instances(){return[...this.boxProps.instances]},options(){let t=[];const e=this.classifiers;return e.forEach(e=>{t.push({name:e})}),t},classifierThresholds(){return this.$store.state.classifierThresholdDict},classifierBandWidthDict(){return this.boxProps.classifierBandWidthDict},classes(){return this.classNumber=[...this.boxProps.classes].length,[...this.boxProps.classes]},classifiers(){const t=[...this.boxProps.classifiers],e=["Oracle","Majority Classifier","Random Classifier"];return t.filter(t=>!e.includes(t))},thresholdClassifierNameList(){return this.$store.state.thresholdClassifierNameList},features(){return[...this.boxProps.features]},predictionKeys(){const t=this.classifiers.slice();return t},continuousPredictionKeys(){if("continuous"==this.$store.state.datasetType){var t=[];return this.predictionKeys.forEach(e=>{t.push(e+"_"+this.$store.state.classifierThresholdDict[e]/100)}),t}return this.predictionKeys},continuousClassifierName(){var t={};return this.classifiers.forEach(e=>{"continuous"==this.$store.state.datasetType?t[e]=e+"_"+this.$store.state.classifierThresholdDict[e]/100:t[e]=e}),t},thresholdRange(){const t={};return this.classifiers.forEach(e=>{t[this.continuousClassifierName[e]]={name:e,threshold:Object.keys(this.classifierThresholds).includes(e)?this.classifierThresholds[e]:0,left_range:Object.keys(this.classifierThresholds).includes(e)?this.classifierThresholds[e]/100-.05:0,right_range:Object.keys(this.classifierThresholds).includes(e)?this.classifierThresholds[e]/100+.05:0}}),t},predictions(){let t=.02,e=.02,s={};this.classifiers.forEach(e=>{let i={},a=0;while(a<1){let e=a.toFixed(2)+"-"+(a+t).toFixed(2);i[e]=[],a+=t}this.instances.forEach(s=>{let a=Nt(s).continuous_predictions[e],r=Math.floor(100*a/2),n=(r*t).toFixed(2)+"-"+((r+1)*t).toFixed(2);50==r&&(n="0.98-1.00"),parseFloat(a)-r*t>0||0==r||(n=((r-1)*t).toFixed(2)+"-"+(r*t).toFixed(2)),i[n].push({id:s,value:parseFloat(a).toFixed(3)})}),s[e]=i}),this.classifierBuckets=s;const i=(t,e,s,i)=>{let a={left_edge:s.toFixed(2),right_edge:i.toFixed(2),rejec_rate:0,c_acc:0,acc:0,recall:0,precision:0,mcc:0,f1:0,m_tp:0,m_tn:0,m_fn:0,m_fp:0,m:0,tp:0,tn:0,fp:0,fn:0,tp_instances:[],m_tp_instances:[],totoal:0};return this.instances.forEach(r=>{let n=Nt(r).continuous_predictions[t];a["totoal"]+=1,n>s&&n<i?(a["m"]+=1,Nt(r).actual==this.classes[1]?n>=e?(a["m_tp"]+=1,a["m_tp_instances"].push({id:r,value:n})):a["m_fn"]+=1:n<e?a["m_tn"]+=1:a["m_fp"]+=1):n>=i?Nt(r).actual==this.classes[1]?(a["tp"]+=1,a["tp_instances"].push({id:r,value:n})):a["fp"]+=1:Nt(r).actual==this.classes[0]?a["tn"]+=1:a["fn"]+=1}),a["rejec_rate"]=a["m"]/a["totoal"],a["c_acc"]=a["totoal"]-a["m"]==0?1:(a["tp"]+a["tn"])/(a["totoal"]-a["m"]),a["acc"]=(a["tp"]+a["tn"])/a["totoal"],a["precision"]=a["tp"]+a["fp"]==0?0:a["tp"]/(a["tp"]+a["fp"]),a["recall"]=a["tp"]+a["fn"]==0?0:a["tp"]/(a["tp"]+a["fn"]),a["f1"]=a["recall"]+a["precision"]==0?0:2*a["recall"]*a["precision"]/(a["recall"]+a["precision"]),1==a["rejec_rate"]?a["mcc"]=1:0==Math.sqrt((a.tp+a.fp)*(a.tp+a.fn)*(a.tn+a.fp)*(a.tn+a.fn))?a["mcc"]=0:a["mcc"]=1==a["rejec_rate"]?1:(a.tp*a.tn-a.fp*a.fn)/Math.sqrt((a.tp+a.fp)*(a.tp+a.fn)*(a.tn+a.fp)*(a.tn+a.fn)),a},a=(t,e,a,r,n)=>{if(parseFloat(a.toFixed(2))==parseFloat(r.toFixed(2))){let s=i(t,e,a,r);return s}let o={left_edge:parseFloat(a.toFixed(2)),right_edge:parseFloat(r.toFixed(2)),rejec_rate:0,c_acc:0,acc:0,recall:0,precision:0,mcc:0,f1:0,m_tp:n.m_tp,m_tn:n.m_tn,m_fn:n.m_fn,m_fp:n.m_fp,m:n.m,tp:n.tp,tn:n.tn,fp:n.fp,fn:n.fn,totoal:n.totoal},l=Math.abs(a).toFixed(2)+"-"+parseFloat(n["left_edge"].toString()).toFixed(2),c=l;parseFloat(Math.abs(a).toFixed(2))>0&&(c=Math.abs(a-.02).toFixed(2)+"-"+Math.abs(a).toFixed(2));let h=[...s[t][l],s[t][c]],d=parseFloat(n["right_edge"].toString()).toFixed(2)+"-"+r.toFixed(2),u=d;parseFloat(Math.abs(n["right_edge"]).toFixed(2))>0&&(u=parseFloat((n["right_edge"]-.02).toString()).toFixed(2)+"-"+parseFloat(n["right_edge"].toString()).toFixed(2));let p=[...s[t][d],...s[t][u]];return h.forEach(t=>{o.left_edge>0?parseFloat(t.value)>o.left_edge&&parseFloat(t.value)<=n.left_edge&&(Nt(t.id).actual==this.classes[1]?o["fn"]>0&&(o["fn"]-=1,o["m_fn"]+=1,o["m"]+=1):o["tn"]>0&&(o["tn"]-=1,o["m_tn"]+=1,o["m"]+=1)):parseFloat(t.value)>=o.left_edge&&parseFloat(t.value)<=n.left_edge&&(Nt(t.id).actual==this.classes[1]?o["fn"]>0&&(o["fn"]-=1,o["m_fn"]+=1,o["m"]+=1):o["tn"]>0&&(o["tn"]-=1,o["m_tn"]+=1,o["m"]+=1))}),p.forEach(t=>{o.right_edge<1?parseFloat(t.value)>n.right_edge&&parseFloat(t.value)<=o.right_edge&&(Nt(t.id).actual==this.classes[1]?o["tp"]>0&&(o["tp"]-=1,o["m_tp"]+=1,o["m"]+=1):o["fp"]>0&&(o["fp"]-=1,o["m_fp"]+=1,o["m"]+=1)):parseFloat(t.value)>=n.right_edge&&parseFloat(t.value)<=o.right_edge&&(Nt(t.id).actual==this.classes[1]?o["tp"]>0&&(o["tp"]-=1,o["m_tp"]+=1,o["m"]+=1):o["fp"]>0&&(o["fp"]-=1,o["m_fp"]+=1,o["m"]+=1))}),o["rejec_rate"]=o["m"]/o["totoal"],o["c_acc"]=o["totoal"]-o["m"]==0?1:(o["tp"]+o["tn"])/(o["totoal"]-o["m"]),o["acc"]=(o["tp"]+o["tn"])/o["totoal"],o["precision"]=1==o["rejec_rate"]?1:o["tp"]+o["fp"]!=0?o["tp"]/(o["tp"]+o["fp"]):o["tp"]>0?1:0,o["recall"]=1==o["rejec_rate"]?1:o["tp"]+o["fn"]!=0?o["tp"]/(o["tp"]+o["fn"]):o["tp"]>0?1:0,o["f1"]=o["recall"]+o["precision"]==0?0:2*o["recall"]*o["precision"]/(o["recall"]+o["precision"]),1==o["rejec_rate"]?o["mcc"]=1:0==Math.sqrt((o.tp+o.fp)*(o.tp+o.fn)*(o.tn+o.fp)*(o.tn+o.fn))?o["mcc"]=0:o["mcc"]=(o.tp*o.tn-o.fp*o.fn)/Math.sqrt((o.tp+o.fp)*(o.tp+o.fn)*(o.tn+o.fp)*(o.tn+o.fn)),o};let r={};return this.classifiers.forEach(s=>{r[s]={};let i=0;while(i<=1){r[s][i.toFixed(2)]=[];let n=i,o=i,l={};while(parseFloat(n.toFixed(2))>=0&&parseFloat(o.toFixed(2))<=1){let t=a(s,i,n,o,l);r[s][i.toFixed(2)].push(t),o+=e,n-=e,l=t}i+=t}}),r},selections(){return this.$store.state.overlapSelections},x(){const t=it["x"]().domain(this.continuousPredictionKeys).range([0,.8*this.width]).paddingOuter(1).paddingInner(.3);return t},y(){const t=it["y"]().domain([0,1]).range([this.height,0]);return t},xScale(){const t=it["y"]().domain([0,200]).range([0,200]).clamp(!0);return t},saveStatus(){return this.$store.state.saveStatus},resumeStatus(){return this.$store.state.resumeStatus}},watch:{resumeStatus(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Rejected_Curve"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.selection_mode=e.selection,this.evaluationKeys=e.evaluation}}),this.drawWithinInitial()},saveStatus(){let t={name:"Rejected_Curve",config:{classifiers:this.value.map(t=>t.name),selection:this.selection_mode,evaluation:this.evaluationKeys}};this.$store.dispatch("changedSaveConfig",t)},click(){this.$store.dispatch("changedOuterBandWidth",this.click)},selection_mode(){"selected"==this.selection_mode?(this.updateSelectedPred(),this.drawSelectionChart()):this.drawStreamChart()},leftRate(){"selected"==this.selection_mode?(this.updateSelectedPred(),this.drawSelectionChart()):this.drawStreamChart()},rightRate(){"selected"==this.selection_mode?(this.updateSelectedPred(),this.drawSelectionChart()):this.drawStreamChart()},classifierThresholds(){"yes"==this.multilClassifier&&this.drawStreamChart()},currentThresholds(){this.thresholdList.push(this.currentThresholds.threshold)},thresholdList(){this.drawStreamChart()},evaluationKeys(){"selected"==this.selection_mode?(this.updateSelectedPred(),this.drawSelectionChart()):this.drawStreamChart()},value(){this.value.length>1?this.multilClassifier="yes":this.multilClassifier="no",this.selection_mode="overall",this.drawWithinInitial(),this.drawStreamChart()},hover(){this.drawHover()},lineHover(){this.drawLineHover()},numberOfBins(){this.selection_mode="overall",this.updatenumberOfBins()},tmp_threshold(){this.drawStreamChart()},instances(){this.drawWithinInitial(),"selected"==this.selection_mode?(this.updateSelectedPred(),this.drawSelectionChart()):this.drawStreamChart()}},mounted(){let t=this.$store.state.viewsConfig;t.forEach(t=>{if("Rejected_Curve"==t.name&&t.config){let e=t.config;this.value=[],e.classifiers.forEach(t=>{this.classifiers.includes(t)&&this.value.push({name:t})}),this.selection_mode=e.selection,this.evaluationKeys=e.evaluation}}),this.drawWithinInitial()},methods:{clearHover(){this.hover={info:"",idx:"",line_idx:""}},updateSelectedPred(){let t=.02,e=.02,s=(this.classifierBuckets,{}),i=0==this.value.length?"":this.value[this.value.length-1].name;const a=(t,e,s,i,a)=>{let r={left_edge:s.toFixed(2),right_edge:i.toFixed(2),rejec_rate:0,c_acc:0,acc:0,recall:0,precision:0,mcc:0,f1:0,m_tp:0,m_tn:0,m_fn:0,m_fp:0,m:0,tp:0,tn:0,fp:0,fn:0,tp_instances:[],m_tp_instances:[],totoal:0};return a.forEach(a=>{let n=Nt(a).continuous_predictions[t];r["totoal"]+=1,n>s&&n<i?(r["m"]+=1,Nt(a).actual==this.classes[1]?n>=e?(r["m_tp"]+=1,r["m_tp_instances"].push({id:a,value:n})):r["m_fn"]+=1:n<e?r["m_tn"]+=1:r["m_fp"]+=1):n>=i?Nt(a).actual==this.classes[1]?(r["tp"]+=1,r["tp_instances"].push({id:a,value:n})):r["fp"]+=1:Nt(a).actual==this.classes[0]?r["tn"]+=1:r["fn"]+=1}),r["rejec_rate"]=r["m"]/r["totoal"],r["c_acc"]=r["totoal"]-r["m"]==0?1:(r["tp"]+r["tn"])/(r["totoal"]-r["m"]),r["acc"]=(r["tp"]+r["tn"])/r["totoal"],r["precision"]=r["tp"]+r["fp"]==0?0:r["tp"]/(r["tp"]+r["fp"]),r["recall"]=r["tp"]+r["fn"]==0?0:r["tp"]/(r["tp"]+r["fn"]),r["f1"]=r["recall"]+r["precision"]==0?0:2*r["recall"]*r["precision"]/(r["recall"]+r["precision"]),1==r["rejec_rate"]?r["mcc"]=1:0==Math.sqrt((r.tp+r.fp)*(r.tp+r.fn)*(r.tn+r.fp)*(r.tn+r.fn))?r["mcc"]=0:r["mcc"]=1==r["rejec_rate"]?1:(r.tp*r.tn-r.fp*r.fn)/Math.sqrt((r.tp+r.fp)*(r.tp+r.fn)*(r.tn+r.fp)*(r.tn+r.fn)),r};let r=i;const{first:n,second:o}=this.selections;let l=[[...n.instances],[...o.instances]],c=0;l.forEach((i,n)=>{s[n]={},c=0;while(c<=1){s[n][c.toFixed(2)]=[];let o=c,l=c;while(parseFloat(o.toFixed(2))>=0&&parseFloat(l.toFixed(2))<=1){let t=a(r,c,o,l,i);s[n][c.toFixed(2)].push(t),l+=e,o-=e}c+=t}}),this.selectedPred=s},updatenumberOfBins(){const t=it["C"](this.$refs.svg);t.select(".svg-curve"),t.select(".slider-threshold-bin").attr("transform","translate("+this.xScale(20*this.numberOfBins*10)+", -7.5)");if(this.thresholds.includes(parseFloat(this.numberOfBins).toFixed(2))){t.select(".bin-text").text("Threshold: "+this.numberOfBins);this.tmp_threshold=parseFloat(this.numberOfBins).toFixed(2)}},drawLineHover(){const t=it["C"](this.$refs.svg),e=this.value[0].name;let s=[];this.thresholdList.forEach(t=>{s.push(t)}),s.push(this.tmp_threshold),this.lineHover.line_idx?s.forEach((s,i)=>{if(i!=this.lineHover.line_idx){let a=this.predictions[e][parseFloat(s).toFixed(2)];t.select(".line-threshold-"+i).attr("opacity",.2),t.select(".text-threshold-"+i).attr("opacity",.2),a.forEach((e,s)=>{t.select(".dot-"+i+"-"+s).attr("opacity",.2)})}}):s.forEach((s,i)=>{let a=this.predictions[e][parseFloat(s).toFixed(2)];t.select(".line-threshold-"+i).attr("opacity",1),t.select(".text-threshold-"+i).attr("opacity",1),a.forEach((e,s)=>{t.select(".dot-"+i+"-"+s).attr("opacity",1)})})},drawHover(){const t=it["C"](this.$refs.svg);this.hover.info?(t.select(".hover-box").attr("visibility","visible"),t.select(".hover-left").attr("visibility","visible").text("Left bound: "+this.hover.info.left_edge),t.select(".hover-right").attr("visibility","visible").text("Right bound: "+this.hover.info.right_edge),t.select(".hover-rej").attr("visibility","visible").text("Rej rate: "+this.hover.info.rejec_rate.toFixed(3)),t.select(".hover-acc").attr("visibility","visible").text("c_accuracy"==this.evaluationKeys?"Acc(Conditional): "+this.hover.info.c_acc.toFixed(3):"acc"==this.evaluationKeys?"Acc: "+this.hover.info.acc.toFixed(3):"precision"==this.evaluationKeys?"Precision: "+this.hover.info.precision.toFixed(3):"recall"==this.evaluationKeys?"Recall: "+this.hover.info.recall.toFixed(3):"mcc"==this.evaluationKeys?"MCC: "+this.hover.info.mcc.toFixed(3):"F1: "+this.hover.info.f1.toFixed(3))):(t.select(".hover-box").attr("visibility","hidden"),t.select(".hover-left").attr("visibility","hidden"),t.select(".hover-right").attr("visibility","hidden"),t.select(".hover-acc").attr("visibility","hidden"),t.select(".hover-rej").attr("visibility","hidden"))},drawWithinInitial(){it["C"](this.$refs.svg).selectAll("*").remove();const t=it["C"](this.$refs.svg).append("svg").attr("class","initail_svg").attr("width","100%").attr("viewBox",`0 0\n          ${this.width+this.margin.left+this.margin.right}\n          ${1.2*(this.height+this.margin.top+this.margin.bottom)}`),e=t.append("g").attr("transform",`translate(0, ${1.2*this.margin.top})`),s=(t.append("g").attr("class","svg-curve").attr("transform",`translate(${this.margin.left}, ${1.2*this.margin.top})`),e.append("g").attr("class","legend").attr("transform",`translate(\n              ${this.width-this.margin.left},\n              ${-this.margin.top})`)),i=s.append("g").attr("transform","translate("+(this.width/3-200-80)+",0)"),a=()=>{i.append("line").attr("class","track").style("stroke","lightgrey").style("stroke-opacity","1").style("stroke-width","6").attr("x1",this.xScale.range()[0]).attr("x2",this.xScale.range()[1]).attr("y1",0).attr("y2",0);let t=i.append("rect").attr("width",20).attr("height",15).attr("rx",6).attr("ry",6).style("fill","steelblue").style("stroke","none").attr("class","slider-threshold-bin").attr("transform","translate(100,-7.5)").call(it["h"]().on("start.interrupt",(function(){t.interrupt()})).on("start drag",t=>this.numberOfBins=(.1*this.xScale.invert(it["i"].x)/20).toFixed(2)));i.append("text").attr("class","bin-text").attr("transform","translate(-100,0)").attr("font-size","24px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("Threshold: "+this.numberOfBins),i.append("rect").attr("width",40).attr("height",20).attr("rx",6).attr("ry",6).attr("fill","#f2f2f2").attr("stroke","lightgrey").attr("class","add-button").attr("transform","translate(210,-7.5)").on("click",(t,e)=>this.currentThresholds={threshold:this.tmp_threshold}),i.append("text").attr("class","add-text").attr("transform","translate(230,2)").attr("font-size","18px").attr("text-anchor","middle").attr("alignment-baseline","middle").text("add").attr("fill","grey").on("click",(t,e)=>this.currentThresholds={threshold:this.tmp_threshold})},r=()=>{i.append("rect").attr("class","hover-box").attr("width",240).attr("height",100).attr("x",200-this.width).attr("y",-20).attr("fill","white").attr("stroke","black").attr("visibility","hidden"),i.append("text").attr("class","hover-left").attr("x",202-this.width).attr("y",0).attr("font-size",20).text("Left bound").attr("visibility","hidden"),i.append("text").attr("class","hover-right").attr("x",202-this.width).attr("y",20).text("Right bound").attr("font-size",20).attr("visibility","hidden"),i.append("text").attr("class","hover-rej").attr("x",202-this.width).attr("y",40).text("Rej Rate").attr("font-size",20).attr("visibility","hidden"),i.append("text").attr("class","hover-acc").attr("x",202-this.width).attr("y",60).text("Acc(conditional)").attr("font-size",20).attr("visibility","hidden")};r(),"yes"!=this.multilClassifier&&a()},drawStreamChart(){const t=it["C"](this.$refs.svg),e=0==this.value.length?"":this.value[this.value.length-1].name,s=t.select(".svg-curve");s.selectAll("*").remove();this.instances,this.thresholds,this.evaluationKeys;const i=this.evaluationKeys,a=it["y"]().domain([this.leftRate,this.rightRate]).range([0,.9*this.width]),r=it["y"]().domain(["mcc"==i?-1:0,1]).range([this.height,0]),n=this.value[0].name,o=it["B"](it["l"]).domain([0,2*(this.thresholdList.length+1)]).interpolator((function(t){return it["l"](.8*t)}));let l=[];this.thresholdList.forEach(t=>{l.push(t)}),l.push(this.tmp_threshold);const c=()=>{l.forEach((t,e)=>{let l=this.predictions[n][parseFloat(t).toFixed(2)],c=l.filter(t=>t.rejec_rate>=this.leftRate&&t.rejec_rate<=this.rightRate),h=c.sort((t,e)=>t.rejec_rate<e.rejec_rate?1:t.rejec_rate>e.rejec_rate?-1:0);function d(){return it["s"]()(h.map((function(t,e){let s=r("c_accuracy"==i?t.c_acc:"f1"==i?t.f1:"precision"==i?t.precision:"recall"==i?t.recall:"mcc"==i?t.mcc:t.acc);return[a(t.rejec_rate),s]})))}"mcc"==i&&(h=h.filter(t=>t.rejec_rate<=.8)),s.append("path").attr("class","").attr("class","line-threshold-"+e).attr("d",d()).style("fill","none").attr("stroke",o(e+1)).style("stroke-width",3),s.selectAll(".dot").data(h).enter().append("circle").attr("class",(t,s)=>"dot-"+e+"-"+s).attr("cx",t=>a(t["rejec_rate"])).attr("cy",t=>{let e=r("c_accuracy"==i?t["c_acc"]:"f1"==i?t["f1"]:"precision"==i?t["precision"]:"recall"==i?t["recall"]:"mcc"==i?t["mcc"]:t["acc"]);return e}).attr("r",5).attr("fill",o(e+1)).attr("stroke","steelblue").on("mouseenter",(t,s)=>this.hover={info:t,idx:s,line_idx:e}).on("mouseleave",(t,e)=>this.hover={info:"",idx:"",line_idx:""}).on("click",(t,e)=>this.click={classifier:n,left_range:t["left_edge"],right_range:t["right_edge"]}).attr("opacity",1),s.append("text").attr("transform",()=>{const t=this.width-100,s=this.height+20*e+this.margin.bottom;return`translate(${t}, ${s})`}).attr("class","text-threshold-"+e).style("text-anchor","middle").style("font-size","24px").attr("fill",o(e+1)).text("Threshold "+t).on("mouseenter",()=>this.lineHover={info:"",line_idx:e}).on("mouseleave",()=>this.lineHover={info:"",line_idx:""})})},h=()=>{const t=it["B"](it["n"]).domain([0,this.classifiers.length]).interpolator((function(t){return it["n"](.8*t)}));this.value.forEach((e,n)=>{let o=e.name,l=(2*Math.floor(this.classifierThresholds[o]/2)/100).toFixed(2),c=this.predictions[o][parseFloat(l).toFixed(2)],h=c.filter(t=>t.rejec_rate>=this.leftRate&&t.rejec_rate<=this.rightRate),d=h.sort((t,e)=>t.rejec_rate<e.rejec_rate?1:t.rejec_rate>e.rejec_rate?-1:0);function u(){return it["s"]()(d.map((function(t,e){let s=r("c_accuracy"==i?t.c_acc:"f1"==i?t.f1:"precision"==i?t.precision:"recall"==i?t.recall:"mcc"==i?t.mcc:t.acc);return[a(t.rejec_rate),s]})))}"mcc"==i&&(d=d.filter(t=>t.rejec_rate<=.8)),s.append("path").attr("class","").attr("class","line-threshold-"+n).attr("d",u()).style("fill","none").attr("stroke",t(n+1)).style("stroke-width",3),s.selectAll(".dot").data(d).enter().append("circle").attr("class",(t,e)=>"dot-"+n+"-"+e).attr("cx",t=>a(t["rejec_rate"])).attr("cy",t=>{let e=r("c_accuracy"==i?t["c_acc"]:"f1"==i?t["f1"]:"precision"==i?t["precision"]:"recall"==i?t["recall"]:"mcc"==i?t["mcc"]:t["acc"]);return e}).attr("r",5).attr("fill",t(n+1)).attr("stroke",t(n+1)).on("mouseenter",(t,e)=>this.hover={info:t,idx:e,line_idx:n}).on("mouseleave",(t,e)=>this.hover={info:"",idx:"",line_idx:""}).on("click",(t,e)=>this.click={classifier:o,left_range:t["left_edge"],right_range:t["right_edge"]}).attr("opacity",1),s.append("text").attr("transform",()=>{const t=this.width-100,e=this.height+20*n+this.margin.bottom;return`translate(${t}, ${e})`}).attr("class","text-threshold-"+n).style("text-anchor","middle").style("font-size","24px").attr("fill",t(n+1)).text(o).on("mouseenter",()=>this.lineHover={info:"",line_idx:n}).on("mouseleave",()=>this.lineHover={info:"",line_idx:""})})},d=()=>{s.append("text").attr("transform",()=>{const t=.4*this.width,e=this.height+this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Rejection Rate"),s.append("text").attr("transform","rotate(-90)").attr("x",-this.height/1.5).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("c_accuracy"==i?"Conditional Accuracy":"f1"==i?"F1":"precision"==i?"Precision":"recall"==i?"Recall":"mcc"==i?"MCC":"Accuracy"),s.append("text").attr("class","curve-title").attr("x",.4*this.width).attr("y",-100).attr("dy","1em").style("text-anchor","middle").style("font-size","32px").text("no"==this.multilClassifier?"Performance ("+e+")":"Performance")},u=()=>{let t=["0.00","0.10","0.20","0.30","0.40","0.50","0.60","0.70","0.80","0.90","1.00"],e=t.filter(t=>parseFloat(t)>=this.leftRate&&parseFloat(t)<=this.rightRate),i=it["x"]().domain(e).range([0,.9*this.width]);const a=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](i).tickSizeOuter(0)).attr("class","xAxis-curve");s.append("g").call(a).attr("font-size",20).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start").on("click",t=>{this.leftRate=parseFloat(t).toFixed(2)}).on("contextmenu",t=>this.rightRate=parseFloat(t).toFixed(2));const n=t=>t.call(it["c"](r).ticks(5).tickFormat(it["j"](".0%")));s.append("g").call(n).attr("font-size",20),s.append("rect").attr("width",40).attr("height",20).attr("x",30-this.margin.left).attr("y",this.height).attr("fill","lightgrey").attr("stroke","grey").on("click",t=>{this.leftRate=0,this.rightRate=1}),s.append("text").attr("x",35-this.margin.left).attr("y",this.height+15).attr("fill","black").attr("font-size",20).text("set").on("click",t=>{this.leftRate=0,this.rightRate=1})};u(),d(),"yes"==this.multilClassifier?h():c()},drawSelectionChart(){const t=it["C"](this.$refs.svg),e=0==this.value.length?"":this.value[this.value.length-1].name,s=t.select(".svg-curve");s.selectAll("*").remove();this.instances,this.thresholds,this.evaluationKeys;const i=this.evaluationKeys,a=it["y"]().domain([this.leftRate,this.rightRate]).range([0,.9*this.width]),r=it["y"]().domain(["mcc"==i?-1:0,1]).range([this.height,0]),{first:n,second:o}=this.selections;let l=[[...n.instances],[...o.instances]];const c=()=>{(2*Math.floor(this.classifierThresholds[e]/2)/100).toFixed(2);let t=[this.selection1Color,this.selection2Color];l.forEach((n,o)=>{let l=e,c=(2*Math.floor(this.classifierThresholds[l]/2)/100).toFixed(2),h=this.selectedPred[o][parseFloat(c).toFixed(2)],d=h.filter(t=>t.rejec_rate>=this.leftRate&&t.rejec_rate<=this.rightRate),u=d.sort((t,e)=>t.rejec_rate<e.rejec_rate?1:t.rejec_rate>e.rejec_rate?-1:0);function p(){return it["s"]()(u.map((function(t,e){let s=r("c_accuracy"==i?t.c_acc:"f1"==i?t.f1:"precision"==i?t.precision:"recall"==i?t.recall:"mcc"==i?t.mcc:t.acc);return[a(t.rejec_rate),s]})))}"mcc"==i&&(u=u.filter(t=>t.rejec_rate<=.8)),s.append("path").attr("class","").attr("class","line-threshold-"+o).attr("d",p()).style("fill","none").attr("stroke",t[o]).style("stroke-width",3),s.selectAll(".dot").data(u).enter().append("circle").attr("class",(t,e)=>"dot-"+o+"-"+e).attr("cx",t=>a(t["rejec_rate"])).attr("cy",t=>{let e=r("c_accuracy"==i?t["c_acc"]:"f1"==i?t["f1"]:"precision"==i?t["precision"]:"recall"==i?t["recall"]:"mcc"==i?t["mcc"]:t["acc"]);return e}).attr("r",5).attr("fill",t[o]).attr("stroke",t[o]).on("mouseenter",(t,e)=>this.hover={info:t,idx:e,line_idx:o}).on("mouseleave",(t,e)=>this.hover={info:"",idx:"",line_idx:""}).on("click",(t,e)=>this.click={classifier:l,left_range:t["left_edge"],right_range:t["right_edge"]}).attr("opacity",1),s.append("text").attr("transform",()=>{const t=this.width-100,e=this.height+20*o+this.margin.bottom;return`translate(${t}, ${e})`}).attr("class","text-threshold-"+o).style("text-anchor","middle").style("font-size","24px").attr("fill",t[o]).text("Selection"+(o+1)).on("mouseenter",()=>this.lineHover={info:"",line_idx:o}).on("mouseleave",()=>this.lineHover={info:"",line_idx:""})})},h=()=>{s.append("text").attr("transform",()=>{const t=.4*this.width,e=this.height+this.margin.bottom;return`translate(${t}, ${e})`}).style("text-anchor","middle").style("font-size","24px").text("Rejection Rate"),s.append("text").attr("transform","rotate(-90)").attr("x",-this.height/1.5).attr("y",.9*-this.margin.left).attr("dy","1em").style("text-anchor","middle").style("font-size","24px").text("c_accuracy"==i?"Conditional Accuracy":"f1"==i?"F1":"precision"==i?"Precision":"recall"==i?"Recall":"mcc"==i?"MCC":"Accuracy"),s.append("text").attr("class","curve-title").attr("x",.4*this.width).attr("y",-100).attr("dy","1em").style("text-anchor","middle").style("font-size","32px").text("no"==this.multilClassifier||"selected"==this.selection_mode?"Performance ("+e+")":"Performance")},d=()=>{let t=["0.00","0.10","0.20","0.30","0.40","0.50","0.60","0.70","0.80","0.90","1.00"],e=t.filter(t=>parseFloat(t)>=this.leftRate&&parseFloat(t)<=this.rightRate),i=it["x"]().domain(e).range([0,.9*this.width]);const a=t=>t.attr("transform",`translate(0, ${this.height})`).call(it["b"](i).tickSizeOuter(0)).attr("class","xAxis-curve");s.append("g").call(a).attr("font-size",20).selectAll("text").attr("transform","rotate(30)").attr("text-anchor","start").on("click",t=>{this.leftRate=parseFloat(t).toFixed(2)}).on("contextmenu",t=>this.rightRate=parseFloat(t).toFixed(2));const n=t=>t.call(it["c"](r).ticks(5).tickFormat(it["j"](".0%")));s.append("g").call(n).attr("font-size",20),s.append("rect").attr("width",40).attr("height",20).attr("x",30-this.margin.left).attr("y",this.height).attr("fill","lightgrey").attr("stroke","grey").on("click",t=>{this.leftRate=0,this.rightRate=1}),s.append("text").attr("x",35-this.margin.left).attr("y",this.height+15).attr("fill","black").attr("font-size",20).text("set").on("click",t=>{this.leftRate=0,this.rightRate=1})};d(),h(),c()},select(t,e,s,i,a){it["i"].preventDefault(),it["i"].stopPropagation();const r=nt();r.rule=X.RIGHT,r.classifier=0==this.value.length?"":this.value[this.value.length-1].name;let n=this.streamData[t]["middle_instances"][this.thresholds[e]].instances,o=(parseFloat(this.thresholds[e])-parseFloat(i["left"])).toFixed(2),l=(parseFloat(this.thresholds[e])+parseFloat(i["right"])).toFixed(2),c=`Instances which ${r.classifier} got uncertain under${o} and ${l}`;if("certainty"==a){let s=[...this.streamData[t]["ci_tp_instances"][this.thresholds[e]].instances];[...this.streamData[t]["ci_fp_instances"][this.thresholds[e]].instances].forEach(t=>{s.push(t)}),[...this.streamData[t]["ci_tn_instances"][this.thresholds[e]].instances].forEach(t=>{s.push(t)}),[...this.streamData[t]["ci_fn_instances"][this.thresholds[e]].instances].forEach(t=>{s.push(t)}),n=new Set(s),c=`Instances which ${r.classifier} got certain under${o} and ${l}`}const h={type:"simple",constraints:[r],metric:[]},d={description:c,instances:n,predicate:h};this.$store.dispatch("prependToSelectionHistory",d),this.$store.dispatch("changedMostRecentSelection",s)}}}),dn=hn,un=(s("b8a9"),Object(m["a"])(dn,ln,cn,!1,null,"f44c4014",null)),pn=un.exports;v()(un,{VExpansionPanel:j["a"],VExpansionPanelContent:K["a"],VExpansionPanelHeader:Jt["a"],VExpansionPanels:Xt["a"],VIcon:B["a"],VRadio:Zt["a"],VRadioGroup:te["a"]});var fn=i["a"].extend({name:"RigidTileHome",components:{Histogram:Yr,UncertaintyHeatMap:Ar,Performance_Overall:se,Performance_Curves:le,Trinary_Performance_Confidence:me,Reliability_Curve:be,Trinary_Bandwidth_Assessment:De,Rejected_Curve:pn,Trinary_Instance_Distribuion:$e,Performance_Selection:He,Performance_Per_Class:We,ConfusionMatrixGrid:hs,draggable:us.a,CumulativeAccuracy:ys,Sidebar:dr,PairwiseClassifierConsensus:vr,MetricsTable:Cr,MetricsParallel:Tr,InstanceList:jr,ScatterPlot:tn,FocusItem:on},data(){const t=[],e=[Q.CA,Q.CC,Q.CB,Q.RC,Q.BA,Q.REC,Q.TID,Q.UM,Q.SCP,Q.COV,Q.CMG,Q.FH,Q.OCA,Q.PCC,Q.SP,Q.SM,Q.SMP,Q.ITL,Q.FI];return{handleIcon:"☉",visualizations:t,visualizationsWithoutExternalHandle:e}},computed:{viewWidth(){return this.$store.getters.viewWidth},storeVisualizations(){return this.$store.getters.visualizations}},watch:{storeVisualizations(){this.visualizations=this.storeVisualizations}},methods:{viewWidthByName(t){return"InstanceList"===t?"100%":this.viewWidth}}}),mn=fn,gn=(s("75d2"),Object(m["a"])(mn,Z,tt,!1,null,"02fadef4",null)),vn=gn.exports,yn=s("683f"),_n=s("9a0f"),xn=s("7de8");i["a"].use(yn["a"]),Object(xn["a"])(!0),i["a"].use(_n["a"]);var bn=i["a"].extend({name:"App",components:{DatasetSelectorPopup:F,Navbar:L,RigidTileHome:vn,Multiselect:$a.a},data(){return{load_dialog:!1,value_classifier:null}},mounted(){this.$store.dispatch("loadFirstDataset"),window.addEventListener("keydown",t=>this.$store.dispatch("changedToggleShift",t)),window.addEventListener("keyup",t=>this.$store.dispatch("changedToggleShift",t))},computed:Object.assign(Object.assign({helpButtons(){return[{name:"Boxer Overview"},{name:"Boxer Views Description"},{name:"Boxer Demo Introduction"}]},viewsMapping(){return"continuous"==this.datasetType?[{view:Q.CA,view_name:"Performance (Overall)"},{view:Q.SCP,view_name:"Performance (Selection)"},{view:Q.CC,view_name:"Performance (Curves)"},{view:Q.RC,view_name:"Reliability (Curves)"},{view:Q.CB,view_name:"(Trinary) Performance Confidence"},{view:Q.BA,view_name:"(Trinary) Bandwidth Assessment"},{view:Q.REC,view_name:"(Trinary) Rejected Curve"},{view:Q.TID,view_name:"(Trinary) Instance Distribuion"},{view:Q.UM,view_name:"Uncertainty HeatMap"},{view:Q.SP,view_name:"Scatter Plot"},{view:Q.FH,view_name:"Feature Histogram"},{view:Q.CMG,view_name:"Confusion Matrix Grid"},{view:Q.PCC,view_name:"Pairwise Classifier Consensus"},{view:Q.OCA,view_name:"Cumulative Accuracy"},{view:Q.SM,view_name:"Metrics Table"},{view:Q.SMP,view_name:"Metrics Parallel"},{view:Q.ITL,view_name:"Instance List"},{view:Q.FI,view_name:"Focus Item"}]:[{view:Q.CA,view_name:"Performance (Overall)"},{view:Q.SCP,view_name:"Performance (Selection)"},{view:Q.COV,view_name:"Performance (Per Class)"},{view:Q.FH,view_name:"Feature Histogram"},{view:Q.CMG,view_name:"Confusion Matrix Grid"},{view:Q.PCC,view_name:"Pairwise Classifier Consensus"},{view:Q.OCA,view_name:"Cumulative Accuracy"},{view:Q.SM,view_name:"Metrics Table"},{view:Q.SMP,view_name:"Metrics Parallel"},{view:Q.ITL,view_name:"Instance List"},{view:Q.FI,view_name:"Focus Item"}]},classifiers(){return[...this.$store.getters.classifiers]},classes(){return[...this.$store.getters.classes]},views(){return this.$store.state.views.all},corsError(){return!this.$store.state.corsError}},Object(d["c"])(["chosenDataset"])),{snackbar(){return!this.$store.getters.intersectionMode},datasetType(){return this.$store.state.datasetType}}),watch:{value_classifier(){const t={entityType:W.Classifier,newFilter:{type:U.Exclude,set:new Set(this.value_classifier)}};this.$store.dispatch("changedFilter",t),"continuous"==this.datasetType&&this.$store.dispatch("changedContinuousMetrics")},chosenDataset(){this.load_dialog=!1},corsError(){this.$alert("Dataset load failed. Please make sure turn on the CORS extension")}},methods:{btnClick(t){if("Git Repo"==t)window.open("https://github.com/uwgraphics/Boxer/");else if("Related Use case"==t){let t=this.$store.state.chosenFixedDataset.related_use_case;window.open(t)}else"Boxer Views Description"==t?window.open("https://pages.graphics.cs.wisc.edu/BoxerDocs/docs/user_guide/view_description/"):"Boxer Demo Introduction"==t?window.open("https://pages.graphics.cs.wisc.edu/BoxerDocs/docs/publication/demo/"):window.open("https://pages.graphics.cs.wisc.edu/BoxerDocs/")},change_grid_size(){this.$store.dispatch("changedGridSize")},save_views(){this.$store.dispatch("saveViews"),this.$store.dispatch("wrtieConfig")},reload_views(){this.$store.dispatch("reloadViews")},open_repo(){this.$store.dispatch("openRepo")},resume_views(){this.$store.dispatch("resumeViews")},buttonPush(t){console.log("DOWN",t)},buttonUp(t){console.log("UP",t)},toggleIsClosed(){const t=document.getElementById("nav-1");null!==t&&t.classList.toggle("is-closed")}}}),wn=bn,Cn=(s("60bc"),s("8e5a"),s("7496")),kn=s("2db4"),Sn=Object(m["a"])(wn,o,l,!1,null,"ff96ecdc",null),zn=Sn.exports;v()(Sn,{VApp:Cn["a"],VBtn:y["a"],VDialog:A["a"],VIcon:B["a"],VList:C["a"],VListItem:k["a"],VListItemTitle:S["c"],VMenu:ti["a"],VSnackbar:kn["a"]});var $n=s("8c4f");i["a"].use($n["a"]);var Fn=new $n["a"]({mode:"history",base:"",routes:[]});i["a"].config.productionTip=!1,new i["a"]({router:Fn,store:Ht,vuetify:n,render:t=>t(zn)}).$mount("#app")},ce11:function(t,e,s){},d33c:function(t,e,s){},d638:function(t,e,s){"use strict";var i=s("4cc2"),a=s.n(i);a.a},de79:function(t,e,s){"use strict";var i=s("3cd7"),a=s.n(i);a.a},e02b:function(t,e,s){},ebf0:function(t,e,s){},eeeb:function(t,e,s){"use strict";var i=s("1030"),a=s.n(i);a.a},f0c9:function(t,e,s){},f481:function(t,e,s){}});
//# sourceMappingURL=app.1fd2a12e.js.map